Run training...
/nfs/scistore14/alistgrp/malimoha/miniconda3/envs/TXL/lib/python3.10/site-packages/torch/distributed/launch.py:178: FutureWarning: The module torch.distributed.launch is deprecated
and will be removed in future. Use torchrun.
Note that --use_env is set by default in torchrun.
If your script expects `--local_rank` argument to be set, please
change it to read from `os.environ['LOCAL_RANK']` instead. See 
https://pytorch.org/docs/stable/distributed.html#launch-utility for 
further instructions

  warnings.warn(
0: thread affinity: {0, 64, 4, 68, 8, 72, 12, 76, 92, 16, 80, 20, 84, 24, 88, 28}
5: thread affinity: {33, 97, 121, 37, 101, 41, 105, 45, 109, 49, 113, 53, 117, 125, 57, 61}
1: thread affinity: {89, 1, 65, 5, 69, 9, 73, 13, 77, 17, 81, 93, 21, 85, 25, 29}
3: thread affinity: {3, 67, 7, 71, 91, 11, 75, 15, 79, 19, 83, 87, 23, 27, 95, 31}
4: thread affinity: {32, 96, 36, 100, 40, 104, 44, 108, 120, 48, 112, 124, 52, 116, 56, 60}
7: thread affinity: {35, 99, 39, 103, 43, 107, 123, 47, 111, 51, 115, 119, 55, 59, 127, 63}
6: thread affinity: {34, 98, 126, 38, 102, 122, 42, 106, 46, 110, 50, 114, 54, 118, 58, 62}
2: thread affinity: {2, 66, 90, 6, 70, 10, 74, 14, 78, 18, 82, 22, 86, 94, 26, 30}
Experiment dir : TF32/Accordion_16_64LGreco_8_128_new
Namespace(work_dir='TF32/Accordion_16_64LGreco_8_128_new', append_dataset=False, append_time=False, cuda=True, fp16=False, restart='', debug=False, log_all_ranks=False, dllog_file='train_log.json', txtlog_file='train_log.log', save_all=False, no_env=False, no_eval=False, no_test=False, log_interval=10, target_throughput=None, target_perplexity=None, apex_amp_opt_level='O2', amp='apex', affinity='socket_unique_interleaved', data='./wikitext-103/', dataset='wt103', vocab='word', n_layer=16, n_head=8, d_head=64, d_embed=512, d_model=512, d_inner=2048, dropout=0.1, dropatt=0.0, pre_lnorm=False, attn_type=0, not_tied=False, clamp_len=-1, adaptive=True, div_val=1, sample_softmax=-1, init='normal', emb_init='normal', init_range=0.1, emb_init_range=0.01, init_std=0.02, proj_init_std=0.01, optim='jitlamb', lr=0.01, mom=0.0, scheduler='cosine', max_step_scheduler=None, warmup_step=1000, decay_rate=0.5, lr_min=0.0, clip=0.25, weight_decay=0.0, clip_nonemb=False, patience=0, eta_min=0.001, max_step=40000, batch_size=256, local_batch_size=None, batch_chunk=1, roll=True, tgt_len=192, ext_len=0, mem_len=192, seed=1111, multi_gpu='ddp', gpu0_bsz=-1, same_length=False, varlen=False, swap_mem=False, eval_tgt_len=192, eval_batch_size=16, eval_max_steps=-1, eval_interval=500, local_rank=0, powersgd_rank=32, tied=True)
world size: 8
Collecting environment information...
PyTorch version: 1.12.1+cu113
Is debug build: False
CUDA used to build PyTorch: 11.3
ROCM used to build PyTorch: N/A

OS: Debian GNU/Linux 11 (bullseye) (x86_64)
GCC version: (Debian 10.2.1-6) 10.2.1 20210110
Clang version: Could not collect
CMake version: Could not collect
Libc version: glibc-2.31

Python version: 3.10.4 (main, Mar 31 2022, 08:41:55) [GCC 7.5.0] (64-bit runtime)
Python platform: Linux-5.10.0-18-amd64-x86_64-with-glibc2.31
Is CUDA available: True
CUDA runtime version: 11.3.109
GPU models and configuration: 
GPU 0: NVIDIA GeForce RTX 3090
GPU 1: NVIDIA GeForce RTX 3090
GPU 2: NVIDIA GeForce RTX 3090
GPU 3: NVIDIA GeForce RTX 3090
GPU 4: NVIDIA GeForce RTX 3090
GPU 5: NVIDIA GeForce RTX 3090
GPU 6: NVIDIA GeForce RTX 3090
GPU 7: NVIDIA GeForce RTX 3090

Nvidia driver version: 470.141.03
cuDNN version: Could not collect
HIP runtime version: N/A
MIOpen runtime version: N/A
Is XNNPACK available: True

Versions of relevant libraries:
[pip3] numpy==1.23.2
[pip3] pytorch-transformers==1.1.0
[pip3] torch==1.12.1+cu113
[pip3] torchaudio==0.12.1+cu113
[pip3] torchvision==0.13.1+cu113
[conda] numpy                     1.23.2                   pypi_0    pypi
[conda] pytorch-transformers      1.1.0                    pypi_0    pypi
[conda] torch                     1.12.1+cu113             pypi_0    pypi
[conda] torchaudio                0.12.1+cu113             pypi_0    pypi
[conda] torchvision               0.13.1+cu113             pypi_0    pypi
Loading cached dataset...
distributed Accordion + LGreCo 32
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
distributed Accordion + LGreCo 32
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
distributed Accordion + LGreCo 32
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
distributed Accordion + LGreCo 32
distributed Accordion + LGreCo 32
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
distributed Accordion + LGreCo 32
distributed Accordion + LGreCo 32
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
distributed Accordion + LGreCo 32
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
PowerSGD config: matrix_approximation_rank = 32; start_powerSGD_iter = 1000; min_compression_rate = 2; orthogonalization_epsilon = 0; use_error_feedback = True; warm_start = True; random_seed = 0; compression_stats_logging_frequency = 10000
====================================================================================================
    - work_dir : TF32/Accordion_16_64LGreco_8_128_new
    - append_dataset : False
    - append_time : False
    - cuda : True
    - fp16 : False
    - restart : 
    - debug : False
    - log_all_ranks : False
    - dllog_file : train_log.json
    - txtlog_file : train_log.log
    - save_all : False
    - no_env : False
    - no_eval : False
    - no_test : False
    - log_interval : 10
    - target_throughput : None
    - target_perplexity : None
    - apex_amp_opt_level : O2
    - amp : apex
    - affinity : socket_unique_interleaved
    - data : ./wikitext-103/
    - dataset : wt103
    - vocab : word
    - n_layer : 16
    - n_head : 8
    - d_head : 64
    - d_embed : 512
    - d_model : 512
    - d_inner : 2048
    - dropout : 0.1
    - dropatt : 0.0
    - pre_lnorm : False
    - attn_type : 0
    - not_tied : False
    - clamp_len : -1
    - adaptive : True
    - div_val : 1
    - sample_softmax : -1
    - init : normal
    - emb_init : normal
    - init_range : 0.1
    - emb_init_range : 0.01
    - init_std : 0.02
    - proj_init_std : 0.01
    - optim : jitlamb
    - lr : 0.01
    - mom : 0.0
    - scheduler : cosine
    - max_step_scheduler : None
    - warmup_step : 1000
    - decay_rate : 0.5
    - lr_min : 0.0
    - clip : 0.25
    - weight_decay : 0.0
    - clip_nonemb : False
    - patience : 0
    - eta_min : 0.001
    - max_step : 40000
    - batch_size : 256
    - local_batch_size : None
    - batch_chunk : 1
    - roll : True
    - tgt_len : 192
    - ext_len : 0
    - mem_len : 192
    - seed : 1111
    - multi_gpu : ddp
    - gpu0_bsz : -1
    - same_length : False
    - varlen : False
    - swap_mem : False
    - eval_tgt_len : 192
    - eval_batch_size : 16
    - eval_max_steps : -1
    - eval_interval : 500
    - local_rank : 0
    - powersgd_rank : 32
    - tied : True
    - n_token : 267735
    - n_all_param : 191950298
    - n_nonemb_param : 54599680
====================================================================================================
#params = 191950298
#non emb params = 54599680
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[W reducer.cpp:1251] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
| epoch   1 step       10 | batches     10 / 2101 | lr 1.000e-04 | ms/batch 1114.6 | tok/s   44131 | loss  9.85 | ppl  18916.03
| epoch   1 step       20 | batches     20 / 2101 | lr 2.000e-04 | ms/batch 918.0 | tok/s   53541 | loss  9.72 | ppl  16598.96
| epoch   1 step       30 | batches     30 / 2101 | lr 3.000e-04 | ms/batch 910.0 | tok/s   54012 | loss  9.65 | ppl  15487.24
| epoch   1 step       40 | batches     40 / 2101 | lr 4.000e-04 | ms/batch 887.0 | tok/s   55412 | loss  9.56 | ppl  14202.10
| epoch   1 step       50 | batches     50 / 2101 | lr 5.000e-04 | ms/batch 892.6 | tok/s   55064 | loss  9.55 | ppl  14007.56
| epoch   1 step       60 | batches     60 / 2101 | lr 6.000e-04 | ms/batch 935.7 | tok/s   52530 | loss  9.49 | ppl  13212.46
| epoch   1 step       70 | batches     70 / 2101 | lr 7.000e-04 | ms/batch 930.4 | tok/s   52828 | loss  9.39 | ppl  12002.29
| epoch   1 step       80 | batches     80 / 2101 | lr 8.000e-04 | ms/batch 908.7 | tok/s   54088 | loss  9.30 | ppl  10979.77
| epoch   1 step       90 | batches     90 / 2101 | lr 9.000e-04 | ms/batch 931.8 | tok/s   52752 | loss  9.22 | ppl  10070.95
| epoch   1 step      100 | batches    100 / 2101 | lr 1.000e-03 | ms/batch 884.8 | tok/s   55553 | loss  9.10 | ppl   8978.09
| epoch   1 step      110 | batches    110 / 2101 | lr 1.100e-03 | ms/batch 972.1 | tok/s   50563 | loss  9.02 | ppl   8273.10
| epoch   1 step      120 | batches    120 / 2101 | lr 1.200e-03 | ms/batch 992.5 | tok/s   49523 | loss  8.93 | ppl   7552.60
| epoch   1 step      130 | batches    130 / 2101 | lr 1.300e-03 | ms/batch 922.2 | tok/s   53299 | loss  8.86 | ppl   7076.09
| epoch   1 step      140 | batches    140 / 2101 | lr 1.400e-03 | ms/batch 927.8 | tok/s   52976 | loss  8.79 | ppl   6555.78
| epoch   1 step      150 | batches    150 / 2101 | lr 1.500e-03 | ms/batch 1084.2 | tok/s   45333 | loss  8.73 | ppl   6164.10
| epoch   1 step      160 | batches    160 / 2101 | lr 1.600e-03 | ms/batch 919.5 | tok/s   53458 | loss  8.64 | ppl   5681.14
| epoch   1 step      170 | batches    170 / 2101 | lr 1.700e-03 | ms/batch 932.9 | tok/s   52690 | loss  8.56 | ppl   5227.58
| epoch   1 step      180 | batches    180 / 2101 | lr 1.800e-03 | ms/batch 987.6 | tok/s   49769 | loss  8.46 | ppl   4716.61
| epoch   1 step      190 | batches    190 / 2101 | lr 1.900e-03 | ms/batch 914.3 | tok/s   53762 | loss  8.37 | ppl   4333.89
| epoch   1 step      200 | batches    200 / 2101 | lr 2.000e-03 | ms/batch 926.8 | tok/s   53037 | loss  8.28 | ppl   3954.03
| epoch   1 step      210 | batches    210 / 2101 | lr 2.100e-03 | ms/batch 932.6 | tok/s   52703 | loss  8.19 | ppl   3590.34
| epoch   1 step      220 | batches    220 / 2101 | lr 2.200e-03 | ms/batch 964.9 | tok/s   50938 | loss  8.09 | ppl   3267.53
| epoch   1 step      230 | batches    230 / 2101 | lr 2.300e-03 | ms/batch 1015.5 | tok/s   48403 | loss  8.00 | ppl   2974.46
| epoch   1 step      240 | batches    240 / 2101 | lr 2.400e-03 | ms/batch 962.1 | tok/s   51089 | loss  7.91 | ppl   2714.33
| epoch   1 step      250 | batches    250 / 2101 | lr 2.500e-03 | ms/batch 973.4 | tok/s   50497 | loss  7.80 | ppl   2445.07
| epoch   1 step      260 | batches    260 / 2101 | lr 2.600e-03 | ms/batch 940.6 | tok/s   52256 | loss  7.74 | ppl   2287.85
| epoch   1 step      270 | batches    270 / 2101 | lr 2.700e-03 | ms/batch 960.3 | tok/s   51183 | loss  7.64 | ppl   2069.66
| epoch   1 step      280 | batches    280 / 2101 | lr 2.800e-03 | ms/batch 967.0 | tok/s   50829 | loss  7.54 | ppl   1882.45
| epoch   1 step      290 | batches    290 / 2101 | lr 2.900e-03 | ms/batch 889.3 | tok/s   55269 | loss  7.45 | ppl   1718.25
| epoch   1 step      300 | batches    300 / 2101 | lr 3.000e-03 | ms/batch 967.5 | tok/s   50806 | loss  7.35 | ppl   1557.26
| epoch   1 step      310 | batches    310 / 2101 | lr 3.100e-03 | ms/batch 927.8 | tok/s   52979 | loss  7.28 | ppl   1444.81
| epoch   1 step      320 | batches    320 / 2101 | lr 3.200e-03 | ms/batch 891.2 | tok/s   55150 | loss  7.21 | ppl   1352.50
| epoch   1 step      330 | batches    330 / 2101 | lr 3.300e-03 | ms/batch 961.0 | tok/s   51146 | loss  7.10 | ppl   1216.22
| epoch   1 step      340 | batches    340 / 2101 | lr 3.400e-03 | ms/batch 915.4 | tok/s   53696 | loss  7.03 | ppl   1125.73
| epoch   1 step      350 | batches    350 / 2101 | lr 3.500e-03 | ms/batch 936.1 | tok/s   52510 | loss  6.96 | ppl   1054.50
| epoch   1 step      360 | batches    360 / 2101 | lr 3.600e-03 | ms/batch 926.4 | tok/s   53058 | loss  6.89 | ppl    984.24
| epoch   1 step      370 | batches    370 / 2101 | lr 3.700e-03 | ms/batch 975.2 | tok/s   50401 | loss  6.83 | ppl    924.45
| epoch   1 step      380 | batches    380 / 2101 | lr 3.800e-03 | ms/batch 940.3 | tok/s   52276 | loss  6.80 | ppl    900.04
| epoch   1 step      390 | batches    390 / 2101 | lr 3.900e-03 | ms/batch 935.3 | tok/s   52554 | loss  6.74 | ppl    843.17
| epoch   1 step      400 | batches    400 / 2101 | lr 4.000e-03 | ms/batch 928.1 | tok/s   52957 | loss  6.68 | ppl    795.14
| epoch   1 step      410 | batches    410 / 2101 | lr 4.100e-03 | ms/batch 934.4 | tok/s   52602 | loss  6.64 | ppl    766.50
| epoch   1 step      420 | batches    420 / 2101 | lr 4.200e-03 | ms/batch 902.7 | tok/s   54448 | loss  6.60 | ppl    732.07
| epoch   1 step      430 | batches    430 / 2101 | lr 4.300e-03 | ms/batch 952.2 | tok/s   51620 | loss  6.55 | ppl    697.88
| epoch   1 step      440 | batches    440 / 2101 | lr 4.400e-03 | ms/batch 941.4 | tok/s   52213 | loss  6.51 | ppl    670.77
| epoch   1 step      450 | batches    450 / 2101 | lr 4.500e-03 | ms/batch 909.5 | tok/s   54043 | loss  6.47 | ppl    643.93
| epoch   1 step      460 | batches    460 / 2101 | lr 4.600e-03 | ms/batch 960.4 | tok/s   51181 | loss  6.46 | ppl    640.34
| epoch   1 step      470 | batches    470 / 2101 | lr 4.700e-03 | ms/batch 942.8 | tok/s   52136 | loss  6.42 | ppl    613.81
| epoch   1 step      480 | batches    480 / 2101 | lr 4.800e-03 | ms/batch 956.4 | tok/s   51395 | loss  6.37 | ppl    581.24
| epoch   1 step      490 | batches    490 / 2101 | lr 4.900e-03 | ms/batch 978.1 | tok/s   50251 | loss  6.33 | ppl    558.66
| epoch   1 step      500 | batches    500 / 2101 | lr 5.000e-03 | ms/batch 956.3 | tok/s   51400 | loss  6.31 | ppl    551.07
----------------------------------------------------------------------------------------------------
| Eval   1 at step      500 | time:  0.80s | valid loss  6.20 | valid ppl   490.351
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   1 step      510 | batches    510 / 2101 | lr 5.100e-03 | ms/batch 930.2 | tok/s   52843 | loss  6.26 | ppl    523.99
| epoch   1 step      520 | batches    520 / 2101 | lr 5.200e-03 | ms/batch 918.3 | tok/s   53525 | loss  6.25 | ppl    517.21
| epoch   1 step      530 | batches    530 / 2101 | lr 5.300e-03 | ms/batch 968.6 | tok/s   50744 | loss  6.22 | ppl    504.00
| epoch   1 step      540 | batches    540 / 2101 | lr 5.400e-03 | ms/batch 933.7 | tok/s   52640 | loss  6.21 | ppl    499.29
| epoch   1 step      550 | batches    550 / 2101 | lr 5.500e-03 | ms/batch 857.7 | tok/s   57310 | loss  6.16 | ppl    475.31
| epoch   1 step      560 | batches    560 / 2101 | lr 5.600e-03 | ms/batch 932.2 | tok/s   52725 | loss  6.12 | ppl    453.79
| epoch   1 step      570 | batches    570 / 2101 | lr 5.700e-03 | ms/batch 974.0 | tok/s   50462 | loss  6.09 | ppl    442.08
| epoch   1 step      580 | batches    580 / 2101 | lr 5.800e-03 | ms/batch 959.2 | tok/s   51243 | loss  6.08 | ppl    435.74
| epoch   1 step      590 | batches    590 / 2101 | lr 5.900e-03 | ms/batch 894.3 | tok/s   54961 | loss  6.08 | ppl    436.80
| epoch   1 step      600 | batches    600 / 2101 | lr 6.000e-03 | ms/batch 903.0 | tok/s   54432 | loss  6.05 | ppl    425.15
| epoch   1 step      610 | batches    610 / 2101 | lr 6.100e-03 | ms/batch 919.8 | tok/s   53437 | loss  6.03 | ppl    416.18
| epoch   1 step      620 | batches    620 / 2101 | lr 6.200e-03 | ms/batch 911.8 | tok/s   53905 | loss  5.99 | ppl    398.52
| epoch   1 step      630 | batches    630 / 2101 | lr 6.300e-03 | ms/batch 956.7 | tok/s   51374 | loss  5.99 | ppl    400.80
| epoch   1 step      640 | batches    640 / 2101 | lr 6.400e-03 | ms/batch 951.3 | tok/s   51668 | loss  5.97 | ppl    392.81
| epoch   1 step      650 | batches    650 / 2101 | lr 6.500e-03 | ms/batch 889.6 | tok/s   55254 | loss  5.93 | ppl    374.80
| epoch   1 step      660 | batches    660 / 2101 | lr 6.600e-03 | ms/batch 922.1 | tok/s   53305 | loss  5.91 | ppl    366.98
| epoch   1 step      670 | batches    670 / 2101 | lr 6.700e-03 | ms/batch 969.5 | tok/s   50697 | loss  5.87 | ppl    353.11
| epoch   1 step      680 | batches    680 / 2101 | lr 6.800e-03 | ms/batch 956.8 | tok/s   51371 | loss  5.90 | ppl    365.02
| epoch   1 step      690 | batches    690 / 2101 | lr 6.900e-03 | ms/batch 906.7 | tok/s   54211 | loss  5.87 | ppl    353.31
| epoch   1 step      700 | batches    700 / 2101 | lr 7.000e-03 | ms/batch 931.6 | tok/s   52763 | loss  5.84 | ppl    343.43
| epoch   1 step      710 | batches    710 / 2101 | lr 7.100e-03 | ms/batch 892.5 | tok/s   55071 | loss  5.80 | ppl    331.34
| epoch   1 step      720 | batches    720 / 2101 | lr 7.200e-03 | ms/batch 920.6 | tok/s   53392 | loss  5.79 | ppl    327.21
| epoch   1 step      730 | batches    730 / 2101 | lr 7.300e-03 | ms/batch 932.4 | tok/s   52714 | loss  5.78 | ppl    323.73
| epoch   1 step      740 | batches    740 / 2101 | lr 7.400e-03 | ms/batch 886.9 | tok/s   55421 | loss  5.74 | ppl    312.10
| epoch   1 step      750 | batches    750 / 2101 | lr 7.500e-03 | ms/batch 896.5 | tok/s   54830 | loss  5.76 | ppl    316.35
| epoch   1 step      760 | batches    760 / 2101 | lr 7.600e-03 | ms/batch 904.0 | tok/s   54369 | loss  5.73 | ppl    307.62
| epoch   1 step      770 | batches    770 / 2101 | lr 7.700e-03 | ms/batch 922.6 | tok/s   53279 | loss  5.71 | ppl    300.65
| epoch   1 step      780 | batches    780 / 2101 | lr 7.800e-03 | ms/batch 955.3 | tok/s   51453 | loss  5.67 | ppl    291.47
| epoch   1 step      790 | batches    790 / 2101 | lr 7.900e-03 | ms/batch 899.4 | tok/s   54652 | loss  5.65 | ppl    284.72
| epoch   1 step      800 | batches    800 / 2101 | lr 8.000e-03 | ms/batch 899.0 | tok/s   54674 | loss  5.66 | ppl    288.50
| epoch   1 step      810 | batches    810 / 2101 | lr 8.100e-03 | ms/batch 938.5 | tok/s   52374 | loss  5.64 | ppl    281.99
| epoch   1 step      820 | batches    820 / 2101 | lr 8.200e-03 | ms/batch 966.6 | tok/s   50849 | loss  5.64 | ppl    282.04
| epoch   1 step      830 | batches    830 / 2101 | lr 8.300e-03 | ms/batch 991.8 | tok/s   49556 | loss  5.59 | ppl    268.47
| epoch   1 step      840 | batches    840 / 2101 | lr 8.400e-03 | ms/batch 928.4 | tok/s   52942 | loss  5.58 | ppl    265.40
| epoch   1 step      850 | batches    850 / 2101 | lr 8.500e-03 | ms/batch 913.8 | tok/s   53789 | loss  5.57 | ppl    262.13
| epoch   1 step      860 | batches    860 / 2101 | lr 8.600e-03 | ms/batch 940.2 | tok/s   52279 | loss  5.55 | ppl    258.47
| epoch   1 step      870 | batches    870 / 2101 | lr 8.700e-03 | ms/batch 926.7 | tok/s   53038 | loss  5.55 | ppl    257.21
| epoch   1 step      880 | batches    880 / 2101 | lr 8.800e-03 | ms/batch 919.6 | tok/s   53451 | loss  5.54 | ppl    254.90
| epoch   1 step      890 | batches    890 / 2101 | lr 8.900e-03 | ms/batch 956.0 | tok/s   51416 | loss  5.52 | ppl    249.02
| epoch   1 step      900 | batches    900 / 2101 | lr 9.000e-03 | ms/batch 966.3 | tok/s   50866 | loss  5.44 | ppl    230.61
| epoch   1 step      910 | batches    910 / 2101 | lr 9.100e-03 | ms/batch 907.8 | tok/s   54146 | loss  5.45 | ppl    232.87
| epoch   1 step      920 | batches    920 / 2101 | lr 9.200e-03 | ms/batch 892.2 | tok/s   55091 | loss  5.45 | ppl    233.14
| epoch   1 step      930 | batches    930 / 2101 | lr 9.300e-03 | ms/batch 938.8 | tok/s   52358 | loss  5.47 | ppl    236.64
| epoch   1 step      940 | batches    940 / 2101 | lr 9.400e-03 | ms/batch 928.2 | tok/s   52952 | loss  5.46 | ppl    234.36
| epoch   1 step      950 | batches    950 / 2101 | lr 9.500e-03 | ms/batch 858.8 | tok/s   57237 | loss  5.44 | ppl    230.55
| epoch   1 step      960 | batches    960 / 2101 | lr 9.600e-03 | ms/batch 878.0 | tok/s   55982 | loss  5.41 | ppl    224.60
| epoch   1 step      970 | batches    970 / 2101 | lr 9.700e-03 | ms/batch 947.3 | tok/s   51886 | loss  5.39 | ppl    218.27
| epoch   1 step      980 | batches    980 / 2101 | lr 9.800e-03 | ms/batch 963.6 | tok/s   51010 | loss  5.36 | ppl    212.66
| epoch   1 step      990 | batches    990 / 2101 | lr 9.900e-03 | ms/batch 936.4 | tok/s   52488 | loss  5.36 | ppl    212.53
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
/nfs/scistore14/alistgrp/malimoha/miniconda3/envs/TXL/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/nfs/scistore14/alistgrp/malimoha/miniconda3/envs/TXL/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/nfs/scistore14/alistgrp/malimoha/miniconda3/envs/TXL/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/nfs/scistore14/alistgrp/malimoha/miniconda3/envs/TXL/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/nfs/scistore14/alistgrp/malimoha/miniconda3/envs/TXL/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/nfs/scistore14/alistgrp/malimoha/miniconda3/envs/TXL/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/nfs/scistore14/alistgrp/malimoha/miniconda3/envs/TXL/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
/nfs/scistore14/alistgrp/malimoha/miniconda3/envs/TXL/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
| epoch   1 step     1000 | batches   1000 / 2101 | lr 1.000e-02 | ms/batch 935.8 | tok/s   52522 | loss  5.36 | ppl    212.72
----------------------------------------------------------------------------------------------------
| Eval   2 at step     1000 | time:  0.79s | valid loss  5.20 | valid ppl   181.549
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
A zero tensor of length 270810 that represents local error is created.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
A zero tensor of length 270810 that represents local error is created.
A zero tensor of length 270810 that represents local error is created.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
A zero tensor of length 270810 that represents local error is created.
A zero tensor of length 270810 that represents local error is created.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
A zero tensor of length 270810 that represents local error is created.
A zero tensor of length 270810 that represents local error is created.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
ratio list []
accordion ranks []
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
A zero tensor of length 270810 that represents local error is created.
Allocating contiguous memory of length 0 for Ps, and of length 0 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6824960 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 6823424 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6823424 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6823424 that represents local error is created.
A zero tensor of length 6823424 that represents local error is created.
A zero tensor of length 6823424 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6823424 that represents local error is created.
A zero tensor of length 6823424 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
A zero tensor of length 6823424 that represents local error is created.
Allocating contiguous memory of length 327680 for Ps, and of length 262144 for Qs, respectively.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
A zero tensor of length 137081344 that represents local error is created.
Start to apply PowerSGD after 1000 iterations.
Start to apply PowerSGD after 1000 iterations.
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
A zero tensor of length 137081344 that represents local error is created.
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
A zero tensor of length 137081344 that represents local error is created.
A zero tensor of length 137081344 that represents local error is created.
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
A zero tensor of length 137081344 that represents local error is created.
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
A zero tensor of length 137081344 that represents local error is created.
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
A zero tensor of length 137081344 that represents local error is created.
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
A zero tensor of length 137081344 that represents local error is created.
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
Compression stats: iter 1000, total before compression 191950298, total after compression 13646522, rate 14.065876858587119
Allocating contiguous memory of length 8567520 for Ps, and of length 16384 for Qs, respectively.
| epoch   1 step     1010 | batches   1010 / 2101 | lr 1.000e-02 | ms/batch 509.6 | tok/s   96450 | loss  5.42 | ppl    225.41
| epoch   1 step     1020 | batches   1020 / 2101 | lr 1.000e-02 | ms/batch 544.4 | tok/s   90280 | loss  5.35 | ppl    210.72
| epoch   1 step     1030 | batches   1030 / 2101 | lr 1.000e-02 | ms/batch 540.5 | tok/s   90937 | loss  5.35 | ppl    210.66
| epoch   1 step     1040 | batches   1040 / 2101 | lr 1.000e-02 | ms/batch 545.1 | tok/s   90177 | loss  5.37 | ppl    215.24
| epoch   1 step     1050 | batches   1050 / 2101 | lr 1.000e-02 | ms/batch 537.5 | tok/s   91447 | loss  5.30 | ppl    200.15
| epoch   1 step     1060 | batches   1060 / 2101 | lr 1.000e-02 | ms/batch 538.1 | tok/s   91342 | loss  5.23 | ppl    186.72
| epoch   1 step     1070 | batches   1070 / 2101 | lr 1.000e-02 | ms/batch 564.1 | tok/s   87129 | loss  5.22 | ppl    185.03
| epoch   1 step     1080 | batches   1080 / 2101 | lr 1.000e-02 | ms/batch 552.7 | tok/s   88938 | loss  5.26 | ppl    192.03
| epoch   1 step     1090 | batches   1090 / 2101 | lr 1.000e-02 | ms/batch 571.4 | tok/s   86017 | loss  5.28 | ppl    195.95
| epoch   1 step     1100 | batches   1100 / 2101 | lr 1.000e-02 | ms/batch 536.3 | tok/s   91657 | loss  5.22 | ppl    185.25
| epoch   1 step     1110 | batches   1110 / 2101 | lr 1.000e-02 | ms/batch 552.0 | tok/s   89040 | loss  5.21 | ppl    182.51
| epoch   1 step     1120 | batches   1120 / 2101 | lr 1.000e-02 | ms/batch 549.6 | tok/s   89430 | loss  5.20 | ppl    181.88
| epoch   1 step     1130 | batches   1130 / 2101 | lr 1.000e-02 | ms/batch 539.6 | tok/s   91097 | loss  5.23 | ppl    186.99
| epoch   1 step     1140 | batches   1140 / 2101 | lr 1.000e-02 | ms/batch 554.6 | tok/s   88620 | loss  5.26 | ppl    193.40
| epoch   1 step     1150 | batches   1150 / 2101 | lr 1.000e-02 | ms/batch 544.4 | tok/s   90283 | loss  5.20 | ppl    181.31
| epoch   1 step     1160 | batches   1160 / 2101 | lr 1.000e-02 | ms/batch 549.2 | tok/s   89495 | loss  5.21 | ppl    182.69
| epoch   1 step     1170 | batches   1170 / 2101 | lr 1.000e-02 | ms/batch 563.1 | tok/s   87291 | loss  5.17 | ppl    176.11
| epoch   1 step     1180 | batches   1180 / 2101 | lr 1.000e-02 | ms/batch 560.6 | tok/s   87672 | loss  5.20 | ppl    182.14
| epoch   1 step     1190 | batches   1190 / 2101 | lr 9.999e-03 | ms/batch 535.3 | tok/s   91829 | loss  5.18 | ppl    177.08
| epoch   1 step     1200 | batches   1200 / 2101 | lr 9.999e-03 | ms/batch 551.4 | tok/s   89147 | loss  5.18 | ppl    177.26
| epoch   1 step     1210 | batches   1210 / 2101 | lr 9.999e-03 | ms/batch 533.3 | tok/s   92166 | loss  5.17 | ppl    175.42
| epoch   1 step     1220 | batches   1220 / 2101 | lr 9.999e-03 | ms/batch 535.5 | tok/s   91791 | loss  5.15 | ppl    173.29
| epoch   1 step     1230 | batches   1230 / 2101 | lr 9.999e-03 | ms/batch 575.4 | tok/s   85417 | loss  5.16 | ppl    174.10
| epoch   1 step     1240 | batches   1240 / 2101 | lr 9.999e-03 | ms/batch 535.5 | tok/s   91796 | loss  5.16 | ppl    173.75
| epoch   1 step     1250 | batches   1250 / 2101 | lr 9.999e-03 | ms/batch 560.9 | tok/s   87629 | loss  5.17 | ppl    175.42
| epoch   1 step     1260 | batches   1260 / 2101 | lr 9.999e-03 | ms/batch 536.6 | tok/s   91606 | loss  5.14 | ppl    171.04
| epoch   1 step     1270 | batches   1270 / 2101 | lr 9.999e-03 | ms/batch 545.2 | tok/s   90163 | loss  5.13 | ppl    169.86
| epoch   1 step     1280 | batches   1280 / 2101 | lr 9.999e-03 | ms/batch 535.4 | tok/s   91806 | loss  5.12 | ppl    168.06
| epoch   1 step     1290 | batches   1290 / 2101 | lr 9.999e-03 | ms/batch 534.4 | tok/s   91979 | loss  5.07 | ppl    159.18
| epoch   1 step     1300 | batches   1300 / 2101 | lr 9.999e-03 | ms/batch 535.2 | tok/s   91835 | loss  5.04 | ppl    154.77
| epoch   1 step     1310 | batches   1310 / 2101 | lr 9.999e-03 | ms/batch 534.4 | tok/s   91982 | loss  5.05 | ppl    155.54
| epoch   1 step     1320 | batches   1320 / 2101 | lr 9.999e-03 | ms/batch 515.3 | tok/s   95386 | loss  5.02 | ppl    151.18
| epoch   1 step     1330 | batches   1330 / 2101 | lr 9.998e-03 | ms/batch 547.5 | tok/s   89776 | loss  5.04 | ppl    154.46
| epoch   1 step     1340 | batches   1340 / 2101 | lr 9.998e-03 | ms/batch 549.3 | tok/s   89480 | loss  5.04 | ppl    154.98
| epoch   1 step     1350 | batches   1350 / 2101 | lr 9.998e-03 | ms/batch 530.2 | tok/s   92705 | loss  5.00 | ppl    148.15
| epoch   1 step     1360 | batches   1360 / 2101 | lr 9.998e-03 | ms/batch 528.2 | tok/s   93051 | loss  5.00 | ppl    148.30
| epoch   1 step     1370 | batches   1370 / 2101 | lr 9.998e-03 | ms/batch 518.2 | tok/s   94845 | loss  5.01 | ppl    149.26
| epoch   1 step     1380 | batches   1380 / 2101 | lr 9.998e-03 | ms/batch 547.4 | tok/s   89793 | loss  5.00 | ppl    148.74
| epoch   1 step     1390 | batches   1390 / 2101 | lr 9.998e-03 | ms/batch 544.5 | tok/s   90264 | loss  4.96 | ppl    142.29
| epoch   1 step     1400 | batches   1400 / 2101 | lr 9.998e-03 | ms/batch 546.1 | tok/s   90006 | loss  5.02 | ppl    150.99
| epoch   1 step     1410 | batches   1410 / 2101 | lr 9.998e-03 | ms/batch 514.4 | tok/s   95554 | loss  5.04 | ppl    154.43
| epoch   1 step     1420 | batches   1420 / 2101 | lr 9.997e-03 | ms/batch 516.0 | tok/s   95260 | loss  5.00 | ppl    148.34
| epoch   1 step     1430 | batches   1430 / 2101 | lr 9.997e-03 | ms/batch 556.7 | tok/s   88287 | loss  5.02 | ppl    151.07
| epoch   1 step     1440 | batches   1440 / 2101 | lr 9.997e-03 | ms/batch 541.3 | tok/s   90800 | loss  4.98 | ppl    144.86
| epoch   1 step     1450 | batches   1450 / 2101 | lr 9.997e-03 | ms/batch 529.5 | tok/s   92829 | loss  4.94 | ppl    139.16
| epoch   1 step     1460 | batches   1460 / 2101 | lr 9.997e-03 | ms/batch 515.3 | tok/s   95389 | loss  4.96 | ppl    142.00
| epoch   1 step     1470 | batches   1470 / 2101 | lr 9.997e-03 | ms/batch 542.5 | tok/s   90611 | loss  4.90 | ppl    134.77
| epoch   1 step     1480 | batches   1480 / 2101 | lr 9.997e-03 | ms/batch 515.4 | tok/s   95364 | loss  4.90 | ppl    134.32
| epoch   1 step     1490 | batches   1490 / 2101 | lr 9.996e-03 | ms/batch 531.2 | tok/s   92529 | loss  4.94 | ppl    139.50
| epoch   1 step     1500 | batches   1500 / 2101 | lr 9.996e-03 | ms/batch 528.2 | tok/s   93065 | loss  4.88 | ppl    131.80
----------------------------------------------------------------------------------------------------
| Eval   3 at step     1500 | time:  0.88s | valid loss  4.71 | valid ppl   110.664
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   1 step     1510 | batches   1510 / 2101 | lr 9.996e-03 | ms/batch 556.3 | tok/s   88364 | loss  4.89 | ppl    133.24
| epoch   1 step     1520 | batches   1520 / 2101 | lr 9.996e-03 | ms/batch 544.1 | tok/s   90344 | loss  4.90 | ppl    134.95
| epoch   1 step     1530 | batches   1530 / 2101 | lr 9.996e-03 | ms/batch 546.8 | tok/s   89885 | loss  4.96 | ppl    141.89
| epoch   1 step     1540 | batches   1540 / 2101 | lr 9.996e-03 | ms/batch 545.0 | tok/s   90183 | loss  4.90 | ppl    134.92
| epoch   1 step     1550 | batches   1550 / 2101 | lr 9.996e-03 | ms/batch 532.3 | tok/s   92335 | loss  4.91 | ppl    135.83
| epoch   1 step     1560 | batches   1560 / 2101 | lr 9.995e-03 | ms/batch 571.2 | tok/s   86050 | loss  4.83 | ppl    125.22
| epoch   1 step     1570 | batches   1570 / 2101 | lr 9.995e-03 | ms/batch 541.9 | tok/s   90706 | loss  4.85 | ppl    127.26
| epoch   1 step     1580 | batches   1580 / 2101 | lr 9.995e-03 | ms/batch 544.8 | tok/s   90224 | loss  4.86 | ppl    128.42
| epoch   1 step     1590 | batches   1590 / 2101 | lr 9.995e-03 | ms/batch 534.2 | tok/s   92015 | loss  4.90 | ppl    134.57
| epoch   1 step     1600 | batches   1600 / 2101 | lr 9.995e-03 | ms/batch 588.8 | tok/s   83479 | loss  4.87 | ppl    130.82
| epoch   1 step     1610 | batches   1610 / 2101 | lr 9.995e-03 | ms/batch 559.9 | tok/s   87791 | loss  4.86 | ppl    128.46
| epoch   1 step     1620 | batches   1620 / 2101 | lr 9.994e-03 | ms/batch 530.0 | tok/s   92737 | loss  4.88 | ppl    131.62
| epoch   1 step     1630 | batches   1630 / 2101 | lr 9.994e-03 | ms/batch 564.6 | tok/s   87064 | loss  4.87 | ppl    130.55
| epoch   1 step     1640 | batches   1640 / 2101 | lr 9.994e-03 | ms/batch 535.3 | tok/s   91819 | loss  4.87 | ppl    130.53
| epoch   1 step     1650 | batches   1650 / 2101 | lr 9.994e-03 | ms/batch 551.6 | tok/s   89116 | loss  4.85 | ppl    127.71
| epoch   1 step     1660 | batches   1660 / 2101 | lr 9.994e-03 | ms/batch 532.4 | tok/s   92316 | loss  4.80 | ppl    121.76
| epoch   1 step     1670 | batches   1670 / 2101 | lr 9.993e-03 | ms/batch 521.5 | tok/s   94249 | loss  4.80 | ppl    121.84
| epoch   1 step     1680 | batches   1680 / 2101 | lr 9.993e-03 | ms/batch 510.7 | tok/s   96254 | loss  4.80 | ppl    121.29
| epoch   1 step     1690 | batches   1690 / 2101 | lr 9.993e-03 | ms/batch 552.4 | tok/s   88974 | loss  4.78 | ppl    119.21
| epoch   1 step     1700 | batches   1700 / 2101 | lr 9.993e-03 | ms/batch 536.7 | tok/s   91575 | loss  4.83 | ppl    125.57
| epoch   1 step     1710 | batches   1710 / 2101 | lr 9.993e-03 | ms/batch 532.2 | tok/s   92362 | loss  4.82 | ppl    123.46
| epoch   1 step     1720 | batches   1720 / 2101 | lr 9.992e-03 | ms/batch 519.3 | tok/s   94648 | loss  4.82 | ppl    123.39
| epoch   1 step     1730 | batches   1730 / 2101 | lr 9.992e-03 | ms/batch 559.3 | tok/s   87880 | loss  4.79 | ppl    120.08
| epoch   1 step     1740 | batches   1740 / 2101 | lr 9.992e-03 | ms/batch 560.4 | tok/s   87711 | loss  4.80 | ppl    121.35
| epoch   1 step     1750 | batches   1750 / 2101 | lr 9.992e-03 | ms/batch 542.8 | tok/s   90546 | loss  4.78 | ppl    119.04
| epoch   1 step     1760 | batches   1760 / 2101 | lr 9.992e-03 | ms/batch 546.1 | tok/s   90011 | loss  4.78 | ppl    118.65
| epoch   1 step     1770 | batches   1770 / 2101 | lr 9.991e-03 | ms/batch 545.5 | tok/s   90108 | loss  4.77 | ppl    117.81
| epoch   1 step     1780 | batches   1780 / 2101 | lr 9.991e-03 | ms/batch 561.8 | tok/s   87489 | loss  4.78 | ppl    118.75
| epoch   1 step     1790 | batches   1790 / 2101 | lr 9.991e-03 | ms/batch 536.2 | tok/s   91675 | loss  4.80 | ppl    121.25
| epoch   1 step     1800 | batches   1800 / 2101 | lr 9.991e-03 | ms/batch 559.5 | tok/s   87844 | loss  4.78 | ppl    119.15
| epoch   1 step     1810 | batches   1810 / 2101 | lr 9.990e-03 | ms/batch 544.9 | tok/s   90210 | loss  4.78 | ppl    119.29
| epoch   1 step     1820 | batches   1820 / 2101 | lr 9.990e-03 | ms/batch 548.9 | tok/s   89549 | loss  4.79 | ppl    120.24
| epoch   1 step     1830 | batches   1830 / 2101 | lr 9.990e-03 | ms/batch 559.9 | tok/s   87783 | loss  4.74 | ppl    114.25
| epoch   1 step     1840 | batches   1840 / 2101 | lr 9.990e-03 | ms/batch 557.7 | tok/s   88134 | loss  4.71 | ppl    110.64
| epoch   1 step     1850 | batches   1850 / 2101 | lr 9.989e-03 | ms/batch 562.2 | tok/s   87433 | loss  4.70 | ppl    109.53
| epoch   1 step     1860 | batches   1860 / 2101 | lr 9.989e-03 | ms/batch 545.2 | tok/s   90150 | loss  4.71 | ppl    111.55
| epoch   1 step     1870 | batches   1870 / 2101 | lr 9.989e-03 | ms/batch 546.5 | tok/s   89948 | loss  4.68 | ppl    107.97
| epoch   1 step     1880 | batches   1880 / 2101 | lr 9.989e-03 | ms/batch 544.0 | tok/s   90346 | loss  4.68 | ppl    107.51
| epoch   1 step     1890 | batches   1890 / 2101 | lr 9.988e-03 | ms/batch 545.5 | tok/s   90110 | loss  4.67 | ppl    106.39
| epoch   1 step     1900 | batches   1900 / 2101 | lr 9.988e-03 | ms/batch 543.5 | tok/s   90440 | loss  4.68 | ppl    107.65
| epoch   1 step     1910 | batches   1910 / 2101 | lr 9.988e-03 | ms/batch 557.3 | tok/s   88197 | loss  4.69 | ppl    109.18
| epoch   1 step     1920 | batches   1920 / 2101 | lr 9.988e-03 | ms/batch 532.3 | tok/s   92344 | loss  4.72 | ppl    112.52
| epoch   1 step     1930 | batches   1930 / 2101 | lr 9.987e-03 | ms/batch 528.7 | tok/s   92973 | loss  4.72 | ppl    112.58
| epoch   1 step     1940 | batches   1940 / 2101 | lr 9.987e-03 | ms/batch 531.5 | tok/s   92476 | loss  4.72 | ppl    111.62
| epoch   1 step     1950 | batches   1950 / 2101 | lr 9.987e-03 | ms/batch 532.2 | tok/s   92365 | loss  4.69 | ppl    108.64
| epoch   1 step     1960 | batches   1960 / 2101 | lr 9.987e-03 | ms/batch 518.4 | tok/s   94814 | loss  4.72 | ppl    112.65
| epoch   1 step     1970 | batches   1970 / 2101 | lr 9.986e-03 | ms/batch 515.8 | tok/s   95302 | loss  4.71 | ppl    111.27
| epoch   1 step     1980 | batches   1980 / 2101 | lr 9.986e-03 | ms/batch 519.1 | tok/s   94689 | loss  4.67 | ppl    107.15
| epoch   1 step     1990 | batches   1990 / 2101 | lr 9.986e-03 | ms/batch 563.8 | tok/s   87185 | loss  4.67 | ppl    106.39
| epoch   1 step     2000 | batches   2000 / 2101 | lr 9.985e-03 | ms/batch 539.0 | tok/s   91200 | loss  4.68 | ppl    107.98
----------------------------------------------------------------------------------------------------
| Eval   4 at step     2000 | time:  0.85s | valid loss  4.43 | valid ppl    83.896
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9]
accordion ranks [[], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64]]
optimal compression parameters =  [[], [127, 127, 18, 117, 109, 124, 127, 20, 114, 126], [127, 124, 52, 108, 68, 123, 128, 18, 111, 79], [127, 125, 14, 99, 56, 128, 128, 19, 109, 67], [113, 126, 19, 92, 50, 125, 122, 31, 83, 46], [67, 87, 9, 70, 47, 88, 110, 17, 78, 52], [86, 100, 10, 82, 48, 100, 107, 16, 77, 47], [44, 91, 12, 88, 38, 76, 99, 11, 84, 39], [63, 113, 9, 103, 41, 79, 128, 17, 95, 44], [9]]
optimal compression parameters =  [[], [127, 127, 18, 117, 109, 124, 127, 20, 114, 126], [127, 124, 52, 108, 68, 123, 128, 18, 111, 79], [127, 125, 14, 99, 56, 128, 128, 19, 109, 67], [113, 126, 19, 92, 50, 125, 122, 31, 83, 46], [67, 87, 9, 70, 47, 88, 110, 17, 78, 52], [86, 100, 10, 82, 48, 100, 107, 16, 77, 47], [44, 91, 12, 88, 38, 76, 99, 11, 84, 39], [63, 113, 9, 103, 41, 79, 128, 17, 95, 44], [9]]
| epoch   1 step     2010 | batches   2010 / 2101 | lr 9.985e-03 | ms/batch 5041.0 | tok/s    9751 | loss  4.65 | ppl    104.58
| epoch   1 step     2020 | batches   2020 / 2101 | lr 9.985e-03 | ms/batch 540.4 | tok/s   90957 | loss  4.64 | ppl    103.04
| epoch   1 step     2030 | batches   2030 / 2101 | lr 9.985e-03 | ms/batch 512.8 | tok/s   95843 | loss  4.61 | ppl    100.09
| epoch   1 step     2040 | batches   2040 / 2101 | lr 9.984e-03 | ms/batch 519.1 | tok/s   94688 | loss  4.60 | ppl     99.04
| epoch   1 step     2050 | batches   2050 / 2101 | lr 9.984e-03 | ms/batch 520.9 | tok/s   94359 | loss  4.61 | ppl    100.31
| epoch   1 step     2060 | batches   2060 / 2101 | lr 9.984e-03 | ms/batch 521.8 | tok/s   94190 | loss  4.63 | ppl    102.92
| epoch   1 step     2070 | batches   2070 / 2101 | lr 9.983e-03 | ms/batch 510.2 | tok/s   96347 | loss  4.63 | ppl    102.91
| epoch   1 step     2080 | batches   2080 / 2101 | lr 9.983e-03 | ms/batch 509.1 | tok/s   96545 | loss  4.61 | ppl    100.76
| epoch   1 step     2090 | batches   2090 / 2101 | lr 9.983e-03 | ms/batch 498.7 | tok/s   98560 | loss  4.63 | ppl    102.04
| epoch   1 step     2100 | batches   2100 / 2101 | lr 9.982e-03 | ms/batch 508.3 | tok/s   96693 | loss  4.60 | ppl     99.74
| epoch   2 step     2110 | batches      9 / 2101 | lr 9.982e-03 | ms/batch 510.9 | tok/s   96337 | loss  4.61 | ppl     99.98
| epoch   2 step     2120 | batches     19 / 2101 | lr 9.982e-03 | ms/batch 508.0 | tok/s   96748 | loss  4.59 | ppl     98.46
| epoch   2 step     2130 | batches     29 / 2101 | lr 9.981e-03 | ms/batch 497.4 | tok/s   98817 | loss  4.55 | ppl     94.19
| epoch   2 step     2140 | batches     39 / 2101 | lr 9.981e-03 | ms/batch 511.0 | tok/s   96183 | loss  4.55 | ppl     94.89
| epoch   2 step     2150 | batches     49 / 2101 | lr 9.981e-03 | ms/batch 520.4 | tok/s   94458 | loss  4.54 | ppl     93.63
| epoch   2 step     2160 | batches     59 / 2101 | lr 9.980e-03 | ms/batch 511.5 | tok/s   96096 | loss  4.53 | ppl     92.60
| epoch   2 step     2170 | batches     69 / 2101 | lr 9.980e-03 | ms/batch 499.5 | tok/s   98400 | loss  4.56 | ppl     95.73
| epoch   2 step     2180 | batches     79 / 2101 | lr 9.980e-03 | ms/batch 510.0 | tok/s   96383 | loss  4.55 | ppl     94.87
| epoch   2 step     2190 | batches     89 / 2101 | lr 9.979e-03 | ms/batch 509.9 | tok/s   96400 | loss  4.53 | ppl     92.67
| epoch   2 step     2200 | batches     99 / 2101 | lr 9.979e-03 | ms/batch 509.9 | tok/s   96392 | loss  4.57 | ppl     96.85
| epoch   2 step     2210 | batches    109 / 2101 | lr 9.979e-03 | ms/batch 498.0 | tok/s   98700 | loss  4.51 | ppl     91.30
| epoch   2 step     2220 | batches    119 / 2101 | lr 9.978e-03 | ms/batch 511.3 | tok/s   96131 | loss  4.57 | ppl     96.38
| epoch   2 step     2230 | batches    129 / 2101 | lr 9.978e-03 | ms/batch 511.5 | tok/s   96096 | loss  4.54 | ppl     93.32
| epoch   2 step     2240 | batches    139 / 2101 | lr 9.978e-03 | ms/batch 509.5 | tok/s   96474 | loss  4.48 | ppl     88.54
| epoch   2 step     2250 | batches    149 / 2101 | lr 9.977e-03 | ms/batch 497.5 | tok/s   98798 | loss  4.48 | ppl     88.44
| epoch   2 step     2260 | batches    159 / 2101 | lr 9.977e-03 | ms/batch 509.5 | tok/s   96480 | loss  4.48 | ppl     88.23
| epoch   2 step     2270 | batches    169 / 2101 | lr 9.976e-03 | ms/batch 520.5 | tok/s   94434 | loss  4.50 | ppl     90.32
| epoch   2 step     2280 | batches    179 / 2101 | lr 9.976e-03 | ms/batch 510.7 | tok/s   96248 | loss  4.47 | ppl     87.28
| epoch   2 step     2290 | batches    189 / 2101 | lr 9.976e-03 | ms/batch 509.7 | tok/s   96437 | loss  4.48 | ppl     88.66
| epoch   2 step     2300 | batches    199 / 2101 | lr 9.975e-03 | ms/batch 498.5 | tok/s   98608 | loss  4.49 | ppl     89.23
| epoch   2 step     2310 | batches    209 / 2101 | lr 9.975e-03 | ms/batch 509.4 | tok/s   96483 | loss  4.50 | ppl     89.68
| epoch   2 step     2320 | batches    219 / 2101 | lr 9.975e-03 | ms/batch 510.5 | tok/s   96283 | loss  4.50 | ppl     89.85
| epoch   2 step     2330 | batches    229 / 2101 | lr 9.974e-03 | ms/batch 520.1 | tok/s   94502 | loss  4.54 | ppl     93.43
| epoch   2 step     2340 | batches    239 / 2101 | lr 9.974e-03 | ms/batch 508.3 | tok/s   96697 | loss  4.49 | ppl     88.99
| epoch   2 step     2350 | batches    249 / 2101 | lr 9.973e-03 | ms/batch 510.5 | tok/s   96275 | loss  4.48 | ppl     88.08
| epoch   2 step     2360 | batches    259 / 2101 | lr 9.973e-03 | ms/batch 512.5 | tok/s   95912 | loss  4.44 | ppl     84.68
| epoch   2 step     2370 | batches    269 / 2101 | lr 9.973e-03 | ms/batch 497.1 | tok/s   98884 | loss  4.47 | ppl     86.93
| epoch   2 step     2380 | batches    279 / 2101 | lr 9.972e-03 | ms/batch 511.0 | tok/s   96193 | loss  4.47 | ppl     87.56
| epoch   2 step     2390 | batches    289 / 2101 | lr 9.972e-03 | ms/batch 510.5 | tok/s   96282 | loss  4.48 | ppl     88.32
| epoch   2 step     2400 | batches    299 / 2101 | lr 9.971e-03 | ms/batch 511.2 | tok/s   96147 | loss  4.47 | ppl     87.20
| epoch   2 step     2410 | batches    309 / 2101 | lr 9.971e-03 | ms/batch 509.5 | tok/s   96475 | loss  4.46 | ppl     86.23
| epoch   2 step     2420 | batches    319 / 2101 | lr 9.971e-03 | ms/batch 498.0 | tok/s   98701 | loss  4.44 | ppl     85.11
| epoch   2 step     2430 | batches    329 / 2101 | lr 9.970e-03 | ms/batch 512.8 | tok/s   95852 | loss  4.47 | ppl     86.93
| epoch   2 step     2440 | batches    339 / 2101 | lr 9.970e-03 | ms/batch 509.9 | tok/s   96403 | loss  4.48 | ppl     88.34
| epoch   2 step     2450 | batches    349 / 2101 | lr 9.969e-03 | ms/batch 511.5 | tok/s   96087 | loss  4.49 | ppl     88.82
| epoch   2 step     2460 | batches    359 / 2101 | lr 9.969e-03 | ms/batch 500.0 | tok/s   98306 | loss  4.45 | ppl     85.34
| epoch   2 step     2470 | batches    369 / 2101 | lr 9.968e-03 | ms/batch 511.6 | tok/s   96082 | loss  4.42 | ppl     83.23
| epoch   2 step     2480 | batches    379 / 2101 | lr 9.968e-03 | ms/batch 509.9 | tok/s   96393 | loss  4.40 | ppl     81.76
| epoch   2 step     2490 | batches    389 / 2101 | lr 9.968e-03 | ms/batch 511.5 | tok/s   96087 | loss  4.42 | ppl     82.98
| epoch   2 step     2500 | batches    399 / 2101 | lr 9.967e-03 | ms/batch 498.5 | tok/s   98592 | loss  4.38 | ppl     79.83
----------------------------------------------------------------------------------------------------
| Eval   5 at step     2500 | time:  0.86s | valid loss  4.22 | valid ppl    68.095
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   2 step     2510 | batches    409 / 2101 | lr 9.967e-03 | ms/batch 506.7 | tok/s   97004 | loss  4.37 | ppl     79.02
| epoch   2 step     2520 | batches    419 / 2101 | lr 9.966e-03 | ms/batch 533.4 | tok/s   92157 | loss  4.44 | ppl     84.46
| epoch   2 step     2530 | batches    429 / 2101 | lr 9.966e-03 | ms/batch 515.7 | tok/s   95311 | loss  4.45 | ppl     85.45
| epoch   2 step     2540 | batches    439 / 2101 | lr 9.965e-03 | ms/batch 511.0 | tok/s   96182 | loss  4.44 | ppl     84.67
| epoch   2 step     2550 | batches    449 / 2101 | lr 9.965e-03 | ms/batch 515.8 | tok/s   95291 | loss  4.44 | ppl     84.45
| epoch   2 step     2560 | batches    459 / 2101 | lr 9.965e-03 | ms/batch 512.4 | tok/s   95932 | loss  4.40 | ppl     81.84
| epoch   2 step     2570 | batches    469 / 2101 | lr 9.964e-03 | ms/batch 510.6 | tok/s   96270 | loss  4.38 | ppl     79.48
| epoch   2 step     2580 | batches    479 / 2101 | lr 9.964e-03 | ms/batch 509.0 | tok/s   96563 | loss  4.36 | ppl     78.09
| epoch   2 step     2590 | batches    489 / 2101 | lr 9.963e-03 | ms/batch 499.9 | tok/s   98323 | loss  4.42 | ppl     82.69
| epoch   2 step     2600 | batches    499 / 2101 | lr 9.963e-03 | ms/batch 510.9 | tok/s   96208 | loss  4.43 | ppl     83.75
| epoch   2 step     2610 | batches    509 / 2101 | lr 9.962e-03 | ms/batch 509.0 | tok/s   96570 | loss  4.43 | ppl     83.61
| epoch   2 step     2620 | batches    519 / 2101 | lr 9.962e-03 | ms/batch 514.2 | tok/s   95582 | loss  4.38 | ppl     79.88
| epoch   2 step     2630 | batches    529 / 2101 | lr 9.961e-03 | ms/batch 497.8 | tok/s   98733 | loss  4.41 | ppl     82.08
| epoch   2 step     2640 | batches    539 / 2101 | lr 9.961e-03 | ms/batch 511.2 | tok/s   96151 | loss  4.42 | ppl     83.44
| epoch   2 step     2650 | batches    549 / 2101 | lr 9.960e-03 | ms/batch 511.9 | tok/s   96019 | loss  4.42 | ppl     83.12
| epoch   2 step     2660 | batches    559 / 2101 | lr 9.960e-03 | ms/batch 499.9 | tok/s   98328 | loss  4.38 | ppl     79.82
| epoch   2 step     2670 | batches    569 / 2101 | lr 9.959e-03 | ms/batch 511.8 | tok/s   96032 | loss  4.38 | ppl     80.06
| epoch   2 step     2680 | batches    579 / 2101 | lr 9.959e-03 | ms/batch 511.5 | tok/s   96086 | loss  4.41 | ppl     82.07
| epoch   2 step     2690 | batches    589 / 2101 | lr 9.958e-03 | ms/batch 511.0 | tok/s   96181 | loss  4.32 | ppl     75.56
| epoch   2 step     2700 | batches    599 / 2101 | lr 9.958e-03 | ms/batch 496.8 | tok/s   98940 | loss  4.33 | ppl     75.76
| epoch   2 step     2710 | batches    609 / 2101 | lr 9.957e-03 | ms/batch 511.3 | tok/s   96133 | loss  4.35 | ppl     77.35
| epoch   2 step     2720 | batches    619 / 2101 | lr 9.957e-03 | ms/batch 510.4 | tok/s   96293 | loss  4.36 | ppl     78.01
| epoch   2 step     2730 | batches    629 / 2101 | lr 9.956e-03 | ms/batch 510.6 | tok/s   96264 | loss  4.37 | ppl     78.89
| epoch   2 step     2740 | batches    639 / 2101 | lr 9.956e-03 | ms/batch 509.1 | tok/s   96551 | loss  4.40 | ppl     81.21
| epoch   2 step     2750 | batches    649 / 2101 | lr 9.955e-03 | ms/batch 498.9 | tok/s   98517 | loss  4.39 | ppl     80.26
| epoch   2 step     2760 | batches    659 / 2101 | lr 9.955e-03 | ms/batch 510.7 | tok/s   96241 | loss  4.40 | ppl     81.43
| epoch   2 step     2770 | batches    669 / 2101 | lr 9.954e-03 | ms/batch 511.1 | tok/s   96162 | loss  4.35 | ppl     77.43
| epoch   2 step     2780 | batches    679 / 2101 | lr 9.954e-03 | ms/batch 507.8 | tok/s   96790 | loss  4.36 | ppl     78.26
| epoch   2 step     2790 | batches    689 / 2101 | lr 9.953e-03 | ms/batch 497.6 | tok/s   98775 | loss  4.35 | ppl     77.53
| epoch   2 step     2800 | batches    699 / 2101 | lr 9.953e-03 | ms/batch 508.8 | tok/s   96608 | loss  4.31 | ppl     74.10
| epoch   2 step     2810 | batches    709 / 2101 | lr 9.952e-03 | ms/batch 522.9 | tok/s   93996 | loss  4.33 | ppl     76.22
| epoch   2 step     2820 | batches    719 / 2101 | lr 9.952e-03 | ms/batch 511.1 | tok/s   96166 | loss  4.35 | ppl     77.77
| epoch   2 step     2830 | batches    729 / 2101 | lr 9.951e-03 | ms/batch 497.9 | tok/s   98713 | loss  4.37 | ppl     79.31
| epoch   2 step     2840 | batches    739 / 2101 | lr 9.951e-03 | ms/batch 509.8 | tok/s   96407 | loss  4.33 | ppl     75.80
| epoch   2 step     2850 | batches    749 / 2101 | lr 9.950e-03 | ms/batch 511.2 | tok/s   96142 | loss  4.34 | ppl     76.72
| epoch   2 step     2860 | batches    759 / 2101 | lr 9.950e-03 | ms/batch 509.9 | tok/s   96389 | loss  4.34 | ppl     76.36
| epoch   2 step     2870 | batches    769 / 2101 | lr 9.949e-03 | ms/batch 497.8 | tok/s   98737 | loss  4.36 | ppl     77.95
| epoch   2 step     2880 | batches    779 / 2101 | lr 9.948e-03 | ms/batch 509.0 | tok/s   96568 | loss  4.35 | ppl     77.68
| epoch   2 step     2890 | batches    789 / 2101 | lr 9.948e-03 | ms/batch 510.2 | tok/s   96335 | loss  4.36 | ppl     78.15
| epoch   2 step     2900 | batches    799 / 2101 | lr 9.947e-03 | ms/batch 510.2 | tok/s   96334 | loss  4.38 | ppl     79.64
| epoch   2 step     2910 | batches    809 / 2101 | lr 9.947e-03 | ms/batch 509.5 | tok/s   96479 | loss  4.37 | ppl     78.96
| epoch   2 step     2920 | batches    819 / 2101 | lr 9.946e-03 | ms/batch 499.0 | tok/s   98506 | loss  4.39 | ppl     80.44
| epoch   2 step     2930 | batches    829 / 2101 | lr 9.946e-03 | ms/batch 510.4 | tok/s   96306 | loss  4.34 | ppl     76.59
| epoch   2 step     2940 | batches    839 / 2101 | lr 9.945e-03 | ms/batch 508.9 | tok/s   96583 | loss  4.32 | ppl     75.30
| epoch   2 step     2950 | batches    849 / 2101 | lr 9.945e-03 | ms/batch 497.5 | tok/s   98806 | loss  4.32 | ppl     75.25
| epoch   2 step     2960 | batches    859 / 2101 | lr 9.944e-03 | ms/batch 509.9 | tok/s   96392 | loss  4.33 | ppl     76.27
| epoch   2 step     2970 | batches    869 / 2101 | lr 9.943e-03 | ms/batch 509.8 | tok/s   96422 | loss  4.32 | ppl     74.83
| epoch   2 step     2980 | batches    879 / 2101 | lr 9.943e-03 | ms/batch 512.0 | tok/s   96001 | loss  4.32 | ppl     75.48
| epoch   2 step     2990 | batches    889 / 2101 | lr 9.942e-03 | ms/batch 498.2 | tok/s   98661 | loss  4.34 | ppl     76.69
| epoch   2 step     3000 | batches    899 / 2101 | lr 9.942e-03 | ms/batch 511.8 | tok/s   96041 | loss  4.33 | ppl     75.57
----------------------------------------------------------------------------------------------------
| Eval   6 at step     3000 | time:  0.85s | valid loss  4.09 | valid ppl    59.645
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.714611593469529, 0.5954310174292515, 0.6174419759832106, 0.5667150738109604, 0.5488724907423133, 0.6742475607621479, 0.5679589519410796, 0.6288324960686494, 0.6015146623833033, 0.5290926481461758, 0.7373277186857917, 0.6530218948417333, 0.5976913763712355, 0.5862717452725595, 0.5623291723104956, 0.7339031209637945, 0.6206792228408461, 0.7482822521056166, 0.5603817950391741, 0.5545063270196471, 0.6368510510055092, 0.5972731726566006, 0.5514477404871386, 0.5854940333770065, 0.5519663931201549, 0.6976521706040789, 0.5941630957850891, 0.5469612848604561, 0.6259725774144047, 0.5618495873170016, 0.6325941467833217, 0.6906915157067454, 0.690076068765718, 0.5747738854081077, 0.5472634771207905, 0.8199821823710094, 0.6724959644339946, 0.8943708134859157, 0.5739858988582532, 0.5366515927296284, 0.6672491033704175, 0.5915657329522717, 0.5968428603997857, 0.5444059878707788, 0.5294072677858334, 0.7689827136014368, 0.6568245877390289, 1.1074912299269644, 0.554999251544123, 0.5359497100615946, 0.5672466413316325, 0.543011946095173, 0.5494461939148808, 0.4919814983388088, 0.5151471995482699, 0.5818051298895667, 0.6095228505182784, 0.6003545835956389, 0.5189971835395305, 0.5276714244351954, 0.7388795743994842, 0.5861623516115122, 1.2701313234547973, 0.43902140820760316, 0.46572521031364567, 0.6615936598472149, 0.5602515269360352, 0.8002234250378554, 0.4552444538361837, 0.47934441352752777, 0.6008618809290172, 0.5792083797113844, 0.7357004317842735, 0.4517272312566316, 0.4223360256826215, 0.6207422446432657, 0.5690493404986063, 0.6113690872388476, 0.4384978948927853, 0.4513195704472099, 0.6902953424198975]
accordion ranks [[], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 64, 64, 64, 64, 64, 64, 64], [64, 64, 64, 16, 64, 64, 64, 64, 64, 64], [64, 64, 64, 16, 16, 64, 64, 64, 16, 16], [64, 64, 64, 16, 16, 64, 64, 64, 16, 16], [64]]
optimal compression parameters =  [[], [126, 128, 21, 102, 85, 126, 127, 15, 104, 123], [128, 122, 56, 87, 53, 127, 127, 21, 97, 61], [127, 127, 14, 84, 44, 128, 128, 16, 89, 46], [117, 126, 14, 77, 36, 128, 127, 36, 80, 42], [65, 89, 9, 64, 36, 94, 113, 18, 71, 39], [74, 94, 9, 62, 36, 89, 105, 13, 60, 35], [50, 84, 12, 52, 29, 67, 95, 9, 58, 32], [60, 94, 9, 49, 40, 73, 115, 13, 54, 33], [11]]
optimal compression parameters =  [[], [126, 128, 21, 102, 85, 126, 127, 15, 104, 123], [128, 122, 56, 87, 53, 127, 127, 21, 97, 61], [127, 127, 14, 84, 44, 128, 128, 16, 89, 46], [117, 126, 14, 77, 36, 128, 127, 36, 80, 42], [65, 89, 9, 64, 36, 94, 113, 18, 71, 39], [74, 94, 9, 62, 36, 89, 105, 13, 60, 35], [50, 84, 12, 52, 29, 67, 95, 9, 58, 32], [60, 94, 9, 49, 40, 73, 115, 13, 54, 33], [11]]
| epoch   2 step     3010 | batches    909 / 2101 | lr 9.941e-03 | ms/batch 4968.3 | tok/s    9893 | loss  4.34 | ppl     76.80
| epoch   2 step     3020 | batches    919 / 2101 | lr 9.941e-03 | ms/batch 501.7 | tok/s   97968 | loss  4.33 | ppl     76.21
| epoch   2 step     3030 | batches    929 / 2101 | lr 9.940e-03 | ms/batch 497.3 | tok/s   98835 | loss  4.27 | ppl     71.62
| epoch   2 step     3040 | batches    939 / 2101 | lr 9.939e-03 | ms/batch 485.7 | tok/s  101198 | loss  4.29 | ppl     73.00
| epoch   2 step     3050 | batches    949 / 2101 | lr 9.939e-03 | ms/batch 485.6 | tok/s  101223 | loss  4.30 | ppl     73.66
| epoch   2 step     3060 | batches    959 / 2101 | lr 9.938e-03 | ms/batch 486.2 | tok/s  101101 | loss  4.30 | ppl     73.75
| epoch   2 step     3070 | batches    969 / 2101 | lr 9.938e-03 | ms/batch 485.9 | tok/s  101164 | loss  4.31 | ppl     74.19
| epoch   2 step     3080 | batches    979 / 2101 | lr 9.937e-03 | ms/batch 486.1 | tok/s  101108 | loss  4.31 | ppl     74.37
| epoch   2 step     3090 | batches    989 / 2101 | lr 9.936e-03 | ms/batch 487.4 | tok/s  100840 | loss  4.32 | ppl     75.51
| epoch   2 step     3100 | batches    999 / 2101 | lr 9.936e-03 | ms/batch 487.0 | tok/s  100925 | loss  4.29 | ppl     73.16
| epoch   2 step     3110 | batches   1009 / 2101 | lr 9.935e-03 | ms/batch 487.3 | tok/s  100877 | loss  4.29 | ppl     72.70
| epoch   2 step     3120 | batches   1019 / 2101 | lr 9.935e-03 | ms/batch 487.1 | tok/s  100915 | loss  4.29 | ppl     73.11
| epoch   2 step     3130 | batches   1029 / 2101 | lr 9.934e-03 | ms/batch 487.5 | tok/s  100834 | loss  4.35 | ppl     77.34
| epoch   2 step     3140 | batches   1039 / 2101 | lr 9.933e-03 | ms/batch 487.6 | tok/s  100808 | loss  4.30 | ppl     73.97
| epoch   2 step     3150 | batches   1049 / 2101 | lr 9.933e-03 | ms/batch 487.8 | tok/s  100753 | loss  4.30 | ppl     74.01
| epoch   2 step     3160 | batches   1059 / 2101 | lr 9.932e-03 | ms/batch 487.2 | tok/s  100882 | loss  4.27 | ppl     71.87
| epoch   2 step     3170 | batches   1069 / 2101 | lr 9.931e-03 | ms/batch 500.3 | tok/s   98236 | loss  4.26 | ppl     70.91
| epoch   2 step     3180 | batches   1079 / 2101 | lr 9.931e-03 | ms/batch 487.2 | tok/s  100881 | loss  4.25 | ppl     70.12
| epoch   2 step     3190 | batches   1089 / 2101 | lr 9.930e-03 | ms/batch 487.2 | tok/s  100896 | loss  4.30 | ppl     73.43
| epoch   2 step     3200 | batches   1099 / 2101 | lr 9.930e-03 | ms/batch 487.8 | tok/s  100759 | loss  4.29 | ppl     72.61
| epoch   2 step     3210 | batches   1109 / 2101 | lr 9.929e-03 | ms/batch 511.6 | tok/s   96076 | loss  4.28 | ppl     71.98
| epoch   2 step     3220 | batches   1119 / 2101 | lr 9.928e-03 | ms/batch 488.7 | tok/s  100582 | loss  4.28 | ppl     72.01
| epoch   2 step     3230 | batches   1129 / 2101 | lr 9.928e-03 | ms/batch 487.9 | tok/s  100742 | loss  4.25 | ppl     69.80
| epoch   2 step     3240 | batches   1139 / 2101 | lr 9.927e-03 | ms/batch 487.6 | tok/s  100813 | loss  4.24 | ppl     69.40
| epoch   2 step     3250 | batches   1149 / 2101 | lr 9.926e-03 | ms/batch 487.7 | tok/s  100779 | loss  4.26 | ppl     71.13
| epoch   2 step     3260 | batches   1159 / 2101 | lr 9.926e-03 | ms/batch 487.7 | tok/s  100785 | loss  4.22 | ppl     67.88
| epoch   2 step     3270 | batches   1169 / 2101 | lr 9.925e-03 | ms/batch 488.4 | tok/s  100634 | loss  4.25 | ppl     69.87
| epoch   2 step     3280 | batches   1179 / 2101 | lr 9.924e-03 | ms/batch 487.5 | tok/s  100824 | loss  4.26 | ppl     70.87
| epoch   2 step     3290 | batches   1189 / 2101 | lr 9.924e-03 | ms/batch 488.1 | tok/s  100703 | loss  4.28 | ppl     71.89
| epoch   2 step     3300 | batches   1199 / 2101 | lr 9.923e-03 | ms/batch 487.2 | tok/s  100892 | loss  4.27 | ppl     71.41
| epoch   2 step     3310 | batches   1209 / 2101 | lr 9.922e-03 | ms/batch 487.2 | tok/s  100893 | loss  4.25 | ppl     70.27
| epoch   2 step     3320 | batches   1219 / 2101 | lr 9.922e-03 | ms/batch 487.8 | tok/s  100760 | loss  4.26 | ppl     71.00
| epoch   2 step     3330 | batches   1229 / 2101 | lr 9.921e-03 | ms/batch 487.9 | tok/s  100737 | loss  4.23 | ppl     68.92
| epoch   2 step     3340 | batches   1239 / 2101 | lr 9.920e-03 | ms/batch 487.3 | tok/s  100875 | loss  4.22 | ppl     68.33
| epoch   2 step     3350 | batches   1249 / 2101 | lr 9.920e-03 | ms/batch 488.4 | tok/s  100640 | loss  4.26 | ppl     70.85
| epoch   2 step     3360 | batches   1259 / 2101 | lr 9.919e-03 | ms/batch 487.6 | tok/s  100807 | loss  4.25 | ppl     70.27
| epoch   2 step     3370 | batches   1269 / 2101 | lr 9.918e-03 | ms/batch 486.9 | tok/s  100940 | loss  4.25 | ppl     70.14
| epoch   2 step     3380 | batches   1279 / 2101 | lr 9.918e-03 | ms/batch 488.0 | tok/s  100729 | loss  4.26 | ppl     70.54
| epoch   2 step     3390 | batches   1289 / 2101 | lr 9.917e-03 | ms/batch 487.5 | tok/s  100828 | loss  4.24 | ppl     69.21
| epoch   2 step     3400 | batches   1299 / 2101 | lr 9.916e-03 | ms/batch 487.6 | tok/s  100801 | loss  4.27 | ppl     71.42
| epoch   2 step     3410 | batches   1309 / 2101 | lr 9.915e-03 | ms/batch 488.0 | tok/s  100726 | loss  4.26 | ppl     70.94
| epoch   2 step     3420 | batches   1319 / 2101 | lr 9.915e-03 | ms/batch 487.0 | tok/s  100919 | loss  4.22 | ppl     68.35
| epoch   2 step     3430 | batches   1329 / 2101 | lr 9.914e-03 | ms/batch 487.4 | tok/s  100839 | loss  4.21 | ppl     67.29
| epoch   2 step     3440 | batches   1339 / 2101 | lr 9.913e-03 | ms/batch 487.4 | tok/s  100850 | loss  4.20 | ppl     66.48
| epoch   2 step     3450 | batches   1349 / 2101 | lr 9.913e-03 | ms/batch 487.0 | tok/s  100938 | loss  4.23 | ppl     68.73
| epoch   2 step     3460 | batches   1359 / 2101 | lr 9.912e-03 | ms/batch 488.2 | tok/s  100673 | loss  4.28 | ppl     72.57
| epoch   2 step     3470 | batches   1369 / 2101 | lr 9.911e-03 | ms/batch 487.6 | tok/s  100815 | loss  4.28 | ppl     72.19
| epoch   2 step     3480 | batches   1379 / 2101 | lr 9.911e-03 | ms/batch 487.1 | tok/s  100904 | loss  4.25 | ppl     69.80
| epoch   2 step     3490 | batches   1389 / 2101 | lr 9.910e-03 | ms/batch 487.7 | tok/s  100784 | loss  4.23 | ppl     68.85
| epoch   2 step     3500 | batches   1399 / 2101 | lr 9.909e-03 | ms/batch 488.0 | tok/s  100722 | loss  4.22 | ppl     67.94
----------------------------------------------------------------------------------------------------
| Eval   7 at step     3500 | time:  0.84s | valid loss  3.97 | valid ppl    53.209
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   2 step     3510 | batches   1409 / 2101 | lr 9.908e-03 | ms/batch 490.4 | tok/s  100242 | loss  4.23 | ppl     68.67
| epoch   2 step     3520 | batches   1419 / 2101 | lr 9.908e-03 | ms/batch 499.6 | tok/s   98387 | loss  4.24 | ppl     69.60
| epoch   2 step     3530 | batches   1429 / 2101 | lr 9.907e-03 | ms/batch 498.0 | tok/s   98700 | loss  4.24 | ppl     69.56
| epoch   2 step     3540 | batches   1439 / 2101 | lr 9.906e-03 | ms/batch 487.5 | tok/s  100816 | loss  4.18 | ppl     65.07
| epoch   2 step     3550 | batches   1449 / 2101 | lr 9.905e-03 | ms/batch 498.1 | tok/s   98687 | loss  4.18 | ppl     65.14
| epoch   2 step     3560 | batches   1459 / 2101 | lr 9.905e-03 | ms/batch 487.7 | tok/s  100780 | loss  4.21 | ppl     67.42
| epoch   2 step     3570 | batches   1469 / 2101 | lr 9.904e-03 | ms/batch 486.6 | tok/s  101007 | loss  4.21 | ppl     67.06
| epoch   2 step     3580 | batches   1479 / 2101 | lr 9.903e-03 | ms/batch 487.3 | tok/s  100877 | loss  4.19 | ppl     66.19
| epoch   2 step     3590 | batches   1489 / 2101 | lr 9.902e-03 | ms/batch 487.0 | tok/s  100938 | loss  4.18 | ppl     65.41
| epoch   2 step     3600 | batches   1499 / 2101 | lr 9.902e-03 | ms/batch 487.1 | tok/s  100917 | loss  4.20 | ppl     66.53
| epoch   2 step     3610 | batches   1509 / 2101 | lr 9.901e-03 | ms/batch 487.2 | tok/s  100883 | loss  4.19 | ppl     66.28
| epoch   2 step     3620 | batches   1519 / 2101 | lr 9.900e-03 | ms/batch 487.4 | tok/s  100843 | loss  4.19 | ppl     66.23
| epoch   2 step     3630 | batches   1529 / 2101 | lr 9.899e-03 | ms/batch 498.5 | tok/s   98595 | loss  4.23 | ppl     69.01
| epoch   2 step     3640 | batches   1539 / 2101 | lr 9.899e-03 | ms/batch 487.9 | tok/s  100745 | loss  4.24 | ppl     69.41
| epoch   2 step     3650 | batches   1549 / 2101 | lr 9.898e-03 | ms/batch 487.0 | tok/s  100932 | loss  4.20 | ppl     66.93
| epoch   2 step     3660 | batches   1559 / 2101 | lr 9.897e-03 | ms/batch 487.4 | tok/s  100843 | loss  4.15 | ppl     63.74
| epoch   2 step     3670 | batches   1569 / 2101 | lr 9.896e-03 | ms/batch 487.0 | tok/s  100928 | loss  4.17 | ppl     64.86
| epoch   2 step     3680 | batches   1579 / 2101 | lr 9.896e-03 | ms/batch 487.8 | tok/s  100754 | loss  4.23 | ppl     68.42
| epoch   2 step     3690 | batches   1589 / 2101 | lr 9.895e-03 | ms/batch 488.0 | tok/s  100720 | loss  4.18 | ppl     65.58
| epoch   2 step     3700 | batches   1599 / 2101 | lr 9.894e-03 | ms/batch 487.7 | tok/s  100791 | loss  4.17 | ppl     64.55
| epoch   2 step     3710 | batches   1609 / 2101 | lr 9.893e-03 | ms/batch 487.8 | tok/s  100760 | loss  4.19 | ppl     65.93
| epoch   2 step     3720 | batches   1619 / 2101 | lr 9.892e-03 | ms/batch 497.8 | tok/s   98740 | loss  4.21 | ppl     67.32
| epoch   2 step     3730 | batches   1629 / 2101 | lr 9.892e-03 | ms/batch 487.8 | tok/s  100767 | loss  4.18 | ppl     65.05
| epoch   2 step     3740 | batches   1639 / 2101 | lr 9.891e-03 | ms/batch 486.4 | tok/s  101055 | loss  4.16 | ppl     64.04
| epoch   2 step     3750 | batches   1649 / 2101 | lr 9.890e-03 | ms/batch 486.7 | tok/s  100986 | loss  4.16 | ppl     63.97
| epoch   2 step     3760 | batches   1659 / 2101 | lr 9.889e-03 | ms/batch 497.4 | tok/s   98820 | loss  4.20 | ppl     66.39
| epoch   2 step     3770 | batches   1669 / 2101 | lr 9.888e-03 | ms/batch 488.3 | tok/s  100651 | loss  4.23 | ppl     68.60
| epoch   2 step     3780 | batches   1679 / 2101 | lr 9.888e-03 | ms/batch 488.3 | tok/s  100667 | loss  4.20 | ppl     66.96
| epoch   2 step     3790 | batches   1689 / 2101 | lr 9.887e-03 | ms/batch 487.6 | tok/s  100795 | loss  4.20 | ppl     66.84
| epoch   2 step     3800 | batches   1699 / 2101 | lr 9.886e-03 | ms/batch 487.7 | tok/s  100779 | loss  4.16 | ppl     64.11
| epoch   2 step     3810 | batches   1709 / 2101 | lr 9.885e-03 | ms/batch 487.5 | tok/s  100815 | loss  4.15 | ppl     63.66
| epoch   2 step     3820 | batches   1719 / 2101 | lr 9.884e-03 | ms/batch 487.8 | tok/s  100766 | loss  4.18 | ppl     65.44
| epoch   2 step     3830 | batches   1729 / 2101 | lr 9.884e-03 | ms/batch 487.8 | tok/s  100769 | loss  4.19 | ppl     66.21
| epoch   2 step     3840 | batches   1739 / 2101 | lr 9.883e-03 | ms/batch 486.8 | tok/s  100971 | loss  4.19 | ppl     65.85
| epoch   2 step     3850 | batches   1749 / 2101 | lr 9.882e-03 | ms/batch 487.6 | tok/s  100814 | loss  4.21 | ppl     67.39
| epoch   2 step     3860 | batches   1759 / 2101 | lr 9.881e-03 | ms/batch 486.9 | tok/s  100953 | loss  4.18 | ppl     65.45
| epoch   2 step     3870 | batches   1769 / 2101 | lr 9.880e-03 | ms/batch 487.3 | tok/s  100870 | loss  4.14 | ppl     63.01
| epoch   2 step     3880 | batches   1779 / 2101 | lr 9.879e-03 | ms/batch 487.5 | tok/s  100822 | loss  4.15 | ppl     63.17
| epoch   2 step     3890 | batches   1789 / 2101 | lr 9.879e-03 | ms/batch 488.1 | tok/s  100700 | loss  4.22 | ppl     67.72
| epoch   2 step     3900 | batches   1799 / 2101 | lr 9.878e-03 | ms/batch 487.6 | tok/s  100806 | loss  4.15 | ppl     63.15
| epoch   2 step     3910 | batches   1809 / 2101 | lr 9.877e-03 | ms/batch 489.0 | tok/s  100523 | loss  4.16 | ppl     64.07
| epoch   2 step     3920 | batches   1819 / 2101 | lr 9.876e-03 | ms/batch 488.5 | tok/s  100618 | loss  4.18 | ppl     65.66
| epoch   2 step     3930 | batches   1829 / 2101 | lr 9.875e-03 | ms/batch 487.1 | tok/s  100913 | loss  4.18 | ppl     65.60
| epoch   2 step     3940 | batches   1839 / 2101 | lr 9.874e-03 | ms/batch 488.1 | tok/s  100706 | loss  4.17 | ppl     64.46
| epoch   2 step     3950 | batches   1849 / 2101 | lr 9.874e-03 | ms/batch 487.8 | tok/s  100755 | loss  4.17 | ppl     65.04
| epoch   2 step     3960 | batches   1859 / 2101 | lr 9.873e-03 | ms/batch 487.7 | tok/s  100777 | loss  4.21 | ppl     67.29
| epoch   2 step     3970 | batches   1869 / 2101 | lr 9.872e-03 | ms/batch 487.5 | tok/s  100832 | loss  4.16 | ppl     64.03
| epoch   2 step     3980 | batches   1879 / 2101 | lr 9.871e-03 | ms/batch 487.8 | tok/s  100774 | loss  4.14 | ppl     63.04
| epoch   2 step     3990 | batches   1889 / 2101 | lr 9.870e-03 | ms/batch 487.9 | tok/s  100750 | loss  4.19 | ppl     65.72
| epoch   2 step     4000 | batches   1899 / 2101 | lr 9.869e-03 | ms/batch 501.4 | tok/s   98036 | loss  4.16 | ppl     64.16
----------------------------------------------------------------------------------------------------
| Eval   8 at step     4000 | time:  0.85s | valid loss  3.90 | valid ppl    49.360
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.2984184665162859, 0.255465449622036, 0.30754788819419493, 0.23740642084867367, 0.208999374198961, 0.283505192266421, 0.24854698393317082, 0.274399108170621, 0.2881797763489003, 0.20249724286187826, 0.267659348616674, 0.2673215338779455, 0.30734279868015757, 0.274024292728914, 0.22934220853607182, 0.28150810240409496, 0.28354571759837566, 0.32977236778458463, 0.25393035970052463, 0.22398306141856328, 0.2972962692747404, 0.26632431122645045, 0.3176100986414386, 0.2932379329482735, 0.25245375121767877, 0.3076614500921002, 0.2726535784928212, 0.3509366065886178, 0.3272414942076038, 0.24981472991479114, 0.3418434900139097, 0.3142027362958626, 0.30657985720000214, 0.28693414497100245, 0.25233718703206454, 0.3114818721127598, 0.29575340387057614, 0.3600294412886737, 0.2777043635381848, 0.24954596956786523, 0.32028748889666997, 0.26981004480767573, 0.31333261700049697, 0.27919632007437356, 0.25581521760514625, 0.3629229655586414, 0.30920541627560016, 0.49728762263710213, 0.277030202784863, 0.2570419400311243, 0.30629362241051844, 0.2608679126073361, 0.2755577259441298, 0.24357133213738974, 0.2459693093501949, 0.2999219629173142, 0.27239876139430835, 0.23373146906043996, 0.25384728363006526, 0.24829919135770853, 0.3467079337542436, 0.27037563697419936, 0.3112477491498978, 0.21586569032469635, 0.2272398235885976, 0.34372677302049665, 0.274777036504727, 0.28978348827475386, 0.22183523367117117, 0.23503362038881406, 0.2718450856054687, 0.2798680955352439, 0.2733691244500162, 0.22901730165260312, 0.21728282978415342, 0.3079316338753839, 0.2673131263555624, 0.374352696096235, 0.21508695917542722, 0.2236307958860919, 0.24119966566711806]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [43, 56, 8, 24, 14, 47, 68, 8, 29, 15], [52, 38, 19, 10, 8, 38, 49, 9, 15, 8], [32, 47, 8, 8, 8, 34, 40, 9, 9, 8], [33, 48, 8, 8, 8, 32, 31, 13, 9, 8], [16, 24, 8, 8, 8, 25, 34, 9, 9, 8], [16, 22, 8, 8, 9, 14, 22, 8, 9, 8], [10, 9, 8, 8, 8, 11, 14, 8, 8, 8], [10, 14, 8, 8, 8, 9, 11, 8, 9, 8], [8]]
optimal compression parameters =  [[], [43, 56, 8, 24, 14, 47, 68, 8, 29, 15], [52, 38, 19, 10, 8, 38, 49, 9, 15, 8], [32, 47, 8, 8, 8, 34, 40, 9, 9, 8], [33, 48, 8, 8, 8, 32, 31, 13, 9, 8], [16, 24, 8, 8, 8, 25, 34, 9, 9, 8], [16, 22, 8, 8, 9, 14, 22, 8, 9, 8], [10, 9, 8, 8, 8, 11, 14, 8, 8, 8], [10, 14, 8, 8, 8, 9, 11, 8, 9, 8], [8]]
| epoch   2 step     4010 | batches   1909 / 2101 | lr 9.868e-03 | ms/batch 4877.8 | tok/s   10077 | loss  4.14 | ppl     62.93
| epoch   2 step     4020 | batches   1919 / 2101 | lr 9.867e-03 | ms/batch 408.9 | tok/s  120202 | loss  4.17 | ppl     64.41
| epoch   2 step     4030 | batches   1929 / 2101 | lr 9.867e-03 | ms/batch 412.0 | tok/s  119301 | loss  4.18 | ppl     65.58
| epoch   2 step     4040 | batches   1939 / 2101 | lr 9.866e-03 | ms/batch 398.9 | tok/s  123216 | loss  4.18 | ppl     65.06
| epoch   2 step     4050 | batches   1949 / 2101 | lr 9.865e-03 | ms/batch 398.8 | tok/s  123261 | loss  4.16 | ppl     64.36
| epoch   2 step     4060 | batches   1959 / 2101 | lr 9.864e-03 | ms/batch 398.7 | tok/s  123289 | loss  4.15 | ppl     63.46
| epoch   2 step     4070 | batches   1969 / 2101 | lr 9.863e-03 | ms/batch 399.2 | tok/s  123134 | loss  4.14 | ppl     62.80
| epoch   2 step     4080 | batches   1979 / 2101 | lr 9.862e-03 | ms/batch 399.5 | tok/s  123033 | loss  4.11 | ppl     61.11
| epoch   2 step     4090 | batches   1989 / 2101 | lr 9.861e-03 | ms/batch 400.0 | tok/s  122892 | loss  4.15 | ppl     63.38
| epoch   2 step     4100 | batches   1999 / 2101 | lr 9.860e-03 | ms/batch 399.8 | tok/s  122930 | loss  4.18 | ppl     65.21
| epoch   2 step     4110 | batches   2009 / 2101 | lr 9.860e-03 | ms/batch 400.1 | tok/s  122865 | loss  4.19 | ppl     65.96
| epoch   2 step     4120 | batches   2019 / 2101 | lr 9.859e-03 | ms/batch 400.4 | tok/s  122770 | loss  4.20 | ppl     66.77
| epoch   2 step     4130 | batches   2029 / 2101 | lr 9.858e-03 | ms/batch 400.4 | tok/s  122752 | loss  4.14 | ppl     63.08
| epoch   2 step     4140 | batches   2039 / 2101 | lr 9.857e-03 | ms/batch 400.0 | tok/s  122872 | loss  4.15 | ppl     63.29
| epoch   2 step     4150 | batches   2049 / 2101 | lr 9.856e-03 | ms/batch 400.8 | tok/s  122627 | loss  4.15 | ppl     63.56
| epoch   2 step     4160 | batches   2059 / 2101 | lr 9.855e-03 | ms/batch 400.9 | tok/s  122601 | loss  4.16 | ppl     64.02
| epoch   2 step     4170 | batches   2069 / 2101 | lr 9.854e-03 | ms/batch 399.8 | tok/s  122938 | loss  4.07 | ppl     58.30
| epoch   2 step     4180 | batches   2079 / 2101 | lr 9.853e-03 | ms/batch 400.9 | tok/s  122609 | loss  4.11 | ppl     61.17
| epoch   2 step     4190 | batches   2089 / 2101 | lr 9.852e-03 | ms/batch 401.1 | tok/s  122555 | loss  4.16 | ppl     63.93
| epoch   2 step     4200 | batches   2099 / 2101 | lr 9.851e-03 | ms/batch 401.3 | tok/s  122489 | loss  4.15 | ppl     63.72
| epoch   3 step     4210 | batches      8 / 2101 | lr 9.850e-03 | ms/batch 402.6 | tok/s  122309 | loss  4.19 | ppl     66.20
| epoch   3 step     4220 | batches     18 / 2101 | lr 9.849e-03 | ms/batch 401.2 | tok/s  122519 | loss  4.10 | ppl     60.45
| epoch   3 step     4230 | batches     28 / 2101 | lr 9.849e-03 | ms/batch 399.9 | tok/s  122923 | loss  4.09 | ppl     59.97
| epoch   3 step     4240 | batches     38 / 2101 | lr 9.848e-03 | ms/batch 400.7 | tok/s  122669 | loss  4.08 | ppl     58.94
| epoch   3 step     4250 | batches     48 / 2101 | lr 9.847e-03 | ms/batch 401.2 | tok/s  122500 | loss  4.09 | ppl     59.77
| epoch   3 step     4260 | batches     58 / 2101 | lr 9.846e-03 | ms/batch 400.4 | tok/s  122747 | loss  4.05 | ppl     57.38
| epoch   3 step     4270 | batches     68 / 2101 | lr 9.845e-03 | ms/batch 400.5 | tok/s  122721 | loss  4.03 | ppl     56.44
| epoch   3 step     4280 | batches     78 / 2101 | lr 9.844e-03 | ms/batch 400.0 | tok/s  122879 | loss  4.05 | ppl     57.29
| epoch   3 step     4290 | batches     88 / 2101 | lr 9.843e-03 | ms/batch 400.5 | tok/s  122717 | loss  4.05 | ppl     57.22
| epoch   3 step     4300 | batches     98 / 2101 | lr 9.842e-03 | ms/batch 401.1 | tok/s  122545 | loss  4.10 | ppl     60.23
| epoch   3 step     4310 | batches    108 / 2101 | lr 9.841e-03 | ms/batch 400.9 | tok/s  122610 | loss  4.07 | ppl     58.66
| epoch   3 step     4320 | batches    118 / 2101 | lr 9.840e-03 | ms/batch 402.4 | tok/s  122158 | loss  4.05 | ppl     57.52
| epoch   3 step     4330 | batches    128 / 2101 | lr 9.839e-03 | ms/batch 400.9 | tok/s  122593 | loss  4.02 | ppl     55.89
| epoch   3 step     4340 | batches    138 / 2101 | lr 9.838e-03 | ms/batch 400.4 | tok/s  122748 | loss  4.02 | ppl     55.85
| epoch   3 step     4350 | batches    148 / 2101 | lr 9.837e-03 | ms/batch 401.7 | tok/s  122348 | loss  4.05 | ppl     57.26
| epoch   3 step     4360 | batches    158 / 2101 | lr 9.836e-03 | ms/batch 401.1 | tok/s  122555 | loss  4.05 | ppl     57.65
| epoch   3 step     4370 | batches    168 / 2101 | lr 9.835e-03 | ms/batch 401.4 | tok/s  122444 | loss  4.02 | ppl     55.93
| epoch   3 step     4380 | batches    178 / 2101 | lr 9.834e-03 | ms/batch 401.8 | tok/s  122336 | loss  4.03 | ppl     56.15
| epoch   3 step     4390 | batches    188 / 2101 | lr 9.833e-03 | ms/batch 401.4 | tok/s  122441 | loss  4.02 | ppl     55.74
| epoch   3 step     4400 | batches    198 / 2101 | lr 9.832e-03 | ms/batch 401.2 | tok/s  122514 | loss  4.05 | ppl     57.13
| epoch   3 step     4410 | batches    208 / 2101 | lr 9.831e-03 | ms/batch 400.5 | tok/s  122732 | loss  4.04 | ppl     56.87
| epoch   3 step     4420 | batches    218 / 2101 | lr 9.830e-03 | ms/batch 400.5 | tok/s  122731 | loss  4.07 | ppl     58.39
| epoch   3 step     4430 | batches    228 / 2101 | lr 9.829e-03 | ms/batch 400.5 | tok/s  122741 | loss  4.06 | ppl     58.03
| epoch   3 step     4440 | batches    238 / 2101 | lr 9.828e-03 | ms/batch 401.0 | tok/s  122574 | loss  4.03 | ppl     56.34
| epoch   3 step     4450 | batches    248 / 2101 | lr 9.827e-03 | ms/batch 400.3 | tok/s  122802 | loss  4.00 | ppl     54.82
| epoch   3 step     4460 | batches    258 / 2101 | lr 9.826e-03 | ms/batch 400.1 | tok/s  122838 | loss  4.03 | ppl     55.99
| epoch   3 step     4470 | batches    268 / 2101 | lr 9.825e-03 | ms/batch 400.2 | tok/s  122808 | loss  4.05 | ppl     57.34
| epoch   3 step     4480 | batches    278 / 2101 | lr 9.824e-03 | ms/batch 401.3 | tok/s  122483 | loss  4.04 | ppl     57.04
| epoch   3 step     4490 | batches    288 / 2101 | lr 9.823e-03 | ms/batch 401.3 | tok/s  122496 | loss  4.06 | ppl     58.06
| epoch   3 step     4500 | batches    298 / 2101 | lr 9.822e-03 | ms/batch 401.0 | tok/s  122579 | loss  4.02 | ppl     55.97
----------------------------------------------------------------------------------------------------
| Eval   9 at step     4500 | time:  0.96s | valid loss  3.85 | valid ppl    46.840
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   3 step     4510 | batches    308 / 2101 | lr 9.821e-03 | ms/batch 403.2 | tok/s  121901 | loss  4.02 | ppl     55.89
| epoch   3 step     4520 | batches    318 / 2101 | lr 9.820e-03 | ms/batch 417.2 | tok/s  117801 | loss  4.06 | ppl     58.01
| epoch   3 step     4530 | batches    328 / 2101 | lr 9.819e-03 | ms/batch 422.3 | tok/s  116403 | loss  4.08 | ppl     59.12
| epoch   3 step     4540 | batches    338 / 2101 | lr 9.818e-03 | ms/batch 400.5 | tok/s  122726 | loss  4.08 | ppl     59.27
| epoch   3 step     4550 | batches    348 / 2101 | lr 9.817e-03 | ms/batch 426.8 | tok/s  115156 | loss  4.06 | ppl     57.96
| epoch   3 step     4560 | batches    358 / 2101 | lr 9.816e-03 | ms/batch 414.8 | tok/s  118483 | loss  4.03 | ppl     56.12
| epoch   3 step     4570 | batches    368 / 2101 | lr 9.815e-03 | ms/batch 414.3 | tok/s  118632 | loss  4.07 | ppl     58.38
| epoch   3 step     4580 | batches    378 / 2101 | lr 9.814e-03 | ms/batch 411.5 | tok/s  119450 | loss  4.04 | ppl     56.96
| epoch   3 step     4590 | batches    388 / 2101 | lr 9.813e-03 | ms/batch 413.9 | tok/s  118763 | loss  3.99 | ppl     54.10
| epoch   3 step     4600 | batches    398 / 2101 | lr 9.812e-03 | ms/batch 425.6 | tok/s  115477 | loss  4.02 | ppl     55.47
| epoch   3 step     4610 | batches    408 / 2101 | lr 9.811e-03 | ms/batch 401.3 | tok/s  122498 | loss  4.03 | ppl     56.39
| epoch   3 step     4620 | batches    418 / 2101 | lr 9.810e-03 | ms/batch 399.9 | tok/s  122920 | loss  4.02 | ppl     55.59
| epoch   3 step     4630 | batches    428 / 2101 | lr 9.809e-03 | ms/batch 399.6 | tok/s  123002 | loss  4.02 | ppl     55.87
| epoch   3 step     4640 | batches    438 / 2101 | lr 9.808e-03 | ms/batch 400.1 | tok/s  122865 | loss  4.05 | ppl     57.12
| epoch   3 step     4650 | batches    448 / 2101 | lr 9.807e-03 | ms/batch 401.2 | tok/s  122528 | loss  4.03 | ppl     56.44
| epoch   3 step     4660 | batches    458 / 2101 | lr 9.806e-03 | ms/batch 400.5 | tok/s  122738 | loss  4.02 | ppl     55.74
| epoch   3 step     4670 | batches    468 / 2101 | lr 9.805e-03 | ms/batch 412.0 | tok/s  119305 | loss  4.01 | ppl     55.00
| epoch   3 step     4680 | batches    478 / 2101 | lr 9.804e-03 | ms/batch 411.8 | tok/s  119361 | loss  4.03 | ppl     55.99
| epoch   3 step     4690 | batches    488 / 2101 | lr 9.803e-03 | ms/batch 402.0 | tok/s  122284 | loss  4.02 | ppl     55.68
| epoch   3 step     4700 | batches    498 / 2101 | lr 9.802e-03 | ms/batch 400.8 | tok/s  122631 | loss  4.01 | ppl     55.29
| epoch   3 step     4710 | batches    508 / 2101 | lr 9.801e-03 | ms/batch 401.0 | tok/s  122583 | loss  4.07 | ppl     58.50
| epoch   3 step     4720 | batches    518 / 2101 | lr 9.799e-03 | ms/batch 401.7 | tok/s  122361 | loss  4.08 | ppl     59.07
| epoch   3 step     4730 | batches    528 / 2101 | lr 9.798e-03 | ms/batch 401.2 | tok/s  122529 | loss  4.08 | ppl     59.08
| epoch   3 step     4740 | batches    538 / 2101 | lr 9.797e-03 | ms/batch 401.9 | tok/s  122311 | loss  4.08 | ppl     58.99
| epoch   3 step     4750 | batches    548 / 2101 | lr 9.796e-03 | ms/batch 400.4 | tok/s  122744 | loss  4.05 | ppl     57.44
| epoch   3 step     4760 | batches    558 / 2101 | lr 9.795e-03 | ms/batch 401.1 | tok/s  122555 | loss  4.06 | ppl     57.99
| epoch   3 step     4770 | batches    568 / 2101 | lr 9.794e-03 | ms/batch 400.1 | tok/s  122845 | loss  4.04 | ppl     56.57
| epoch   3 step     4780 | batches    578 / 2101 | lr 9.793e-03 | ms/batch 401.0 | tok/s  122587 | loss  4.01 | ppl     55.32
| epoch   3 step     4790 | batches    588 / 2101 | lr 9.792e-03 | ms/batch 400.7 | tok/s  122667 | loss  4.05 | ppl     57.44
| epoch   3 step     4800 | batches    598 / 2101 | lr 9.791e-03 | ms/batch 400.7 | tok/s  122677 | loss  4.04 | ppl     56.63
| epoch   3 step     4810 | batches    608 / 2101 | lr 9.790e-03 | ms/batch 399.9 | tok/s  122918 | loss  4.01 | ppl     55.18
| epoch   3 step     4820 | batches    618 / 2101 | lr 9.789e-03 | ms/batch 400.8 | tok/s  122642 | loss  4.05 | ppl     57.56
| epoch   3 step     4830 | batches    628 / 2101 | lr 9.788e-03 | ms/batch 400.1 | tok/s  122837 | loss  4.02 | ppl     55.88
| epoch   3 step     4840 | batches    638 / 2101 | lr 9.786e-03 | ms/batch 400.6 | tok/s  122695 | loss  4.02 | ppl     55.86
| epoch   3 step     4850 | batches    648 / 2101 | lr 9.785e-03 | ms/batch 400.0 | tok/s  122873 | loss  4.03 | ppl     56.11
| epoch   3 step     4860 | batches    658 / 2101 | lr 9.784e-03 | ms/batch 399.8 | tok/s  122942 | loss  3.99 | ppl     53.81
| epoch   3 step     4870 | batches    668 / 2101 | lr 9.783e-03 | ms/batch 399.9 | tok/s  122927 | loss  4.00 | ppl     54.41
| epoch   3 step     4880 | batches    678 / 2101 | lr 9.782e-03 | ms/batch 400.0 | tok/s  122892 | loss  4.02 | ppl     55.83
| epoch   3 step     4890 | batches    688 / 2101 | lr 9.781e-03 | ms/batch 400.7 | tok/s  122658 | loss  4.00 | ppl     54.81
| epoch   3 step     4900 | batches    698 / 2101 | lr 9.780e-03 | ms/batch 401.0 | tok/s  122589 | loss  3.99 | ppl     53.81
| epoch   3 step     4910 | batches    708 / 2101 | lr 9.779e-03 | ms/batch 400.9 | tok/s  122601 | loss  3.99 | ppl     54.18
| epoch   3 step     4920 | batches    718 / 2101 | lr 9.778e-03 | ms/batch 401.4 | tok/s  122458 | loss  4.02 | ppl     55.63
| epoch   3 step     4930 | batches    728 / 2101 | lr 9.776e-03 | ms/batch 400.9 | tok/s  122601 | loss  4.00 | ppl     54.73
| epoch   3 step     4940 | batches    738 / 2101 | lr 9.775e-03 | ms/batch 400.8 | tok/s  122625 | loss  3.99 | ppl     54.22
| epoch   3 step     4950 | batches    748 / 2101 | lr 9.774e-03 | ms/batch 401.9 | tok/s  122285 | loss  4.01 | ppl     55.41
| epoch   3 step     4960 | batches    758 / 2101 | lr 9.773e-03 | ms/batch 401.5 | tok/s  122435 | loss  3.99 | ppl     53.87
| epoch   3 step     4970 | batches    768 / 2101 | lr 9.772e-03 | ms/batch 400.6 | tok/s  122684 | loss  4.01 | ppl     55.06
| epoch   3 step     4980 | batches    778 / 2101 | lr 9.771e-03 | ms/batch 401.0 | tok/s  122571 | loss  4.01 | ppl     54.96
| epoch   3 step     4990 | batches    788 / 2101 | lr 9.770e-03 | ms/batch 401.3 | tok/s  122481 | loss  4.02 | ppl     55.95
| epoch   3 step     5000 | batches    798 / 2101 | lr 9.768e-03 | ms/batch 415.0 | tok/s  118438 | loss  3.98 | ppl     53.72
----------------------------------------------------------------------------------------------------
| Eval  10 at step     5000 | time:  0.86s | valid loss  3.80 | valid ppl    44.880
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.283336929293314, 0.23162445882497895, 0.25635164949550787, 0.21438557129952338, 0.1997785540053482, 0.266985737123404, 0.22156113553313433, 0.21595734072532835, 0.2471610250594645, 0.1946833002832521, 0.25917342707655383, 0.23613315532196183, 0.2138286542460929, 0.24836305365486208, 0.21762146900914733, 0.2893410659366267, 0.25543421581514597, 0.3037419785867513, 0.22360093418175844, 0.210828048953734, 0.26160975471183434, 0.2300372994946963, 0.19985863907471196, 0.24707968039538028, 0.2344258256650415, 0.2681111280202285, 0.2401331575192927, 0.2784601544917061, 0.27557258455851685, 0.2312203398546825, 0.27660129757000834, 0.26345829411814536, 0.27346613757668814, 0.23328276065409426, 0.22120898227363034, 0.24361590091078258, 0.23845234184125538, 0.26983327509960314, 0.22958340060974544, 0.22887052213481301, 0.2557946476283636, 0.22916034178644257, 0.20605133992503993, 0.22313547176123313, 0.21563633709403462, 0.2794281923005674, 0.25285656894436936, 0.30569766079838534, 0.22391715519710842, 0.22646197296086992, 0.226755354387855, 0.23342719323337838, 0.19526299187061907, 0.19081253720302638, 0.20309504961347374, 0.24661353093264937, 0.22236941792647003, 0.2167024983249684, 0.20388875687481678, 0.20672711747908618, 0.24697350768719462, 0.21002792880468132, 0.20834827753698917, 0.1672479139472094, 0.19297974280198246, 0.2445417194575354, 0.21335867368431083, 0.1730335813695983, 0.1752651306881661, 0.1951056276057945, 0.25266764925209273, 0.22313011400725638, 0.28038592541370416, 0.17814050103391585, 0.1828547025322105, 0.25955095571444914, 0.2049950890863813, 0.2533713649015791, 0.16743862126418535, 0.1820383320916359, 0.24658068938783767]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [45, 48, 8, 20, 12, 45, 61, 9, 28, 16], [54, 42, 17, 10, 8, 46, 52, 9, 13, 9], [33, 45, 9, 9, 8, 36, 42, 9, 10, 9], [33, 47, 8, 8, 8, 32, 24, 12, 8, 8], [15, 17, 8, 9, 8, 27, 33, 8, 9, 8], [16, 26, 8, 8, 8, 17, 22, 9, 8, 8], [12, 8, 8, 8, 8, 15, 11, 8, 8, 8], [9, 16, 9, 8, 8, 11, 10, 8, 8, 8], [8]]
optimal compression parameters =  [[], [45, 48, 8, 20, 12, 45, 61, 9, 28, 16], [54, 42, 17, 10, 8, 46, 52, 9, 13, 9], [33, 45, 9, 9, 8, 36, 42, 9, 10, 9], [33, 47, 8, 8, 8, 32, 24, 12, 8, 8], [15, 17, 8, 9, 8, 27, 33, 8, 9, 8], [16, 26, 8, 8, 8, 17, 22, 9, 8, 8], [12, 8, 8, 8, 8, 15, 11, 8, 8, 8], [9, 16, 9, 8, 8, 11, 10, 8, 8, 8], [8]]
| epoch   3 step     5010 | batches    808 / 2101 | lr 9.767e-03 | ms/batch 4892.4 | tok/s   10047 | loss  4.01 | ppl     54.89
| epoch   3 step     5020 | batches    818 / 2101 | lr 9.766e-03 | ms/batch 413.6 | tok/s  118826 | loss  4.00 | ppl     54.62
| epoch   3 step     5030 | batches    828 / 2101 | lr 9.765e-03 | ms/batch 411.4 | tok/s  119474 | loss  3.99 | ppl     54.11
| epoch   3 step     5040 | batches    838 / 2101 | lr 9.764e-03 | ms/batch 399.3 | tok/s  123084 | loss  3.98 | ppl     53.77
| epoch   3 step     5050 | batches    848 / 2101 | lr 9.763e-03 | ms/batch 422.9 | tok/s  116225 | loss  4.04 | ppl     57.09
| epoch   3 step     5060 | batches    858 / 2101 | lr 9.761e-03 | ms/batch 400.0 | tok/s  122894 | loss  4.02 | ppl     55.82
| epoch   3 step     5070 | batches    868 / 2101 | lr 9.760e-03 | ms/batch 399.8 | tok/s  122957 | loss  3.98 | ppl     53.77
| epoch   3 step     5080 | batches    878 / 2101 | lr 9.759e-03 | ms/batch 399.9 | tok/s  122898 | loss  3.99 | ppl     53.92
| epoch   3 step     5090 | batches    888 / 2101 | lr 9.758e-03 | ms/batch 400.1 | tok/s  122860 | loss  4.00 | ppl     54.51
| epoch   3 step     5100 | batches    898 / 2101 | lr 9.757e-03 | ms/batch 400.0 | tok/s  122880 | loss  4.02 | ppl     55.92
| epoch   3 step     5110 | batches    908 / 2101 | lr 9.756e-03 | ms/batch 401.0 | tok/s  122577 | loss  4.02 | ppl     55.93
| epoch   3 step     5120 | batches    918 / 2101 | lr 9.754e-03 | ms/batch 400.5 | tok/s  122730 | loss  4.00 | ppl     54.53
| epoch   3 step     5130 | batches    928 / 2101 | lr 9.753e-03 | ms/batch 401.1 | tok/s  122538 | loss  4.02 | ppl     55.43
| epoch   3 step     5140 | batches    938 / 2101 | lr 9.752e-03 | ms/batch 402.0 | tok/s  122283 | loss  4.00 | ppl     54.49
| epoch   3 step     5150 | batches    948 / 2101 | lr 9.751e-03 | ms/batch 401.7 | tok/s  122352 | loss  4.00 | ppl     54.55
| epoch   3 step     5160 | batches    958 / 2101 | lr 9.750e-03 | ms/batch 400.8 | tok/s  122652 | loss  3.99 | ppl     53.89
| epoch   3 step     5170 | batches    968 / 2101 | lr 9.749e-03 | ms/batch 401.2 | tok/s  122502 | loss  3.99 | ppl     53.86
| epoch   3 step     5180 | batches    978 / 2101 | lr 9.747e-03 | ms/batch 401.0 | tok/s  122574 | loss  4.02 | ppl     55.62
| epoch   3 step     5190 | batches    988 / 2101 | lr 9.746e-03 | ms/batch 401.3 | tok/s  122470 | loss  4.02 | ppl     55.95
| epoch   3 step     5200 | batches    998 / 2101 | lr 9.745e-03 | ms/batch 401.4 | tok/s  122455 | loss  3.98 | ppl     53.73
| epoch   3 step     5210 | batches   1008 / 2101 | lr 9.744e-03 | ms/batch 401.5 | tok/s  122413 | loss  3.97 | ppl     52.97
| epoch   3 step     5220 | batches   1018 / 2101 | lr 9.742e-03 | ms/batch 402.0 | tok/s  122271 | loss  3.96 | ppl     52.59
| epoch   3 step     5230 | batches   1028 / 2101 | lr 9.741e-03 | ms/batch 411.4 | tok/s  119464 | loss  3.99 | ppl     53.93
| epoch   3 step     5240 | batches   1038 / 2101 | lr 9.740e-03 | ms/batch 411.5 | tok/s  119452 | loss  3.97 | ppl     52.89
| epoch   3 step     5250 | batches   1048 / 2101 | lr 9.739e-03 | ms/batch 403.4 | tok/s  121839 | loss  3.99 | ppl     54.07
| epoch   3 step     5260 | batches   1058 / 2101 | lr 9.738e-03 | ms/batch 412.6 | tok/s  119136 | loss  3.99 | ppl     53.88
| epoch   3 step     5270 | batches   1068 / 2101 | lr 9.736e-03 | ms/batch 402.9 | tok/s  121993 | loss  3.99 | ppl     54.15
| epoch   3 step     5280 | batches   1078 / 2101 | lr 9.735e-03 | ms/batch 402.2 | tok/s  122196 | loss  3.99 | ppl     54.25
| epoch   3 step     5290 | batches   1088 / 2101 | lr 9.734e-03 | ms/batch 401.8 | tok/s  122335 | loss  4.00 | ppl     54.58
| epoch   3 step     5300 | batches   1098 / 2101 | lr 9.733e-03 | ms/batch 401.7 | tok/s  122353 | loss  4.01 | ppl     54.93
| epoch   3 step     5310 | batches   1108 / 2101 | lr 9.732e-03 | ms/batch 402.3 | tok/s  122185 | loss  4.03 | ppl     56.51
| epoch   3 step     5320 | batches   1118 / 2101 | lr 9.730e-03 | ms/batch 414.1 | tok/s  118706 | loss  4.01 | ppl     55.12
| epoch   3 step     5330 | batches   1128 / 2101 | lr 9.729e-03 | ms/batch 413.9 | tok/s  118755 | loss  4.00 | ppl     54.70
| epoch   3 step     5340 | batches   1138 / 2101 | lr 9.728e-03 | ms/batch 404.0 | tok/s  121664 | loss  3.97 | ppl     53.16
| epoch   3 step     5350 | batches   1148 / 2101 | lr 9.727e-03 | ms/batch 402.8 | tok/s  122035 | loss  4.01 | ppl     54.93
| epoch   3 step     5360 | batches   1158 / 2101 | lr 9.725e-03 | ms/batch 412.0 | tok/s  119301 | loss  3.99 | ppl     53.92
| epoch   3 step     5370 | batches   1168 / 2101 | lr 9.724e-03 | ms/batch 403.3 | tok/s  121889 | loss  4.02 | ppl     55.85
| epoch   3 step     5380 | batches   1178 / 2101 | lr 9.723e-03 | ms/batch 413.4 | tok/s  118911 | loss  3.99 | ppl     54.08
| epoch   3 step     5390 | batches   1188 / 2101 | lr 9.722e-03 | ms/batch 402.8 | tok/s  122014 | loss  3.97 | ppl     53.05
| epoch   3 step     5400 | batches   1198 / 2101 | lr 9.720e-03 | ms/batch 402.7 | tok/s  122063 | loss  3.99 | ppl     54.29
| epoch   3 step     5410 | batches   1208 / 2101 | lr 9.719e-03 | ms/batch 402.7 | tok/s  122071 | loss  3.97 | ppl     52.88
| epoch   3 step     5420 | batches   1218 / 2101 | lr 9.718e-03 | ms/batch 403.3 | tok/s  121885 | loss  3.95 | ppl     51.97
| epoch   3 step     5430 | batches   1228 / 2101 | lr 9.717e-03 | ms/batch 403.0 | tok/s  121970 | loss  3.95 | ppl     51.70
| epoch   3 step     5440 | batches   1238 / 2101 | lr 9.715e-03 | ms/batch 402.5 | tok/s  122112 | loss  4.00 | ppl     54.87
| epoch   3 step     5450 | batches   1248 / 2101 | lr 9.714e-03 | ms/batch 403.6 | tok/s  121775 | loss  4.01 | ppl     54.93
| epoch   3 step     5460 | batches   1258 / 2101 | lr 9.713e-03 | ms/batch 403.3 | tok/s  121880 | loss  3.97 | ppl     52.75
| epoch   3 step     5470 | batches   1268 / 2101 | lr 9.711e-03 | ms/batch 402.2 | tok/s  122197 | loss  3.93 | ppl     51.09
| epoch   3 step     5480 | batches   1278 / 2101 | lr 9.710e-03 | ms/batch 402.0 | tok/s  122261 | loss  4.00 | ppl     54.56
| epoch   3 step     5490 | batches   1288 / 2101 | lr 9.709e-03 | ms/batch 402.1 | tok/s  122227 | loss  3.97 | ppl     52.97
| epoch   3 step     5500 | batches   1298 / 2101 | lr 9.708e-03 | ms/batch 402.2 | tok/s  122208 | loss  3.93 | ppl     51.10
----------------------------------------------------------------------------------------------------
| Eval  11 at step     5500 | time:  0.88s | valid loss  3.75 | valid ppl    42.692
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   3 step     5510 | batches   1308 / 2101 | lr 9.706e-03 | ms/batch 403.5 | tok/s  121824 | loss  3.96 | ppl     52.40
| epoch   3 step     5520 | batches   1318 / 2101 | lr 9.705e-03 | ms/batch 414.2 | tok/s  118663 | loss  3.93 | ppl     50.84
| epoch   3 step     5530 | batches   1328 / 2101 | lr 9.704e-03 | ms/batch 413.3 | tok/s  118919 | loss  3.95 | ppl     51.88
| epoch   3 step     5540 | batches   1338 / 2101 | lr 9.702e-03 | ms/batch 401.9 | tok/s  122292 | loss  3.96 | ppl     52.70
| epoch   3 step     5550 | batches   1348 / 2101 | lr 9.701e-03 | ms/batch 414.6 | tok/s  118565 | loss  3.97 | ppl     52.85
| epoch   3 step     5560 | batches   1358 / 2101 | lr 9.700e-03 | ms/batch 414.9 | tok/s  118458 | loss  3.94 | ppl     51.53
| epoch   3 step     5570 | batches   1368 / 2101 | lr 9.699e-03 | ms/batch 401.7 | tok/s  122373 | loss  3.98 | ppl     53.68
| epoch   3 step     5580 | batches   1378 / 2101 | lr 9.697e-03 | ms/batch 402.3 | tok/s  122175 | loss  4.02 | ppl     55.60
| epoch   3 step     5590 | batches   1388 / 2101 | lr 9.696e-03 | ms/batch 402.7 | tok/s  122043 | loss  3.99 | ppl     54.27
| epoch   3 step     5600 | batches   1398 / 2101 | lr 9.695e-03 | ms/batch 402.7 | tok/s  122070 | loss  3.94 | ppl     51.63
| epoch   3 step     5610 | batches   1408 / 2101 | lr 9.693e-03 | ms/batch 402.5 | tok/s  122122 | loss  3.94 | ppl     51.40
| epoch   3 step     5620 | batches   1418 / 2101 | lr 9.692e-03 | ms/batch 402.6 | tok/s  122096 | loss  3.93 | ppl     51.03
| epoch   3 step     5630 | batches   1428 / 2101 | lr 9.691e-03 | ms/batch 403.7 | tok/s  121742 | loss  3.96 | ppl     52.23
| epoch   3 step     5640 | batches   1438 / 2101 | lr 9.689e-03 | ms/batch 402.2 | tok/s  122223 | loss  3.96 | ppl     52.57
| epoch   3 step     5650 | batches   1448 / 2101 | lr 9.688e-03 | ms/batch 401.6 | tok/s  122400 | loss  3.94 | ppl     51.58
| epoch   3 step     5660 | batches   1458 / 2101 | lr 9.687e-03 | ms/batch 402.0 | tok/s  122257 | loss  3.94 | ppl     51.33
| epoch   3 step     5670 | batches   1468 / 2101 | lr 9.685e-03 | ms/batch 402.4 | tok/s  122146 | loss  3.99 | ppl     53.89
| epoch   3 step     5680 | batches   1478 / 2101 | lr 9.684e-03 | ms/batch 402.7 | tok/s  122068 | loss  3.98 | ppl     53.53
| epoch   3 step     5690 | batches   1488 / 2101 | lr 9.683e-03 | ms/batch 400.7 | tok/s  122674 | loss  3.96 | ppl     52.56
| epoch   3 step     5700 | batches   1498 / 2101 | lr 9.681e-03 | ms/batch 402.7 | tok/s  122064 | loss  3.96 | ppl     52.49
| epoch   3 step     5710 | batches   1508 / 2101 | lr 9.680e-03 | ms/batch 402.9 | tok/s  122001 | loss  3.98 | ppl     53.76
| epoch   3 step     5720 | batches   1518 / 2101 | lr 9.679e-03 | ms/batch 402.3 | tok/s  122186 | loss  3.93 | ppl     51.16
| epoch   3 step     5730 | batches   1528 / 2101 | lr 9.677e-03 | ms/batch 402.8 | tok/s  122038 | loss  3.96 | ppl     52.26
| epoch   3 step     5740 | batches   1538 / 2101 | lr 9.676e-03 | ms/batch 403.3 | tok/s  121891 | loss  3.97 | ppl     52.90
| epoch   3 step     5750 | batches   1548 / 2101 | lr 9.675e-03 | ms/batch 403.0 | tok/s  121959 | loss  3.98 | ppl     53.44
| epoch   3 step     5760 | batches   1558 / 2101 | lr 9.673e-03 | ms/batch 402.9 | tok/s  121993 | loss  3.94 | ppl     51.18
| epoch   3 step     5770 | batches   1568 / 2101 | lr 9.672e-03 | ms/batch 402.6 | tok/s  122085 | loss  3.95 | ppl     51.88
| epoch   3 step     5780 | batches   1578 / 2101 | lr 9.671e-03 | ms/batch 402.3 | tok/s  122177 | loss  3.96 | ppl     52.35
| epoch   3 step     5790 | batches   1588 / 2101 | lr 9.669e-03 | ms/batch 402.6 | tok/s  122088 | loss  3.94 | ppl     51.48
| epoch   3 step     5800 | batches   1598 / 2101 | lr 9.668e-03 | ms/batch 403.9 | tok/s  121690 | loss  3.92 | ppl     50.38
| epoch   3 step     5810 | batches   1608 / 2101 | lr 9.666e-03 | ms/batch 403.1 | tok/s  121940 | loss  3.97 | ppl     53.15
| epoch   3 step     5820 | batches   1618 / 2101 | lr 9.665e-03 | ms/batch 412.1 | tok/s  119267 | loss  3.93 | ppl     50.84
| epoch   3 step     5830 | batches   1628 / 2101 | lr 9.664e-03 | ms/batch 403.4 | tok/s  121834 | loss  3.98 | ppl     53.31
| epoch   3 step     5840 | batches   1638 / 2101 | lr 9.662e-03 | ms/batch 402.8 | tok/s  122016 | loss  3.95 | ppl     52.01
| epoch   3 step     5850 | batches   1648 / 2101 | lr 9.661e-03 | ms/batch 403.4 | tok/s  121844 | loss  3.97 | ppl     52.80
| epoch   3 step     5860 | batches   1658 / 2101 | lr 9.660e-03 | ms/batch 402.9 | tok/s  122002 | loss  3.98 | ppl     53.30
| epoch   3 step     5870 | batches   1668 / 2101 | lr 9.658e-03 | ms/batch 402.7 | tok/s  122058 | loss  3.97 | ppl     53.06
| epoch   3 step     5880 | batches   1678 / 2101 | lr 9.657e-03 | ms/batch 402.2 | tok/s  122214 | loss  3.95 | ppl     51.85
| epoch   3 step     5890 | batches   1688 / 2101 | lr 9.655e-03 | ms/batch 413.7 | tok/s  118801 | loss  3.93 | ppl     50.99
| epoch   3 step     5900 | batches   1698 / 2101 | lr 9.654e-03 | ms/batch 403.4 | tok/s  121842 | loss  3.91 | ppl     49.91
| epoch   3 step     5910 | batches   1708 / 2101 | lr 9.653e-03 | ms/batch 413.6 | tok/s  118839 | loss  3.92 | ppl     50.24
| epoch   3 step     5920 | batches   1718 / 2101 | lr 9.651e-03 | ms/batch 402.5 | tok/s  122104 | loss  3.91 | ppl     49.69
| epoch   3 step     5930 | batches   1728 / 2101 | lr 9.650e-03 | ms/batch 402.0 | tok/s  122271 | loss  3.91 | ppl     50.13
| epoch   3 step     5940 | batches   1738 / 2101 | lr 9.648e-03 | ms/batch 403.1 | tok/s  121943 | loss  3.94 | ppl     51.48
| epoch   3 step     5950 | batches   1748 / 2101 | lr 9.647e-03 | ms/batch 403.1 | tok/s  121951 | loss  3.94 | ppl     51.60
| epoch   3 step     5960 | batches   1758 / 2101 | lr 9.646e-03 | ms/batch 402.8 | tok/s  122020 | loss  3.96 | ppl     52.66
| epoch   3 step     5970 | batches   1768 / 2101 | lr 9.644e-03 | ms/batch 403.3 | tok/s  121880 | loss  3.95 | ppl     51.86
| epoch   3 step     5980 | batches   1778 / 2101 | lr 9.643e-03 | ms/batch 402.7 | tok/s  122044 | loss  3.93 | ppl     50.95
| epoch   3 step     5990 | batches   1788 / 2101 | lr 9.641e-03 | ms/batch 402.5 | tok/s  122112 | loss  3.93 | ppl     50.87
| epoch   3 step     6000 | batches   1798 / 2101 | lr 9.640e-03 | ms/batch 418.4 | tok/s  117486 | loss  3.95 | ppl     52.11
----------------------------------------------------------------------------------------------------
| Eval  12 at step     6000 | time:  0.85s | valid loss  3.71 | valid ppl    41.031
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.17760301186695954, 0.1695350184080577, 0.1682346580443959, 0.14648047808402484, 0.14970107543513314, 0.1682578465544508, 0.16424537607930556, 0.16167540212331724, 0.16751736357099498, 0.14695018646920957, 0.1571953103577424, 0.15822719524152845, 0.15850977795447105, 0.1741791531029635, 0.15633212902727214, 0.17715968881636499, 0.17317009907282957, 0.15733667508421498, 0.1577391992759512, 0.15607176463356393, 0.18631192873265676, 0.16696460038962285, 0.1816052402101132, 0.1720967772802303, 0.16136188512777477, 0.18273495014027452, 0.17247062266567303, 0.12567643620158184, 0.18995317030754322, 0.15948247898909484, 0.17480443137275556, 0.18092863446029336, 0.12138150195971421, 0.16135853912980125, 0.15620991336923684, 0.15727715305143894, 0.15612519563717972, 0.15826040135594185, 0.16212787704712864, 0.1602446899096457, 0.18277721969702262, 0.1634977291179446, 0.1618569321098622, 0.15822769592525945, 0.14822328154262693, 0.17112363734387243, 0.16750006393843722, 0.1990159183484262, 0.1526472006603169, 0.1552584250494242, 0.15093157629934392, 0.14797760328114795, 0.15345775203510026, 0.12715585729557397, 0.13701323858637204, 0.17461887563273862, 0.153550521888352, 0.1666966213313044, 0.138905915452331, 0.14064725813571521, 0.14804128467678515, 0.142686915689111, 0.16495923133259002, 0.1185067732056681, 0.130742202998864, 0.16035075293345918, 0.14717567669327503, 0.14961263391592422, 0.12081741328704632, 0.13373191299550613, 0.17894470749846422, 0.15453977400074403, 0.1850530579382765, 0.12275826542009886, 0.12421764774401807, 0.1510120571461505, 0.1472779772034663, 0.14593885757961353, 0.11810204432647309, 0.12547551724591555, 0.1940916218040114]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [48, 54, 8, 20, 14, 47, 65, 9, 26, 15], [53, 38, 17, 8, 9, 44, 52, 8, 14, 9], [31, 38, 8, 8, 8, 37, 46, 9, 9, 8], [34, 46, 8, 9, 8, 34, 22, 13, 8, 8], [12, 21, 8, 8, 8, 22, 30, 9, 8, 8], [15, 22, 8, 8, 8, 18, 18, 9, 8, 8], [10, 8, 8, 8, 8, 13, 10, 9, 8, 8], [10, 17, 9, 8, 8, 9, 10, 9, 8, 8], [8]]
optimal compression parameters =  [[], [48, 54, 8, 20, 14, 47, 65, 9, 26, 15], [53, 38, 17, 8, 9, 44, 52, 8, 14, 9], [31, 38, 8, 8, 8, 37, 46, 9, 9, 8], [34, 46, 8, 9, 8, 34, 22, 13, 8, 8], [12, 21, 8, 8, 8, 22, 30, 9, 8, 8], [15, 22, 8, 8, 8, 18, 18, 9, 8, 8], [10, 8, 8, 8, 8, 13, 10, 9, 8, 8], [10, 17, 9, 8, 8, 9, 10, 9, 8, 8], [8]]
| epoch   3 step     6010 | batches   1808 / 2101 | lr 9.638e-03 | ms/batch 4885.3 | tok/s   10061 | loss  3.93 | ppl     50.82
| epoch   3 step     6020 | batches   1818 / 2101 | lr 9.637e-03 | ms/batch 420.5 | tok/s  116881 | loss  3.96 | ppl     52.49
| epoch   3 step     6030 | batches   1828 / 2101 | lr 9.636e-03 | ms/batch 400.6 | tok/s  122683 | loss  3.96 | ppl     52.45
| epoch   3 step     6040 | batches   1838 / 2101 | lr 9.634e-03 | ms/batch 399.7 | tok/s  122972 | loss  3.93 | ppl     51.08
| epoch   3 step     6050 | batches   1848 / 2101 | lr 9.633e-03 | ms/batch 411.8 | tok/s  119358 | loss  3.94 | ppl     51.65
| epoch   3 step     6060 | batches   1858 / 2101 | lr 9.631e-03 | ms/batch 400.2 | tok/s  122817 | loss  3.92 | ppl     50.63
| epoch   3 step     6070 | batches   1868 / 2101 | lr 9.630e-03 | ms/batch 400.1 | tok/s  122855 | loss  3.90 | ppl     49.53
| epoch   3 step     6080 | batches   1878 / 2101 | lr 9.628e-03 | ms/batch 400.4 | tok/s  122760 | loss  3.92 | ppl     50.62
| epoch   3 step     6090 | batches   1888 / 2101 | lr 9.627e-03 | ms/batch 400.4 | tok/s  122760 | loss  3.91 | ppl     50.06
| epoch   3 step     6100 | batches   1898 / 2101 | lr 9.626e-03 | ms/batch 400.9 | tok/s  122599 | loss  3.94 | ppl     51.44
| epoch   3 step     6110 | batches   1908 / 2101 | lr 9.624e-03 | ms/batch 401.0 | tok/s  122563 | loss  3.94 | ppl     51.51
| epoch   3 step     6120 | batches   1918 / 2101 | lr 9.623e-03 | ms/batch 400.2 | tok/s  122824 | loss  3.92 | ppl     50.56
| epoch   3 step     6130 | batches   1928 / 2101 | lr 9.621e-03 | ms/batch 401.4 | tok/s  122448 | loss  3.91 | ppl     49.86
| epoch   3 step     6140 | batches   1938 / 2101 | lr 9.620e-03 | ms/batch 401.7 | tok/s  122376 | loss  3.95 | ppl     51.85
| epoch   3 step     6150 | batches   1948 / 2101 | lr 9.618e-03 | ms/batch 400.7 | tok/s  122677 | loss  3.95 | ppl     51.96
| epoch   3 step     6160 | batches   1958 / 2101 | lr 9.617e-03 | ms/batch 401.1 | tok/s  122555 | loss  3.97 | ppl     52.86
| epoch   3 step     6170 | batches   1968 / 2101 | lr 9.615e-03 | ms/batch 400.8 | tok/s  122643 | loss  3.94 | ppl     51.40
| epoch   3 step     6180 | batches   1978 / 2101 | lr 9.614e-03 | ms/batch 400.2 | tok/s  122809 | loss  3.90 | ppl     49.56
| epoch   3 step     6190 | batches   1988 / 2101 | lr 9.612e-03 | ms/batch 400.4 | tok/s  122772 | loss  3.90 | ppl     49.24
| epoch   3 step     6200 | batches   1998 / 2101 | lr 9.611e-03 | ms/batch 400.8 | tok/s  122638 | loss  3.93 | ppl     50.92
| epoch   3 step     6210 | batches   2008 / 2101 | lr 9.609e-03 | ms/batch 401.8 | tok/s  122336 | loss  3.91 | ppl     49.80
| epoch   3 step     6220 | batches   2018 / 2101 | lr 9.608e-03 | ms/batch 401.5 | tok/s  122407 | loss  3.94 | ppl     51.39
| epoch   3 step     6230 | batches   2028 / 2101 | lr 9.607e-03 | ms/batch 401.9 | tok/s  122297 | loss  3.96 | ppl     52.42
| epoch   3 step     6240 | batches   2038 / 2101 | lr 9.605e-03 | ms/batch 411.3 | tok/s  119512 | loss  3.92 | ppl     50.37
| epoch   3 step     6250 | batches   2048 / 2101 | lr 9.604e-03 | ms/batch 402.5 | tok/s  122104 | loss  3.96 | ppl     52.26
| epoch   3 step     6260 | batches   2058 / 2101 | lr 9.602e-03 | ms/batch 411.8 | tok/s  119354 | loss  3.96 | ppl     52.62
| epoch   3 step     6270 | batches   2068 / 2101 | lr 9.601e-03 | ms/batch 401.5 | tok/s  122416 | loss  3.91 | ppl     49.95
| epoch   3 step     6280 | batches   2078 / 2101 | lr 9.599e-03 | ms/batch 401.2 | tok/s  122521 | loss  3.96 | ppl     52.41
| epoch   3 step     6290 | batches   2088 / 2101 | lr 9.598e-03 | ms/batch 400.8 | tok/s  122637 | loss  3.93 | ppl     50.99
| epoch   3 step     6300 | batches   2098 / 2101 | lr 9.596e-03 | ms/batch 401.5 | tok/s  122410 | loss  3.95 | ppl     51.76
| epoch   4 step     6310 | batches      7 / 2101 | lr 9.595e-03 | ms/batch 403.1 | tok/s  122159 | loss  3.94 | ppl     51.27
| epoch   4 step     6320 | batches     17 / 2101 | lr 9.593e-03 | ms/batch 413.8 | tok/s  118769 | loss  3.83 | ppl     45.99
| epoch   4 step     6330 | batches     27 / 2101 | lr 9.592e-03 | ms/batch 402.5 | tok/s  122108 | loss  3.81 | ppl     45.33
| epoch   4 step     6340 | batches     37 / 2101 | lr 9.590e-03 | ms/batch 401.7 | tok/s  122364 | loss  3.84 | ppl     46.35
| epoch   4 step     6350 | batches     47 / 2101 | lr 9.589e-03 | ms/batch 401.7 | tok/s  122356 | loss  3.84 | ppl     46.58
| epoch   4 step     6360 | batches     57 / 2101 | lr 9.587e-03 | ms/batch 401.5 | tok/s  122430 | loss  3.85 | ppl     47.08
| epoch   4 step     6370 | batches     67 / 2101 | lr 9.586e-03 | ms/batch 401.7 | tok/s  122355 | loss  3.83 | ppl     45.94
| epoch   4 step     6380 | batches     77 / 2101 | lr 9.584e-03 | ms/batch 402.5 | tok/s  122123 | loss  3.82 | ppl     45.61
| epoch   4 step     6390 | batches     87 / 2101 | lr 9.582e-03 | ms/batch 401.6 | tok/s  122405 | loss  3.84 | ppl     46.42
| epoch   4 step     6400 | batches     97 / 2101 | lr 9.581e-03 | ms/batch 401.9 | tok/s  122288 | loss  3.86 | ppl     47.43
| epoch   4 step     6410 | batches    107 / 2101 | lr 9.579e-03 | ms/batch 401.4 | tok/s  122463 | loss  3.81 | ppl     45.22
| epoch   4 step     6420 | batches    117 / 2101 | lr 9.578e-03 | ms/batch 401.2 | tok/s  122512 | loss  3.83 | ppl     46.04
| epoch   4 step     6430 | batches    127 / 2101 | lr 9.576e-03 | ms/batch 401.9 | tok/s  122313 | loss  3.87 | ppl     47.72
| epoch   4 step     6440 | batches    137 / 2101 | lr 9.575e-03 | ms/batch 401.9 | tok/s  122312 | loss  3.86 | ppl     47.45
| epoch   4 step     6450 | batches    147 / 2101 | lr 9.573e-03 | ms/batch 401.9 | tok/s  122303 | loss  3.86 | ppl     47.66
| epoch   4 step     6460 | batches    157 / 2101 | lr 9.572e-03 | ms/batch 402.3 | tok/s  122172 | loss  3.87 | ppl     47.86
| epoch   4 step     6470 | batches    167 / 2101 | lr 9.570e-03 | ms/batch 401.8 | tok/s  122324 | loss  3.87 | ppl     48.07
| epoch   4 step     6480 | batches    177 / 2101 | lr 9.569e-03 | ms/batch 401.0 | tok/s  122590 | loss  3.86 | ppl     47.24
| epoch   4 step     6490 | batches    187 / 2101 | lr 9.567e-03 | ms/batch 401.2 | tok/s  122507 | loss  3.89 | ppl     48.82
| epoch   4 step     6500 | batches    197 / 2101 | lr 9.566e-03 | ms/batch 401.7 | tok/s  122350 | loss  3.81 | ppl     44.96
----------------------------------------------------------------------------------------------------
| Eval  13 at step     6500 | time:  0.84s | valid loss  3.68 | valid ppl    39.612
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   4 step     6510 | batches    207 / 2101 | lr 9.564e-03 | ms/batch 402.4 | tok/s  122167 | loss  3.85 | ppl     46.86
| epoch   4 step     6520 | batches    217 / 2101 | lr 9.562e-03 | ms/batch 416.3 | tok/s  118068 | loss  3.89 | ppl     48.95
| epoch   4 step     6530 | batches    227 / 2101 | lr 9.561e-03 | ms/batch 411.3 | tok/s  119519 | loss  3.85 | ppl     47.03
| epoch   4 step     6540 | batches    237 / 2101 | lr 9.559e-03 | ms/batch 400.8 | tok/s  122642 | loss  3.83 | ppl     46.27
| epoch   4 step     6550 | batches    247 / 2101 | lr 9.558e-03 | ms/batch 412.0 | tok/s  119317 | loss  3.85 | ppl     47.06
| epoch   4 step     6560 | batches    257 / 2101 | lr 9.556e-03 | ms/batch 400.4 | tok/s  122766 | loss  3.88 | ppl     48.24
| epoch   4 step     6570 | batches    267 / 2101 | lr 9.555e-03 | ms/batch 400.5 | tok/s  122734 | loss  3.86 | ppl     47.66
| epoch   4 step     6580 | batches    277 / 2101 | lr 9.553e-03 | ms/batch 401.0 | tok/s  122569 | loss  3.85 | ppl     47.00
| epoch   4 step     6590 | batches    287 / 2101 | lr 9.551e-03 | ms/batch 400.6 | tok/s  122712 | loss  3.87 | ppl     48.12
| epoch   4 step     6600 | batches    297 / 2101 | lr 9.550e-03 | ms/batch 401.0 | tok/s  122590 | loss  3.86 | ppl     47.69
| epoch   4 step     6610 | batches    307 / 2101 | lr 9.548e-03 | ms/batch 401.0 | tok/s  122581 | loss  3.83 | ppl     46.12
| epoch   4 step     6620 | batches    317 / 2101 | lr 9.547e-03 | ms/batch 401.6 | tok/s  122378 | loss  3.88 | ppl     48.61
| epoch   4 step     6630 | batches    327 / 2101 | lr 9.545e-03 | ms/batch 400.9 | tok/s  122602 | loss  3.86 | ppl     47.63
| epoch   4 step     6640 | batches    337 / 2101 | lr 9.544e-03 | ms/batch 411.8 | tok/s  119369 | loss  3.84 | ppl     46.74
| epoch   4 step     6650 | batches    347 / 2101 | lr 9.542e-03 | ms/batch 401.9 | tok/s  122293 | loss  3.85 | ppl     47.11
| epoch   4 step     6660 | batches    357 / 2101 | lr 9.540e-03 | ms/batch 401.1 | tok/s  122556 | loss  3.83 | ppl     46.14
| epoch   4 step     6670 | batches    367 / 2101 | lr 9.539e-03 | ms/batch 401.3 | tok/s  122492 | loss  3.89 | ppl     48.89
| epoch   4 step     6680 | batches    377 / 2101 | lr 9.537e-03 | ms/batch 401.1 | tok/s  122538 | loss  3.85 | ppl     46.87
| epoch   4 step     6690 | batches    387 / 2101 | lr 9.536e-03 | ms/batch 401.3 | tok/s  122470 | loss  3.85 | ppl     47.09
| epoch   4 step     6700 | batches    397 / 2101 | lr 9.534e-03 | ms/batch 401.6 | tok/s  122384 | loss  3.86 | ppl     47.59
| epoch   4 step     6710 | batches    407 / 2101 | lr 9.532e-03 | ms/batch 401.4 | tok/s  122461 | loss  3.85 | ppl     46.94
| epoch   4 step     6720 | batches    417 / 2101 | lr 9.531e-03 | ms/batch 401.0 | tok/s  122559 | loss  3.82 | ppl     45.61
| epoch   4 step     6730 | batches    427 / 2101 | lr 9.529e-03 | ms/batch 400.7 | tok/s  122658 | loss  3.84 | ppl     46.37
| epoch   4 step     6740 | batches    437 / 2101 | lr 9.527e-03 | ms/batch 400.8 | tok/s  122634 | loss  3.84 | ppl     46.59
| epoch   4 step     6750 | batches    447 / 2101 | lr 9.526e-03 | ms/batch 413.2 | tok/s  118961 | loss  3.87 | ppl     47.94
| epoch   4 step     6760 | batches    457 / 2101 | lr 9.524e-03 | ms/batch 402.1 | tok/s  122238 | loss  3.87 | ppl     47.80
| epoch   4 step     6770 | batches    467 / 2101 | lr 9.523e-03 | ms/batch 401.5 | tok/s  122437 | loss  3.85 | ppl     46.97
| epoch   4 step     6780 | batches    477 / 2101 | lr 9.521e-03 | ms/batch 401.8 | tok/s  122332 | loss  3.85 | ppl     46.91
| epoch   4 step     6790 | batches    487 / 2101 | lr 9.519e-03 | ms/batch 401.7 | tok/s  122349 | loss  3.89 | ppl     48.76
| epoch   4 step     6800 | batches    497 / 2101 | lr 9.518e-03 | ms/batch 401.8 | tok/s  122318 | loss  3.88 | ppl     48.27
| epoch   4 step     6810 | batches    507 / 2101 | lr 9.516e-03 | ms/batch 402.0 | tok/s  122270 | loss  3.86 | ppl     47.42
| epoch   4 step     6820 | batches    517 / 2101 | lr 9.514e-03 | ms/batch 401.9 | tok/s  122291 | loss  3.82 | ppl     45.80
| epoch   4 step     6830 | batches    527 / 2101 | lr 9.513e-03 | ms/batch 401.7 | tok/s  122352 | loss  3.83 | ppl     46.05
| epoch   4 step     6840 | batches    537 / 2101 | lr 9.511e-03 | ms/batch 412.9 | tok/s  119035 | loss  3.83 | ppl     46.23
| epoch   4 step     6850 | batches    547 / 2101 | lr 9.510e-03 | ms/batch 402.7 | tok/s  122054 | loss  3.81 | ppl     44.99
| epoch   4 step     6860 | batches    557 / 2101 | lr 9.508e-03 | ms/batch 402.2 | tok/s  122213 | loss  3.84 | ppl     46.53
| epoch   4 step     6870 | batches    567 / 2101 | lr 9.506e-03 | ms/batch 401.5 | tok/s  122412 | loss  3.82 | ppl     45.64
| epoch   4 step     6880 | batches    577 / 2101 | lr 9.505e-03 | ms/batch 401.9 | tok/s  122308 | loss  3.80 | ppl     44.74
| epoch   4 step     6890 | batches    587 / 2101 | lr 9.503e-03 | ms/batch 401.2 | tok/s  122512 | loss  3.83 | ppl     45.94
| epoch   4 step     6900 | batches    597 / 2101 | lr 9.501e-03 | ms/batch 401.4 | tok/s  122440 | loss  3.82 | ppl     45.65
| epoch   4 step     6910 | batches    607 / 2101 | lr 9.500e-03 | ms/batch 402.1 | tok/s  122251 | loss  3.79 | ppl     44.32
| epoch   4 step     6920 | batches    617 / 2101 | lr 9.498e-03 | ms/batch 401.3 | tok/s  122472 | loss  3.79 | ppl     44.10
| epoch   4 step     6930 | batches    627 / 2101 | lr 9.496e-03 | ms/batch 402.2 | tok/s  122211 | loss  3.80 | ppl     44.81
| epoch   4 step     6940 | batches    637 / 2101 | lr 9.495e-03 | ms/batch 401.5 | tok/s  122407 | loss  3.78 | ppl     43.80
| epoch   4 step     6950 | batches    647 / 2101 | lr 9.493e-03 | ms/batch 401.9 | tok/s  122298 | loss  3.84 | ppl     46.62
| epoch   4 step     6960 | batches    657 / 2101 | lr 9.491e-03 | ms/batch 401.3 | tok/s  122477 | loss  3.82 | ppl     45.54
| epoch   4 step     6970 | batches    667 / 2101 | lr 9.490e-03 | ms/batch 401.8 | tok/s  122329 | loss  3.84 | ppl     46.45
| epoch   4 step     6980 | batches    677 / 2101 | lr 9.488e-03 | ms/batch 401.1 | tok/s  122544 | loss  3.86 | ppl     47.64
| epoch   4 step     6990 | batches    687 / 2101 | lr 9.486e-03 | ms/batch 402.0 | tok/s  122254 | loss  3.84 | ppl     46.74
| epoch   4 step     7000 | batches    697 / 2101 | lr 9.485e-03 | ms/batch 416.3 | tok/s  118070 | loss  3.81 | ppl     45.35
----------------------------------------------------------------------------------------------------
| Eval  14 at step     7000 | time:  0.85s | valid loss  3.65 | valid ppl    38.516
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.15868455295699768, 0.1531410415731945, 0.1694415588725615, 0.13594709102049815, 0.13352534051546816, 0.15015559353308108, 0.15475508458095563, 0.13465124090412772, 0.13723040872110778, 0.13189188890363843, 0.15092769340236034, 0.14762022761409463, 0.15333249183444642, 0.17350678832137745, 0.14633698359369937, 0.16297428497220406, 0.16315707820890885, 0.14500237805187077, 0.14757697572510353, 0.14148796354363238, 0.14951521229338324, 0.1526864993058877, 0.11885640424473005, 0.15506408205382827, 0.14669999095716588, 0.18309148731035746, 0.15645010250020605, 0.1285738704974794, 0.1724060404393197, 0.1520795417717829, 0.16699571286305728, 0.1599235838048385, 0.1140020593495185, 0.1357720667788326, 0.1357024296554671, 0.14276194975191586, 0.1421220780411989, 0.1423817954942673, 0.13883965250061936, 0.1418863235705589, 0.16781473834516214, 0.13385346651656685, 0.124458929031128, 0.1312253954445237, 0.13187564794407916, 0.16217401104958343, 0.16071620684461496, 0.1497686709818752, 0.13113080218830483, 0.1394053373792609, 0.14298827830189584, 0.1346271761639523, 0.12680991258021734, 0.11363932948704576, 0.12280815169976896, 0.15235089721263143, 0.13305158439289788, 0.1103026629039041, 0.12587372704775177, 0.12607272508889966, 0.13490394077991733, 0.11732630359166829, 0.08296982149730867, 0.09943369249930487, 0.11286368475057246, 0.13707019231753836, 0.12223987652414336, 0.11875802936474948, 0.10166525453839804, 0.11804254389029531, 0.14043811950444396, 0.1314182592103164, 0.12538629672659937, 0.10439290446670571, 0.10937036566482886, 0.1326736177891757, 0.12104444375653328, 0.10962835188960326, 0.09932842033375858, 0.10896350957667238, 0.153871650978224]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [47, 52, 8, 23, 11, 49, 67, 9, 30, 18], [52, 38, 21, 9, 8, 44, 52, 8, 12, 9], [35, 45, 8, 9, 8, 37, 46, 9, 9, 8], [31, 49, 9, 8, 8, 30, 20, 8, 8, 8], [12, 18, 9, 8, 8, 18, 27, 8, 8, 8], [15, 18, 9, 8, 8, 16, 17, 8, 8, 8], [9, 9, 8, 8, 8, 12, 8, 8, 8, 8], [9, 15, 9, 8, 8, 12, 8, 9, 8, 8], [8]]
optimal compression parameters =  [[], [47, 52, 8, 23, 11, 49, 67, 9, 30, 18], [52, 38, 21, 9, 8, 44, 52, 8, 12, 9], [35, 45, 8, 9, 8, 37, 46, 9, 9, 8], [31, 49, 9, 8, 8, 30, 20, 8, 8, 8], [12, 18, 9, 8, 8, 18, 27, 8, 8, 8], [15, 18, 9, 8, 8, 16, 17, 8, 8, 8], [9, 9, 8, 8, 8, 12, 8, 8, 8, 8], [9, 15, 9, 8, 8, 12, 8, 9, 8, 8], [8]]
| epoch   4 step     7010 | batches    707 / 2101 | lr 9.483e-03 | ms/batch 4882.9 | tok/s   10066 | loss  3.81 | ppl     45.32
| epoch   4 step     7020 | batches    717 / 2101 | lr 9.481e-03 | ms/batch 400.0 | tok/s  122873 | loss  3.83 | ppl     45.92
| epoch   4 step     7030 | batches    727 / 2101 | lr 9.479e-03 | ms/batch 398.0 | tok/s  123492 | loss  3.81 | ppl     45.20
| epoch   4 step     7040 | batches    737 / 2101 | lr 9.478e-03 | ms/batch 398.1 | tok/s  123454 | loss  3.85 | ppl     47.13
| epoch   4 step     7050 | batches    747 / 2101 | lr 9.476e-03 | ms/batch 398.8 | tok/s  123258 | loss  3.87 | ppl     47.75
| epoch   4 step     7060 | batches    757 / 2101 | lr 9.474e-03 | ms/batch 399.7 | tok/s  122988 | loss  3.83 | ppl     46.21
| epoch   4 step     7070 | batches    767 / 2101 | lr 9.473e-03 | ms/batch 398.9 | tok/s  123211 | loss  3.82 | ppl     45.39
| epoch   4 step     7080 | batches    777 / 2101 | lr 9.471e-03 | ms/batch 399.5 | tok/s  123037 | loss  3.83 | ppl     46.20
| epoch   4 step     7090 | batches    787 / 2101 | lr 9.469e-03 | ms/batch 398.6 | tok/s  123302 | loss  3.79 | ppl     44.12
| epoch   4 step     7100 | batches    797 / 2101 | lr 9.468e-03 | ms/batch 399.3 | tok/s  123087 | loss  3.82 | ppl     45.46
| epoch   4 step     7110 | batches    807 / 2101 | lr 9.466e-03 | ms/batch 399.9 | tok/s  122901 | loss  3.81 | ppl     45.06
| epoch   4 step     7120 | batches    817 / 2101 | lr 9.464e-03 | ms/batch 399.9 | tok/s  122915 | loss  3.80 | ppl     44.65
| epoch   4 step     7130 | batches    827 / 2101 | lr 9.462e-03 | ms/batch 400.2 | tok/s  122814 | loss  3.80 | ppl     44.86
| epoch   4 step     7140 | batches    837 / 2101 | lr 9.461e-03 | ms/batch 400.5 | tok/s  122739 | loss  3.81 | ppl     45.08
| epoch   4 step     7150 | batches    847 / 2101 | lr 9.459e-03 | ms/batch 400.0 | tok/s  122881 | loss  3.83 | ppl     46.27
| epoch   4 step     7160 | batches    857 / 2101 | lr 9.457e-03 | ms/batch 400.3 | tok/s  122803 | loss  3.86 | ppl     47.63
| epoch   4 step     7170 | batches    867 / 2101 | lr 9.456e-03 | ms/batch 399.6 | tok/s  122994 | loss  3.86 | ppl     47.66
| epoch   4 step     7180 | batches    877 / 2101 | lr 9.454e-03 | ms/batch 400.1 | tok/s  122858 | loss  3.84 | ppl     46.57
| epoch   4 step     7190 | batches    887 / 2101 | lr 9.452e-03 | ms/batch 399.8 | tok/s  122948 | loss  3.82 | ppl     45.55
| epoch   4 step     7200 | batches    897 / 2101 | lr 9.450e-03 | ms/batch 400.0 | tok/s  122879 | loss  3.83 | ppl     45.92
| epoch   4 step     7210 | batches    907 / 2101 | lr 9.449e-03 | ms/batch 400.5 | tok/s  122723 | loss  3.84 | ppl     46.71
| epoch   4 step     7220 | batches    917 / 2101 | lr 9.447e-03 | ms/batch 400.1 | tok/s  122847 | loss  3.80 | ppl     44.78
| epoch   4 step     7230 | batches    927 / 2101 | lr 9.445e-03 | ms/batch 400.3 | tok/s  122794 | loss  3.76 | ppl     42.79
| epoch   4 step     7240 | batches    937 / 2101 | lr 9.443e-03 | ms/batch 399.8 | tok/s  122940 | loss  3.78 | ppl     43.66
| epoch   4 step     7250 | batches    947 / 2101 | lr 9.442e-03 | ms/batch 400.6 | tok/s  122684 | loss  3.79 | ppl     44.42
| epoch   4 step     7260 | batches    957 / 2101 | lr 9.440e-03 | ms/batch 400.6 | tok/s  122712 | loss  3.81 | ppl     45.03
| epoch   4 step     7270 | batches    967 / 2101 | lr 9.438e-03 | ms/batch 401.1 | tok/s  122534 | loss  3.83 | ppl     46.04
| epoch   4 step     7280 | batches    977 / 2101 | lr 9.436e-03 | ms/batch 399.7 | tok/s  122967 | loss  3.86 | ppl     47.59
| epoch   4 step     7290 | batches    987 / 2101 | lr 9.435e-03 | ms/batch 400.1 | tok/s  122855 | loss  3.83 | ppl     46.00
| epoch   4 step     7300 | batches    997 / 2101 | lr 9.433e-03 | ms/batch 401.2 | tok/s  122526 | loss  3.80 | ppl     44.86
| epoch   4 step     7310 | batches   1007 / 2101 | lr 9.431e-03 | ms/batch 401.6 | tok/s  122389 | loss  3.82 | ppl     45.69
| epoch   4 step     7320 | batches   1017 / 2101 | lr 9.429e-03 | ms/batch 400.9 | tok/s  122599 | loss  3.85 | ppl     46.93
| epoch   4 step     7330 | batches   1027 / 2101 | lr 9.428e-03 | ms/batch 412.2 | tok/s  119234 | loss  3.83 | ppl     46.14
| epoch   4 step     7340 | batches   1037 / 2101 | lr 9.426e-03 | ms/batch 412.8 | tok/s  119074 | loss  3.81 | ppl     45.14
| epoch   4 step     7350 | batches   1047 / 2101 | lr 9.424e-03 | ms/batch 400.5 | tok/s  122723 | loss  3.82 | ppl     45.49
| epoch   4 step     7360 | batches   1057 / 2101 | lr 9.422e-03 | ms/batch 401.6 | tok/s  122379 | loss  3.79 | ppl     44.42
| epoch   4 step     7370 | batches   1067 / 2101 | lr 9.420e-03 | ms/batch 401.2 | tok/s  122506 | loss  3.81 | ppl     45.21
| epoch   4 step     7380 | batches   1077 / 2101 | lr 9.419e-03 | ms/batch 402.2 | tok/s  122199 | loss  3.83 | ppl     46.06
| epoch   4 step     7390 | batches   1087 / 2101 | lr 9.417e-03 | ms/batch 412.4 | tok/s  119194 | loss  3.81 | ppl     45.05
| epoch   4 step     7400 | batches   1097 / 2101 | lr 9.415e-03 | ms/batch 402.5 | tok/s  122132 | loss  3.81 | ppl     45.27
| epoch   4 step     7410 | batches   1107 / 2101 | lr 9.413e-03 | ms/batch 401.4 | tok/s  122443 | loss  3.83 | ppl     46.08
| epoch   4 step     7420 | batches   1117 / 2101 | lr 9.412e-03 | ms/batch 400.9 | tok/s  122599 | loss  3.82 | ppl     45.44
| epoch   4 step     7430 | batches   1127 / 2101 | lr 9.410e-03 | ms/batch 401.7 | tok/s  122368 | loss  3.81 | ppl     44.98
| epoch   4 step     7440 | batches   1137 / 2101 | lr 9.408e-03 | ms/batch 402.2 | tok/s  122216 | loss  3.77 | ppl     43.59
| epoch   4 step     7450 | batches   1147 / 2101 | lr 9.406e-03 | ms/batch 400.1 | tok/s  122835 | loss  3.80 | ppl     44.90
| epoch   4 step     7460 | batches   1157 / 2101 | lr 9.404e-03 | ms/batch 401.2 | tok/s  122525 | loss  3.85 | ppl     46.92
| epoch   4 step     7470 | batches   1167 / 2101 | lr 9.403e-03 | ms/batch 400.9 | tok/s  122613 | loss  3.84 | ppl     46.51
| epoch   4 step     7480 | batches   1177 / 2101 | lr 9.401e-03 | ms/batch 400.5 | tok/s  122741 | loss  3.85 | ppl     46.85
| epoch   4 step     7490 | batches   1187 / 2101 | lr 9.399e-03 | ms/batch 401.1 | tok/s  122554 | loss  3.87 | ppl     47.95
| epoch   4 step     7500 | batches   1197 / 2101 | lr 9.397e-03 | ms/batch 399.7 | tok/s  122975 | loss  3.86 | ppl     47.24
----------------------------------------------------------------------------------------------------
| Eval  15 at step     7500 | time:  0.91s | valid loss  3.62 | valid ppl    37.436
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   4 step     7510 | batches   1207 / 2101 | lr 9.395e-03 | ms/batch 401.9 | tok/s  122304 | loss  3.87 | ppl     47.76
| epoch   4 step     7520 | batches   1217 / 2101 | lr 9.393e-03 | ms/batch 421.4 | tok/s  116634 | loss  3.85 | ppl     46.80
| epoch   4 step     7530 | batches   1227 / 2101 | lr 9.392e-03 | ms/batch 400.2 | tok/s  122821 | loss  3.85 | ppl     47.22
| epoch   4 step     7540 | batches   1237 / 2101 | lr 9.390e-03 | ms/batch 399.8 | tok/s  122929 | loss  3.80 | ppl     44.68
| epoch   4 step     7550 | batches   1247 / 2101 | lr 9.388e-03 | ms/batch 399.5 | tok/s  123021 | loss  3.76 | ppl     43.02
| epoch   4 step     7560 | batches   1257 / 2101 | lr 9.386e-03 | ms/batch 399.9 | tok/s  122913 | loss  3.83 | ppl     45.86
| epoch   4 step     7570 | batches   1267 / 2101 | lr 9.384e-03 | ms/batch 400.0 | tok/s  122871 | loss  3.80 | ppl     44.91
| epoch   4 step     7580 | batches   1277 / 2101 | lr 9.383e-03 | ms/batch 399.7 | tok/s  122968 | loss  3.83 | ppl     46.01
| epoch   4 step     7590 | batches   1287 / 2101 | lr 9.381e-03 | ms/batch 400.0 | tok/s  122883 | loss  3.85 | ppl     47.08
| epoch   4 step     7600 | batches   1297 / 2101 | lr 9.379e-03 | ms/batch 399.7 | tok/s  122962 | loss  3.82 | ppl     45.72
| epoch   4 step     7610 | batches   1307 / 2101 | lr 9.377e-03 | ms/batch 400.3 | tok/s  122793 | loss  3.79 | ppl     44.31
| epoch   4 step     7620 | batches   1317 / 2101 | lr 9.375e-03 | ms/batch 399.7 | tok/s  122974 | loss  3.81 | ppl     45.28
| epoch   4 step     7630 | batches   1327 / 2101 | lr 9.373e-03 | ms/batch 399.8 | tok/s  122936 | loss  3.79 | ppl     44.12
| epoch   4 step     7640 | batches   1337 / 2101 | lr 9.371e-03 | ms/batch 398.9 | tok/s  123208 | loss  3.79 | ppl     44.17
| epoch   4 step     7650 | batches   1347 / 2101 | lr 9.370e-03 | ms/batch 399.2 | tok/s  123133 | loss  3.82 | ppl     45.53
| epoch   4 step     7660 | batches   1357 / 2101 | lr 9.368e-03 | ms/batch 399.9 | tok/s  122927 | loss  3.83 | ppl     45.89
| epoch   4 step     7670 | batches   1367 / 2101 | lr 9.366e-03 | ms/batch 400.4 | tok/s  122764 | loss  3.83 | ppl     46.28
| epoch   4 step     7680 | batches   1377 / 2101 | lr 9.364e-03 | ms/batch 400.1 | tok/s  122845 | loss  3.84 | ppl     46.43
| epoch   4 step     7690 | batches   1387 / 2101 | lr 9.362e-03 | ms/batch 399.6 | tok/s  122998 | loss  3.82 | ppl     45.66
| epoch   4 step     7700 | batches   1397 / 2101 | lr 9.360e-03 | ms/batch 399.9 | tok/s  122900 | loss  3.80 | ppl     44.78
| epoch   4 step     7710 | batches   1407 / 2101 | lr 9.358e-03 | ms/batch 400.3 | tok/s  122784 | loss  3.80 | ppl     44.90
| epoch   4 step     7720 | batches   1417 / 2101 | lr 9.357e-03 | ms/batch 401.6 | tok/s  122399 | loss  3.79 | ppl     44.07
| epoch   4 step     7730 | batches   1427 / 2101 | lr 9.355e-03 | ms/batch 399.6 | tok/s  122991 | loss  3.82 | ppl     45.59
| epoch   4 step     7740 | batches   1437 / 2101 | lr 9.353e-03 | ms/batch 400.0 | tok/s  122869 | loss  3.79 | ppl     44.38
| epoch   4 step     7750 | batches   1447 / 2101 | lr 9.351e-03 | ms/batch 399.8 | tok/s  122928 | loss  3.82 | ppl     45.77
| epoch   4 step     7760 | batches   1457 / 2101 | lr 9.349e-03 | ms/batch 399.9 | tok/s  122927 | loss  3.83 | ppl     46.08
| epoch   4 step     7770 | batches   1467 / 2101 | lr 9.347e-03 | ms/batch 400.3 | tok/s  122789 | loss  3.80 | ppl     44.49
| epoch   4 step     7780 | batches   1477 / 2101 | lr 9.345e-03 | ms/batch 411.6 | tok/s  119424 | loss  3.78 | ppl     43.78
| epoch   4 step     7790 | batches   1487 / 2101 | lr 9.343e-03 | ms/batch 400.9 | tok/s  122595 | loss  3.80 | ppl     44.79
| epoch   4 step     7800 | batches   1497 / 2101 | lr 9.342e-03 | ms/batch 400.2 | tok/s  122812 | loss  3.84 | ppl     46.44
| epoch   4 step     7810 | batches   1507 / 2101 | lr 9.340e-03 | ms/batch 401.5 | tok/s  122436 | loss  3.84 | ppl     46.54
| epoch   4 step     7820 | batches   1517 / 2101 | lr 9.338e-03 | ms/batch 400.7 | tok/s  122658 | loss  3.84 | ppl     46.65
| epoch   4 step     7830 | batches   1527 / 2101 | lr 9.336e-03 | ms/batch 400.5 | tok/s  122723 | loss  3.83 | ppl     46.29
| epoch   4 step     7840 | batches   1537 / 2101 | lr 9.334e-03 | ms/batch 400.3 | tok/s  122800 | loss  3.78 | ppl     43.85
| epoch   4 step     7850 | batches   1547 / 2101 | lr 9.332e-03 | ms/batch 400.2 | tok/s  122832 | loss  3.76 | ppl     42.97
| epoch   4 step     7860 | batches   1557 / 2101 | lr 9.330e-03 | ms/batch 401.6 | tok/s  122382 | loss  3.79 | ppl     44.07
| epoch   4 step     7870 | batches   1567 / 2101 | lr 9.328e-03 | ms/batch 400.2 | tok/s  122813 | loss  3.78 | ppl     43.74
| epoch   4 step     7880 | batches   1577 / 2101 | lr 9.326e-03 | ms/batch 399.9 | tok/s  122913 | loss  3.77 | ppl     43.41
| epoch   4 step     7890 | batches   1587 / 2101 | lr 9.325e-03 | ms/batch 401.0 | tok/s  122583 | loss  3.81 | ppl     45.32
| epoch   4 step     7900 | batches   1597 / 2101 | lr 9.323e-03 | ms/batch 400.6 | tok/s  122691 | loss  3.81 | ppl     45.02
| epoch   4 step     7910 | batches   1607 / 2101 | lr 9.321e-03 | ms/batch 400.7 | tok/s  122672 | loss  3.85 | ppl     46.96
| epoch   4 step     7920 | batches   1617 / 2101 | lr 9.319e-03 | ms/batch 400.9 | tok/s  122615 | loss  3.85 | ppl     47.04
| epoch   4 step     7930 | batches   1627 / 2101 | lr 9.317e-03 | ms/batch 400.3 | tok/s  122783 | loss  3.86 | ppl     47.53
| epoch   4 step     7940 | batches   1637 / 2101 | lr 9.315e-03 | ms/batch 400.6 | tok/s  122704 | loss  3.84 | ppl     46.48
| epoch   4 step     7950 | batches   1647 / 2101 | lr 9.313e-03 | ms/batch 400.7 | tok/s  122665 | loss  3.79 | ppl     44.07
| epoch   4 step     7960 | batches   1657 / 2101 | lr 9.311e-03 | ms/batch 400.3 | tok/s  122776 | loss  3.80 | ppl     44.82
| epoch   4 step     7970 | batches   1667 / 2101 | lr 9.309e-03 | ms/batch 400.5 | tok/s  122721 | loss  3.80 | ppl     44.57
| epoch   4 step     7980 | batches   1677 / 2101 | lr 9.307e-03 | ms/batch 399.9 | tok/s  122899 | loss  3.78 | ppl     43.91
| epoch   4 step     7990 | batches   1687 / 2101 | lr 9.305e-03 | ms/batch 400.1 | tok/s  122861 | loss  3.79 | ppl     44.11
| epoch   4 step     8000 | batches   1697 / 2101 | lr 9.303e-03 | ms/batch 413.7 | tok/s  118824 | loss  3.82 | ppl     45.38
----------------------------------------------------------------------------------------------------
| Eval  16 at step     8000 | time:  0.84s | valid loss  3.60 | valid ppl    36.502
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.12094082679315812, 0.1320280269670218, 0.12748910374460473, 0.11829053090146639, 0.11742405323275983, 0.12225081379831343, 0.1329768444845675, 0.1277198358266654, 0.15037581103171385, 0.11512219830073954, 0.11563586722897344, 0.12606738201979228, 0.11600165257337727, 0.14280952151338736, 0.11832653146212468, 0.131168941010639, 0.1364972888308073, 0.14267226874652392, 0.12086400317798789, 0.11835640691073246, 0.11663440136199947, 0.12476092425478358, 0.11523885200063042, 0.12451881506949516, 0.11885607157188291, 0.13334309555951046, 0.12819337994966723, 0.09698087215603331, 0.133158606956473, 0.11925150636107826, 0.11079410489026466, 0.1276466060069087, 0.12020585511842159, 0.11295156611414392, 0.11098262635947151, 0.10278576843364148, 0.11720934903691811, 0.1047609088210237, 0.11723313343725207, 0.11651887931127926, 0.11798933953944347, 0.1221646476135428, 0.1197060554003638, 0.11394715630603346, 0.1062201429970443, 0.11545241325017579, 0.11830501067578048, 0.157699664608848, 0.10695091491076716, 0.109327895330702, 0.11812428775574987, 0.11213977945262729, 0.12656818524872865, 0.09394838924707727, 0.1004577963842068, 0.11748322406235587, 0.10900648656863024, 0.07567779692129477, 0.10505335205741612, 0.1011716696970471, 0.10870846729752635, 0.0943844191941749, 0.12442480693259485, 0.08087117881874946, 0.09341797054364842, 0.10705967550479291, 0.09988868668711438, 0.12419679213585469, 0.0852942831395084, 0.09609154110289296, 0.12103165634082672, 0.11133847096522344, 0.13854182000618867, 0.08647398635837625, 0.09143460832129427, 0.11236518603975099, 0.1000225318064902, 0.10311678832723575, 0.08198873608094595, 0.09156697339056752, 0.13871936668971901]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [47, 56, 9, 21, 12, 47, 64, 8, 26, 13], [51, 38, 19, 9, 8, 48, 50, 8, 11, 9], [32, 44, 8, 9, 8, 35, 50, 9, 8, 8], [31, 47, 9, 8, 8, 30, 23, 10, 8, 8], [13, 19, 8, 8, 8, 24, 29, 8, 8, 8], [14, 23, 8, 8, 8, 16, 19, 8, 8, 8], [9, 8, 8, 8, 8, 11, 14, 8, 8, 8], [9, 17, 9, 8, 8, 13, 15, 8, 8, 8], [8]]
optimal compression parameters =  [[], [47, 56, 9, 21, 12, 47, 64, 8, 26, 13], [51, 38, 19, 9, 8, 48, 50, 8, 11, 9], [32, 44, 8, 9, 8, 35, 50, 9, 8, 8], [31, 47, 9, 8, 8, 30, 23, 10, 8, 8], [13, 19, 8, 8, 8, 24, 29, 8, 8, 8], [14, 23, 8, 8, 8, 16, 19, 8, 8, 8], [9, 8, 8, 8, 8, 11, 14, 8, 8, 8], [9, 17, 9, 8, 8, 13, 15, 8, 8, 8], [8]]
| epoch   4 step     8010 | batches   1707 / 2101 | lr 9.301e-03 | ms/batch 4881.0 | tok/s   10070 | loss  3.81 | ppl     45.32
| epoch   4 step     8020 | batches   1717 / 2101 | lr 9.299e-03 | ms/batch 398.7 | tok/s  123271 | loss  3.77 | ppl     43.42
| epoch   4 step     8030 | batches   1727 / 2101 | lr 9.298e-03 | ms/batch 397.8 | tok/s  123562 | loss  3.71 | ppl     40.95
| epoch   4 step     8040 | batches   1737 / 2101 | lr 9.296e-03 | ms/batch 398.4 | tok/s  123366 | loss  3.76 | ppl     42.80
| epoch   4 step     8050 | batches   1747 / 2101 | lr 9.294e-03 | ms/batch 398.9 | tok/s  123229 | loss  3.79 | ppl     44.30
| epoch   4 step     8060 | batches   1757 / 2101 | lr 9.292e-03 | ms/batch 398.9 | tok/s  123229 | loss  3.81 | ppl     44.98
| epoch   4 step     8070 | batches   1767 / 2101 | lr 9.290e-03 | ms/batch 399.9 | tok/s  122906 | loss  3.80 | ppl     44.67
| epoch   4 step     8080 | batches   1777 / 2101 | lr 9.288e-03 | ms/batch 399.9 | tok/s  122904 | loss  3.82 | ppl     45.39
| epoch   4 step     8090 | batches   1787 / 2101 | lr 9.286e-03 | ms/batch 400.1 | tok/s  122864 | loss  3.81 | ppl     45.15
| epoch   4 step     8100 | batches   1797 / 2101 | lr 9.284e-03 | ms/batch 411.3 | tok/s  119496 | loss  3.82 | ppl     45.75
| epoch   4 step     8110 | batches   1807 / 2101 | lr 9.282e-03 | ms/batch 400.1 | tok/s  122836 | loss  3.80 | ppl     44.80
| epoch   4 step     8120 | batches   1817 / 2101 | lr 9.280e-03 | ms/batch 411.6 | tok/s  119409 | loss  3.78 | ppl     43.61
| epoch   4 step     8130 | batches   1827 / 2101 | lr 9.278e-03 | ms/batch 401.3 | tok/s  122495 | loss  3.82 | ppl     45.61
| epoch   4 step     8140 | batches   1837 / 2101 | lr 9.276e-03 | ms/batch 400.4 | tok/s  122769 | loss  3.81 | ppl     45.32
| epoch   4 step     8150 | batches   1847 / 2101 | lr 9.274e-03 | ms/batch 400.7 | tok/s  122677 | loss  3.80 | ppl     44.77
| epoch   4 step     8160 | batches   1857 / 2101 | lr 9.272e-03 | ms/batch 400.2 | tok/s  122822 | loss  3.77 | ppl     43.48
| epoch   4 step     8170 | batches   1867 / 2101 | lr 9.270e-03 | ms/batch 400.3 | tok/s  122796 | loss  3.81 | ppl     45.05
| epoch   4 step     8180 | batches   1877 / 2101 | lr 9.268e-03 | ms/batch 410.8 | tok/s  119646 | loss  3.80 | ppl     44.50
| epoch   4 step     8190 | batches   1887 / 2101 | lr 9.266e-03 | ms/batch 400.5 | tok/s  122725 | loss  3.81 | ppl     44.99
| epoch   4 step     8200 | batches   1897 / 2101 | lr 9.264e-03 | ms/batch 401.2 | tok/s  122508 | loss  3.82 | ppl     45.59
| epoch   4 step     8210 | batches   1907 / 2101 | lr 9.262e-03 | ms/batch 411.7 | tok/s  119385 | loss  3.80 | ppl     44.80
| epoch   4 step     8220 | batches   1917 / 2101 | lr 9.260e-03 | ms/batch 401.6 | tok/s  122381 | loss  3.79 | ppl     44.39
| epoch   4 step     8230 | batches   1927 / 2101 | lr 9.258e-03 | ms/batch 401.0 | tok/s  122585 | loss  3.82 | ppl     45.59
| epoch   4 step     8240 | batches   1937 / 2101 | lr 9.256e-03 | ms/batch 400.4 | tok/s  122771 | loss  3.82 | ppl     45.65
| epoch   4 step     8250 | batches   1947 / 2101 | lr 9.254e-03 | ms/batch 400.3 | tok/s  122802 | loss  3.82 | ppl     45.42
| epoch   4 step     8260 | batches   1957 / 2101 | lr 9.252e-03 | ms/batch 400.9 | tok/s  122618 | loss  3.82 | ppl     45.68
| epoch   4 step     8270 | batches   1967 / 2101 | lr 9.250e-03 | ms/batch 400.5 | tok/s  122726 | loss  3.80 | ppl     44.72
| epoch   4 step     8280 | batches   1977 / 2101 | lr 9.248e-03 | ms/batch 400.1 | tok/s  122836 | loss  3.81 | ppl     45.07
| epoch   4 step     8290 | batches   1987 / 2101 | lr 9.246e-03 | ms/batch 400.3 | tok/s  122787 | loss  3.80 | ppl     44.77
| epoch   4 step     8300 | batches   1997 / 2101 | lr 9.244e-03 | ms/batch 400.5 | tok/s  122722 | loss  3.80 | ppl     44.74
| epoch   4 step     8310 | batches   2007 / 2101 | lr 9.242e-03 | ms/batch 401.3 | tok/s  122497 | loss  3.78 | ppl     43.75
| epoch   4 step     8320 | batches   2017 / 2101 | lr 9.240e-03 | ms/batch 400.2 | tok/s  122828 | loss  3.77 | ppl     43.33
| epoch   4 step     8330 | batches   2027 / 2101 | lr 9.238e-03 | ms/batch 402.1 | tok/s  122232 | loss  3.77 | ppl     43.20
| epoch   4 step     8340 | batches   2037 / 2101 | lr 9.236e-03 | ms/batch 401.3 | tok/s  122486 | loss  3.76 | ppl     42.85
| epoch   4 step     8350 | batches   2047 / 2101 | lr 9.234e-03 | ms/batch 401.4 | tok/s  122460 | loss  3.78 | ppl     43.92
| epoch   4 step     8360 | batches   2057 / 2101 | lr 9.232e-03 | ms/batch 400.6 | tok/s  122692 | loss  3.83 | ppl     46.09
| epoch   4 step     8370 | batches   2067 / 2101 | lr 9.230e-03 | ms/batch 401.4 | tok/s  122439 | loss  3.78 | ppl     43.60
| epoch   4 step     8380 | batches   2077 / 2101 | lr 9.228e-03 | ms/batch 401.3 | tok/s  122474 | loss  3.80 | ppl     44.76
| epoch   4 step     8390 | batches   2087 / 2101 | lr 9.226e-03 | ms/batch 401.0 | tok/s  122589 | loss  3.80 | ppl     44.89
| epoch   4 step     8400 | batches   2097 / 2101 | lr 9.224e-03 | ms/batch 400.5 | tok/s  122719 | loss  3.79 | ppl     44.11
| epoch   5 step     8410 | batches      6 / 2101 | lr 9.222e-03 | ms/batch 402.2 | tok/s  122374 | loss  3.80 | ppl     44.59
| epoch   5 step     8420 | batches     16 / 2101 | lr 9.220e-03 | ms/batch 401.1 | tok/s  122529 | loss  3.71 | ppl     40.68
| epoch   5 step     8430 | batches     26 / 2101 | lr 9.218e-03 | ms/batch 402.1 | tok/s  122232 | loss  3.71 | ppl     40.93
| epoch   5 step     8440 | batches     36 / 2101 | lr 9.216e-03 | ms/batch 402.0 | tok/s  122262 | loss  3.74 | ppl     42.24
| epoch   5 step     8450 | batches     46 / 2101 | lr 9.214e-03 | ms/batch 401.3 | tok/s  122496 | loss  3.72 | ppl     41.25
| epoch   5 step     8460 | batches     56 / 2101 | lr 9.212e-03 | ms/batch 401.1 | tok/s  122538 | loss  3.71 | ppl     40.78
| epoch   5 step     8470 | batches     66 / 2101 | lr 9.210e-03 | ms/batch 401.5 | tok/s  122430 | loss  3.72 | ppl     41.42
| epoch   5 step     8480 | batches     76 / 2101 | lr 9.208e-03 | ms/batch 400.9 | tok/s  122594 | loss  3.74 | ppl     42.02
| epoch   5 step     8490 | batches     86 / 2101 | lr 9.205e-03 | ms/batch 401.5 | tok/s  122433 | loss  3.73 | ppl     41.73
| epoch   5 step     8500 | batches     96 / 2101 | lr 9.203e-03 | ms/batch 400.6 | tok/s  122700 | loss  3.71 | ppl     40.92
----------------------------------------------------------------------------------------------------
| Eval  17 at step     8500 | time:  0.82s | valid loss  3.57 | valid ppl    35.480
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   5 step     8510 | batches    106 / 2101 | lr 9.201e-03 | ms/batch 401.9 | tok/s  122312 | loss  3.70 | ppl     40.49
| epoch   5 step     8520 | batches    116 / 2101 | lr 9.199e-03 | ms/batch 432.3 | tok/s  113709 | loss  3.72 | ppl     41.38
| epoch   5 step     8530 | batches    126 / 2101 | lr 9.197e-03 | ms/batch 401.3 | tok/s  122478 | loss  3.76 | ppl     42.83
| epoch   5 step     8540 | batches    136 / 2101 | lr 9.195e-03 | ms/batch 410.3 | tok/s  119783 | loss  3.73 | ppl     41.52
| epoch   5 step     8550 | batches    146 / 2101 | lr 9.193e-03 | ms/batch 410.7 | tok/s  119677 | loss  3.68 | ppl     39.61
| epoch   5 step     8560 | batches    156 / 2101 | lr 9.191e-03 | ms/batch 399.9 | tok/s  122915 | loss  3.68 | ppl     39.62
| epoch   5 step     8570 | batches    166 / 2101 | lr 9.189e-03 | ms/batch 410.5 | tok/s  119737 | loss  3.69 | ppl     40.02
| epoch   5 step     8580 | batches    176 / 2101 | lr 9.187e-03 | ms/batch 400.4 | tok/s  122766 | loss  3.69 | ppl     40.01
| epoch   5 step     8590 | batches    186 / 2101 | lr 9.185e-03 | ms/batch 410.8 | tok/s  119648 | loss  3.73 | ppl     41.74
| epoch   5 step     8600 | batches    196 / 2101 | lr 9.183e-03 | ms/batch 411.6 | tok/s  119422 | loss  3.76 | ppl     42.92
| epoch   5 step     8610 | batches    206 / 2101 | lr 9.181e-03 | ms/batch 400.6 | tok/s  122687 | loss  3.75 | ppl     42.60
| epoch   5 step     8620 | batches    216 / 2101 | lr 9.179e-03 | ms/batch 400.6 | tok/s  122706 | loss  3.73 | ppl     41.58
| epoch   5 step     8630 | batches    226 / 2101 | lr 9.176e-03 | ms/batch 399.8 | tok/s  122954 | loss  3.71 | ppl     40.76
| epoch   5 step     8640 | batches    236 / 2101 | lr 9.174e-03 | ms/batch 400.6 | tok/s  122690 | loss  3.73 | ppl     41.78
| epoch   5 step     8650 | batches    246 / 2101 | lr 9.172e-03 | ms/batch 400.1 | tok/s  122860 | loss  3.71 | ppl     40.71
| epoch   5 step     8660 | batches    256 / 2101 | lr 9.170e-03 | ms/batch 401.3 | tok/s  122481 | loss  3.68 | ppl     39.81
| epoch   5 step     8670 | batches    266 / 2101 | lr 9.168e-03 | ms/batch 400.3 | tok/s  122781 | loss  3.68 | ppl     39.78
| epoch   5 step     8680 | batches    276 / 2101 | lr 9.166e-03 | ms/batch 400.5 | tok/s  122733 | loss  3.71 | ppl     40.83
| epoch   5 step     8690 | batches    286 / 2101 | lr 9.164e-03 | ms/batch 400.5 | tok/s  122740 | loss  3.75 | ppl     42.73
| epoch   5 step     8700 | batches    296 / 2101 | lr 9.162e-03 | ms/batch 400.6 | tok/s  122702 | loss  3.75 | ppl     42.67
| epoch   5 step     8710 | batches    306 / 2101 | lr 9.160e-03 | ms/batch 400.0 | tok/s  122894 | loss  3.75 | ppl     42.41
| epoch   5 step     8720 | batches    316 / 2101 | lr 9.158e-03 | ms/batch 400.4 | tok/s  122772 | loss  3.76 | ppl     42.86
| epoch   5 step     8730 | batches    326 / 2101 | lr 9.155e-03 | ms/batch 400.0 | tok/s  122894 | loss  3.74 | ppl     42.11
| epoch   5 step     8740 | batches    336 / 2101 | lr 9.153e-03 | ms/batch 400.9 | tok/s  122615 | loss  3.70 | ppl     40.26
| epoch   5 step     8750 | batches    346 / 2101 | lr 9.151e-03 | ms/batch 400.2 | tok/s  122818 | loss  3.70 | ppl     40.26
| epoch   5 step     8760 | batches    356 / 2101 | lr 9.149e-03 | ms/batch 401.4 | tok/s  122465 | loss  3.74 | ppl     42.08
| epoch   5 step     8770 | batches    366 / 2101 | lr 9.147e-03 | ms/batch 400.5 | tok/s  122736 | loss  3.75 | ppl     42.33
| epoch   5 step     8780 | batches    376 / 2101 | lr 9.145e-03 | ms/batch 399.7 | tok/s  122978 | loss  3.76 | ppl     42.77
| epoch   5 step     8790 | batches    386 / 2101 | lr 9.143e-03 | ms/batch 400.0 | tok/s  122891 | loss  3.71 | ppl     40.97
| epoch   5 step     8800 | batches    396 / 2101 | lr 9.141e-03 | ms/batch 411.1 | tok/s  119556 | loss  3.72 | ppl     41.12
| epoch   5 step     8810 | batches    406 / 2101 | lr 9.138e-03 | ms/batch 411.0 | tok/s  119580 | loss  3.71 | ppl     41.03
| epoch   5 step     8820 | batches    416 / 2101 | lr 9.136e-03 | ms/batch 401.5 | tok/s  122409 | loss  3.68 | ppl     39.61
| epoch   5 step     8830 | batches    426 / 2101 | lr 9.134e-03 | ms/batch 400.7 | tok/s  122652 | loss  3.72 | ppl     41.26
| epoch   5 step     8840 | batches    436 / 2101 | lr 9.132e-03 | ms/batch 404.6 | tok/s  121482 | loss  3.71 | ppl     40.68
| epoch   5 step     8850 | batches    446 / 2101 | lr 9.130e-03 | ms/batch 400.6 | tok/s  122701 | loss  3.75 | ppl     42.31
| epoch   5 step     8860 | batches    456 / 2101 | lr 9.128e-03 | ms/batch 401.3 | tok/s  122478 | loss  3.71 | ppl     40.83
| epoch   5 step     8870 | batches    466 / 2101 | lr 9.126e-03 | ms/batch 400.6 | tok/s  122690 | loss  3.71 | ppl     40.89
| epoch   5 step     8880 | batches    476 / 2101 | lr 9.123e-03 | ms/batch 400.4 | tok/s  122755 | loss  3.73 | ppl     41.47
| epoch   5 step     8890 | batches    486 / 2101 | lr 9.121e-03 | ms/batch 400.0 | tok/s  122894 | loss  3.71 | ppl     40.89
| epoch   5 step     8900 | batches    496 / 2101 | lr 9.119e-03 | ms/batch 400.5 | tok/s  122739 | loss  3.69 | ppl     40.14
| epoch   5 step     8910 | batches    506 / 2101 | lr 9.117e-03 | ms/batch 400.9 | tok/s  122610 | loss  3.66 | ppl     38.75
| epoch   5 step     8920 | batches    516 / 2101 | lr 9.115e-03 | ms/batch 400.7 | tok/s  122671 | loss  3.71 | ppl     40.75
| epoch   5 step     8930 | batches    526 / 2101 | lr 9.113e-03 | ms/batch 400.8 | tok/s  122647 | loss  3.70 | ppl     40.63
| epoch   5 step     8940 | batches    536 / 2101 | lr 9.111e-03 | ms/batch 401.2 | tok/s  122510 | loss  3.73 | ppl     41.59
| epoch   5 step     8950 | batches    546 / 2101 | lr 9.108e-03 | ms/batch 400.6 | tok/s  122696 | loss  3.71 | ppl     40.87
| epoch   5 step     8960 | batches    556 / 2101 | lr 9.106e-03 | ms/batch 400.4 | tok/s  122748 | loss  3.72 | ppl     41.43
| epoch   5 step     8970 | batches    566 / 2101 | lr 9.104e-03 | ms/batch 401.0 | tok/s  122578 | loss  3.68 | ppl     39.78
| epoch   5 step     8980 | batches    576 / 2101 | lr 9.102e-03 | ms/batch 400.6 | tok/s  122694 | loss  3.71 | ppl     40.98
| epoch   5 step     8990 | batches    586 / 2101 | lr 9.100e-03 | ms/batch 400.2 | tok/s  122817 | loss  3.70 | ppl     40.60
| epoch   5 step     9000 | batches    596 / 2101 | lr 9.097e-03 | ms/batch 415.1 | tok/s  118416 | loss  3.68 | ppl     39.79
----------------------------------------------------------------------------------------------------
| Eval  18 at step     9000 | time:  0.82s | valid loss  3.55 | valid ppl    34.761
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.1155339828972949, 0.1143006210565792, 0.12822032381219808, 0.10181965145308812, 0.10314447085209277, 0.11435599888257565, 0.11257226714931544, 0.09472892740671975, 0.11255395614265205, 0.10024519824117026, 0.11840740847056513, 0.11015384196890421, 0.11718722181693837, 0.12591112592901146, 0.11020839248725767, 0.1207164738144123, 0.11982487597055154, 0.12277007894218103, 0.1129227061823181, 0.10805222051406226, 0.12332192136729804, 0.11274996030590198, 0.10378885143564873, 0.1174036386309801, 0.1109295629080506, 0.1410468646573775, 0.11697134241554134, 0.13507916053019145, 0.12786647341258753, 0.11214191757013446, 0.1195762257387934, 0.11253462083610884, 0.09807181461133055, 0.09941555172760244, 0.10202444500405902, 0.10275959800410489, 0.10258172428178836, 0.09978883910778048, 0.10374199208650134, 0.10810586395912695, 0.11800398489992067, 0.09324783481020661, 0.09301651029827182, 0.10432724738992996, 0.09821656041651326, 0.10707573936929071, 0.10626121199715667, 0.06980899672807907, 0.09628597634566077, 0.10083899958212629, 0.10811279746496617, 0.0949276843042602, 0.07706220759840242, 0.085218947868602, 0.0886830173542609, 0.1154763383928464, 0.09934451956154579, 0.11745380980160953, 0.09442679854688278, 0.09265114903294086, 0.09630050698959845, 0.07997004632535554, 0.05814260775838726, 0.07125653275958925, 0.08333313231589269, 0.09274645499323547, 0.08437964980706393, 0.07818514266094091, 0.07387446500792721, 0.08620319496833094, 0.10640620814860052, 0.0977644292162023, 0.1507256953226825, 0.07401676753671879, 0.07915270332824896, 0.09679399048802835, 0.08865062002718346, 0.09505203006612221, 0.07095490037264073, 0.08105735598524788, 0.11896782325123037]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [48, 60, 9, 21, 11, 49, 71, 8, 29, 15], [49, 36, 17, 9, 8, 41, 53, 8, 10, 10], [33, 43, 8, 8, 8, 36, 45, 9, 9, 8], [30, 48, 9, 8, 8, 24, 23, 11, 8, 8], [14, 20, 8, 8, 8, 24, 29, 8, 8, 8], [11, 22, 8, 8, 8, 18, 20, 8, 8, 8], [9, 8, 8, 8, 8, 12, 12, 8, 8, 8], [11, 18, 9, 8, 8, 11, 10, 8, 8, 8], [8]]
optimal compression parameters =  [[], [48, 60, 9, 21, 11, 49, 71, 8, 29, 15], [49, 36, 17, 9, 8, 41, 53, 8, 10, 10], [33, 43, 8, 8, 8, 36, 45, 9, 9, 8], [30, 48, 9, 8, 8, 24, 23, 11, 8, 8], [14, 20, 8, 8, 8, 24, 29, 8, 8, 8], [11, 22, 8, 8, 8, 18, 20, 8, 8, 8], [9, 8, 8, 8, 8, 12, 12, 8, 8, 8], [11, 18, 9, 8, 8, 11, 10, 8, 8, 8], [8]]
| epoch   5 step     9010 | batches    606 / 2101 | lr 9.095e-03 | ms/batch 4886.7 | tok/s   10058 | loss  3.72 | ppl     41.16
| epoch   5 step     9020 | batches    616 / 2101 | lr 9.093e-03 | ms/batch 409.3 | tok/s  120099 | loss  3.74 | ppl     42.00
| epoch   5 step     9030 | batches    626 / 2101 | lr 9.091e-03 | ms/batch 398.1 | tok/s  123475 | loss  3.67 | ppl     39.34
| epoch   5 step     9040 | batches    636 / 2101 | lr 9.089e-03 | ms/batch 397.1 | tok/s  123773 | loss  3.67 | ppl     39.11
| epoch   5 step     9050 | batches    646 / 2101 | lr 9.087e-03 | ms/batch 409.0 | tok/s  120183 | loss  3.68 | ppl     39.73
| epoch   5 step     9060 | batches    656 / 2101 | lr 9.084e-03 | ms/batch 408.8 | tok/s  120237 | loss  3.70 | ppl     40.40
| epoch   5 step     9070 | batches    666 / 2101 | lr 9.082e-03 | ms/batch 399.2 | tok/s  123127 | loss  3.72 | ppl     41.25
| epoch   5 step     9080 | batches    676 / 2101 | lr 9.080e-03 | ms/batch 398.8 | tok/s  123261 | loss  3.69 | ppl     40.02
| epoch   5 step     9090 | batches    686 / 2101 | lr 9.078e-03 | ms/batch 399.0 | tok/s  123192 | loss  3.69 | ppl     40.11
| epoch   5 step     9100 | batches    696 / 2101 | lr 9.076e-03 | ms/batch 399.0 | tok/s  123193 | loss  3.74 | ppl     42.01
| epoch   5 step     9110 | batches    706 / 2101 | lr 9.073e-03 | ms/batch 409.9 | tok/s  119909 | loss  3.69 | ppl     40.16
| epoch   5 step     9120 | batches    716 / 2101 | lr 9.071e-03 | ms/batch 399.2 | tok/s  123118 | loss  3.72 | ppl     41.32
| epoch   5 step     9130 | batches    726 / 2101 | lr 9.069e-03 | ms/batch 409.8 | tok/s  119945 | loss  3.73 | ppl     41.58
| epoch   5 step     9140 | batches    736 / 2101 | lr 9.067e-03 | ms/batch 409.9 | tok/s  119922 | loss  3.72 | ppl     41.40
| epoch   5 step     9150 | batches    746 / 2101 | lr 9.065e-03 | ms/batch 409.9 | tok/s  119903 | loss  3.72 | ppl     41.31
| epoch   5 step     9160 | batches    756 / 2101 | lr 9.062e-03 | ms/batch 399.3 | tok/s  123087 | loss  3.75 | ppl     42.61
| epoch   5 step     9170 | batches    766 / 2101 | lr 9.060e-03 | ms/batch 399.9 | tok/s  122922 | loss  3.73 | ppl     41.73
| epoch   5 step     9180 | batches    776 / 2101 | lr 9.058e-03 | ms/batch 399.4 | tok/s  123052 | loss  3.75 | ppl     42.55
| epoch   5 step     9190 | batches    786 / 2101 | lr 9.056e-03 | ms/batch 399.8 | tok/s  122936 | loss  3.75 | ppl     42.65
| epoch   5 step     9200 | batches    796 / 2101 | lr 9.053e-03 | ms/batch 400.4 | tok/s  122746 | loss  3.77 | ppl     43.21
| epoch   5 step     9210 | batches    806 / 2101 | lr 9.051e-03 | ms/batch 400.2 | tok/s  122827 | loss  3.79 | ppl     44.40
| epoch   5 step     9220 | batches    816 / 2101 | lr 9.049e-03 | ms/batch 399.7 | tok/s  122961 | loss  3.73 | ppl     41.64
| epoch   5 step     9230 | batches    826 / 2101 | lr 9.047e-03 | ms/batch 399.8 | tok/s  122941 | loss  3.75 | ppl     42.45
| epoch   5 step     9240 | batches    836 / 2101 | lr 9.045e-03 | ms/batch 399.6 | tok/s  123015 | loss  3.74 | ppl     42.16
| epoch   5 step     9250 | batches    846 / 2101 | lr 9.042e-03 | ms/batch 410.5 | tok/s  119741 | loss  3.76 | ppl     43.15
| epoch   5 step     9260 | batches    856 / 2101 | lr 9.040e-03 | ms/batch 399.9 | tok/s  122898 | loss  3.74 | ppl     42.07
| epoch   5 step     9270 | batches    866 / 2101 | lr 9.038e-03 | ms/batch 400.1 | tok/s  122858 | loss  3.70 | ppl     40.46
| epoch   5 step     9280 | batches    876 / 2101 | lr 9.036e-03 | ms/batch 399.9 | tok/s  122897 | loss  3.76 | ppl     42.78
| epoch   5 step     9290 | batches    886 / 2101 | lr 9.033e-03 | ms/batch 400.6 | tok/s  122683 | loss  3.70 | ppl     40.59
| epoch   5 step     9300 | batches    896 / 2101 | lr 9.031e-03 | ms/batch 399.4 | tok/s  123079 | loss  3.70 | ppl     40.65
| epoch   5 step     9310 | batches    906 / 2101 | lr 9.029e-03 | ms/batch 400.3 | tok/s  122794 | loss  3.73 | ppl     41.62
| epoch   5 step     9320 | batches    916 / 2101 | lr 9.027e-03 | ms/batch 401.8 | tok/s  122317 | loss  3.75 | ppl     42.36
| epoch   5 step     9330 | batches    926 / 2101 | lr 9.024e-03 | ms/batch 399.6 | tok/s  122993 | loss  3.68 | ppl     39.56
| epoch   5 step     9340 | batches    936 / 2101 | lr 9.022e-03 | ms/batch 399.1 | tok/s  123157 | loss  3.67 | ppl     39.31
| epoch   5 step     9350 | batches    946 / 2101 | lr 9.020e-03 | ms/batch 399.6 | tok/s  122997 | loss  3.68 | ppl     39.77
| epoch   5 step     9360 | batches    956 / 2101 | lr 9.018e-03 | ms/batch 399.6 | tok/s  123006 | loss  3.68 | ppl     39.69
| epoch   5 step     9370 | batches    966 / 2101 | lr 9.015e-03 | ms/batch 400.3 | tok/s  122787 | loss  3.71 | ppl     40.96
| epoch   5 step     9380 | batches    976 / 2101 | lr 9.013e-03 | ms/batch 399.8 | tok/s  122928 | loss  3.64 | ppl     38.20
| epoch   5 step     9390 | batches    986 / 2101 | lr 9.011e-03 | ms/batch 399.6 | tok/s  123012 | loss  3.69 | ppl     40.17
| epoch   5 step     9400 | batches    996 / 2101 | lr 9.009e-03 | ms/batch 400.1 | tok/s  122864 | loss  3.71 | ppl     40.73
| epoch   5 step     9410 | batches   1006 / 2101 | lr 9.006e-03 | ms/batch 399.8 | tok/s  122947 | loss  3.72 | ppl     41.24
| epoch   5 step     9420 | batches   1016 / 2101 | lr 9.004e-03 | ms/batch 399.9 | tok/s  122927 | loss  3.71 | ppl     40.98
| epoch   5 step     9430 | batches   1026 / 2101 | lr 9.002e-03 | ms/batch 399.9 | tok/s  122902 | loss  3.73 | ppl     41.71
| epoch   5 step     9440 | batches   1036 / 2101 | lr 8.999e-03 | ms/batch 410.6 | tok/s  119699 | loss  3.72 | ppl     41.44
| epoch   5 step     9450 | batches   1046 / 2101 | lr 8.997e-03 | ms/batch 402.1 | tok/s  122231 | loss  3.72 | ppl     41.26
| epoch   5 step     9460 | batches   1056 / 2101 | lr 8.995e-03 | ms/batch 411.7 | tok/s  119399 | loss  3.72 | ppl     41.43
| epoch   5 step     9470 | batches   1066 / 2101 | lr 8.993e-03 | ms/batch 400.4 | tok/s  122753 | loss  3.70 | ppl     40.60
| epoch   5 step     9480 | batches   1076 / 2101 | lr 8.990e-03 | ms/batch 411.8 | tok/s  119367 | loss  3.71 | ppl     40.99
| epoch   5 step     9490 | batches   1086 / 2101 | lr 8.988e-03 | ms/batch 400.4 | tok/s  122753 | loss  3.71 | ppl     40.95
| epoch   5 step     9500 | batches   1096 / 2101 | lr 8.986e-03 | ms/batch 399.7 | tok/s  122984 | loss  3.69 | ppl     40.14
----------------------------------------------------------------------------------------------------
| Eval  19 at step     9500 | time:  0.83s | valid loss  3.53 | valid ppl    34.006
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   5 step     9510 | batches   1106 / 2101 | lr 8.983e-03 | ms/batch 400.2 | tok/s  122835 | loss  3.71 | ppl     41.02
| epoch   5 step     9520 | batches   1116 / 2101 | lr 8.981e-03 | ms/batch 410.9 | tok/s  119631 | loss  3.71 | ppl     40.92
| epoch   5 step     9530 | batches   1126 / 2101 | lr 8.979e-03 | ms/batch 409.9 | tok/s  119925 | loss  3.71 | ppl     41.01
| epoch   5 step     9540 | batches   1136 / 2101 | lr 8.977e-03 | ms/batch 398.8 | tok/s  123241 | loss  3.72 | ppl     41.40
| epoch   5 step     9550 | batches   1146 / 2101 | lr 8.974e-03 | ms/batch 409.7 | tok/s  119980 | loss  3.70 | ppl     40.43
| epoch   5 step     9560 | batches   1156 / 2101 | lr 8.972e-03 | ms/batch 400.7 | tok/s  122661 | loss  3.72 | ppl     41.42
| epoch   5 step     9570 | batches   1166 / 2101 | lr 8.970e-03 | ms/batch 410.6 | tok/s  119702 | loss  3.70 | ppl     40.26
| epoch   5 step     9580 | batches   1176 / 2101 | lr 8.967e-03 | ms/batch 411.0 | tok/s  119589 | loss  3.72 | ppl     41.30
| epoch   5 step     9590 | batches   1186 / 2101 | lr 8.965e-03 | ms/batch 399.8 | tok/s  122945 | loss  3.74 | ppl     42.13
| epoch   5 step     9600 | batches   1196 / 2101 | lr 8.963e-03 | ms/batch 399.7 | tok/s  122966 | loss  3.76 | ppl     42.91
| epoch   5 step     9610 | batches   1206 / 2101 | lr 8.960e-03 | ms/batch 400.1 | tok/s  122866 | loss  3.71 | ppl     40.69
| epoch   5 step     9620 | batches   1216 / 2101 | lr 8.958e-03 | ms/batch 411.0 | tok/s  119583 | loss  3.76 | ppl     42.76
| epoch   5 step     9630 | batches   1226 / 2101 | lr 8.956e-03 | ms/batch 411.2 | tok/s  119532 | loss  3.73 | ppl     41.87
| epoch   5 step     9640 | batches   1236 / 2101 | lr 8.953e-03 | ms/batch 399.8 | tok/s  122948 | loss  3.70 | ppl     40.42
| epoch   5 step     9650 | batches   1246 / 2101 | lr 8.951e-03 | ms/batch 400.6 | tok/s  122711 | loss  3.75 | ppl     42.51
| epoch   5 step     9660 | batches   1256 / 2101 | lr 8.949e-03 | ms/batch 399.5 | tok/s  123022 | loss  3.72 | ppl     41.18
| epoch   5 step     9670 | batches   1266 / 2101 | lr 8.946e-03 | ms/batch 400.2 | tok/s  122824 | loss  3.73 | ppl     41.55
| epoch   5 step     9680 | batches   1276 / 2101 | lr 8.944e-03 | ms/batch 399.8 | tok/s  122949 | loss  3.72 | ppl     41.35
| epoch   5 step     9690 | batches   1286 / 2101 | lr 8.942e-03 | ms/batch 400.0 | tok/s  122885 | loss  3.74 | ppl     42.10
| epoch   5 step     9700 | batches   1296 / 2101 | lr 8.939e-03 | ms/batch 400.0 | tok/s  122884 | loss  3.71 | ppl     40.68
| epoch   5 step     9710 | batches   1306 / 2101 | lr 8.937e-03 | ms/batch 400.2 | tok/s  122812 | loss  3.69 | ppl     40.14
| epoch   5 step     9720 | batches   1316 / 2101 | lr 8.935e-03 | ms/batch 400.0 | tok/s  122894 | loss  3.68 | ppl     39.79
| epoch   5 step     9730 | batches   1326 / 2101 | lr 8.932e-03 | ms/batch 401.9 | tok/s  122294 | loss  3.69 | ppl     40.13
| epoch   5 step     9740 | batches   1336 / 2101 | lr 8.930e-03 | ms/batch 400.7 | tok/s  122680 | loss  3.69 | ppl     39.97
| epoch   5 step     9750 | batches   1346 / 2101 | lr 8.928e-03 | ms/batch 399.7 | tok/s  122979 | loss  3.71 | ppl     40.82
| epoch   5 step     9760 | batches   1356 / 2101 | lr 8.925e-03 | ms/batch 411.5 | tok/s  119458 | loss  3.70 | ppl     40.28
| epoch   5 step     9770 | batches   1366 / 2101 | lr 8.923e-03 | ms/batch 410.5 | tok/s  119748 | loss  3.69 | ppl     40.23
| epoch   5 step     9780 | batches   1376 / 2101 | lr 8.921e-03 | ms/batch 400.0 | tok/s  122889 | loss  3.71 | ppl     40.83
| epoch   5 step     9790 | batches   1386 / 2101 | lr 8.918e-03 | ms/batch 399.7 | tok/s  122981 | loss  3.69 | ppl     40.15
| epoch   5 step     9800 | batches   1396 / 2101 | lr 8.916e-03 | ms/batch 400.0 | tok/s  122888 | loss  3.69 | ppl     39.89
| epoch   5 step     9810 | batches   1406 / 2101 | lr 8.914e-03 | ms/batch 399.9 | tok/s  122914 | loss  3.70 | ppl     40.39
| epoch   5 step     9820 | batches   1416 / 2101 | lr 8.911e-03 | ms/batch 399.7 | tok/s  122963 | loss  3.73 | ppl     41.70
| epoch   5 step     9830 | batches   1426 / 2101 | lr 8.909e-03 | ms/batch 410.4 | tok/s  119782 | loss  3.71 | ppl     40.66
| epoch   5 step     9840 | batches   1436 / 2101 | lr 8.906e-03 | ms/batch 399.4 | tok/s  123067 | loss  3.66 | ppl     38.99
| epoch   5 step     9850 | batches   1446 / 2101 | lr 8.904e-03 | ms/batch 399.3 | tok/s  123094 | loss  3.66 | ppl     38.78
| epoch   5 step     9860 | batches   1456 / 2101 | lr 8.902e-03 | ms/batch 399.5 | tok/s  123028 | loss  3.67 | ppl     39.29
| epoch   5 step     9870 | batches   1466 / 2101 | lr 8.899e-03 | ms/batch 400.3 | tok/s  122795 | loss  3.66 | ppl     38.96
| epoch   5 step     9880 | batches   1476 / 2101 | lr 8.897e-03 | ms/batch 399.8 | tok/s  122952 | loss  3.63 | ppl     37.73
| epoch   5 step     9890 | batches   1486 / 2101 | lr 8.895e-03 | ms/batch 399.8 | tok/s  122934 | loss  3.66 | ppl     38.71
| epoch   5 step     9900 | batches   1496 / 2101 | lr 8.892e-03 | ms/batch 401.3 | tok/s  122469 | loss  3.67 | ppl     39.27
| epoch   5 step     9910 | batches   1506 / 2101 | lr 8.890e-03 | ms/batch 399.8 | tok/s  122944 | loss  3.68 | ppl     39.53
| epoch   5 step     9920 | batches   1516 / 2101 | lr 8.887e-03 | ms/batch 399.6 | tok/s  122994 | loss  3.65 | ppl     38.54
| epoch   5 step     9930 | batches   1526 / 2101 | lr 8.885e-03 | ms/batch 400.1 | tok/s  122853 | loss  3.66 | ppl     38.84
| epoch   5 step     9940 | batches   1536 / 2101 | lr 8.883e-03 | ms/batch 399.8 | tok/s  122955 | loss  3.69 | ppl     39.93
| epoch   5 step     9950 | batches   1546 / 2101 | lr 8.880e-03 | ms/batch 400.1 | tok/s  122848 | loss  3.67 | ppl     39.31
| epoch   5 step     9960 | batches   1556 / 2101 | lr 8.878e-03 | ms/batch 399.7 | tok/s  122987 | loss  3.67 | ppl     39.23
| epoch   5 step     9970 | batches   1566 / 2101 | lr 8.875e-03 | ms/batch 399.7 | tok/s  122962 | loss  3.69 | ppl     39.94
| epoch   5 step     9980 | batches   1576 / 2101 | lr 8.873e-03 | ms/batch 399.4 | tok/s  123066 | loss  3.73 | ppl     41.85
| epoch   5 step     9990 | batches   1586 / 2101 | lr 8.871e-03 | ms/batch 411.3 | tok/s  119508 | loss  3.74 | ppl     42.16
| epoch   5 step    10000 | batches   1596 / 2101 | lr 8.868e-03 | ms/batch 414.0 | tok/s  118720 | loss  3.68 | ppl     39.84
----------------------------------------------------------------------------------------------------
| Eval  20 at step    10000 | time:  0.83s | valid loss  3.52 | valid ppl    33.635
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.10156900282696439, 0.10171925959523964, 0.09616366554411078, 0.08813537420270852, 0.09140236204450955, 0.09557323400937075, 0.102461624437325, 0.09887156554727254, 0.08143500646784091, 0.08869106059852853, 0.1017110161495777, 0.0977282199321135, 0.0880585530130443, 0.10756382625664235, 0.0950263136026664, 0.10417429034134774, 0.1056079217359856, 0.10157072358245678, 0.09713421273570297, 0.09431388255422579, 0.09120542043598341, 0.09698381970843487, 0.08957100846573307, 0.09370770386381853, 0.09419509161089097, 0.10159812391178931, 0.10040609124308995, 0.08405576073027435, 0.10545490029503943, 0.09549436975486812, 0.10455466100914361, 0.10197100022609179, 0.10095069733860045, 0.09301752425506528, 0.09024227279467442, 0.08895972200699355, 0.09337958051281575, 0.07950319405956939, 0.09221533509824777, 0.09311223990215647, 0.08326214861037702, 0.09313464153704752, 0.08458961975885554, 0.0839558656010379, 0.08400287423296099, 0.09523010779497548, 0.09799008892897608, 0.0660053644770903, 0.08229784511831337, 0.09081890210233565, 0.08280947771257105, 0.08324538601908223, 0.0682490170543911, 0.07292369409122972, 0.07707150650132216, 0.08195294095358054, 0.084250951056858, 0.07412899567385987, 0.07924528398656529, 0.08026903752500916, 0.0792346420956501, 0.06433369033591992, 0.025830904997588923, 0.0626992806610813, 0.07237479383197633, 0.07300324351696907, 0.07056685836604097, 0.04089080357460747, 0.06437848637329986, 0.07433776159222157, 0.0922513447503453, 0.08493153999022675, 0.11120627764253187, 0.06522835422807512, 0.06987908640640768, 0.08106617036237149, 0.07446569269585014, 0.08254382097144208, 0.06084710064348568, 0.06958972912097308, 0.10857132137013055]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [46, 58, 9, 19, 13, 48, 72, 8, 27, 15], [50, 42, 17, 8, 9, 46, 54, 8, 8, 9], [31, 40, 8, 8, 9, 38, 46, 9, 9, 9], [30, 49, 9, 8, 8, 24, 21, 9, 9, 8], [14, 21, 8, 8, 8, 24, 30, 9, 8, 8], [13, 19, 8, 8, 8, 17, 19, 8, 8, 8], [11, 9, 9, 8, 8, 11, 12, 9, 8, 8], [9, 13, 9, 8, 8, 9, 10, 8, 8, 8], [8]]
optimal compression parameters =  [[], [46, 58, 9, 19, 13, 48, 72, 8, 27, 15], [50, 42, 17, 8, 9, 46, 54, 8, 8, 9], [31, 40, 8, 8, 9, 38, 46, 9, 9, 9], [30, 49, 9, 8, 8, 24, 21, 9, 9, 8], [14, 21, 8, 8, 8, 24, 30, 9, 8, 8], [13, 19, 8, 8, 8, 17, 19, 8, 8, 8], [11, 9, 9, 8, 8, 11, 12, 9, 8, 8], [9, 13, 9, 8, 8, 9, 10, 8, 8, 8], [8]]
| epoch   5 step    10010 | batches   1606 / 2101 | lr 8.866e-03 | ms/batch 4888.0 | tok/s   10056 | loss  3.66 | ppl     38.72
| epoch   5 step    10020 | batches   1616 / 2101 | lr 8.863e-03 | ms/batch 409.5 | tok/s  120043 | loss  3.69 | ppl     40.17
| epoch   5 step    10030 | batches   1626 / 2101 | lr 8.861e-03 | ms/batch 397.8 | tok/s  123546 | loss  3.65 | ppl     38.43
| epoch   5 step    10040 | batches   1636 / 2101 | lr 8.859e-03 | ms/batch 397.7 | tok/s  123596 | loss  3.64 | ppl     38.21
| epoch   5 step    10050 | batches   1646 / 2101 | lr 8.856e-03 | ms/batch 399.5 | tok/s  123048 | loss  3.66 | ppl     38.92
| epoch   5 step    10060 | batches   1656 / 2101 | lr 8.854e-03 | ms/batch 398.3 | tok/s  123397 | loss  3.68 | ppl     39.54
| epoch   5 step    10070 | batches   1666 / 2101 | lr 8.851e-03 | ms/batch 401.4 | tok/s  122438 | loss  3.69 | ppl     40.18
| epoch   5 step    10080 | batches   1676 / 2101 | lr 8.849e-03 | ms/batch 398.9 | tok/s  123214 | loss  3.68 | ppl     39.46
| epoch   5 step    10090 | batches   1686 / 2101 | lr 8.847e-03 | ms/batch 409.1 | tok/s  120142 | loss  3.62 | ppl     37.43
| epoch   5 step    10100 | batches   1696 / 2101 | lr 8.844e-03 | ms/batch 398.3 | tok/s  123396 | loss  3.67 | ppl     39.09
| epoch   5 step    10110 | batches   1706 / 2101 | lr 8.842e-03 | ms/batch 398.4 | tok/s  123362 | loss  3.70 | ppl     40.29
| epoch   5 step    10120 | batches   1716 / 2101 | lr 8.839e-03 | ms/batch 399.0 | tok/s  123197 | loss  3.68 | ppl     39.80
| epoch   5 step    10130 | batches   1726 / 2101 | lr 8.837e-03 | ms/batch 400.4 | tok/s  122756 | loss  3.70 | ppl     40.37
| epoch   5 step    10140 | batches   1736 / 2101 | lr 8.834e-03 | ms/batch 399.9 | tok/s  122909 | loss  3.71 | ppl     41.04
| epoch   5 step    10150 | batches   1746 / 2101 | lr 8.832e-03 | ms/batch 399.8 | tok/s  122938 | loss  3.72 | ppl     41.47
| epoch   5 step    10160 | batches   1756 / 2101 | lr 8.830e-03 | ms/batch 399.8 | tok/s  122953 | loss  3.68 | ppl     39.78
| epoch   5 step    10170 | batches   1766 / 2101 | lr 8.827e-03 | ms/batch 400.3 | tok/s  122792 | loss  3.71 | ppl     40.90
| epoch   5 step    10180 | batches   1776 / 2101 | lr 8.825e-03 | ms/batch 400.0 | tok/s  122877 | loss  3.71 | ppl     40.70
| epoch   5 step    10190 | batches   1786 / 2101 | lr 8.822e-03 | ms/batch 399.3 | tok/s  123100 | loss  3.72 | ppl     41.07
| epoch   5 step    10200 | batches   1796 / 2101 | lr 8.820e-03 | ms/batch 399.2 | tok/s  123129 | loss  3.71 | ppl     40.78
| epoch   5 step    10210 | batches   1806 / 2101 | lr 8.817e-03 | ms/batch 403.0 | tok/s  121952 | loss  3.71 | ppl     40.86
| epoch   5 step    10220 | batches   1816 / 2101 | lr 8.815e-03 | ms/batch 400.0 | tok/s  122873 | loss  3.66 | ppl     38.92
| epoch   5 step    10230 | batches   1826 / 2101 | lr 8.812e-03 | ms/batch 400.4 | tok/s  122744 | loss  3.67 | ppl     39.38
| epoch   5 step    10240 | batches   1836 / 2101 | lr 8.810e-03 | ms/batch 400.2 | tok/s  122822 | loss  3.65 | ppl     38.61
| epoch   5 step    10250 | batches   1846 / 2101 | lr 8.808e-03 | ms/batch 400.3 | tok/s  122781 | loss  3.70 | ppl     40.31
| epoch   5 step    10260 | batches   1856 / 2101 | lr 8.805e-03 | ms/batch 400.5 | tok/s  122733 | loss  3.67 | ppl     39.39
| epoch   5 step    10270 | batches   1866 / 2101 | lr 8.803e-03 | ms/batch 399.8 | tok/s  122932 | loss  3.67 | ppl     39.32
| epoch   5 step    10280 | batches   1876 / 2101 | lr 8.800e-03 | ms/batch 411.4 | tok/s  119472 | loss  3.70 | ppl     40.30
| epoch   5 step    10290 | batches   1886 / 2101 | lr 8.798e-03 | ms/batch 411.3 | tok/s  119509 | loss  3.65 | ppl     38.64
| epoch   5 step    10300 | batches   1896 / 2101 | lr 8.795e-03 | ms/batch 400.4 | tok/s  122770 | loss  3.69 | ppl     40.08
| epoch   5 step    10310 | batches   1906 / 2101 | lr 8.793e-03 | ms/batch 400.5 | tok/s  122743 | loss  3.73 | ppl     41.54
| epoch   5 step    10320 | batches   1916 / 2101 | lr 8.790e-03 | ms/batch 399.8 | tok/s  122935 | loss  3.68 | ppl     39.66
| epoch   5 step    10330 | batches   1926 / 2101 | lr 8.788e-03 | ms/batch 400.7 | tok/s  122652 | loss  3.63 | ppl     37.69
| epoch   5 step    10340 | batches   1936 / 2101 | lr 8.785e-03 | ms/batch 400.9 | tok/s  122618 | loss  3.65 | ppl     38.29
| epoch   5 step    10350 | batches   1946 / 2101 | lr 8.783e-03 | ms/batch 400.1 | tok/s  122839 | loss  3.70 | ppl     40.60
| epoch   5 step    10360 | batches   1956 / 2101 | lr 8.780e-03 | ms/batch 399.9 | tok/s  122902 | loss  3.66 | ppl     38.91
| epoch   5 step    10370 | batches   1966 / 2101 | lr 8.778e-03 | ms/batch 402.1 | tok/s  122237 | loss  3.71 | ppl     40.88
| epoch   5 step    10380 | batches   1976 / 2101 | lr 8.775e-03 | ms/batch 400.3 | tok/s  122803 | loss  3.70 | ppl     40.63
| epoch   5 step    10390 | batches   1986 / 2101 | lr 8.773e-03 | ms/batch 400.5 | tok/s  122738 | loss  3.66 | ppl     38.81
| epoch   5 step    10400 | batches   1996 / 2101 | lr 8.770e-03 | ms/batch 400.5 | tok/s  122730 | loss  3.70 | ppl     40.25
| epoch   5 step    10410 | batches   2006 / 2101 | lr 8.768e-03 | ms/batch 399.9 | tok/s  122914 | loss  3.67 | ppl     39.20
| epoch   5 step    10420 | batches   2016 / 2101 | lr 8.765e-03 | ms/batch 399.8 | tok/s  122947 | loss  3.69 | ppl     40.11
| epoch   5 step    10430 | batches   2026 / 2101 | lr 8.763e-03 | ms/batch 399.8 | tok/s  122942 | loss  3.71 | ppl     40.97
| epoch   5 step    10440 | batches   2036 / 2101 | lr 8.760e-03 | ms/batch 399.7 | tok/s  122985 | loss  3.68 | ppl     39.69
| epoch   5 step    10450 | batches   2046 / 2101 | lr 8.758e-03 | ms/batch 400.5 | tok/s  122739 | loss  3.68 | ppl     39.84
| epoch   5 step    10460 | batches   2056 / 2101 | lr 8.755e-03 | ms/batch 400.4 | tok/s  122770 | loss  3.71 | ppl     40.89
| epoch   5 step    10470 | batches   2066 / 2101 | lr 8.753e-03 | ms/batch 400.6 | tok/s  122688 | loss  3.72 | ppl     41.23
| epoch   5 step    10480 | batches   2076 / 2101 | lr 8.750e-03 | ms/batch 400.9 | tok/s  122619 | loss  3.68 | ppl     39.46
| epoch   5 step    10490 | batches   2086 / 2101 | lr 8.748e-03 | ms/batch 401.4 | tok/s  122452 | loss  3.67 | ppl     39.33
| epoch   5 step    10500 | batches   2096 / 2101 | lr 8.745e-03 | ms/batch 401.2 | tok/s  122507 | loss  3.69 | ppl     39.98
----------------------------------------------------------------------------------------------------
| Eval  21 at step    10500 | time:  0.91s | valid loss  3.49 | valid ppl    32.810
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   6 step    10510 | batches      5 / 2101 | lr 8.743e-03 | ms/batch 417.9 | tok/s  119296 | loss  3.76 | ppl     42.97
| epoch   6 step    10520 | batches     15 / 2101 | lr 8.740e-03 | ms/batch 412.1 | tok/s  119263 | loss  3.63 | ppl     37.61
| epoch   6 step    10530 | batches     25 / 2101 | lr 8.738e-03 | ms/batch 399.5 | tok/s  123043 | loss  3.61 | ppl     36.91
| epoch   6 step    10540 | batches     35 / 2101 | lr 8.735e-03 | ms/batch 411.1 | tok/s  119553 | loss  3.62 | ppl     37.19
| epoch   6 step    10550 | batches     45 / 2101 | lr 8.733e-03 | ms/batch 399.9 | tok/s  122898 | loss  3.62 | ppl     37.19
| epoch   6 step    10560 | batches     55 / 2101 | lr 8.730e-03 | ms/batch 399.8 | tok/s  122929 | loss  3.63 | ppl     37.75
| epoch   6 step    10570 | batches     65 / 2101 | lr 8.728e-03 | ms/batch 399.8 | tok/s  122934 | loss  3.64 | ppl     38.08
| epoch   6 step    10580 | batches     75 / 2101 | lr 8.725e-03 | ms/batch 400.0 | tok/s  122876 | loss  3.60 | ppl     36.61
| epoch   6 step    10590 | batches     85 / 2101 | lr 8.723e-03 | ms/batch 399.8 | tok/s  122929 | loss  3.56 | ppl     35.32
| epoch   6 step    10600 | batches     95 / 2101 | lr 8.720e-03 | ms/batch 400.1 | tok/s  122843 | loss  3.62 | ppl     37.42
| epoch   6 step    10610 | batches    105 / 2101 | lr 8.718e-03 | ms/batch 401.1 | tok/s  122539 | loss  3.62 | ppl     37.51
| epoch   6 step    10620 | batches    115 / 2101 | lr 8.715e-03 | ms/batch 400.4 | tok/s  122762 | loss  3.58 | ppl     36.03
| epoch   6 step    10630 | batches    125 / 2101 | lr 8.713e-03 | ms/batch 401.9 | tok/s  122315 | loss  3.57 | ppl     35.63
| epoch   6 step    10640 | batches    135 / 2101 | lr 8.710e-03 | ms/batch 400.7 | tok/s  122677 | loss  3.61 | ppl     37.07
| epoch   6 step    10650 | batches    145 / 2101 | lr 8.708e-03 | ms/batch 401.6 | tok/s  122382 | loss  3.65 | ppl     38.46
| epoch   6 step    10660 | batches    155 / 2101 | lr 8.705e-03 | ms/batch 400.9 | tok/s  122604 | loss  3.61 | ppl     37.06
| epoch   6 step    10670 | batches    165 / 2101 | lr 8.702e-03 | ms/batch 400.1 | tok/s  122856 | loss  3.61 | ppl     37.01
| epoch   6 step    10680 | batches    175 / 2101 | lr 8.700e-03 | ms/batch 421.7 | tok/s  116558 | loss  3.60 | ppl     36.76
| epoch   6 step    10690 | batches    185 / 2101 | lr 8.697e-03 | ms/batch 402.1 | tok/s  122242 | loss  3.62 | ppl     37.41
| epoch   6 step    10700 | batches    195 / 2101 | lr 8.695e-03 | ms/batch 412.0 | tok/s  119293 | loss  3.58 | ppl     35.70
| epoch   6 step    10710 | batches    205 / 2101 | lr 8.692e-03 | ms/batch 410.7 | tok/s  119670 | loss  3.61 | ppl     36.99
| epoch   6 step    10720 | batches    215 / 2101 | lr 8.690e-03 | ms/batch 401.2 | tok/s  122513 | loss  3.67 | ppl     39.06
| epoch   6 step    10730 | batches    225 / 2101 | lr 8.687e-03 | ms/batch 401.4 | tok/s  122442 | loss  3.66 | ppl     38.69
| epoch   6 step    10740 | batches    235 / 2101 | lr 8.685e-03 | ms/batch 400.9 | tok/s  122615 | loss  3.67 | ppl     39.18
| epoch   6 step    10750 | batches    245 / 2101 | lr 8.682e-03 | ms/batch 401.1 | tok/s  122551 | loss  3.61 | ppl     37.06
| epoch   6 step    10760 | batches    255 / 2101 | lr 8.679e-03 | ms/batch 399.8 | tok/s  122936 | loss  3.59 | ppl     36.31
| epoch   6 step    10770 | batches    265 / 2101 | lr 8.677e-03 | ms/batch 400.4 | tok/s  122745 | loss  3.60 | ppl     36.68
| epoch   6 step    10780 | batches    275 / 2101 | lr 8.674e-03 | ms/batch 399.9 | tok/s  122914 | loss  3.62 | ppl     37.35
| epoch   6 step    10790 | batches    285 / 2101 | lr 8.672e-03 | ms/batch 401.1 | tok/s  122547 | loss  3.62 | ppl     37.36
| epoch   6 step    10800 | batches    295 / 2101 | lr 8.669e-03 | ms/batch 402.4 | tok/s  122147 | loss  3.63 | ppl     37.79
| epoch   6 step    10810 | batches    305 / 2101 | lr 8.667e-03 | ms/batch 400.7 | tok/s  122656 | loss  3.64 | ppl     37.94
| epoch   6 step    10820 | batches    315 / 2101 | lr 8.664e-03 | ms/batch 401.1 | tok/s  122531 | loss  3.61 | ppl     37.10
| epoch   6 step    10830 | batches    325 / 2101 | lr 8.661e-03 | ms/batch 401.1 | tok/s  122548 | loss  3.63 | ppl     37.70
| epoch   6 step    10840 | batches    335 / 2101 | lr 8.659e-03 | ms/batch 400.6 | tok/s  122692 | loss  3.67 | ppl     39.38
| epoch   6 step    10850 | batches    345 / 2101 | lr 8.656e-03 | ms/batch 400.7 | tok/s  122666 | loss  3.65 | ppl     38.57
| epoch   6 step    10860 | batches    355 / 2101 | lr 8.654e-03 | ms/batch 401.6 | tok/s  122406 | loss  3.61 | ppl     36.83
| epoch   6 step    10870 | batches    365 / 2101 | lr 8.651e-03 | ms/batch 401.0 | tok/s  122581 | loss  3.65 | ppl     38.56
| epoch   6 step    10880 | batches    375 / 2101 | lr 8.648e-03 | ms/batch 401.0 | tok/s  122573 | loss  3.63 | ppl     37.67
| epoch   6 step    10890 | batches    385 / 2101 | lr 8.646e-03 | ms/batch 400.7 | tok/s  122662 | loss  3.64 | ppl     38.16
| epoch   6 step    10900 | batches    395 / 2101 | lr 8.643e-03 | ms/batch 400.4 | tok/s  122744 | loss  3.61 | ppl     36.86
| epoch   6 step    10910 | batches    405 / 2101 | lr 8.641e-03 | ms/batch 401.0 | tok/s  122561 | loss  3.63 | ppl     37.87
| epoch   6 step    10920 | batches    415 / 2101 | lr 8.638e-03 | ms/batch 400.6 | tok/s  122684 | loss  3.61 | ppl     37.04
| epoch   6 step    10930 | batches    425 / 2101 | lr 8.636e-03 | ms/batch 400.1 | tok/s  122847 | loss  3.63 | ppl     37.78
| epoch   6 step    10940 | batches    435 / 2101 | lr 8.633e-03 | ms/batch 401.1 | tok/s  122537 | loss  3.65 | ppl     38.60
| epoch   6 step    10950 | batches    445 / 2101 | lr 8.630e-03 | ms/batch 402.1 | tok/s  122241 | loss  3.63 | ppl     37.81
| epoch   6 step    10960 | batches    455 / 2101 | lr 8.628e-03 | ms/batch 400.2 | tok/s  122815 | loss  3.58 | ppl     35.84
| epoch   6 step    10970 | batches    465 / 2101 | lr 8.625e-03 | ms/batch 400.0 | tok/s  122875 | loss  3.65 | ppl     38.44
| epoch   6 step    10980 | batches    475 / 2101 | lr 8.622e-03 | ms/batch 401.1 | tok/s  122542 | loss  3.65 | ppl     38.59
| epoch   6 step    10990 | batches    485 / 2101 | lr 8.620e-03 | ms/batch 400.5 | tok/s  122712 | loss  3.61 | ppl     37.13
| epoch   6 step    11000 | batches    495 / 2101 | lr 8.617e-03 | ms/batch 415.9 | tok/s  118197 | loss  3.64 | ppl     38.18
----------------------------------------------------------------------------------------------------
| Eval  22 at step    11000 | time:  0.82s | valid loss  3.47 | valid ppl    32.268
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.08728722575427506, 0.0929971247069888, 0.09443220216123384, 0.08182797759128205, 0.08353411988867347, 0.09713568874411385, 0.09457689198889875, 0.09276511580763191, 0.07917640938489375, 0.08027241230958464, 0.0969339729117694, 0.08788073105145072, 0.07902335764099647, 0.1032748046937948, 0.08671461636096663, 0.09538668511746752, 0.0966912194112524, 0.09519671229372399, 0.09122621547883975, 0.08592751180953602, 0.08967405759617102, 0.08916391190843076, 0.08445956757207389, 0.0892995119721784, 0.08958050248962314, 0.0886579815081691, 0.0926193902588027, 0.08592134587548204, 0.10205938425756593, 0.09080419824356012, 0.0849012713362632, 0.09042656916293032, 0.0714282673090611, 0.08664350608894751, 0.0811250673258988, 0.07242653035956641, 0.0803219201676369, 0.0728685091751731, 0.08463487467705681, 0.08780131704615735, 0.07795619835095856, 0.08355357452072186, 0.07875387057113663, 0.07569045258386012, 0.07662018938867043, 0.08040842184406001, 0.08273097309514207, 0.05783314686910428, 0.07247932115662932, 0.08117061668480549, 0.08348067117091731, 0.075816414953952, 0.07877163814107095, 0.06427289982887416, 0.06961234940609293, 0.07236757243561473, 0.07821551155605667, 0.08126926530571303, 0.07527201429780413, 0.0734267562472807, 0.07557744350843862, 0.06045912679771255, 0.0414107458869164, 0.05559702360420449, 0.06602327481010267, 0.07638606968161177, 0.06373766932632567, 0.04076130332415499, 0.05966100539695766, 0.06989003785967995, 0.08185621469147719, 0.07527661806965681, 0.08045454179197785, 0.057178289574228255, 0.06341218327651171, 0.07177113529703961, 0.06595082237692987, 0.06253372072568772, 0.05555984900019292, 0.06412384945110322, 0.09267591457700135]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [45, 59, 9, 19, 10, 52, 74, 8, 23, 14], [43, 43, 20, 8, 8, 47, 52, 8, 10, 8], [34, 47, 9, 8, 8, 41, 47, 9, 9, 9], [31, 48, 9, 8, 8, 24, 19, 10, 8, 8], [11, 17, 8, 8, 8, 20, 30, 9, 8, 8], [12, 21, 8, 8, 8, 15, 20, 8, 8, 8], [8, 10, 8, 8, 8, 10, 10, 8, 8, 8], [9, 17, 9, 8, 8, 14, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [45, 59, 9, 19, 10, 52, 74, 8, 23, 14], [43, 43, 20, 8, 8, 47, 52, 8, 10, 8], [34, 47, 9, 8, 8, 41, 47, 9, 9, 9], [31, 48, 9, 8, 8, 24, 19, 10, 8, 8], [11, 17, 8, 8, 8, 20, 30, 9, 8, 8], [12, 21, 8, 8, 8, 15, 20, 8, 8, 8], [8, 10, 8, 8, 8, 10, 10, 8, 8, 8], [9, 17, 9, 8, 8, 14, 8, 8, 8, 8], [8]]
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
Compression stats: iter 11000, total before compression 1919694930298, total after compression 136478866522, rate 14.065876858587119
| epoch   6 step    11010 | batches    505 / 2101 | lr 8.615e-03 | ms/batch 4882.2 | tok/s   10068 | loss  3.63 | ppl     37.76
| epoch   6 step    11020 | batches    515 / 2101 | lr 8.612e-03 | ms/batch 398.5 | tok/s  123344 | loss  3.65 | ppl     38.37
| epoch   6 step    11030 | batches    525 / 2101 | lr 8.609e-03 | ms/batch 396.8 | tok/s  123870 | loss  3.63 | ppl     37.90
| epoch   6 step    11040 | batches    535 / 2101 | lr 8.607e-03 | ms/batch 397.6 | tok/s  123634 | loss  3.65 | ppl     38.30
| epoch   6 step    11050 | batches    545 / 2101 | lr 8.604e-03 | ms/batch 397.6 | tok/s  123637 | loss  3.60 | ppl     36.74
| epoch   6 step    11060 | batches    555 / 2101 | lr 8.602e-03 | ms/batch 397.8 | tok/s  123551 | loss  3.60 | ppl     36.69
| epoch   6 step    11070 | batches    565 / 2101 | lr 8.599e-03 | ms/batch 398.6 | tok/s  123317 | loss  3.64 | ppl     38.00
| epoch   6 step    11080 | batches    575 / 2101 | lr 8.596e-03 | ms/batch 398.2 | tok/s  123445 | loss  3.62 | ppl     37.21
| epoch   6 step    11090 | batches    585 / 2101 | lr 8.594e-03 | ms/batch 399.1 | tok/s  123145 | loss  3.55 | ppl     34.90
| epoch   6 step    11100 | batches    595 / 2101 | lr 8.591e-03 | ms/batch 399.0 | tok/s  123194 | loss  3.56 | ppl     35.27
| epoch   6 step    11110 | batches    605 / 2101 | lr 8.588e-03 | ms/batch 399.4 | tok/s  123066 | loss  3.57 | ppl     35.66
| epoch   6 step    11120 | batches    615 / 2101 | lr 8.586e-03 | ms/batch 398.0 | tok/s  123496 | loss  3.60 | ppl     36.48
| epoch   6 step    11130 | batches    625 / 2101 | lr 8.583e-03 | ms/batch 398.3 | tok/s  123395 | loss  3.57 | ppl     35.63
| epoch   6 step    11140 | batches    635 / 2101 | lr 8.580e-03 | ms/batch 398.8 | tok/s  123263 | loss  3.57 | ppl     35.47
| epoch   6 step    11150 | batches    645 / 2101 | lr 8.578e-03 | ms/batch 398.8 | tok/s  123246 | loss  3.58 | ppl     35.77
| epoch   6 step    11160 | batches    655 / 2101 | lr 8.575e-03 | ms/batch 399.9 | tok/s  122919 | loss  3.62 | ppl     37.22
| epoch   6 step    11170 | batches    665 / 2101 | lr 8.573e-03 | ms/batch 399.8 | tok/s  122933 | loss  3.61 | ppl     36.98
| epoch   6 step    11180 | batches    675 / 2101 | lr 8.570e-03 | ms/batch 399.4 | tok/s  123077 | loss  3.61 | ppl     36.96
| epoch   6 step    11190 | batches    685 / 2101 | lr 8.567e-03 | ms/batch 399.7 | tok/s  122961 | loss  3.61 | ppl     36.88
| epoch   6 step    11200 | batches    695 / 2101 | lr 8.565e-03 | ms/batch 399.0 | tok/s  123201 | loss  3.58 | ppl     35.70
| epoch   6 step    11210 | batches    705 / 2101 | lr 8.562e-03 | ms/batch 400.5 | tok/s  122739 | loss  3.57 | ppl     35.41
| epoch   6 step    11220 | batches    715 / 2101 | lr 8.559e-03 | ms/batch 399.4 | tok/s  123079 | loss  3.58 | ppl     35.82
| epoch   6 step    11230 | batches    725 / 2101 | lr 8.557e-03 | ms/batch 399.7 | tok/s  122959 | loss  3.60 | ppl     36.75
| epoch   6 step    11240 | batches    735 / 2101 | lr 8.554e-03 | ms/batch 400.5 | tok/s  122739 | loss  3.64 | ppl     38.03
| epoch   6 step    11250 | batches    745 / 2101 | lr 8.551e-03 | ms/batch 399.5 | tok/s  123049 | loss  3.65 | ppl     38.57
| epoch   6 step    11260 | batches    755 / 2101 | lr 8.549e-03 | ms/batch 399.6 | tok/s  123008 | loss  3.62 | ppl     37.47
| epoch   6 step    11270 | batches    765 / 2101 | lr 8.546e-03 | ms/batch 399.9 | tok/s  122912 | loss  3.62 | ppl     37.32
| epoch   6 step    11280 | batches    775 / 2101 | lr 8.543e-03 | ms/batch 399.8 | tok/s  122944 | loss  3.62 | ppl     37.52
| epoch   6 step    11290 | batches    785 / 2101 | lr 8.541e-03 | ms/batch 399.3 | tok/s  123097 | loss  3.59 | ppl     36.38
| epoch   6 step    11300 | batches    795 / 2101 | lr 8.538e-03 | ms/batch 399.6 | tok/s  122991 | loss  3.59 | ppl     36.29
| epoch   6 step    11310 | batches    805 / 2101 | lr 8.535e-03 | ms/batch 399.0 | tok/s  123201 | loss  3.59 | ppl     36.38
| epoch   6 step    11320 | batches    815 / 2101 | lr 8.533e-03 | ms/batch 399.5 | tok/s  123047 | loss  3.62 | ppl     37.23
| epoch   6 step    11330 | batches    825 / 2101 | lr 8.530e-03 | ms/batch 399.7 | tok/s  122965 | loss  3.61 | ppl     37.10
| epoch   6 step    11340 | batches    835 / 2101 | lr 8.527e-03 | ms/batch 398.7 | tok/s  123290 | loss  3.62 | ppl     37.46
| epoch   6 step    11350 | batches    845 / 2101 | lr 8.525e-03 | ms/batch 399.5 | tok/s  123035 | loss  3.63 | ppl     37.64
| epoch   6 step    11360 | batches    855 / 2101 | lr 8.522e-03 | ms/batch 399.9 | tok/s  122913 | loss  3.63 | ppl     37.70
| epoch   6 step    11370 | batches    865 / 2101 | lr 8.519e-03 | ms/batch 400.0 | tok/s  122882 | loss  3.63 | ppl     37.72
| epoch   6 step    11380 | batches    875 / 2101 | lr 8.516e-03 | ms/batch 411.4 | tok/s  119464 | loss  3.63 | ppl     37.83
| epoch   6 step    11390 | batches    885 / 2101 | lr 8.514e-03 | ms/batch 400.7 | tok/s  122655 | loss  3.66 | ppl     38.88
| epoch   6 step    11400 | batches    895 / 2101 | lr 8.511e-03 | ms/batch 400.0 | tok/s  122884 | loss  3.62 | ppl     37.52
| epoch   6 step    11410 | batches    905 / 2101 | lr 8.508e-03 | ms/batch 400.1 | tok/s  122860 | loss  3.66 | ppl     38.81
| epoch   6 step    11420 | batches    915 / 2101 | lr 8.506e-03 | ms/batch 400.0 | tok/s  122888 | loss  3.66 | ppl     38.76
| epoch   6 step    11430 | batches    925 / 2101 | lr 8.503e-03 | ms/batch 400.8 | tok/s  122630 | loss  3.63 | ppl     37.83
| epoch   6 step    11440 | batches    935 / 2101 | lr 8.500e-03 | ms/batch 399.8 | tok/s  122937 | loss  3.62 | ppl     37.17
| epoch   6 step    11450 | batches    945 / 2101 | lr 8.498e-03 | ms/batch 400.3 | tok/s  122787 | loss  3.60 | ppl     36.56
| epoch   6 step    11460 | batches    955 / 2101 | lr 8.495e-03 | ms/batch 399.8 | tok/s  122929 | loss  3.63 | ppl     37.65
| epoch   6 step    11470 | batches    965 / 2101 | lr 8.492e-03 | ms/batch 399.8 | tok/s  122957 | loss  3.64 | ppl     38.27
| epoch   6 step    11480 | batches    975 / 2101 | lr 8.489e-03 | ms/batch 399.7 | tok/s  122958 | loss  3.62 | ppl     37.37
| epoch   6 step    11490 | batches    985 / 2101 | lr 8.487e-03 | ms/batch 400.7 | tok/s  122682 | loss  3.62 | ppl     37.48
| epoch   6 step    11500 | batches    995 / 2101 | lr 8.484e-03 | ms/batch 400.5 | tok/s  122742 | loss  3.64 | ppl     38.24
----------------------------------------------------------------------------------------------------
| Eval  23 at step    11500 | time:  0.84s | valid loss  3.46 | valid ppl    31.832
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   6 step    11510 | batches   1005 / 2101 | lr 8.481e-03 | ms/batch 399.5 | tok/s  123045 | loss  3.65 | ppl     38.58
| epoch   6 step    11520 | batches   1015 / 2101 | lr 8.479e-03 | ms/batch 409.4 | tok/s  120068 | loss  3.62 | ppl     37.24
| epoch   6 step    11530 | batches   1025 / 2101 | lr 8.476e-03 | ms/batch 398.6 | tok/s  123305 | loss  3.64 | ppl     38.13
| epoch   6 step    11540 | batches   1035 / 2101 | lr 8.473e-03 | ms/batch 398.2 | tok/s  123423 | loss  3.62 | ppl     37.30
| epoch   6 step    11550 | batches   1045 / 2101 | lr 8.470e-03 | ms/batch 399.4 | tok/s  123077 | loss  3.62 | ppl     37.35
| epoch   6 step    11560 | batches   1055 / 2101 | lr 8.468e-03 | ms/batch 400.7 | tok/s  122653 | loss  3.60 | ppl     36.64
| epoch   6 step    11570 | batches   1065 / 2101 | lr 8.465e-03 | ms/batch 399.7 | tok/s  122977 | loss  3.60 | ppl     36.61
| epoch   6 step    11580 | batches   1075 / 2101 | lr 8.462e-03 | ms/batch 399.8 | tok/s  122954 | loss  3.65 | ppl     38.35
| epoch   6 step    11590 | batches   1085 / 2101 | lr 8.460e-03 | ms/batch 399.0 | tok/s  123179 | loss  3.65 | ppl     38.41
| epoch   6 step    11600 | batches   1095 / 2101 | lr 8.457e-03 | ms/batch 399.5 | tok/s  123044 | loss  3.58 | ppl     36.02
| epoch   6 step    11610 | batches   1105 / 2101 | lr 8.454e-03 | ms/batch 399.4 | tok/s  123056 | loss  3.59 | ppl     36.07
| epoch   6 step    11620 | batches   1115 / 2101 | lr 8.451e-03 | ms/batch 399.1 | tok/s  123166 | loss  3.60 | ppl     36.64
| epoch   6 step    11630 | batches   1125 / 2101 | lr 8.449e-03 | ms/batch 398.8 | tok/s  123253 | loss  3.61 | ppl     36.87
| epoch   6 step    11640 | batches   1135 / 2101 | lr 8.446e-03 | ms/batch 399.4 | tok/s  123072 | loss  3.63 | ppl     37.59
| epoch   6 step    11650 | batches   1145 / 2101 | lr 8.443e-03 | ms/batch 399.7 | tok/s  122984 | loss  3.59 | ppl     36.20
| epoch   6 step    11660 | batches   1155 / 2101 | lr 8.440e-03 | ms/batch 399.0 | tok/s  123185 | loss  3.60 | ppl     36.67
| epoch   6 step    11670 | batches   1165 / 2101 | lr 8.438e-03 | ms/batch 399.0 | tok/s  123187 | loss  3.62 | ppl     37.33
| epoch   6 step    11680 | batches   1175 / 2101 | lr 8.435e-03 | ms/batch 398.8 | tok/s  123254 | loss  3.60 | ppl     36.49
| epoch   6 step    11690 | batches   1185 / 2101 | lr 8.432e-03 | ms/batch 399.4 | tok/s  123076 | loss  3.60 | ppl     36.70
| epoch   6 step    11700 | batches   1195 / 2101 | lr 8.429e-03 | ms/batch 399.4 | tok/s  123068 | loss  3.60 | ppl     36.53
| epoch   6 step    11710 | batches   1205 / 2101 | lr 8.427e-03 | ms/batch 400.2 | tok/s  122807 | loss  3.62 | ppl     37.29
| epoch   6 step    11720 | batches   1215 / 2101 | lr 8.424e-03 | ms/batch 399.5 | tok/s  123034 | loss  3.62 | ppl     37.26
| epoch   6 step    11730 | batches   1225 / 2101 | lr 8.421e-03 | ms/batch 398.7 | tok/s  123282 | loss  3.60 | ppl     36.48
| epoch   6 step    11740 | batches   1235 / 2101 | lr 8.418e-03 | ms/batch 399.9 | tok/s  122914 | loss  3.64 | ppl     38.13
| epoch   6 step    11750 | batches   1245 / 2101 | lr 8.416e-03 | ms/batch 410.6 | tok/s  119709 | loss  3.61 | ppl     36.97
| epoch   6 step    11760 | batches   1255 / 2101 | lr 8.413e-03 | ms/batch 410.4 | tok/s  119769 | loss  3.63 | ppl     37.53
| epoch   6 step    11770 | batches   1265 / 2101 | lr 8.410e-03 | ms/batch 399.6 | tok/s  123017 | loss  3.63 | ppl     37.84
| epoch   6 step    11780 | batches   1275 / 2101 | lr 8.407e-03 | ms/batch 399.9 | tok/s  122906 | loss  3.64 | ppl     38.17
| epoch   6 step    11790 | batches   1285 / 2101 | lr 8.405e-03 | ms/batch 399.0 | tok/s  123194 | loss  3.65 | ppl     38.47
| epoch   6 step    11800 | batches   1295 / 2101 | lr 8.402e-03 | ms/batch 399.0 | tok/s  123174 | loss  3.63 | ppl     37.69
| epoch   6 step    11810 | batches   1305 / 2101 | lr 8.399e-03 | ms/batch 399.0 | tok/s  123188 | loss  3.63 | ppl     37.56
| epoch   6 step    11820 | batches   1315 / 2101 | lr 8.396e-03 | ms/batch 399.0 | tok/s  123201 | loss  3.67 | ppl     39.23
| epoch   6 step    11830 | batches   1325 / 2101 | lr 8.393e-03 | ms/batch 399.2 | tok/s  123134 | loss  3.63 | ppl     37.70
| epoch   6 step    11840 | batches   1335 / 2101 | lr 8.391e-03 | ms/batch 399.2 | tok/s  123143 | loss  3.64 | ppl     37.91
| epoch   6 step    11850 | batches   1345 / 2101 | lr 8.388e-03 | ms/batch 399.2 | tok/s  123115 | loss  3.62 | ppl     37.42
| epoch   6 step    11860 | batches   1355 / 2101 | lr 8.385e-03 | ms/batch 400.4 | tok/s  122756 | loss  3.61 | ppl     37.09
| epoch   6 step    11870 | batches   1365 / 2101 | lr 8.382e-03 | ms/batch 400.0 | tok/s  122881 | loss  3.60 | ppl     36.67
| epoch   6 step    11880 | batches   1375 / 2101 | lr 8.380e-03 | ms/batch 399.4 | tok/s  123070 | loss  3.61 | ppl     37.12
| epoch   6 step    11890 | batches   1385 / 2101 | lr 8.377e-03 | ms/batch 400.2 | tok/s  122828 | loss  3.62 | ppl     37.36
| epoch   6 step    11900 | batches   1395 / 2101 | lr 8.374e-03 | ms/batch 400.6 | tok/s  122711 | loss  3.63 | ppl     37.83
| epoch   6 step    11910 | batches   1405 / 2101 | lr 8.371e-03 | ms/batch 399.3 | tok/s  123110 | loss  3.63 | ppl     37.66
| epoch   6 step    11920 | batches   1415 / 2101 | lr 8.368e-03 | ms/batch 400.0 | tok/s  122885 | loss  3.65 | ppl     38.41
| epoch   6 step    11930 | batches   1425 / 2101 | lr 8.366e-03 | ms/batch 399.7 | tok/s  122980 | loss  3.64 | ppl     38.09
| epoch   6 step    11940 | batches   1435 / 2101 | lr 8.363e-03 | ms/batch 399.1 | tok/s  123165 | loss  3.60 | ppl     36.58
| epoch   6 step    11950 | batches   1445 / 2101 | lr 8.360e-03 | ms/batch 398.9 | tok/s  123217 | loss  3.57 | ppl     35.38
| epoch   6 step    11960 | batches   1455 / 2101 | lr 8.357e-03 | ms/batch 399.0 | tok/s  123178 | loss  3.58 | ppl     35.72
| epoch   6 step    11970 | batches   1465 / 2101 | lr 8.354e-03 | ms/batch 399.7 | tok/s  122962 | loss  3.63 | ppl     37.53
| epoch   6 step    11980 | batches   1475 / 2101 | lr 8.352e-03 | ms/batch 400.6 | tok/s  122694 | loss  3.63 | ppl     37.86
| epoch   6 step    11990 | batches   1485 / 2101 | lr 8.349e-03 | ms/batch 399.3 | tok/s  123107 | loss  3.60 | ppl     36.69
| epoch   6 step    12000 | batches   1495 / 2101 | lr 8.346e-03 | ms/batch 413.3 | tok/s  118927 | loss  3.59 | ppl     36.14
----------------------------------------------------------------------------------------------------
| Eval  24 at step    12000 | time:  0.82s | valid loss  3.45 | valid ppl    31.364
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.0880705828305212, 0.08655272547416015, 0.08104111288059986, 0.07622691786549872, 0.07819174129526904, 0.08284861783979537, 0.08543466677848395, 0.084874319804497, 0.09227314297118439, 0.07623550320859372, 0.08621822730333613, 0.08110804861761853, 0.08493824872571705, 0.09279126492822666, 0.08042129723062491, 0.08608668486948896, 0.08898893657648563, 0.09343950085078892, 0.08346375165487463, 0.07991780753753716, 0.0810565148121732, 0.08118582152955581, 0.08493865661280799, 0.08485221635647369, 0.0803727883700609, 0.08970786772218739, 0.08604519069466462, 0.09463113692821795, 0.09086269423094229, 0.08074887987511314, 0.08894902404823143, 0.08297673874930836, 0.08808321129645666, 0.0754037761654357, 0.07527872756301042, 0.07629598550410578, 0.07785631066868945, 0.07127326753729887, 0.07453716979541031, 0.07820003992522212, 0.08213618093459761, 0.0764458633050686, 0.05799646540477543, 0.08296762984319943, 0.07275463318641152, 0.08226166857155928, 0.0804961749691, 0.07002874947208461, 0.07055118622363564, 0.07836898824127714, 0.07554961979880363, 0.07278095003165724, 0.04860110455995474, 0.06292718254035018, 0.06667639836502927, 0.07990439414869893, 0.07277326354915734, 0.07305864374071608, 0.07228368900060828, 0.06979358125182732, 0.0711787952159925, 0.05196340549247328, 0.029031291520844677, 0.05176481584171876, 0.06337305503939412, 0.06519672976576824, 0.059095273535297387, 0.040661520271476966, 0.054026219370276414, 0.06372031778131544, 0.07315973982080654, 0.06982017684031107, 0.07106082757146723, 0.05313314666350149, 0.05835694260166371, 0.06723029620454377, 0.062377639250790706, 0.06471708045487572, 0.05122414605365046, 0.0593688969077031, 0.08632148057683374]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [49, 58, 9, 19, 9, 52, 70, 8, 25, 16], [40, 36, 18, 9, 8, 43, 53, 8, 8, 8], [31, 46, 9, 8, 8, 40, 48, 9, 8, 8], [35, 55, 8, 8, 8, 26, 19, 13, 8, 8], [12, 15, 8, 8, 8, 20, 25, 8, 8, 8], [12, 20, 8, 8, 8, 15, 21, 8, 8, 8], [9, 8, 8, 8, 8, 9, 11, 8, 8, 8], [12, 16, 9, 8, 8, 13, 8, 9, 8, 8], [8]]
optimal compression parameters =  [[], [49, 58, 9, 19, 9, 52, 70, 8, 25, 16], [40, 36, 18, 9, 8, 43, 53, 8, 8, 8], [31, 46, 9, 8, 8, 40, 48, 9, 8, 8], [35, 55, 8, 8, 8, 26, 19, 13, 8, 8], [12, 15, 8, 8, 8, 20, 25, 8, 8, 8], [12, 20, 8, 8, 8, 15, 21, 8, 8, 8], [9, 8, 8, 8, 8, 9, 11, 8, 8, 8], [12, 16, 9, 8, 8, 13, 8, 9, 8, 8], [8]]
| epoch   6 step    12010 | batches   1505 / 2101 | lr 8.343e-03 | ms/batch 4870.1 | tok/s   10093 | loss  3.53 | ppl     34.17
| epoch   6 step    12020 | batches   1515 / 2101 | lr 8.340e-03 | ms/batch 407.7 | tok/s  120555 | loss  3.57 | ppl     35.65
| epoch   6 step    12030 | batches   1525 / 2101 | lr 8.338e-03 | ms/batch 397.1 | tok/s  123763 | loss  3.61 | ppl     37.02
| epoch   6 step    12040 | batches   1535 / 2101 | lr 8.335e-03 | ms/batch 396.7 | tok/s  123892 | loss  3.63 | ppl     37.60
| epoch   6 step    12050 | batches   1545 / 2101 | lr 8.332e-03 | ms/batch 397.2 | tok/s  123753 | loss  3.62 | ppl     37.22
| epoch   6 step    12060 | batches   1555 / 2101 | lr 8.329e-03 | ms/batch 397.5 | tok/s  123660 | loss  3.65 | ppl     38.62
| epoch   6 step    12070 | batches   1565 / 2101 | lr 8.326e-03 | ms/batch 398.6 | tok/s  123322 | loss  3.63 | ppl     37.55
| epoch   6 step    12080 | batches   1575 / 2101 | lr 8.323e-03 | ms/batch 397.8 | tok/s  123546 | loss  3.61 | ppl     37.13
| epoch   6 step    12090 | batches   1585 / 2101 | lr 8.321e-03 | ms/batch 398.5 | tok/s  123354 | loss  3.60 | ppl     36.70
| epoch   6 step    12100 | batches   1595 / 2101 | lr 8.318e-03 | ms/batch 398.6 | tok/s  123301 | loss  3.60 | ppl     36.60
| epoch   6 step    12110 | batches   1605 / 2101 | lr 8.315e-03 | ms/batch 398.5 | tok/s  123350 | loss  3.62 | ppl     37.34
| epoch   6 step    12120 | batches   1615 / 2101 | lr 8.312e-03 | ms/batch 399.7 | tok/s  122978 | loss  3.61 | ppl     36.80
| epoch   6 step    12130 | batches   1625 / 2101 | lr 8.309e-03 | ms/batch 399.0 | tok/s  123201 | loss  3.59 | ppl     36.27
| epoch   6 step    12140 | batches   1635 / 2101 | lr 8.307e-03 | ms/batch 399.1 | tok/s  123163 | loss  3.59 | ppl     36.28
| epoch   6 step    12150 | batches   1645 / 2101 | lr 8.304e-03 | ms/batch 399.5 | tok/s  123041 | loss  3.63 | ppl     37.64
| epoch   6 step    12160 | batches   1655 / 2101 | lr 8.301e-03 | ms/batch 398.9 | tok/s  123210 | loss  3.60 | ppl     36.53
| epoch   6 step    12170 | batches   1665 / 2101 | lr 8.298e-03 | ms/batch 400.6 | tok/s  122699 | loss  3.63 | ppl     37.70
| epoch   6 step    12180 | batches   1675 / 2101 | lr 8.295e-03 | ms/batch 399.9 | tok/s  122907 | loss  3.63 | ppl     37.82
| epoch   6 step    12190 | batches   1685 / 2101 | lr 8.292e-03 | ms/batch 399.3 | tok/s  123100 | loss  3.60 | ppl     36.67
| epoch   6 step    12200 | batches   1695 / 2101 | lr 8.289e-03 | ms/batch 399.5 | tok/s  123049 | loss  3.61 | ppl     37.09
| epoch   6 step    12210 | batches   1705 / 2101 | lr 8.287e-03 | ms/batch 400.1 | tok/s  122854 | loss  3.57 | ppl     35.69
| epoch   6 step    12220 | batches   1715 / 2101 | lr 8.284e-03 | ms/batch 400.3 | tok/s  122782 | loss  3.61 | ppl     36.83
| epoch   6 step    12230 | batches   1725 / 2101 | lr 8.281e-03 | ms/batch 400.0 | tok/s  122893 | loss  3.63 | ppl     37.72
| epoch   6 step    12240 | batches   1735 / 2101 | lr 8.278e-03 | ms/batch 399.7 | tok/s  122981 | loss  3.64 | ppl     37.96
| epoch   6 step    12250 | batches   1745 / 2101 | lr 8.275e-03 | ms/batch 399.8 | tok/s  122948 | loss  3.61 | ppl     36.85
| epoch   6 step    12260 | batches   1755 / 2101 | lr 8.272e-03 | ms/batch 399.6 | tok/s  123015 | loss  3.58 | ppl     35.70
| epoch   6 step    12270 | batches   1765 / 2101 | lr 8.270e-03 | ms/batch 399.7 | tok/s  122982 | loss  3.61 | ppl     36.79
| epoch   6 step    12280 | batches   1775 / 2101 | lr 8.267e-03 | ms/batch 399.6 | tok/s  123016 | loss  3.61 | ppl     36.99
| epoch   6 step    12290 | batches   1785 / 2101 | lr 8.264e-03 | ms/batch 398.7 | tok/s  123283 | loss  3.58 | ppl     35.76
| epoch   6 step    12300 | batches   1795 / 2101 | lr 8.261e-03 | ms/batch 399.3 | tok/s  123084 | loss  3.60 | ppl     36.65
| epoch   6 step    12310 | batches   1805 / 2101 | lr 8.258e-03 | ms/batch 399.9 | tok/s  122924 | loss  3.63 | ppl     37.65
| epoch   6 step    12320 | batches   1815 / 2101 | lr 8.255e-03 | ms/batch 400.5 | tok/s  122741 | loss  3.59 | ppl     36.14
| epoch   6 step    12330 | batches   1825 / 2101 | lr 8.252e-03 | ms/batch 400.6 | tok/s  122706 | loss  3.58 | ppl     35.83
| epoch   6 step    12340 | batches   1835 / 2101 | lr 8.249e-03 | ms/batch 399.3 | tok/s  123095 | loss  3.60 | ppl     36.76
| epoch   6 step    12350 | batches   1845 / 2101 | lr 8.247e-03 | ms/batch 399.4 | tok/s  123065 | loss  3.57 | ppl     35.38
| epoch   6 step    12360 | batches   1855 / 2101 | lr 8.244e-03 | ms/batch 399.9 | tok/s  122901 | loss  3.62 | ppl     37.29
| epoch   6 step    12370 | batches   1865 / 2101 | lr 8.241e-03 | ms/batch 400.3 | tok/s  122802 | loss  3.61 | ppl     37.12
| epoch   6 step    12380 | batches   1875 / 2101 | lr 8.238e-03 | ms/batch 400.1 | tok/s  122837 | loss  3.59 | ppl     36.31
| epoch   6 step    12390 | batches   1885 / 2101 | lr 8.235e-03 | ms/batch 399.8 | tok/s  122949 | loss  3.61 | ppl     36.84
| epoch   6 step    12400 | batches   1895 / 2101 | lr 8.232e-03 | ms/batch 399.6 | tok/s  123010 | loss  3.58 | ppl     35.95
| epoch   6 step    12410 | batches   1905 / 2101 | lr 8.229e-03 | ms/batch 400.1 | tok/s  122845 | loss  3.59 | ppl     36.16
| epoch   6 step    12420 | batches   1915 / 2101 | lr 8.226e-03 | ms/batch 410.0 | tok/s  119887 | loss  3.56 | ppl     35.17
| epoch   6 step    12430 | batches   1925 / 2101 | lr 8.224e-03 | ms/batch 400.5 | tok/s  122730 | loss  3.58 | ppl     35.85
| epoch   6 step    12440 | batches   1935 / 2101 | lr 8.221e-03 | ms/batch 410.3 | tok/s  119787 | loss  3.64 | ppl     37.96
| epoch   6 step    12450 | batches   1945 / 2101 | lr 8.218e-03 | ms/batch 400.5 | tok/s  122740 | loss  3.63 | ppl     37.63
| epoch   6 step    12460 | batches   1955 / 2101 | lr 8.215e-03 | ms/batch 400.1 | tok/s  122861 | loss  3.61 | ppl     36.81
| epoch   6 step    12470 | batches   1965 / 2101 | lr 8.212e-03 | ms/batch 400.0 | tok/s  122896 | loss  3.61 | ppl     36.85
| epoch   6 step    12480 | batches   1975 / 2101 | lr 8.209e-03 | ms/batch 399.9 | tok/s  122914 | loss  3.63 | ppl     37.65
| epoch   6 step    12490 | batches   1985 / 2101 | lr 8.206e-03 | ms/batch 399.9 | tok/s  122902 | loss  3.61 | ppl     37.09
| epoch   6 step    12500 | batches   1995 / 2101 | lr 8.203e-03 | ms/batch 400.2 | tok/s  122828 | loss  3.58 | ppl     35.70
----------------------------------------------------------------------------------------------------
| Eval  25 at step    12500 | time:  0.83s | valid loss  3.43 | valid ppl    30.941
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   6 step    12510 | batches   2005 / 2101 | lr 8.200e-03 | ms/batch 399.2 | tok/s  123144 | loss  3.58 | ppl     36.01
| epoch   6 step    12520 | batches   2015 / 2101 | lr 8.198e-03 | ms/batch 409.6 | tok/s  120008 | loss  3.62 | ppl     37.23
| epoch   6 step    12530 | batches   2025 / 2101 | lr 8.195e-03 | ms/batch 409.1 | tok/s  120140 | loss  3.60 | ppl     36.70
| epoch   6 step    12540 | batches   2035 / 2101 | lr 8.192e-03 | ms/batch 398.9 | tok/s  123223 | loss  3.57 | ppl     35.65
| epoch   6 step    12550 | batches   2045 / 2101 | lr 8.189e-03 | ms/batch 399.0 | tok/s  123187 | loss  3.59 | ppl     36.14
| epoch   6 step    12560 | batches   2055 / 2101 | lr 8.186e-03 | ms/batch 399.6 | tok/s  122992 | loss  3.59 | ppl     36.10
| epoch   6 step    12570 | batches   2065 / 2101 | lr 8.183e-03 | ms/batch 399.9 | tok/s  122900 | loss  3.59 | ppl     36.14
| epoch   6 step    12580 | batches   2075 / 2101 | lr 8.180e-03 | ms/batch 399.7 | tok/s  122965 | loss  3.63 | ppl     37.62
| epoch   6 step    12590 | batches   2085 / 2101 | lr 8.177e-03 | ms/batch 399.5 | tok/s  123035 | loss  3.62 | ppl     37.19
| epoch   6 step    12600 | batches   2095 / 2101 | lr 8.174e-03 | ms/batch 399.2 | tok/s  123135 | loss  3.60 | ppl     36.67
| epoch   7 step    12610 | batches      4 / 2101 | lr 8.171e-03 | ms/batch 400.7 | tok/s  122792 | loss  3.66 | ppl     38.99
| epoch   7 step    12620 | batches     14 / 2101 | lr 8.168e-03 | ms/batch 410.9 | tok/s  119612 | loss  3.54 | ppl     34.39
| epoch   7 step    12630 | batches     24 / 2101 | lr 8.166e-03 | ms/batch 400.0 | tok/s  122894 | loss  3.55 | ppl     34.79
| epoch   7 step    12640 | batches     34 / 2101 | lr 8.163e-03 | ms/batch 398.8 | tok/s  123244 | loss  3.57 | ppl     35.56
| epoch   7 step    12650 | batches     44 / 2101 | lr 8.160e-03 | ms/batch 398.5 | tok/s  123354 | loss  3.52 | ppl     33.87
| epoch   7 step    12660 | batches     54 / 2101 | lr 8.157e-03 | ms/batch 398.6 | tok/s  123327 | loss  3.47 | ppl     32.17
| epoch   7 step    12670 | batches     64 / 2101 | lr 8.154e-03 | ms/batch 398.9 | tok/s  123212 | loss  3.52 | ppl     33.78
| epoch   7 step    12680 | batches     74 / 2101 | lr 8.151e-03 | ms/batch 399.0 | tok/s  123195 | loss  3.50 | ppl     33.08
| epoch   7 step    12690 | batches     84 / 2101 | lr 8.148e-03 | ms/batch 399.5 | tok/s  123043 | loss  3.50 | ppl     33.05
| epoch   7 step    12700 | batches     94 / 2101 | lr 8.145e-03 | ms/batch 399.6 | tok/s  123009 | loss  3.51 | ppl     33.39
| epoch   7 step    12710 | batches    104 / 2101 | lr 8.142e-03 | ms/batch 399.9 | tok/s  122901 | loss  3.58 | ppl     35.77
| epoch   7 step    12720 | batches    114 / 2101 | lr 8.139e-03 | ms/batch 399.3 | tok/s  123103 | loss  3.58 | ppl     35.81
| epoch   7 step    12730 | batches    124 / 2101 | lr 8.136e-03 | ms/batch 399.1 | tok/s  123169 | loss  3.55 | ppl     34.85
| epoch   7 step    12740 | batches    134 / 2101 | lr 8.133e-03 | ms/batch 399.2 | tok/s  123122 | loss  3.55 | ppl     34.79
| epoch   7 step    12750 | batches    144 / 2101 | lr 8.130e-03 | ms/batch 399.9 | tok/s  122907 | loss  3.53 | ppl     34.18
| epoch   7 step    12760 | batches    154 / 2101 | lr 8.127e-03 | ms/batch 399.3 | tok/s  123107 | loss  3.55 | ppl     34.81
| epoch   7 step    12770 | batches    164 / 2101 | lr 8.124e-03 | ms/batch 400.0 | tok/s  122870 | loss  3.59 | ppl     36.07
| epoch   7 step    12780 | batches    174 / 2101 | lr 8.122e-03 | ms/batch 400.0 | tok/s  122866 | loss  3.56 | ppl     35.31
| epoch   7 step    12790 | batches    184 / 2101 | lr 8.119e-03 | ms/batch 400.5 | tok/s  122717 | loss  3.56 | ppl     35.09
| epoch   7 step    12800 | batches    194 / 2101 | lr 8.116e-03 | ms/batch 400.5 | tok/s  122728 | loss  3.54 | ppl     34.42
| epoch   7 step    12810 | batches    204 / 2101 | lr 8.113e-03 | ms/batch 410.8 | tok/s  119653 | loss  3.53 | ppl     33.99
| epoch   7 step    12820 | batches    214 / 2101 | lr 8.110e-03 | ms/batch 400.5 | tok/s  122737 | loss  3.55 | ppl     34.80
| epoch   7 step    12830 | batches    224 / 2101 | lr 8.107e-03 | ms/batch 399.9 | tok/s  122906 | loss  3.55 | ppl     34.84
| epoch   7 step    12840 | batches    234 / 2101 | lr 8.104e-03 | ms/batch 399.1 | tok/s  123173 | loss  3.51 | ppl     33.32
| epoch   7 step    12850 | batches    244 / 2101 | lr 8.101e-03 | ms/batch 398.7 | tok/s  123279 | loss  3.54 | ppl     34.35
| epoch   7 step    12860 | batches    254 / 2101 | lr 8.098e-03 | ms/batch 399.0 | tok/s  123181 | loss  3.50 | ppl     33.16
| epoch   7 step    12870 | batches    264 / 2101 | lr 8.095e-03 | ms/batch 399.2 | tok/s  123115 | loss  3.51 | ppl     33.58
| epoch   7 step    12880 | batches    274 / 2101 | lr 8.092e-03 | ms/batch 399.5 | tok/s  123033 | loss  3.53 | ppl     34.26
| epoch   7 step    12890 | batches    284 / 2101 | lr 8.089e-03 | ms/batch 409.6 | tok/s  119988 | loss  3.54 | ppl     34.32
| epoch   7 step    12900 | batches    294 / 2101 | lr 8.086e-03 | ms/batch 409.6 | tok/s  120015 | loss  3.51 | ppl     33.35
| epoch   7 step    12910 | batches    304 / 2101 | lr 8.083e-03 | ms/batch 399.9 | tok/s  122923 | loss  3.52 | ppl     33.62
| epoch   7 step    12920 | batches    314 / 2101 | lr 8.080e-03 | ms/batch 400.4 | tok/s  122766 | loss  3.56 | ppl     35.28
| epoch   7 step    12930 | batches    324 / 2101 | lr 8.077e-03 | ms/batch 400.2 | tok/s  122831 | loss  3.57 | ppl     35.39
| epoch   7 step    12940 | batches    334 / 2101 | lr 8.074e-03 | ms/batch 399.8 | tok/s  122951 | loss  3.55 | ppl     34.96
| epoch   7 step    12950 | batches    344 / 2101 | lr 8.071e-03 | ms/batch 399.9 | tok/s  122908 | loss  3.57 | ppl     35.54
| epoch   7 step    12960 | batches    354 / 2101 | lr 8.068e-03 | ms/batch 400.5 | tok/s  122737 | loss  3.54 | ppl     34.54
| epoch   7 step    12970 | batches    364 / 2101 | lr 8.065e-03 | ms/batch 399.9 | tok/s  122900 | loss  3.54 | ppl     34.40
| epoch   7 step    12980 | batches    374 / 2101 | lr 8.062e-03 | ms/batch 399.6 | tok/s  123001 | loss  3.57 | ppl     35.54
| epoch   7 step    12990 | batches    384 / 2101 | lr 8.059e-03 | ms/batch 399.3 | tok/s  123101 | loss  3.59 | ppl     36.32
| epoch   7 step    13000 | batches    394 / 2101 | lr 8.056e-03 | ms/batch 413.9 | tok/s  118741 | loss  3.59 | ppl     36.07
----------------------------------------------------------------------------------------------------
| Eval  26 at step    13000 | time:  0.83s | valid loss  3.43 | valid ppl    30.759
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.07226010230109603, 0.07499613311841613, 0.07874798606607032, 0.06978186638922665, 0.07099582190316105, 0.07306371913186664, 0.07787077457441383, 0.08867964348511995, 0.07171933828454578, 0.06881307111831318, 0.07086987034677315, 0.0746312070276024, 0.06966445767660237, 0.08896889702014672, 0.07186972606931737, 0.07567851538221428, 0.07924025256152058, 0.07453062662041196, 0.0793291794639116, 0.07255013647467681, 0.07479177006670958, 0.07572496910033466, 0.08098911674478079, 0.07598273213628047, 0.07098878113780625, 0.07593040488961716, 0.07758993218792636, 0.08482946338512264, 0.07213549702132394, 0.07096101810767767, 0.07394987466341778, 0.07580709203937741, 0.10301610444393138, 0.07161549329530174, 0.06875518404691636, 0.06825574515341971, 0.06902113761739195, 0.07287442538744458, 0.06993103567068769, 0.07086898844230603, 0.07701883426158367, 0.06704026387642416, 0.0589133517471521, 0.06630036426118262, 0.06466338652433465, 0.07236510058603167, 0.07087728025080925, 0.06597813799160282, 0.062083236989752905, 0.06697220033946302, 0.06036690009696291, 0.06679064838480704, 0.0513988846119022, 0.05609684289761885, 0.05918954979505375, 0.0640806033060135, 0.06764355876003998, 0.08258981550479523, 0.06220647674410697, 0.062246409279864585, 0.05312394433945109, 0.041710865446760365, 0.021876686973590236, 0.047495249674012, 0.05501823261729088, 0.056084718504373, 0.05285722612752944, 0.03285477191618477, 0.048903934384969386, 0.057707202865346925, 0.07578433695157667, 0.06641445608995404, 0.14700110021687612, 0.04801594721115422, 0.05322171818999056, 0.05829115613703019, 0.05643838838210607, 0.07867826544314699, 0.04532053827498781, 0.05399635867240242, 0.0767594744144426]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [46, 64, 9, 14, 11, 53, 69, 8, 29, 14], [47, 37, 16, 8, 8, 46, 54, 8, 9, 8], [34, 45, 9, 8, 8, 38, 44, 8, 8, 8], [28, 51, 8, 8, 8, 25, 22, 9, 8, 8], [10, 18, 8, 8, 8, 19, 30, 8, 8, 8], [12, 21, 8, 8, 8, 13, 22, 8, 8, 8], [8, 9, 8, 8, 8, 8, 11, 8, 8, 8], [11, 13, 9, 8, 8, 9, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [46, 64, 9, 14, 11, 53, 69, 8, 29, 14], [47, 37, 16, 8, 8, 46, 54, 8, 9, 8], [34, 45, 9, 8, 8, 38, 44, 8, 8, 8], [28, 51, 8, 8, 8, 25, 22, 9, 8, 8], [10, 18, 8, 8, 8, 19, 30, 8, 8, 8], [12, 21, 8, 8, 8, 13, 22, 8, 8, 8], [8, 9, 8, 8, 8, 8, 11, 8, 8, 8], [11, 13, 9, 8, 8, 9, 8, 8, 8, 8], [8]]
| epoch   7 step    13010 | batches    404 / 2101 | lr 8.053e-03 | ms/batch 4886.1 | tok/s   10060 | loss  3.55 | ppl     34.81
| epoch   7 step    13020 | batches    414 / 2101 | lr 8.050e-03 | ms/batch 411.4 | tok/s  119486 | loss  3.53 | ppl     34.02
| epoch   7 step    13030 | batches    424 / 2101 | lr 8.047e-03 | ms/batch 409.2 | tok/s  120109 | loss  3.53 | ppl     34.24
| epoch   7 step    13040 | batches    434 / 2101 | lr 8.044e-03 | ms/batch 397.2 | tok/s  123747 | loss  3.54 | ppl     34.51
| epoch   7 step    13050 | batches    444 / 2101 | lr 8.041e-03 | ms/batch 397.9 | tok/s  123538 | loss  3.53 | ppl     34.01
| epoch   7 step    13060 | batches    454 / 2101 | lr 8.038e-03 | ms/batch 396.9 | tok/s  123850 | loss  3.54 | ppl     34.41
| epoch   7 step    13070 | batches    464 / 2101 | lr 8.035e-03 | ms/batch 396.6 | tok/s  123945 | loss  3.52 | ppl     33.92
| epoch   7 step    13080 | batches    474 / 2101 | lr 8.032e-03 | ms/batch 408.1 | tok/s  120437 | loss  3.54 | ppl     34.40
| epoch   7 step    13090 | batches    484 / 2101 | lr 8.029e-03 | ms/batch 397.8 | tok/s  123566 | loss  3.54 | ppl     34.36
| epoch   7 step    13100 | batches    494 / 2101 | lr 8.026e-03 | ms/batch 409.1 | tok/s  120143 | loss  3.55 | ppl     34.78
| epoch   7 step    13110 | batches    504 / 2101 | lr 8.023e-03 | ms/batch 399.2 | tok/s  123120 | loss  3.57 | ppl     35.43
| epoch   7 step    13120 | batches    514 / 2101 | lr 8.020e-03 | ms/batch 398.4 | tok/s  123365 | loss  3.56 | ppl     35.19
| epoch   7 step    13130 | batches    524 / 2101 | lr 8.017e-03 | ms/batch 398.4 | tok/s  123364 | loss  3.60 | ppl     36.62
| epoch   7 step    13140 | batches    534 / 2101 | lr 8.014e-03 | ms/batch 398.1 | tok/s  123469 | loss  3.59 | ppl     36.40
| epoch   7 step    13150 | batches    544 / 2101 | lr 8.011e-03 | ms/batch 398.3 | tok/s  123417 | loss  3.55 | ppl     34.70
| epoch   7 step    13160 | batches    554 / 2101 | lr 8.008e-03 | ms/batch 398.1 | tok/s  123472 | loss  3.54 | ppl     34.61
| epoch   7 step    13170 | batches    564 / 2101 | lr 8.005e-03 | ms/batch 398.8 | tok/s  123263 | loss  3.56 | ppl     35.27
| epoch   7 step    13180 | batches    574 / 2101 | lr 8.002e-03 | ms/batch 398.7 | tok/s  123291 | loss  3.53 | ppl     34.18
| epoch   7 step    13190 | batches    584 / 2101 | lr 7.999e-03 | ms/batch 398.7 | tok/s  123278 | loss  3.55 | ppl     34.96
| epoch   7 step    13200 | batches    594 / 2101 | lr 7.996e-03 | ms/batch 398.6 | tok/s  123310 | loss  3.59 | ppl     36.30
| epoch   7 step    13210 | batches    604 / 2101 | lr 7.993e-03 | ms/batch 398.8 | tok/s  123266 | loss  3.57 | ppl     35.47
| epoch   7 step    13220 | batches    614 / 2101 | lr 7.990e-03 | ms/batch 399.3 | tok/s  123093 | loss  3.53 | ppl     34.26
| epoch   7 step    13230 | batches    624 / 2101 | lr 7.987e-03 | ms/batch 399.3 | tok/s  123111 | loss  3.58 | ppl     35.82
| epoch   7 step    13240 | batches    634 / 2101 | lr 7.984e-03 | ms/batch 398.5 | tok/s  123349 | loss  3.57 | ppl     35.64
| epoch   7 step    13250 | batches    644 / 2101 | lr 7.981e-03 | ms/batch 398.6 | tok/s  123326 | loss  3.54 | ppl     34.53
| epoch   7 step    13260 | batches    654 / 2101 | lr 7.978e-03 | ms/batch 399.1 | tok/s  123147 | loss  3.54 | ppl     34.44
| epoch   7 step    13270 | batches    664 / 2101 | lr 7.975e-03 | ms/batch 399.1 | tok/s  123150 | loss  3.52 | ppl     33.77
| epoch   7 step    13280 | batches    674 / 2101 | lr 7.972e-03 | ms/batch 399.6 | tok/s  123005 | loss  3.55 | ppl     34.86
| epoch   7 step    13290 | batches    684 / 2101 | lr 7.969e-03 | ms/batch 398.6 | tok/s  123321 | loss  3.52 | ppl     33.75
| epoch   7 step    13300 | batches    694 / 2101 | lr 7.966e-03 | ms/batch 398.7 | tok/s  123293 | loss  3.52 | ppl     33.76
| epoch   7 step    13310 | batches    704 / 2101 | lr 7.963e-03 | ms/batch 398.3 | tok/s  123400 | loss  3.48 | ppl     32.37
| epoch   7 step    13320 | batches    714 / 2101 | lr 7.960e-03 | ms/batch 398.7 | tok/s  123288 | loss  3.50 | ppl     33.15
| epoch   7 step    13330 | batches    724 / 2101 | lr 7.957e-03 | ms/batch 398.8 | tok/s  123265 | loss  3.55 | ppl     34.84
| epoch   7 step    13340 | batches    734 / 2101 | lr 7.954e-03 | ms/batch 410.4 | tok/s  119777 | loss  3.53 | ppl     34.09
| epoch   7 step    13350 | batches    744 / 2101 | lr 7.951e-03 | ms/batch 399.4 | tok/s  123067 | loss  3.54 | ppl     34.53
| epoch   7 step    13360 | batches    754 / 2101 | lr 7.948e-03 | ms/batch 399.4 | tok/s  123059 | loss  3.56 | ppl     35.14
| epoch   7 step    13370 | batches    764 / 2101 | lr 7.945e-03 | ms/batch 399.8 | tok/s  122932 | loss  3.53 | ppl     34.00
| epoch   7 step    13380 | batches    774 / 2101 | lr 7.942e-03 | ms/batch 399.4 | tok/s  123061 | loss  3.55 | ppl     34.85
| epoch   7 step    13390 | batches    784 / 2101 | lr 7.939e-03 | ms/batch 400.0 | tok/s  122890 | loss  3.53 | ppl     33.97
| epoch   7 step    13400 | batches    794 / 2101 | lr 7.936e-03 | ms/batch 399.8 | tok/s  122951 | loss  3.54 | ppl     34.62
| epoch   7 step    13410 | batches    804 / 2101 | lr 7.933e-03 | ms/batch 399.8 | tok/s  122936 | loss  3.53 | ppl     34.16
| epoch   7 step    13420 | batches    814 / 2101 | lr 7.930e-03 | ms/batch 398.9 | tok/s  123235 | loss  3.49 | ppl     32.73
| epoch   7 step    13430 | batches    824 / 2101 | lr 7.927e-03 | ms/batch 399.1 | tok/s  123168 | loss  3.55 | ppl     34.81
| epoch   7 step    13440 | batches    834 / 2101 | lr 7.923e-03 | ms/batch 400.1 | tok/s  122863 | loss  3.56 | ppl     35.25
| epoch   7 step    13450 | batches    844 / 2101 | lr 7.920e-03 | ms/batch 399.3 | tok/s  123106 | loss  3.56 | ppl     35.25
| epoch   7 step    13460 | batches    854 / 2101 | lr 7.917e-03 | ms/batch 399.1 | tok/s  123156 | loss  3.57 | ppl     35.49
| epoch   7 step    13470 | batches    864 / 2101 | lr 7.914e-03 | ms/batch 399.7 | tok/s  122960 | loss  3.57 | ppl     35.67
| epoch   7 step    13480 | batches    874 / 2101 | lr 7.911e-03 | ms/batch 399.6 | tok/s  122994 | loss  3.54 | ppl     34.50
| epoch   7 step    13490 | batches    884 / 2101 | lr 7.908e-03 | ms/batch 398.9 | tok/s  123220 | loss  3.55 | ppl     34.85
| epoch   7 step    13500 | batches    894 / 2101 | lr 7.905e-03 | ms/batch 399.2 | tok/s  123127 | loss  3.52 | ppl     33.82
----------------------------------------------------------------------------------------------------
| Eval  27 at step    13500 | time:  0.82s | valid loss  3.41 | valid ppl    30.169
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   7 step    13510 | batches    904 / 2101 | lr 7.902e-03 | ms/batch 398.1 | tok/s  123459 | loss  3.54 | ppl     34.39
| epoch   7 step    13520 | batches    914 / 2101 | lr 7.899e-03 | ms/batch 409.6 | tok/s  119992 | loss  3.55 | ppl     34.76
| epoch   7 step    13530 | batches    924 / 2101 | lr 7.896e-03 | ms/batch 408.2 | tok/s  120423 | loss  3.55 | ppl     34.75
| epoch   7 step    13540 | batches    934 / 2101 | lr 7.893e-03 | ms/batch 398.4 | tok/s  123377 | loss  3.54 | ppl     34.52
| epoch   7 step    13550 | batches    944 / 2101 | lr 7.890e-03 | ms/batch 408.2 | tok/s  120416 | loss  3.49 | ppl     32.82
| epoch   7 step    13560 | batches    954 / 2101 | lr 7.887e-03 | ms/batch 409.6 | tok/s  120014 | loss  3.53 | ppl     33.96
| epoch   7 step    13570 | batches    964 / 2101 | lr 7.884e-03 | ms/batch 408.7 | tok/s  120274 | loss  3.52 | ppl     33.88
| epoch   7 step    13580 | batches    974 / 2101 | lr 7.881e-03 | ms/batch 398.7 | tok/s  123283 | loss  3.54 | ppl     34.34
| epoch   7 step    13590 | batches    984 / 2101 | lr 7.877e-03 | ms/batch 399.8 | tok/s  122943 | loss  3.53 | ppl     34.09
| epoch   7 step    13600 | batches    994 / 2101 | lr 7.874e-03 | ms/batch 409.9 | tok/s  119910 | loss  3.53 | ppl     34.12
| epoch   7 step    13610 | batches   1004 / 2101 | lr 7.871e-03 | ms/batch 409.8 | tok/s  119930 | loss  3.55 | ppl     34.95
| epoch   7 step    13620 | batches   1014 / 2101 | lr 7.868e-03 | ms/batch 399.0 | tok/s  123192 | loss  3.54 | ppl     34.59
| epoch   7 step    13630 | batches   1024 / 2101 | lr 7.865e-03 | ms/batch 409.9 | tok/s  119925 | loss  3.52 | ppl     33.82
| epoch   7 step    13640 | batches   1034 / 2101 | lr 7.862e-03 | ms/batch 410.1 | tok/s  119863 | loss  3.56 | ppl     35.07
| epoch   7 step    13650 | batches   1044 / 2101 | lr 7.859e-03 | ms/batch 409.3 | tok/s  120088 | loss  3.58 | ppl     35.70
| epoch   7 step    13660 | batches   1054 / 2101 | lr 7.856e-03 | ms/batch 399.3 | tok/s  123112 | loss  3.57 | ppl     35.60
| epoch   7 step    13670 | batches   1064 / 2101 | lr 7.853e-03 | ms/batch 399.5 | tok/s  123027 | loss  3.56 | ppl     35.14
| epoch   7 step    13680 | batches   1074 / 2101 | lr 7.850e-03 | ms/batch 399.4 | tok/s  123055 | loss  3.57 | ppl     35.46
| epoch   7 step    13690 | batches   1084 / 2101 | lr 7.847e-03 | ms/batch 398.9 | tok/s  123207 | loss  3.58 | ppl     35.86
| epoch   7 step    13700 | batches   1094 / 2101 | lr 7.844e-03 | ms/batch 399.8 | tok/s  122951 | loss  3.56 | ppl     35.33
| epoch   7 step    13710 | batches   1104 / 2101 | lr 7.840e-03 | ms/batch 400.0 | tok/s  122895 | loss  3.54 | ppl     34.44
| epoch   7 step    13720 | batches   1114 / 2101 | lr 7.837e-03 | ms/batch 399.4 | tok/s  123063 | loss  3.54 | ppl     34.38
| epoch   7 step    13730 | batches   1124 / 2101 | lr 7.834e-03 | ms/batch 399.3 | tok/s  123095 | loss  3.58 | ppl     35.72
| epoch   7 step    13740 | batches   1134 / 2101 | lr 7.831e-03 | ms/batch 399.4 | tok/s  123058 | loss  3.58 | ppl     35.97
| epoch   7 step    13750 | batches   1144 / 2101 | lr 7.828e-03 | ms/batch 398.7 | tok/s  123293 | loss  3.56 | ppl     35.01
| epoch   7 step    13760 | batches   1154 / 2101 | lr 7.825e-03 | ms/batch 398.5 | tok/s  123332 | loss  3.53 | ppl     34.17
| epoch   7 step    13770 | batches   1164 / 2101 | lr 7.822e-03 | ms/batch 399.7 | tok/s  122969 | loss  3.53 | ppl     34.26
| epoch   7 step    13780 | batches   1174 / 2101 | lr 7.819e-03 | ms/batch 399.2 | tok/s  123115 | loss  3.54 | ppl     34.43
| epoch   7 step    13790 | batches   1184 / 2101 | lr 7.816e-03 | ms/batch 399.6 | tok/s  123010 | loss  3.57 | ppl     35.37
| epoch   7 step    13800 | batches   1194 / 2101 | lr 7.812e-03 | ms/batch 399.5 | tok/s  123032 | loss  3.52 | ppl     33.94
| epoch   7 step    13810 | batches   1204 / 2101 | lr 7.809e-03 | ms/batch 399.9 | tok/s  122898 | loss  3.54 | ppl     34.34
| epoch   7 step    13820 | batches   1214 / 2101 | lr 7.806e-03 | ms/batch 398.7 | tok/s  123283 | loss  3.49 | ppl     32.92
| epoch   7 step    13830 | batches   1224 / 2101 | lr 7.803e-03 | ms/batch 399.0 | tok/s  123201 | loss  3.54 | ppl     34.47
| epoch   7 step    13840 | batches   1234 / 2101 | lr 7.800e-03 | ms/batch 398.9 | tok/s  123213 | loss  3.55 | ppl     34.97
| epoch   7 step    13850 | batches   1244 / 2101 | lr 7.797e-03 | ms/batch 398.8 | tok/s  123242 | loss  3.53 | ppl     34.27
| epoch   7 step    13860 | batches   1254 / 2101 | lr 7.794e-03 | ms/batch 399.6 | tok/s  123015 | loss  3.53 | ppl     33.95
| epoch   7 step    13870 | batches   1264 / 2101 | lr 7.791e-03 | ms/batch 399.0 | tok/s  123189 | loss  3.51 | ppl     33.47
| epoch   7 step    13880 | batches   1274 / 2101 | lr 7.788e-03 | ms/batch 399.0 | tok/s  123194 | loss  3.55 | ppl     34.78
| epoch   7 step    13890 | batches   1284 / 2101 | lr 7.784e-03 | ms/batch 398.7 | tok/s  123266 | loss  3.53 | ppl     33.97
| epoch   7 step    13900 | batches   1294 / 2101 | lr 7.781e-03 | ms/batch 398.6 | tok/s  123300 | loss  3.51 | ppl     33.59
| epoch   7 step    13910 | batches   1304 / 2101 | lr 7.778e-03 | ms/batch 399.7 | tok/s  122973 | loss  3.55 | ppl     34.65
| epoch   7 step    13920 | batches   1314 / 2101 | lr 7.775e-03 | ms/batch 399.4 | tok/s  123053 | loss  3.53 | ppl     34.15
| epoch   7 step    13930 | batches   1324 / 2101 | lr 7.772e-03 | ms/batch 399.3 | tok/s  123082 | loss  3.53 | ppl     34.28
| epoch   7 step    13940 | batches   1334 / 2101 | lr 7.769e-03 | ms/batch 400.2 | tok/s  122813 | loss  3.56 | ppl     35.04
| epoch   7 step    13950 | batches   1344 / 2101 | lr 7.766e-03 | ms/batch 399.9 | tok/s  122920 | loss  3.54 | ppl     34.53
| epoch   7 step    13960 | batches   1354 / 2101 | lr 7.763e-03 | ms/batch 399.2 | tok/s  123137 | loss  3.57 | ppl     35.54
| epoch   7 step    13970 | batches   1364 / 2101 | lr 7.759e-03 | ms/batch 399.9 | tok/s  122912 | loss  3.58 | ppl     35.72
| epoch   7 step    13980 | batches   1374 / 2101 | lr 7.756e-03 | ms/batch 399.8 | tok/s  122933 | loss  3.57 | ppl     35.69
| epoch   7 step    13990 | batches   1384 / 2101 | lr 7.753e-03 | ms/batch 410.0 | tok/s  119881 | loss  3.58 | ppl     35.73
| epoch   7 step    14000 | batches   1394 / 2101 | lr 7.750e-03 | ms/batch 423.2 | tok/s  116158 | loss  3.54 | ppl     34.49
----------------------------------------------------------------------------------------------------
| Eval  28 at step    14000 | time:  0.82s | valid loss  3.39 | valid ppl    29.742
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.07511506314879103, 0.07301022642137728, 0.07861095104138041, 0.0673363912693181, 0.06887283415209171, 0.07449254142923156, 0.07345570890313431, 0.09345144655954817, 0.07967083545964829, 0.06596665807343595, 0.0776447229351768, 0.07273567029712955, 0.0670090496600336, 0.08432557901372653, 0.07313729210266688, 0.0752662597604468, 0.07649986690020126, 0.07065441215848361, 0.0755552993087136, 0.07194018205625548, 0.07654617792193669, 0.07229051718852231, 0.0593461911903218, 0.0751926942597407, 0.0710906171167604, 0.07676818852816679, 0.07612969362254474, 0.07041877153600531, 0.07745751971281115, 0.07340091332035215, 0.07506913724793678, 0.069597024051846, 0.10224875708599901, 0.06569935281145048, 0.06659704955591765, 0.06862994353454319, 0.06749361109054473, 0.06109797292195484, 0.06854068934273959, 0.07069350891165907, 0.08600019159300631, 0.06910930999882578, 0.05862753925477922, 0.07338985548078641, 0.06573012588208356, 0.07738517916713808, 0.06818991066330603, 0.057486881693598814, 0.06153957509765523, 0.0677468364580226, 0.06438906497140977, 0.06712100863454713, 0.06920458274696947, 0.05630761530354787, 0.059630124979554534, 0.07171976075793349, 0.06315674170304938, 0.09806522311380327, 0.06547188987990148, 0.06050116826650341, 0.0507487040361334, 0.036745139020461774, 0.02099341336843507, 0.04536826853211865, 0.05493012254885971, 0.054540745113507365, 0.04979355389001651, 0.027365975369464928, 0.04918943434939924, 0.056144808688571274, 0.06408749759522354, 0.06182415835016388, 0.07428112609395626, 0.04557514313185927, 0.05220177508378471, 0.05824787269226921, 0.05428007071610974, 0.04297780392393255, 0.0440645444744066, 0.05266521864730599, 0.07580826478761656]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [49, 60, 9, 17, 10, 49, 73, 9, 28, 12], [48, 43, 16, 8, 9, 44, 63, 8, 9, 8], [33, 47, 9, 8, 8, 40, 42, 8, 8, 8], [31, 53, 8, 8, 8, 21, 19, 10, 8, 8], [10, 18, 8, 8, 8, 21, 24, 9, 8, 8], [9, 16, 9, 8, 8, 11, 18, 8, 8, 8], [8, 8, 9, 8, 8, 8, 8, 8, 8, 8], [9, 15, 9, 8, 8, 10, 10, 8, 8, 8], [8]]
optimal compression parameters =  [[], [49, 60, 9, 17, 10, 49, 73, 9, 28, 12], [48, 43, 16, 8, 9, 44, 63, 8, 9, 8], [33, 47, 9, 8, 8, 40, 42, 8, 8, 8], [31, 53, 8, 8, 8, 21, 19, 10, 8, 8], [10, 18, 8, 8, 8, 21, 24, 9, 8, 8], [9, 16, 9, 8, 8, 11, 18, 8, 8, 8], [8, 8, 9, 8, 8, 8, 8, 8, 8, 8], [9, 15, 9, 8, 8, 10, 10, 8, 8, 8], [8]]
| epoch   7 step    14010 | batches   1404 / 2101 | lr 7.747e-03 | ms/batch 4882.5 | tok/s   10067 | loss  3.56 | ppl     35.21
| epoch   7 step    14020 | batches   1414 / 2101 | lr 7.744e-03 | ms/batch 409.0 | tok/s  120180 | loss  3.56 | ppl     35.06
| epoch   7 step    14030 | batches   1424 / 2101 | lr 7.741e-03 | ms/batch 408.3 | tok/s  120376 | loss  3.56 | ppl     35.09
| epoch   7 step    14040 | batches   1434 / 2101 | lr 7.737e-03 | ms/batch 397.7 | tok/s  123588 | loss  3.56 | ppl     35.22
| epoch   7 step    14050 | batches   1444 / 2101 | lr 7.734e-03 | ms/batch 397.3 | tok/s  123726 | loss  3.55 | ppl     34.78
| epoch   7 step    14060 | batches   1454 / 2101 | lr 7.731e-03 | ms/batch 397.6 | tok/s  123630 | loss  3.54 | ppl     34.63
| epoch   7 step    14070 | batches   1464 / 2101 | lr 7.728e-03 | ms/batch 397.6 | tok/s  123626 | loss  3.52 | ppl     33.76
| epoch   7 step    14080 | batches   1474 / 2101 | lr 7.725e-03 | ms/batch 398.1 | tok/s  123465 | loss  3.53 | ppl     33.95
| epoch   7 step    14090 | batches   1484 / 2101 | lr 7.722e-03 | ms/batch 398.4 | tok/s  123386 | loss  3.50 | ppl     33.19
| epoch   7 step    14100 | batches   1494 / 2101 | lr 7.719e-03 | ms/batch 398.1 | tok/s  123458 | loss  3.51 | ppl     33.52
| epoch   7 step    14110 | batches   1504 / 2101 | lr 7.715e-03 | ms/batch 398.4 | tok/s  123361 | loss  3.51 | ppl     33.45
| epoch   7 step    14120 | batches   1514 / 2101 | lr 7.712e-03 | ms/batch 398.1 | tok/s  123481 | loss  3.53 | ppl     34.24
| epoch   7 step    14130 | batches   1524 / 2101 | lr 7.709e-03 | ms/batch 410.2 | tok/s  119839 | loss  3.53 | ppl     34.22
| epoch   7 step    14140 | batches   1534 / 2101 | lr 7.706e-03 | ms/batch 399.9 | tok/s  122905 | loss  3.54 | ppl     34.37
| epoch   7 step    14150 | batches   1544 / 2101 | lr 7.703e-03 | ms/batch 399.4 | tok/s  123059 | loss  3.54 | ppl     34.32
| epoch   7 step    14160 | batches   1554 / 2101 | lr 7.700e-03 | ms/batch 399.7 | tok/s  122966 | loss  3.54 | ppl     34.59
| epoch   7 step    14170 | batches   1564 / 2101 | lr 7.696e-03 | ms/batch 399.3 | tok/s  123101 | loss  3.51 | ppl     33.42
| epoch   7 step    14180 | batches   1574 / 2101 | lr 7.693e-03 | ms/batch 398.7 | tok/s  123268 | loss  3.54 | ppl     34.39
| epoch   7 step    14190 | batches   1584 / 2101 | lr 7.690e-03 | ms/batch 398.9 | tok/s  123228 | loss  3.52 | ppl     33.69
| epoch   7 step    14200 | batches   1594 / 2101 | lr 7.687e-03 | ms/batch 400.1 | tok/s  122854 | loss  3.53 | ppl     34.23
| epoch   7 step    14210 | batches   1604 / 2101 | lr 7.684e-03 | ms/batch 399.7 | tok/s  122972 | loss  3.49 | ppl     32.89
| epoch   7 step    14220 | batches   1614 / 2101 | lr 7.681e-03 | ms/batch 399.8 | tok/s  122939 | loss  3.51 | ppl     33.52
| epoch   7 step    14230 | batches   1624 / 2101 | lr 7.677e-03 | ms/batch 400.0 | tok/s  122872 | loss  3.52 | ppl     33.91
| epoch   7 step    14240 | batches   1634 / 2101 | lr 7.674e-03 | ms/batch 399.6 | tok/s  123000 | loss  3.54 | ppl     34.50
| epoch   7 step    14250 | batches   1644 / 2101 | lr 7.671e-03 | ms/batch 399.2 | tok/s  123129 | loss  3.51 | ppl     33.59
| epoch   7 step    14260 | batches   1654 / 2101 | lr 7.668e-03 | ms/batch 399.6 | tok/s  123010 | loss  3.55 | ppl     34.77
| epoch   7 step    14270 | batches   1664 / 2101 | lr 7.665e-03 | ms/batch 400.4 | tok/s  122747 | loss  3.50 | ppl     33.14
| epoch   7 step    14280 | batches   1674 / 2101 | lr 7.662e-03 | ms/batch 399.5 | tok/s  123040 | loss  3.50 | ppl     32.98
| epoch   7 step    14290 | batches   1684 / 2101 | lr 7.658e-03 | ms/batch 399.4 | tok/s  123058 | loss  3.50 | ppl     33.05
| epoch   7 step    14300 | batches   1694 / 2101 | lr 7.655e-03 | ms/batch 399.6 | tok/s  123019 | loss  3.51 | ppl     33.39
| epoch   7 step    14310 | batches   1704 / 2101 | lr 7.652e-03 | ms/batch 399.7 | tok/s  122964 | loss  3.56 | ppl     35.27
| epoch   7 step    14320 | batches   1714 / 2101 | lr 7.649e-03 | ms/batch 399.5 | tok/s  123047 | loss  3.53 | ppl     34.15
| epoch   7 step    14330 | batches   1724 / 2101 | lr 7.646e-03 | ms/batch 400.0 | tok/s  122895 | loss  3.54 | ppl     34.33
| epoch   7 step    14340 | batches   1734 / 2101 | lr 7.642e-03 | ms/batch 399.4 | tok/s  123071 | loss  3.58 | ppl     35.85
| epoch   7 step    14350 | batches   1744 / 2101 | lr 7.639e-03 | ms/batch 399.6 | tok/s  123006 | loss  3.54 | ppl     34.60
| epoch   7 step    14360 | batches   1754 / 2101 | lr 7.636e-03 | ms/batch 399.6 | tok/s  123000 | loss  3.58 | ppl     35.70
| epoch   7 step    14370 | batches   1764 / 2101 | lr 7.633e-03 | ms/batch 399.8 | tok/s  122929 | loss  3.56 | ppl     35.22
| epoch   7 step    14380 | batches   1774 / 2101 | lr 7.630e-03 | ms/batch 400.0 | tok/s  122866 | loss  3.57 | ppl     35.44
| epoch   7 step    14390 | batches   1784 / 2101 | lr 7.626e-03 | ms/batch 399.9 | tok/s  122919 | loss  3.54 | ppl     34.50
| epoch   7 step    14400 | batches   1794 / 2101 | lr 7.623e-03 | ms/batch 399.9 | tok/s  122923 | loss  3.55 | ppl     34.77
| epoch   7 step    14410 | batches   1804 / 2101 | lr 7.620e-03 | ms/batch 399.3 | tok/s  123087 | loss  3.54 | ppl     34.57
| epoch   7 step    14420 | batches   1814 / 2101 | lr 7.617e-03 | ms/batch 399.6 | tok/s  123011 | loss  3.54 | ppl     34.47
| epoch   7 step    14430 | batches   1824 / 2101 | lr 7.614e-03 | ms/batch 399.6 | tok/s  123013 | loss  3.52 | ppl     33.64
| epoch   7 step    14440 | batches   1834 / 2101 | lr 7.610e-03 | ms/batch 399.7 | tok/s  122980 | loss  3.54 | ppl     34.46
| epoch   7 step    14450 | batches   1844 / 2101 | lr 7.607e-03 | ms/batch 410.5 | tok/s  119743 | loss  3.53 | ppl     34.15
| epoch   7 step    14460 | batches   1854 / 2101 | lr 7.604e-03 | ms/batch 400.7 | tok/s  122661 | loss  3.58 | ppl     35.81
| epoch   7 step    14470 | batches   1864 / 2101 | lr 7.601e-03 | ms/batch 400.0 | tok/s  122874 | loss  3.54 | ppl     34.61
| epoch   7 step    14480 | batches   1874 / 2101 | lr 7.598e-03 | ms/batch 399.7 | tok/s  122969 | loss  3.52 | ppl     33.78
| epoch   7 step    14490 | batches   1884 / 2101 | lr 7.594e-03 | ms/batch 400.0 | tok/s  122877 | loss  3.53 | ppl     34.07
| epoch   7 step    14500 | batches   1894 / 2101 | lr 7.591e-03 | ms/batch 399.5 | tok/s  123028 | loss  3.50 | ppl     33.27
----------------------------------------------------------------------------------------------------
| Eval  29 at step    14500 | time:  0.82s | valid loss  3.38 | valid ppl    29.319
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   7 step    14510 | batches   1904 / 2101 | lr 7.588e-03 | ms/batch 398.5 | tok/s  123336 | loss  3.54 | ppl     34.39
| epoch   7 step    14520 | batches   1914 / 2101 | lr 7.585e-03 | ms/batch 410.1 | tok/s  119865 | loss  3.53 | ppl     34.27
| epoch   7 step    14530 | batches   1924 / 2101 | lr 7.582e-03 | ms/batch 399.2 | tok/s  123122 | loss  3.52 | ppl     33.71
| epoch   7 step    14540 | batches   1934 / 2101 | lr 7.578e-03 | ms/batch 399.8 | tok/s  122935 | loss  3.49 | ppl     32.78
| epoch   7 step    14550 | batches   1944 / 2101 | lr 7.575e-03 | ms/batch 399.6 | tok/s  123001 | loss  3.51 | ppl     33.33
| epoch   7 step    14560 | batches   1954 / 2101 | lr 7.572e-03 | ms/batch 399.7 | tok/s  122980 | loss  3.51 | ppl     33.51
| epoch   7 step    14570 | batches   1964 / 2101 | lr 7.569e-03 | ms/batch 411.4 | tok/s  119469 | loss  3.55 | ppl     34.84
| epoch   7 step    14580 | batches   1974 / 2101 | lr 7.566e-03 | ms/batch 399.5 | tok/s  123045 | loss  3.57 | ppl     35.60
| epoch   7 step    14590 | batches   1984 / 2101 | lr 7.562e-03 | ms/batch 399.9 | tok/s  122911 | loss  3.58 | ppl     35.97
| epoch   7 step    14600 | batches   1994 / 2101 | lr 7.559e-03 | ms/batch 400.3 | tok/s  122796 | loss  3.56 | ppl     35.10
| epoch   7 step    14610 | batches   2004 / 2101 | lr 7.556e-03 | ms/batch 399.7 | tok/s  122977 | loss  3.56 | ppl     35.23
| epoch   7 step    14620 | batches   2014 / 2101 | lr 7.553e-03 | ms/batch 399.7 | tok/s  122977 | loss  3.51 | ppl     33.38
| epoch   7 step    14630 | batches   2024 / 2101 | lr 7.549e-03 | ms/batch 399.1 | tok/s  123163 | loss  3.51 | ppl     33.31
| epoch   7 step    14640 | batches   2034 / 2101 | lr 7.546e-03 | ms/batch 400.0 | tok/s  122877 | loss  3.53 | ppl     34.22
| epoch   7 step    14650 | batches   2044 / 2101 | lr 7.543e-03 | ms/batch 399.8 | tok/s  122953 | loss  3.57 | ppl     35.37
| epoch   7 step    14660 | batches   2054 / 2101 | lr 7.540e-03 | ms/batch 400.0 | tok/s  122870 | loss  3.56 | ppl     35.18
| epoch   7 step    14670 | batches   2064 / 2101 | lr 7.536e-03 | ms/batch 399.8 | tok/s  122945 | loss  3.55 | ppl     34.85
| epoch   7 step    14680 | batches   2074 / 2101 | lr 7.533e-03 | ms/batch 400.0 | tok/s  122892 | loss  3.53 | ppl     34.28
| epoch   7 step    14690 | batches   2084 / 2101 | lr 7.530e-03 | ms/batch 400.0 | tok/s  122892 | loss  3.54 | ppl     34.43
| epoch   7 step    14700 | batches   2094 / 2101 | lr 7.527e-03 | ms/batch 400.2 | tok/s  122815 | loss  3.55 | ppl     34.66
| epoch   8 step    14710 | batches      3 / 2101 | lr 7.524e-03 | ms/batch 426.7 | tok/s  117447 | loss  3.70 | ppl     40.25
| epoch   8 step    14720 | batches     13 / 2101 | lr 7.520e-03 | ms/batch 400.3 | tok/s  122784 | loss  3.52 | ppl     33.74
| epoch   8 step    14730 | batches     23 / 2101 | lr 7.517e-03 | ms/batch 399.6 | tok/s  123014 | loss  3.46 | ppl     31.93
| epoch   8 step    14740 | batches     33 / 2101 | lr 7.514e-03 | ms/batch 399.8 | tok/s  122946 | loss  3.46 | ppl     31.85
| epoch   8 step    14750 | batches     43 / 2101 | lr 7.511e-03 | ms/batch 399.5 | tok/s  123021 | loss  3.48 | ppl     32.43
| epoch   8 step    14760 | batches     53 / 2101 | lr 7.507e-03 | ms/batch 399.6 | tok/s  122993 | loss  3.50 | ppl     33.08
| epoch   8 step    14770 | batches     63 / 2101 | lr 7.504e-03 | ms/batch 400.1 | tok/s  122850 | loss  3.48 | ppl     32.53
| epoch   8 step    14780 | batches     73 / 2101 | lr 7.501e-03 | ms/batch 399.7 | tok/s  122970 | loss  3.51 | ppl     33.41
| epoch   8 step    14790 | batches     83 / 2101 | lr 7.498e-03 | ms/batch 400.8 | tok/s  122643 | loss  3.47 | ppl     32.09
| epoch   8 step    14800 | batches     93 / 2101 | lr 7.494e-03 | ms/batch 399.9 | tok/s  122910 | loss  3.48 | ppl     32.32
| epoch   8 step    14810 | batches    103 / 2101 | lr 7.491e-03 | ms/batch 399.8 | tok/s  122949 | loss  3.47 | ppl     32.16
| epoch   8 step    14820 | batches    113 / 2101 | lr 7.488e-03 | ms/batch 399.7 | tok/s  122972 | loss  3.50 | ppl     33.23
| epoch   8 step    14830 | batches    123 / 2101 | lr 7.485e-03 | ms/batch 399.3 | tok/s  123089 | loss  3.50 | ppl     33.16
| epoch   8 step    14840 | batches    133 / 2101 | lr 7.481e-03 | ms/batch 399.4 | tok/s  123076 | loss  3.50 | ppl     33.16
| epoch   8 step    14850 | batches    143 / 2101 | lr 7.478e-03 | ms/batch 399.6 | tok/s  123017 | loss  3.49 | ppl     32.78
| epoch   8 step    14860 | batches    153 / 2101 | lr 7.475e-03 | ms/batch 399.1 | tok/s  123172 | loss  3.47 | ppl     32.09
| epoch   8 step    14870 | batches    163 / 2101 | lr 7.472e-03 | ms/batch 399.3 | tok/s  123081 | loss  3.44 | ppl     31.34
| epoch   8 step    14880 | batches    173 / 2101 | lr 7.468e-03 | ms/batch 399.3 | tok/s  123087 | loss  3.41 | ppl     30.38
| epoch   8 step    14890 | batches    183 / 2101 | lr 7.465e-03 | ms/batch 410.6 | tok/s  119706 | loss  3.47 | ppl     32.07
| epoch   8 step    14900 | batches    193 / 2101 | lr 7.462e-03 | ms/batch 399.7 | tok/s  122969 | loss  3.44 | ppl     31.23
| epoch   8 step    14910 | batches    203 / 2101 | lr 7.459e-03 | ms/batch 410.4 | tok/s  119767 | loss  3.43 | ppl     30.82
| epoch   8 step    14920 | batches    213 / 2101 | lr 7.455e-03 | ms/batch 399.9 | tok/s  122920 | loss  3.44 | ppl     31.18
| epoch   8 step    14930 | batches    223 / 2101 | lr 7.452e-03 | ms/batch 400.1 | tok/s  122865 | loss  3.48 | ppl     32.49
| epoch   8 step    14940 | batches    233 / 2101 | lr 7.449e-03 | ms/batch 400.1 | tok/s  122863 | loss  3.47 | ppl     32.17
| epoch   8 step    14950 | batches    243 / 2101 | lr 7.445e-03 | ms/batch 399.9 | tok/s  122911 | loss  3.47 | ppl     32.01
| epoch   8 step    14960 | batches    253 / 2101 | lr 7.442e-03 | ms/batch 399.9 | tok/s  122926 | loss  3.45 | ppl     31.47
| epoch   8 step    14970 | batches    263 / 2101 | lr 7.439e-03 | ms/batch 400.5 | tok/s  122742 | loss  3.48 | ppl     32.34
| epoch   8 step    14980 | batches    273 / 2101 | lr 7.436e-03 | ms/batch 400.5 | tok/s  122727 | loss  3.49 | ppl     32.72
| epoch   8 step    14990 | batches    283 / 2101 | lr 7.432e-03 | ms/batch 400.9 | tok/s  122606 | loss  3.48 | ppl     32.47
| epoch   8 step    15000 | batches    293 / 2101 | lr 7.429e-03 | ms/batch 414.9 | tok/s  118467 | loss  3.49 | ppl     32.85
----------------------------------------------------------------------------------------------------
| Eval  30 at step    15000 | time:  0.82s | valid loss  3.37 | valid ppl    29.071
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.06299595470597175, 0.06816603885145153, 0.07193992777743259, 0.05920343174862929, 0.062398054702337204, 0.06742514382638304, 0.06764516014963581, 0.07136029963561433, 0.0577116263896298, 0.06006271902323305, 0.060772936195314396, 0.06542559294150833, 0.059307009249020555, 0.07968515235340261, 0.06251331053654702, 0.06545653435009054, 0.06945455691119451, 0.07819960944999965, 0.06831113667898392, 0.06246138017197031, 0.05961755924146527, 0.06240623571618053, 0.06377822165683275, 0.06026368540638477, 0.06085114882313486, 0.06580908957826145, 0.06655694258847342, 0.07198016712545598, 0.06692561717355894, 0.06289719720373169, 0.06630962149195549, 0.06346182651182797, 0.07166803148262547, 0.060599263483028014, 0.05918106344435737, 0.05851741726589495, 0.061673792665724494, 0.05501630793545975, 0.05873670660125498, 0.060544939938586034, 0.06058216739176237, 0.06019920463859996, 0.05034033769814401, 0.06465168979323689, 0.05749148124128089, 0.06374971174451778, 0.060607498038219715, 0.05927978637609385, 0.054445040556637486, 0.059557483026015774, 0.05217767149029286, 0.05597764791862784, 0.05072732644625728, 0.05077036520117731, 0.05267992974188915, 0.06351430544955518, 0.06076786603633237, 0.03703735377883161, 0.05291999046819123, 0.054644824842838835, 0.03508782597578354, 0.0306841243784288, 0.014474134641951653, 0.03925644972895864, 0.04885626642158921, 0.05166174374086776, 0.04566503172005076, 0.039020047912939074, 0.04216031464345435, 0.05036353704829853, 0.058516413212987284, 0.05740523497715626, 0.03535996709886617, 0.04081464164979273, 0.04658217083433048, 0.049192739128482, 0.04820898446193324, 0.04296396877869736, 0.0403379199234981, 0.04771073387926914, 0.06756956453134301]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [51, 64, 9, 14, 11, 48, 78, 8, 21, 14], [45, 42, 19, 9, 9, 41, 59, 8, 9, 8], [32, 44, 9, 9, 8, 37, 46, 10, 8, 8], [33, 55, 8, 8, 8, 20, 17, 10, 8, 8], [12, 18, 8, 8, 8, 20, 30, 9, 8, 8], [9, 18, 8, 8, 8, 11, 18, 8, 8, 8], [8, 9, 8, 8, 8, 11, 8, 8, 8, 8], [8, 15, 9, 8, 8, 9, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [51, 64, 9, 14, 11, 48, 78, 8, 21, 14], [45, 42, 19, 9, 9, 41, 59, 8, 9, 8], [32, 44, 9, 9, 8, 37, 46, 10, 8, 8], [33, 55, 8, 8, 8, 20, 17, 10, 8, 8], [12, 18, 8, 8, 8, 20, 30, 9, 8, 8], [9, 18, 8, 8, 8, 11, 18, 8, 8, 8], [8, 9, 8, 8, 8, 11, 8, 8, 8, 8], [8, 15, 9, 8, 8, 9, 9, 8, 8, 8], [8]]
| epoch   8 step    15010 | batches    303 / 2101 | lr 7.426e-03 | ms/batch 4887.2 | tok/s   10057 | loss  3.44 | ppl     31.30
| epoch   8 step    15020 | batches    313 / 2101 | lr 7.423e-03 | ms/batch 409.4 | tok/s  120074 | loss  3.46 | ppl     31.83
| epoch   8 step    15030 | batches    323 / 2101 | lr 7.419e-03 | ms/batch 398.2 | tok/s  123441 | loss  3.41 | ppl     30.17
| epoch   8 step    15040 | batches    333 / 2101 | lr 7.416e-03 | ms/batch 398.2 | tok/s  123424 | loss  3.44 | ppl     31.14
| epoch   8 step    15050 | batches    343 / 2101 | lr 7.413e-03 | ms/batch 397.8 | tok/s  123551 | loss  3.46 | ppl     31.89
| epoch   8 step    15060 | batches    353 / 2101 | lr 7.409e-03 | ms/batch 398.3 | tok/s  123418 | loss  3.46 | ppl     31.67
| epoch   8 step    15070 | batches    363 / 2101 | lr 7.406e-03 | ms/batch 398.7 | tok/s  123280 | loss  3.45 | ppl     31.52
| epoch   8 step    15080 | batches    373 / 2101 | lr 7.403e-03 | ms/batch 398.6 | tok/s  123306 | loss  3.44 | ppl     31.30
| epoch   8 step    15090 | batches    383 / 2101 | lr 7.400e-03 | ms/batch 408.2 | tok/s  120401 | loss  3.44 | ppl     31.19
| epoch   8 step    15100 | batches    393 / 2101 | lr 7.396e-03 | ms/batch 398.6 | tok/s  123306 | loss  3.44 | ppl     31.14
| epoch   8 step    15110 | batches    403 / 2101 | lr 7.393e-03 | ms/batch 409.7 | tok/s  119971 | loss  3.46 | ppl     31.91
| epoch   8 step    15120 | batches    413 / 2101 | lr 7.390e-03 | ms/batch 411.1 | tok/s  119572 | loss  3.46 | ppl     31.82
| epoch   8 step    15130 | batches    423 / 2101 | lr 7.386e-03 | ms/batch 399.5 | tok/s  123035 | loss  3.47 | ppl     32.13
| epoch   8 step    15140 | batches    433 / 2101 | lr 7.383e-03 | ms/batch 399.8 | tok/s  122929 | loss  3.48 | ppl     32.32
| epoch   8 step    15150 | batches    443 / 2101 | lr 7.380e-03 | ms/batch 399.4 | tok/s  123063 | loss  3.47 | ppl     32.28
| epoch   8 step    15160 | batches    453 / 2101 | lr 7.377e-03 | ms/batch 399.6 | tok/s  122995 | loss  3.43 | ppl     30.93
| epoch   8 step    15170 | batches    463 / 2101 | lr 7.373e-03 | ms/batch 400.2 | tok/s  122832 | loss  3.48 | ppl     32.41
| epoch   8 step    15180 | batches    473 / 2101 | lr 7.370e-03 | ms/batch 400.6 | tok/s  122692 | loss  3.49 | ppl     32.67
| epoch   8 step    15190 | batches    483 / 2101 | lr 7.367e-03 | ms/batch 399.6 | tok/s  123000 | loss  3.46 | ppl     31.74
| epoch   8 step    15200 | batches    493 / 2101 | lr 7.363e-03 | ms/batch 399.9 | tok/s  122921 | loss  3.46 | ppl     31.84
| epoch   8 step    15210 | batches    503 / 2101 | lr 7.360e-03 | ms/batch 400.1 | tok/s  122844 | loss  3.49 | ppl     32.85
| epoch   8 step    15220 | batches    513 / 2101 | lr 7.357e-03 | ms/batch 399.9 | tok/s  122925 | loss  3.49 | ppl     32.70
| epoch   8 step    15230 | batches    523 / 2101 | lr 7.353e-03 | ms/batch 399.8 | tok/s  122954 | loss  3.50 | ppl     33.21
| epoch   8 step    15240 | batches    533 / 2101 | lr 7.350e-03 | ms/batch 399.8 | tok/s  122941 | loss  3.49 | ppl     32.94
| epoch   8 step    15250 | batches    543 / 2101 | lr 7.347e-03 | ms/batch 399.9 | tok/s  122918 | loss  3.45 | ppl     31.36
| epoch   8 step    15260 | batches    553 / 2101 | lr 7.344e-03 | ms/batch 399.8 | tok/s  122940 | loss  3.43 | ppl     30.80
| epoch   8 step    15270 | batches    563 / 2101 | lr 7.340e-03 | ms/batch 400.0 | tok/s  122867 | loss  3.42 | ppl     30.69
| epoch   8 step    15280 | batches    573 / 2101 | lr 7.337e-03 | ms/batch 400.0 | tok/s  122881 | loss  3.46 | ppl     31.94
| epoch   8 step    15290 | batches    583 / 2101 | lr 7.334e-03 | ms/batch 400.0 | tok/s  122870 | loss  3.48 | ppl     32.35
| epoch   8 step    15300 | batches    593 / 2101 | lr 7.330e-03 | ms/batch 399.4 | tok/s  123066 | loss  3.44 | ppl     31.26
| epoch   8 step    15310 | batches    603 / 2101 | lr 7.327e-03 | ms/batch 399.8 | tok/s  122939 | loss  3.50 | ppl     33.13
| epoch   8 step    15320 | batches    613 / 2101 | lr 7.324e-03 | ms/batch 399.8 | tok/s  122930 | loss  3.46 | ppl     31.86
| epoch   8 step    15330 | batches    623 / 2101 | lr 7.320e-03 | ms/batch 400.0 | tok/s  122884 | loss  3.49 | ppl     32.66
| epoch   8 step    15340 | batches    633 / 2101 | lr 7.317e-03 | ms/batch 400.0 | tok/s  122879 | loss  3.51 | ppl     33.32
| epoch   8 step    15350 | batches    643 / 2101 | lr 7.314e-03 | ms/batch 400.4 | tok/s  122763 | loss  3.51 | ppl     33.29
| epoch   8 step    15360 | batches    653 / 2101 | lr 7.310e-03 | ms/batch 400.6 | tok/s  122707 | loss  3.51 | ppl     33.55
| epoch   8 step    15370 | batches    663 / 2101 | lr 7.307e-03 | ms/batch 399.9 | tok/s  122923 | loss  3.48 | ppl     32.62
| epoch   8 step    15380 | batches    673 / 2101 | lr 7.304e-03 | ms/batch 399.9 | tok/s  122898 | loss  3.45 | ppl     31.35
| epoch   8 step    15390 | batches    683 / 2101 | lr 7.300e-03 | ms/batch 400.5 | tok/s  122721 | loss  3.50 | ppl     33.11
| epoch   8 step    15400 | batches    693 / 2101 | lr 7.297e-03 | ms/batch 400.0 | tok/s  122871 | loss  3.50 | ppl     33.17
| epoch   8 step    15410 | batches    703 / 2101 | lr 7.294e-03 | ms/batch 400.9 | tok/s  122605 | loss  3.50 | ppl     33.07
| epoch   8 step    15420 | batches    713 / 2101 | lr 7.290e-03 | ms/batch 400.7 | tok/s  122660 | loss  3.46 | ppl     31.76
| epoch   8 step    15430 | batches    723 / 2101 | lr 7.287e-03 | ms/batch 399.7 | tok/s  122965 | loss  3.45 | ppl     31.51
| epoch   8 step    15440 | batches    733 / 2101 | lr 7.284e-03 | ms/batch 399.8 | tok/s  122928 | loss  3.44 | ppl     31.26
| epoch   8 step    15450 | batches    743 / 2101 | lr 7.281e-03 | ms/batch 399.9 | tok/s  122904 | loss  3.47 | ppl     32.10
| epoch   8 step    15460 | batches    753 / 2101 | lr 7.277e-03 | ms/batch 400.0 | tok/s  122893 | loss  3.47 | ppl     32.11
| epoch   8 step    15470 | batches    763 / 2101 | lr 7.274e-03 | ms/batch 399.6 | tok/s  122996 | loss  3.48 | ppl     32.57
| epoch   8 step    15480 | batches    773 / 2101 | lr 7.271e-03 | ms/batch 400.7 | tok/s  122654 | loss  3.45 | ppl     31.48
| epoch   8 step    15490 | batches    783 / 2101 | lr 7.267e-03 | ms/batch 399.8 | tok/s  122938 | loss  3.50 | ppl     33.21
| epoch   8 step    15500 | batches    793 / 2101 | lr 7.264e-03 | ms/batch 400.2 | tok/s  122832 | loss  3.51 | ppl     33.42
----------------------------------------------------------------------------------------------------
| Eval  31 at step    15500 | time:  0.91s | valid loss  3.37 | valid ppl    28.974
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   8 step    15510 | batches    803 / 2101 | lr 7.261e-03 | ms/batch 399.8 | tok/s  122961 | loss  3.47 | ppl     31.98
| epoch   8 step    15520 | batches    813 / 2101 | lr 7.257e-03 | ms/batch 411.8 | tok/s  119348 | loss  3.50 | ppl     32.97
| epoch   8 step    15530 | batches    823 / 2101 | lr 7.254e-03 | ms/batch 399.0 | tok/s  123191 | loss  3.48 | ppl     32.39
| epoch   8 step    15540 | batches    833 / 2101 | lr 7.251e-03 | ms/batch 400.0 | tok/s  122873 | loss  3.53 | ppl     33.99
| epoch   8 step    15550 | batches    843 / 2101 | lr 7.247e-03 | ms/batch 399.5 | tok/s  123036 | loss  3.49 | ppl     32.93
| epoch   8 step    15560 | batches    853 / 2101 | lr 7.244e-03 | ms/batch 399.7 | tok/s  122970 | loss  3.49 | ppl     32.72
| epoch   8 step    15570 | batches    863 / 2101 | lr 7.240e-03 | ms/batch 399.9 | tok/s  122914 | loss  3.53 | ppl     34.23
| epoch   8 step    15580 | batches    873 / 2101 | lr 7.237e-03 | ms/batch 412.3 | tok/s  119215 | loss  3.51 | ppl     33.54
| epoch   8 step    15590 | batches    883 / 2101 | lr 7.234e-03 | ms/batch 400.5 | tok/s  122733 | loss  3.51 | ppl     33.46
| epoch   8 step    15600 | batches    893 / 2101 | lr 7.230e-03 | ms/batch 400.1 | tok/s  122848 | loss  3.54 | ppl     34.53
| epoch   8 step    15610 | batches    903 / 2101 | lr 7.227e-03 | ms/batch 399.9 | tok/s  122901 | loss  3.51 | ppl     33.50
| epoch   8 step    15620 | batches    913 / 2101 | lr 7.224e-03 | ms/batch 400.5 | tok/s  122729 | loss  3.50 | ppl     33.18
| epoch   8 step    15630 | batches    923 / 2101 | lr 7.220e-03 | ms/batch 399.9 | tok/s  122906 | loss  3.48 | ppl     32.50
| epoch   8 step    15640 | batches    933 / 2101 | lr 7.217e-03 | ms/batch 399.5 | tok/s  123048 | loss  3.47 | ppl     32.00
| epoch   8 step    15650 | batches    943 / 2101 | lr 7.214e-03 | ms/batch 399.8 | tok/s  122950 | loss  3.47 | ppl     32.27
| epoch   8 step    15660 | batches    953 / 2101 | lr 7.210e-03 | ms/batch 399.6 | tok/s  123001 | loss  3.45 | ppl     31.62
| epoch   8 step    15670 | batches    963 / 2101 | lr 7.207e-03 | ms/batch 400.0 | tok/s  122872 | loss  3.44 | ppl     31.28
| epoch   8 step    15680 | batches    973 / 2101 | lr 7.204e-03 | ms/batch 399.9 | tok/s  122921 | loss  3.46 | ppl     31.75
| epoch   8 step    15690 | batches    983 / 2101 | lr 7.200e-03 | ms/batch 400.5 | tok/s  122728 | loss  3.49 | ppl     32.77
| epoch   8 step    15700 | batches    993 / 2101 | lr 7.197e-03 | ms/batch 399.8 | tok/s  122950 | loss  3.46 | ppl     31.94
| epoch   8 step    15710 | batches   1003 / 2101 | lr 7.194e-03 | ms/batch 398.4 | tok/s  123369 | loss  3.48 | ppl     32.44
| epoch   8 step    15720 | batches   1013 / 2101 | lr 7.190e-03 | ms/batch 400.0 | tok/s  122891 | loss  3.47 | ppl     32.11
| epoch   8 step    15730 | batches   1023 / 2101 | lr 7.187e-03 | ms/batch 399.3 | tok/s  123093 | loss  3.47 | ppl     32.25
| epoch   8 step    15740 | batches   1033 / 2101 | lr 7.183e-03 | ms/batch 399.0 | tok/s  123194 | loss  3.46 | ppl     31.91
| epoch   8 step    15750 | batches   1043 / 2101 | lr 7.180e-03 | ms/batch 399.3 | tok/s  123093 | loss  3.46 | ppl     31.86
| epoch   8 step    15760 | batches   1053 / 2101 | lr 7.177e-03 | ms/batch 399.9 | tok/s  122916 | loss  3.45 | ppl     31.46
| epoch   8 step    15770 | batches   1063 / 2101 | lr 7.173e-03 | ms/batch 399.3 | tok/s  123098 | loss  3.51 | ppl     33.58
| epoch   8 step    15780 | batches   1073 / 2101 | lr 7.170e-03 | ms/batch 399.8 | tok/s  122952 | loss  3.50 | ppl     32.98
| epoch   8 step    15790 | batches   1083 / 2101 | lr 7.167e-03 | ms/batch 400.0 | tok/s  122890 | loss  3.47 | ppl     32.09
| epoch   8 step    15800 | batches   1093 / 2101 | lr 7.163e-03 | ms/batch 399.9 | tok/s  122916 | loss  3.48 | ppl     32.40
| epoch   8 step    15810 | batches   1103 / 2101 | lr 7.160e-03 | ms/batch 400.4 | tok/s  122747 | loss  3.50 | ppl     33.14
| epoch   8 step    15820 | batches   1113 / 2101 | lr 7.157e-03 | ms/batch 399.8 | tok/s  122946 | loss  3.51 | ppl     33.51
| epoch   8 step    15830 | batches   1123 / 2101 | lr 7.153e-03 | ms/batch 399.9 | tok/s  122925 | loss  3.47 | ppl     32.18
| epoch   8 step    15840 | batches   1133 / 2101 | lr 7.150e-03 | ms/batch 400.2 | tok/s  122830 | loss  3.47 | ppl     32.23
| epoch   8 step    15850 | batches   1143 / 2101 | lr 7.146e-03 | ms/batch 400.6 | tok/s  122686 | loss  3.46 | ppl     31.95
| epoch   8 step    15860 | batches   1153 / 2101 | lr 7.143e-03 | ms/batch 400.9 | tok/s  122617 | loss  3.47 | ppl     32.15
| epoch   8 step    15870 | batches   1163 / 2101 | lr 7.140e-03 | ms/batch 400.0 | tok/s  122871 | loss  3.51 | ppl     33.40
| epoch   8 step    15880 | batches   1173 / 2101 | lr 7.136e-03 | ms/batch 400.4 | tok/s  122771 | loss  3.50 | ppl     33.05
| epoch   8 step    15890 | batches   1183 / 2101 | lr 7.133e-03 | ms/batch 400.1 | tok/s  122853 | loss  3.48 | ppl     32.31
| epoch   8 step    15900 | batches   1193 / 2101 | lr 7.130e-03 | ms/batch 400.3 | tok/s  122801 | loss  3.47 | ppl     32.06
| epoch   8 step    15910 | batches   1203 / 2101 | lr 7.126e-03 | ms/batch 399.9 | tok/s  122901 | loss  3.49 | ppl     32.92
| epoch   8 step    15920 | batches   1213 / 2101 | lr 7.123e-03 | ms/batch 399.7 | tok/s  122963 | loss  3.50 | ppl     33.00
| epoch   8 step    15930 | batches   1223 / 2101 | lr 7.119e-03 | ms/batch 399.3 | tok/s  123105 | loss  3.46 | ppl     31.93
| epoch   8 step    15940 | batches   1233 / 2101 | lr 7.116e-03 | ms/batch 399.2 | tok/s  123117 | loss  3.50 | ppl     33.11
| epoch   8 step    15950 | batches   1243 / 2101 | lr 7.113e-03 | ms/batch 399.9 | tok/s  122898 | loss  3.51 | ppl     33.49
| epoch   8 step    15960 | batches   1253 / 2101 | lr 7.109e-03 | ms/batch 400.1 | tok/s  122838 | loss  3.50 | ppl     33.23
| epoch   8 step    15970 | batches   1263 / 2101 | lr 7.106e-03 | ms/batch 400.2 | tok/s  122816 | loss  3.53 | ppl     34.02
| epoch   8 step    15980 | batches   1273 / 2101 | lr 7.102e-03 | ms/batch 400.5 | tok/s  122719 | loss  3.51 | ppl     33.30
| epoch   8 step    15990 | batches   1283 / 2101 | lr 7.099e-03 | ms/batch 400.8 | tok/s  122625 | loss  3.53 | ppl     34.00
| epoch   8 step    16000 | batches   1293 / 2101 | lr 7.096e-03 | ms/batch 414.3 | tok/s  118637 | loss  3.50 | ppl     33.15
----------------------------------------------------------------------------------------------------
| Eval  32 at step    16000 | time:  0.81s | valid loss  3.35 | valid ppl    28.429
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.060453667402193365, 0.06553823570760772, 0.05684406870654981, 0.059465848017045256, 0.05998796002607653, 0.05648911877775151, 0.06604824179250526, 0.06866135935871842, 0.051305127465388047, 0.05724613739321947, 0.0618869828980627, 0.0645615652954217, 0.05158551989607466, 0.07210932400399965, 0.060734576187285984, 0.06241724519424319, 0.06743390731783416, 0.0813902918843711, 0.06497649489507168, 0.061464209415307135, 0.05960806276781459, 0.06310138517312841, 0.06401355684416306, 0.0638403338907812, 0.06110683776399306, 0.061207714937869154, 0.06635495642286905, 0.06376872589431422, 0.06271597337561634, 0.062182170465182256, 0.06351443915817391, 0.06048893500607461, 0.050464662638504465, 0.054474379481834645, 0.05730894104999104, 0.05609532668931758, 0.06102002637734682, 0.04904439667935871, 0.05991726140855033, 0.05979330910387225, 0.06742213343667793, 0.05932707375820919, 0.06606193511387579, 0.054216079597435816, 0.0558312963680104, 0.05894602083974785, 0.05989461175423772, 0.05793983311817385, 0.05235298976226181, 0.057004719149394124, 0.05906856886575003, 0.05791835820972039, 0.04062833713464555, 0.05013674662052412, 0.052271434967711125, 0.05898838002631895, 0.056831929721410414, 0.05688326838976375, 0.05841990523217586, 0.05271494079739554, 0.04975118495369767, 0.030333704873833443, 0.014455363056039653, 0.03984649366220845, 0.047544712843175845, 0.047496884939875146, 0.0420049731721808, 0.020683878267456404, 0.04155754000346474, 0.04981024476553541, 0.06313883404044267, 0.05488645659252126, 0.06527575838756429, 0.039438756895970796, 0.046028699655093645, 0.05084536567275584, 0.0463434433930735, 0.054357754276704376, 0.039346986756926036, 0.04682055508313277, 0.0630154904848458]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [49, 54, 10, 18, 10, 54, 74, 9, 23, 11], [45, 43, 17, 8, 8, 47, 57, 10, 9, 9], [36, 43, 9, 8, 8, 38, 50, 8, 8, 9], [30, 54, 9, 8, 8, 19, 22, 11, 8, 8], [11, 13, 8, 8, 8, 18, 21, 9, 8, 8], [11, 19, 8, 8, 8, 8, 15, 8, 8, 8], [10, 9, 8, 8, 8, 9, 8, 8, 8, 8], [10, 13, 8, 8, 8, 9, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [49, 54, 10, 18, 10, 54, 74, 9, 23, 11], [45, 43, 17, 8, 8, 47, 57, 10, 9, 9], [36, 43, 9, 8, 8, 38, 50, 8, 8, 9], [30, 54, 9, 8, 8, 19, 22, 11, 8, 8], [11, 13, 8, 8, 8, 18, 21, 9, 8, 8], [11, 19, 8, 8, 8, 8, 15, 8, 8, 8], [10, 9, 8, 8, 8, 9, 8, 8, 8, 8], [10, 13, 8, 8, 8, 9, 9, 8, 8, 8], [8]]
| epoch   8 step    16010 | batches   1303 / 2101 | lr 7.092e-03 | ms/batch 4891.5 | tok/s   10049 | loss  3.51 | ppl     33.34
| epoch   8 step    16020 | batches   1313 / 2101 | lr 7.089e-03 | ms/batch 396.9 | tok/s  123843 | loss  3.50 | ppl     33.08
| epoch   8 step    16030 | batches   1323 / 2101 | lr 7.086e-03 | ms/batch 396.7 | tok/s  123896 | loss  3.46 | ppl     31.88
| epoch   8 step    16040 | batches   1333 / 2101 | lr 7.082e-03 | ms/batch 396.7 | tok/s  123904 | loss  3.44 | ppl     31.32
| epoch   8 step    16050 | batches   1343 / 2101 | lr 7.079e-03 | ms/batch 396.9 | tok/s  123827 | loss  3.45 | ppl     31.47
| epoch   8 step    16060 | batches   1353 / 2101 | lr 7.075e-03 | ms/batch 397.0 | tok/s  123794 | loss  3.48 | ppl     32.56
| epoch   8 step    16070 | batches   1363 / 2101 | lr 7.072e-03 | ms/batch 400.7 | tok/s  122670 | loss  3.49 | ppl     32.92
| epoch   8 step    16080 | batches   1373 / 2101 | lr 7.069e-03 | ms/batch 398.2 | tok/s  123448 | loss  3.50 | ppl     33.00
| epoch   8 step    16090 | batches   1383 / 2101 | lr 7.065e-03 | ms/batch 398.3 | tok/s  123395 | loss  3.51 | ppl     33.33
| epoch   8 step    16100 | batches   1393 / 2101 | lr 7.062e-03 | ms/batch 399.0 | tok/s  123196 | loss  3.50 | ppl     33.10
| epoch   8 step    16110 | batches   1403 / 2101 | lr 7.058e-03 | ms/batch 399.3 | tok/s  123097 | loss  3.55 | ppl     34.73
| epoch   8 step    16120 | batches   1413 / 2101 | lr 7.055e-03 | ms/batch 399.5 | tok/s  123040 | loss  3.54 | ppl     34.50
| epoch   8 step    16130 | batches   1423 / 2101 | lr 7.052e-03 | ms/batch 398.6 | tok/s  123327 | loss  3.48 | ppl     32.37
| epoch   8 step    16140 | batches   1433 / 2101 | lr 7.048e-03 | ms/batch 399.1 | tok/s  123170 | loss  3.47 | ppl     31.99
| epoch   8 step    16150 | batches   1443 / 2101 | lr 7.045e-03 | ms/batch 399.3 | tok/s  123091 | loss  3.49 | ppl     32.87
| epoch   8 step    16160 | batches   1453 / 2101 | lr 7.041e-03 | ms/batch 399.9 | tok/s  122904 | loss  3.46 | ppl     31.81
| epoch   8 step    16170 | batches   1463 / 2101 | lr 7.038e-03 | ms/batch 400.8 | tok/s  122642 | loss  3.49 | ppl     32.83
| epoch   8 step    16180 | batches   1473 / 2101 | lr 7.035e-03 | ms/batch 399.6 | tok/s  122995 | loss  3.53 | ppl     34.08
| epoch   8 step    16190 | batches   1483 / 2101 | lr 7.031e-03 | ms/batch 400.0 | tok/s  122887 | loss  3.47 | ppl     32.24
| epoch   8 step    16200 | batches   1493 / 2101 | lr 7.028e-03 | ms/batch 399.8 | tok/s  122955 | loss  3.45 | ppl     31.50
| epoch   8 step    16210 | batches   1503 / 2101 | lr 7.024e-03 | ms/batch 399.8 | tok/s  122952 | loss  3.48 | ppl     32.40
| epoch   8 step    16220 | batches   1513 / 2101 | lr 7.021e-03 | ms/batch 399.8 | tok/s  122933 | loss  3.49 | ppl     32.72
| epoch   8 step    16230 | batches   1523 / 2101 | lr 7.017e-03 | ms/batch 399.9 | tok/s  122922 | loss  3.50 | ppl     33.11
| epoch   8 step    16240 | batches   1533 / 2101 | lr 7.014e-03 | ms/batch 399.7 | tok/s  122968 | loss  3.50 | ppl     33.23
| epoch   8 step    16250 | batches   1543 / 2101 | lr 7.011e-03 | ms/batch 399.6 | tok/s  123000 | loss  3.48 | ppl     32.43
| epoch   8 step    16260 | batches   1553 / 2101 | lr 7.007e-03 | ms/batch 400.3 | tok/s  122776 | loss  3.51 | ppl     33.45
| epoch   8 step    16270 | batches   1563 / 2101 | lr 7.004e-03 | ms/batch 400.2 | tok/s  122834 | loss  3.52 | ppl     33.74
| epoch   8 step    16280 | batches   1573 / 2101 | lr 7.000e-03 | ms/batch 399.8 | tok/s  122949 | loss  3.50 | ppl     33.02
| epoch   8 step    16290 | batches   1583 / 2101 | lr 6.997e-03 | ms/batch 399.6 | tok/s  123003 | loss  3.47 | ppl     32.12
| epoch   8 step    16300 | batches   1593 / 2101 | lr 6.994e-03 | ms/batch 399.8 | tok/s  122941 | loss  3.47 | ppl     32.12
| epoch   8 step    16310 | batches   1603 / 2101 | lr 6.990e-03 | ms/batch 399.9 | tok/s  122921 | loss  3.47 | ppl     32.09
| epoch   8 step    16320 | batches   1613 / 2101 | lr 6.987e-03 | ms/batch 400.1 | tok/s  122841 | loss  3.51 | ppl     33.47
| epoch   8 step    16330 | batches   1623 / 2101 | lr 6.983e-03 | ms/batch 400.0 | tok/s  122880 | loss  3.46 | ppl     31.97
| epoch   8 step    16340 | batches   1633 / 2101 | lr 6.980e-03 | ms/batch 400.1 | tok/s  122846 | loss  3.50 | ppl     32.95
| epoch   8 step    16350 | batches   1643 / 2101 | lr 6.976e-03 | ms/batch 400.0 | tok/s  122887 | loss  3.52 | ppl     33.86
| epoch   8 step    16360 | batches   1653 / 2101 | lr 6.973e-03 | ms/batch 400.5 | tok/s  122716 | loss  3.51 | ppl     33.60
| epoch   8 step    16370 | batches   1663 / 2101 | lr 6.970e-03 | ms/batch 400.2 | tok/s  122816 | loss  3.50 | ppl     33.13
| epoch   8 step    16380 | batches   1673 / 2101 | lr 6.966e-03 | ms/batch 399.6 | tok/s  123019 | loss  3.50 | ppl     33.25
| epoch   8 step    16390 | batches   1683 / 2101 | lr 6.963e-03 | ms/batch 399.8 | tok/s  122929 | loss  3.46 | ppl     31.83
| epoch   8 step    16400 | batches   1693 / 2101 | lr 6.959e-03 | ms/batch 400.1 | tok/s  122839 | loss  3.46 | ppl     31.87
| epoch   8 step    16410 | batches   1703 / 2101 | lr 6.956e-03 | ms/batch 400.3 | tok/s  122781 | loss  3.42 | ppl     30.44
| epoch   8 step    16420 | batches   1713 / 2101 | lr 6.952e-03 | ms/batch 399.8 | tok/s  122949 | loss  3.46 | ppl     31.98
| epoch   8 step    16430 | batches   1723 / 2101 | lr 6.949e-03 | ms/batch 399.9 | tok/s  122903 | loss  3.50 | ppl     32.98
| epoch   8 step    16440 | batches   1733 / 2101 | lr 6.946e-03 | ms/batch 400.3 | tok/s  122798 | loss  3.51 | ppl     33.43
| epoch   8 step    16450 | batches   1743 / 2101 | lr 6.942e-03 | ms/batch 400.2 | tok/s  122823 | loss  3.48 | ppl     32.30
| epoch   8 step    16460 | batches   1753 / 2101 | lr 6.939e-03 | ms/batch 400.7 | tok/s  122664 | loss  3.47 | ppl     32.26
| epoch   8 step    16470 | batches   1763 / 2101 | lr 6.935e-03 | ms/batch 400.3 | tok/s  122781 | loss  3.45 | ppl     31.43
| epoch   8 step    16480 | batches   1773 / 2101 | lr 6.932e-03 | ms/batch 399.8 | tok/s  122927 | loss  3.46 | ppl     31.88
| epoch   8 step    16490 | batches   1783 / 2101 | lr 6.928e-03 | ms/batch 399.4 | tok/s  123066 | loss  3.46 | ppl     31.96
| epoch   8 step    16500 | batches   1793 / 2101 | lr 6.925e-03 | ms/batch 400.1 | tok/s  122846 | loss  3.47 | ppl     32.09
----------------------------------------------------------------------------------------------------
| Eval  33 at step    16500 | time:  0.81s | valid loss  3.34 | valid ppl    28.147
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   8 step    16510 | batches   1803 / 2101 | lr 6.922e-03 | ms/batch 399.0 | tok/s  123199 | loss  3.42 | ppl     30.58
| epoch   8 step    16520 | batches   1813 / 2101 | lr 6.918e-03 | ms/batch 411.0 | tok/s  119581 | loss  3.46 | ppl     31.94
| epoch   8 step    16530 | batches   1823 / 2101 | lr 6.915e-03 | ms/batch 411.8 | tok/s  119348 | loss  3.45 | ppl     31.54
| epoch   8 step    16540 | batches   1833 / 2101 | lr 6.911e-03 | ms/batch 400.0 | tok/s  122891 | loss  3.45 | ppl     31.64
| epoch   8 step    16550 | batches   1843 / 2101 | lr 6.908e-03 | ms/batch 411.6 | tok/s  119405 | loss  3.48 | ppl     32.33
| epoch   8 step    16560 | batches   1853 / 2101 | lr 6.904e-03 | ms/batch 411.4 | tok/s  119466 | loss  3.44 | ppl     31.28
| epoch   8 step    16570 | batches   1863 / 2101 | lr 6.901e-03 | ms/batch 411.3 | tok/s  119502 | loss  3.41 | ppl     30.41
| epoch   8 step    16580 | batches   1873 / 2101 | lr 6.897e-03 | ms/batch 399.9 | tok/s  122904 | loss  3.46 | ppl     31.78
| epoch   8 step    16590 | batches   1883 / 2101 | lr 6.894e-03 | ms/batch 400.8 | tok/s  122638 | loss  3.45 | ppl     31.39
| epoch   8 step    16600 | batches   1893 / 2101 | lr 6.891e-03 | ms/batch 400.3 | tok/s  122789 | loss  3.47 | ppl     32.29
| epoch   8 step    16610 | batches   1903 / 2101 | lr 6.887e-03 | ms/batch 400.0 | tok/s  122894 | loss  3.48 | ppl     32.46
| epoch   8 step    16620 | batches   1913 / 2101 | lr 6.884e-03 | ms/batch 400.3 | tok/s  122795 | loss  3.50 | ppl     32.96
| epoch   8 step    16630 | batches   1923 / 2101 | lr 6.880e-03 | ms/batch 399.9 | tok/s  122912 | loss  3.45 | ppl     31.65
| epoch   8 step    16640 | batches   1933 / 2101 | lr 6.877e-03 | ms/batch 399.4 | tok/s  123078 | loss  3.45 | ppl     31.64
| epoch   8 step    16650 | batches   1943 / 2101 | lr 6.873e-03 | ms/batch 399.6 | tok/s  122991 | loss  3.48 | ppl     32.51
| epoch   8 step    16660 | batches   1953 / 2101 | lr 6.870e-03 | ms/batch 409.6 | tok/s  120003 | loss  3.47 | ppl     32.10
| epoch   8 step    16670 | batches   1963 / 2101 | lr 6.866e-03 | ms/batch 399.5 | tok/s  123029 | loss  3.44 | ppl     31.29
| epoch   8 step    16680 | batches   1973 / 2101 | lr 6.863e-03 | ms/batch 404.6 | tok/s  121491 | loss  3.46 | ppl     31.96
| epoch   8 step    16690 | batches   1983 / 2101 | lr 6.860e-03 | ms/batch 399.4 | tok/s  123068 | loss  3.45 | ppl     31.49
| epoch   8 step    16700 | batches   1993 / 2101 | lr 6.856e-03 | ms/batch 399.4 | tok/s  123057 | loss  3.47 | ppl     32.05
| epoch   8 step    16710 | batches   2003 / 2101 | lr 6.853e-03 | ms/batch 400.6 | tok/s  122705 | loss  3.48 | ppl     32.55
| epoch   8 step    16720 | batches   2013 / 2101 | lr 6.849e-03 | ms/batch 400.1 | tok/s  122836 | loss  3.45 | ppl     31.52
| epoch   8 step    16730 | batches   2023 / 2101 | lr 6.846e-03 | ms/batch 399.7 | tok/s  122969 | loss  3.46 | ppl     31.88
| epoch   8 step    16740 | batches   2033 / 2101 | lr 6.842e-03 | ms/batch 399.3 | tok/s  123100 | loss  3.45 | ppl     31.44
| epoch   8 step    16750 | batches   2043 / 2101 | lr 6.839e-03 | ms/batch 399.1 | tok/s  123150 | loss  3.48 | ppl     32.39
| epoch   8 step    16760 | batches   2053 / 2101 | lr 6.835e-03 | ms/batch 408.6 | tok/s  120295 | loss  3.46 | ppl     31.95
| epoch   8 step    16770 | batches   2063 / 2101 | lr 6.832e-03 | ms/batch 410.3 | tok/s  119798 | loss  3.47 | ppl     32.08
| epoch   8 step    16780 | batches   2073 / 2101 | lr 6.828e-03 | ms/batch 400.3 | tok/s  122786 | loss  3.49 | ppl     32.89
| epoch   8 step    16790 | batches   2083 / 2101 | lr 6.825e-03 | ms/batch 400.4 | tok/s  122772 | loss  3.53 | ppl     34.25
| epoch   8 step    16800 | batches   2093 / 2101 | lr 6.821e-03 | ms/batch 399.7 | tok/s  122970 | loss  3.52 | ppl     33.80
| epoch   9 step    16810 | batches      2 / 2101 | lr 6.818e-03 | ms/batch 404.5 | tok/s  122417 | loss  3.72 | ppl     41.23
| epoch   9 step    16820 | batches     12 / 2101 | lr 6.815e-03 | ms/batch 400.1 | tok/s  122842 | loss  3.43 | ppl     30.77
| epoch   9 step    16830 | batches     22 / 2101 | lr 6.811e-03 | ms/batch 399.4 | tok/s  123053 | loss  3.38 | ppl     29.38
| epoch   9 step    16840 | batches     32 / 2101 | lr 6.808e-03 | ms/batch 398.8 | tok/s  123266 | loss  3.36 | ppl     28.79
| epoch   9 step    16850 | batches     42 / 2101 | lr 6.804e-03 | ms/batch 400.4 | tok/s  122771 | loss  3.40 | ppl     29.96
| epoch   9 step    16860 | batches     52 / 2101 | lr 6.801e-03 | ms/batch 399.3 | tok/s  123100 | loss  3.41 | ppl     30.25
| epoch   9 step    16870 | batches     62 / 2101 | lr 6.797e-03 | ms/batch 399.6 | tok/s  123016 | loss  3.40 | ppl     29.87
| epoch   9 step    16880 | batches     72 / 2101 | lr 6.794e-03 | ms/batch 400.3 | tok/s  122782 | loss  3.43 | ppl     30.73
| epoch   9 step    16890 | batches     82 / 2101 | lr 6.790e-03 | ms/batch 399.1 | tok/s  123154 | loss  3.42 | ppl     30.67
| epoch   9 step    16900 | batches     92 / 2101 | lr 6.787e-03 | ms/batch 399.1 | tok/s  123157 | loss  3.41 | ppl     30.38
| epoch   9 step    16910 | batches    102 / 2101 | lr 6.783e-03 | ms/batch 399.3 | tok/s  123084 | loss  3.43 | ppl     30.78
| epoch   9 step    16920 | batches    112 / 2101 | lr 6.780e-03 | ms/batch 399.1 | tok/s  123156 | loss  3.42 | ppl     30.69
| epoch   9 step    16930 | batches    122 / 2101 | lr 6.776e-03 | ms/batch 399.1 | tok/s  123146 | loss  3.39 | ppl     29.61
| epoch   9 step    16940 | batches    132 / 2101 | lr 6.773e-03 | ms/batch 398.7 | tok/s  123267 | loss  3.41 | ppl     30.30
| epoch   9 step    16950 | batches    142 / 2101 | lr 6.769e-03 | ms/batch 399.0 | tok/s  123190 | loss  3.41 | ppl     30.38
| epoch   9 step    16960 | batches    152 / 2101 | lr 6.766e-03 | ms/batch 399.7 | tok/s  122964 | loss  3.42 | ppl     30.65
| epoch   9 step    16970 | batches    162 / 2101 | lr 6.762e-03 | ms/batch 399.5 | tok/s  123040 | loss  3.41 | ppl     30.36
| epoch   9 step    16980 | batches    172 / 2101 | lr 6.759e-03 | ms/batch 399.3 | tok/s  123084 | loss  3.41 | ppl     30.26
| epoch   9 step    16990 | batches    182 / 2101 | lr 6.755e-03 | ms/batch 398.7 | tok/s  123272 | loss  3.37 | ppl     29.16
| epoch   9 step    17000 | batches    192 / 2101 | lr 6.752e-03 | ms/batch 414.4 | tok/s  118606 | loss  3.42 | ppl     30.66
----------------------------------------------------------------------------------------------------
| Eval  34 at step    17000 | time:  0.82s | valid loss  3.33 | valid ppl    27.948
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.057963636547204885, 0.05962427029554371, 0.059994386672458766, 0.05464581950212596, 0.05637929944581187, 0.06211317117383822, 0.05912036171004628, 0.07113949144193348, 0.06493612297977011, 0.05335347831310826, 0.05821789640229093, 0.05842180261548959, 0.04994152665050992, 0.06074239079377939, 0.057951460918626914, 0.06165560119337346, 0.06234124287569773, 0.07234274485183657, 0.061874884005017304, 0.05801642019403567, 0.05908163778931303, 0.05889075069751602, 0.06760526288232953, 0.0602971804359615, 0.05682636237423568, 0.0657986852924003, 0.06091819900529069, 0.049339037332922255, 0.06047650239894729, 0.058015139791163566, 0.05835871776489464, 0.05726365400609925, 0.07296014750986228, 0.053666919410755715, 0.05383361273982428, 0.05139695754653012, 0.05419016937171373, 0.0493084998619624, 0.05329499023129701, 0.05530810300949139, 0.06272461316030001, 0.055942209636865144, 0.059156436700393715, 0.05746451091900789, 0.05139579367396742, 0.058360010849541934, 0.05620161736883866, 0.050213204368747696, 0.051104188225251014, 0.053604853137572184, 0.045736005412151316, 0.05245351479685772, 0.04431569099824462, 0.04535861747667273, 0.048176241749495904, 0.061339237896104716, 0.05399555994957136, 0.04929298479901344, 0.04874018159040235, 0.04902071598852177, 0.03460898471458211, 0.028214334773517955, 0.01655838140739024, 0.036267169191634, 0.044928362870794075, 0.04701242971430982, 0.04266136655651391, 0.030964408835241652, 0.03878466893405926, 0.04677529984195209, 0.048526404714667355, 0.0506192634054079, 0.05473486787957595, 0.03542024022123629, 0.04165189503059108, 0.046426443582585235, 0.04403007788444977, 0.040465461295565434, 0.036033783261509106, 0.044209893438652406, 0.06147708779885293]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [52, 64, 8, 18, 10, 55, 78, 9, 22, 10], [43, 39, 17, 9, 8, 48, 61, 10, 8, 8], [31, 45, 9, 8, 8, 35, 49, 8, 8, 9], [32, 45, 9, 8, 8, 22, 17, 9, 8, 8], [11, 16, 8, 8, 8, 20, 24, 8, 8, 8], [11, 17, 8, 8, 8, 11, 13, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 8, 8, 8], [8, 14, 9, 8, 8, 9, 8, 9, 8, 8], [8]]
optimal compression parameters =  [[], [52, 64, 8, 18, 10, 55, 78, 9, 22, 10], [43, 39, 17, 9, 8, 48, 61, 10, 8, 8], [31, 45, 9, 8, 8, 35, 49, 8, 8, 9], [32, 45, 9, 8, 8, 22, 17, 9, 8, 8], [11, 16, 8, 8, 8, 20, 24, 8, 8, 8], [11, 17, 8, 8, 8, 11, 13, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 8, 8, 8], [8, 14, 9, 8, 8, 9, 8, 9, 8, 8], [8]]
| epoch   9 step    17010 | batches    202 / 2101 | lr 6.748e-03 | ms/batch 4866.8 | tok/s   10100 | loss  3.39 | ppl     29.75
| epoch   9 step    17020 | batches    212 / 2101 | lr 6.745e-03 | ms/batch 409.4 | tok/s  120057 | loss  3.45 | ppl     31.47
| epoch   9 step    17030 | batches    222 / 2101 | lr 6.742e-03 | ms/batch 407.7 | tok/s  120556 | loss  3.43 | ppl     30.89
| epoch   9 step    17040 | batches    232 / 2101 | lr 6.738e-03 | ms/batch 396.9 | tok/s  123837 | loss  3.41 | ppl     30.21
| epoch   9 step    17050 | batches    242 / 2101 | lr 6.735e-03 | ms/batch 396.0 | tok/s  124127 | loss  3.41 | ppl     30.38
| epoch   9 step    17060 | batches    252 / 2101 | lr 6.731e-03 | ms/batch 396.0 | tok/s  124108 | loss  3.47 | ppl     32.28
| epoch   9 step    17070 | batches    262 / 2101 | lr 6.728e-03 | ms/batch 396.9 | tok/s  123856 | loss  3.43 | ppl     30.87
| epoch   9 step    17080 | batches    272 / 2101 | lr 6.724e-03 | ms/batch 397.5 | tok/s  123645 | loss  3.43 | ppl     30.72
| epoch   9 step    17090 | batches    282 / 2101 | lr 6.721e-03 | ms/batch 397.6 | tok/s  123637 | loss  3.44 | ppl     31.29
| epoch   9 step    17100 | batches    292 / 2101 | lr 6.717e-03 | ms/batch 397.6 | tok/s  123634 | loss  3.46 | ppl     31.68
| epoch   9 step    17110 | batches    302 / 2101 | lr 6.714e-03 | ms/batch 397.7 | tok/s  123581 | loss  3.42 | ppl     30.47
| epoch   9 step    17120 | batches    312 / 2101 | lr 6.710e-03 | ms/batch 397.7 | tok/s  123585 | loss  3.39 | ppl     29.61
| epoch   9 step    17130 | batches    322 / 2101 | lr 6.707e-03 | ms/batch 398.1 | tok/s  123456 | loss  3.39 | ppl     29.70
| epoch   9 step    17140 | batches    332 / 2101 | lr 6.703e-03 | ms/batch 398.2 | tok/s  123450 | loss  3.39 | ppl     29.80
| epoch   9 step    17150 | batches    342 / 2101 | lr 6.700e-03 | ms/batch 398.1 | tok/s  123481 | loss  3.45 | ppl     31.36
| epoch   9 step    17160 | batches    352 / 2101 | lr 6.696e-03 | ms/batch 398.2 | tok/s  123449 | loss  3.47 | ppl     32.08
| epoch   9 step    17170 | batches    362 / 2101 | lr 6.693e-03 | ms/batch 398.7 | tok/s  123280 | loss  3.42 | ppl     30.64
| epoch   9 step    17180 | batches    372 / 2101 | lr 6.689e-03 | ms/batch 397.9 | tok/s  123521 | loss  3.45 | ppl     31.45
| epoch   9 step    17190 | batches    382 / 2101 | lr 6.686e-03 | ms/batch 398.0 | tok/s  123485 | loss  3.41 | ppl     30.33
| epoch   9 step    17200 | batches    392 / 2101 | lr 6.682e-03 | ms/batch 398.4 | tok/s  123366 | loss  3.40 | ppl     30.09
| epoch   9 step    17210 | batches    402 / 2101 | lr 6.679e-03 | ms/batch 398.4 | tok/s  123377 | loss  3.47 | ppl     32.08
| epoch   9 step    17220 | batches    412 / 2101 | lr 6.675e-03 | ms/batch 397.9 | tok/s  123515 | loss  3.42 | ppl     30.65
| epoch   9 step    17230 | batches    422 / 2101 | lr 6.672e-03 | ms/batch 398.9 | tok/s  123214 | loss  3.44 | ppl     31.23
| epoch   9 step    17240 | batches    432 / 2101 | lr 6.668e-03 | ms/batch 398.4 | tok/s  123388 | loss  3.45 | ppl     31.55
| epoch   9 step    17250 | batches    442 / 2101 | lr 6.665e-03 | ms/batch 397.7 | tok/s  123594 | loss  3.43 | ppl     30.86
| epoch   9 step    17260 | batches    452 / 2101 | lr 6.661e-03 | ms/batch 397.9 | tok/s  123537 | loss  3.40 | ppl     30.01
| epoch   9 step    17270 | batches    462 / 2101 | lr 6.658e-03 | ms/batch 398.2 | tok/s  123436 | loss  3.41 | ppl     30.30
| epoch   9 step    17280 | batches    472 / 2101 | lr 6.654e-03 | ms/batch 398.5 | tok/s  123333 | loss  3.44 | ppl     31.18
| epoch   9 step    17290 | batches    482 / 2101 | lr 6.651e-03 | ms/batch 398.7 | tok/s  123270 | loss  3.43 | ppl     30.77
| epoch   9 step    17300 | batches    492 / 2101 | lr 6.647e-03 | ms/batch 398.7 | tok/s  123291 | loss  3.42 | ppl     30.64
| epoch   9 step    17310 | batches    502 / 2101 | lr 6.644e-03 | ms/batch 398.8 | tok/s  123253 | loss  3.45 | ppl     31.64
| epoch   9 step    17320 | batches    512 / 2101 | lr 6.640e-03 | ms/batch 399.9 | tok/s  122927 | loss  3.45 | ppl     31.36
| epoch   9 step    17330 | batches    522 / 2101 | lr 6.637e-03 | ms/batch 399.0 | tok/s  123190 | loss  3.41 | ppl     30.14
| epoch   9 step    17340 | batches    532 / 2101 | lr 6.633e-03 | ms/batch 398.7 | tok/s  123278 | loss  3.40 | ppl     30.07
| epoch   9 step    17350 | batches    542 / 2101 | lr 6.630e-03 | ms/batch 398.4 | tok/s  123359 | loss  3.41 | ppl     30.22
| epoch   9 step    17360 | batches    552 / 2101 | lr 6.626e-03 | ms/batch 407.8 | tok/s  120517 | loss  3.44 | ppl     31.12
| epoch   9 step    17370 | batches    562 / 2101 | lr 6.623e-03 | ms/batch 399.4 | tok/s  123054 | loss  3.43 | ppl     30.84
| epoch   9 step    17380 | batches    572 / 2101 | lr 6.619e-03 | ms/batch 410.4 | tok/s  119772 | loss  3.41 | ppl     30.39
| epoch   9 step    17390 | batches    582 / 2101 | lr 6.616e-03 | ms/batch 399.3 | tok/s  123089 | loss  3.45 | ppl     31.52
| epoch   9 step    17400 | batches    592 / 2101 | lr 6.612e-03 | ms/batch 409.8 | tok/s  119945 | loss  3.43 | ppl     30.98
| epoch   9 step    17410 | batches    602 / 2101 | lr 6.609e-03 | ms/batch 399.9 | tok/s  122907 | loss  3.43 | ppl     30.78
| epoch   9 step    17420 | batches    612 / 2101 | lr 6.605e-03 | ms/batch 398.8 | tok/s  123251 | loss  3.41 | ppl     30.13
| epoch   9 step    17430 | batches    622 / 2101 | lr 6.602e-03 | ms/batch 398.5 | tok/s  123333 | loss  3.41 | ppl     30.22
| epoch   9 step    17440 | batches    632 / 2101 | lr 6.598e-03 | ms/batch 398.6 | tok/s  123309 | loss  3.44 | ppl     31.04
| epoch   9 step    17450 | batches    642 / 2101 | lr 6.595e-03 | ms/batch 399.5 | tok/s  123034 | loss  3.44 | ppl     31.21
| epoch   9 step    17460 | batches    652 / 2101 | lr 6.591e-03 | ms/batch 400.0 | tok/s  122873 | loss  3.35 | ppl     28.51
| epoch   9 step    17470 | batches    662 / 2101 | lr 6.587e-03 | ms/batch 399.3 | tok/s  123082 | loss  3.38 | ppl     29.35
| epoch   9 step    17480 | batches    672 / 2101 | lr 6.584e-03 | ms/batch 398.8 | tok/s  123236 | loss  3.41 | ppl     30.41
| epoch   9 step    17490 | batches    682 / 2101 | lr 6.580e-03 | ms/batch 399.4 | tok/s  123060 | loss  3.44 | ppl     31.14
| epoch   9 step    17500 | batches    692 / 2101 | lr 6.577e-03 | ms/batch 399.6 | tok/s  122998 | loss  3.45 | ppl     31.47
----------------------------------------------------------------------------------------------------
| Eval  35 at step    17500 | time:  0.83s | valid loss  3.32 | valid ppl    27.636
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   9 step    17510 | batches    702 / 2101 | lr 6.573e-03 | ms/batch 401.2 | tok/s  122536 | loss  3.43 | ppl     30.86
| epoch   9 step    17520 | batches    712 / 2101 | lr 6.570e-03 | ms/batch 420.4 | tok/s  116906 | loss  3.45 | ppl     31.52
| epoch   9 step    17530 | batches    722 / 2101 | lr 6.566e-03 | ms/batch 399.4 | tok/s  123073 | loss  3.41 | ppl     30.26
| epoch   9 step    17540 | batches    732 / 2101 | lr 6.563e-03 | ms/batch 398.6 | tok/s  123324 | loss  3.45 | ppl     31.35
| epoch   9 step    17550 | batches    742 / 2101 | lr 6.559e-03 | ms/batch 398.0 | tok/s  123486 | loss  3.43 | ppl     30.98
| epoch   9 step    17560 | batches    752 / 2101 | lr 6.556e-03 | ms/batch 398.3 | tok/s  123396 | loss  3.46 | ppl     31.83
| epoch   9 step    17570 | batches    762 / 2101 | lr 6.552e-03 | ms/batch 398.2 | tok/s  123429 | loss  3.43 | ppl     30.80
| epoch   9 step    17580 | batches    772 / 2101 | lr 6.549e-03 | ms/batch 409.5 | tok/s  120029 | loss  3.42 | ppl     30.65
| epoch   9 step    17590 | batches    782 / 2101 | lr 6.545e-03 | ms/batch 398.6 | tok/s  123301 | loss  3.40 | ppl     30.04
| epoch   9 step    17600 | batches    792 / 2101 | lr 6.542e-03 | ms/batch 399.2 | tok/s  123140 | loss  3.40 | ppl     29.96
| epoch   9 step    17610 | batches    802 / 2101 | lr 6.538e-03 | ms/batch 398.5 | tok/s  123346 | loss  3.41 | ppl     30.33
| epoch   9 step    17620 | batches    812 / 2101 | lr 6.535e-03 | ms/batch 398.8 | tok/s  123258 | loss  3.39 | ppl     29.67
| epoch   9 step    17630 | batches    822 / 2101 | lr 6.531e-03 | ms/batch 397.9 | tok/s  123514 | loss  3.41 | ppl     30.19
| epoch   9 step    17640 | batches    832 / 2101 | lr 6.528e-03 | ms/batch 399.4 | tok/s  123070 | loss  3.46 | ppl     31.68
| epoch   9 step    17650 | batches    842 / 2101 | lr 6.524e-03 | ms/batch 399.9 | tok/s  122907 | loss  3.45 | ppl     31.41
| epoch   9 step    17660 | batches    852 / 2101 | lr 6.521e-03 | ms/batch 398.2 | tok/s  123439 | loss  3.42 | ppl     30.57
| epoch   9 step    17670 | batches    862 / 2101 | lr 6.517e-03 | ms/batch 409.7 | tok/s  119977 | loss  3.44 | ppl     31.27
| epoch   9 step    17680 | batches    872 / 2101 | lr 6.513e-03 | ms/batch 409.8 | tok/s  119938 | loss  3.44 | ppl     31.25
| epoch   9 step    17690 | batches    882 / 2101 | lr 6.510e-03 | ms/batch 399.2 | tok/s  123113 | loss  3.44 | ppl     31.14
| epoch   9 step    17700 | batches    892 / 2101 | lr 6.506e-03 | ms/batch 399.7 | tok/s  122975 | loss  3.44 | ppl     31.08
| epoch   9 step    17710 | batches    902 / 2101 | lr 6.503e-03 | ms/batch 399.0 | tok/s  123198 | loss  3.43 | ppl     30.95
| epoch   9 step    17720 | batches    912 / 2101 | lr 6.499e-03 | ms/batch 399.3 | tok/s  123099 | loss  3.43 | ppl     30.82
| epoch   9 step    17730 | batches    922 / 2101 | lr 6.496e-03 | ms/batch 399.5 | tok/s  123035 | loss  3.43 | ppl     30.80
| epoch   9 step    17740 | batches    932 / 2101 | lr 6.492e-03 | ms/batch 399.0 | tok/s  123197 | loss  3.42 | ppl     30.68
| epoch   9 step    17750 | batches    942 / 2101 | lr 6.489e-03 | ms/batch 399.4 | tok/s  123067 | loss  3.46 | ppl     31.78
| epoch   9 step    17760 | batches    952 / 2101 | lr 6.485e-03 | ms/batch 399.3 | tok/s  123106 | loss  3.45 | ppl     31.48
| epoch   9 step    17770 | batches    962 / 2101 | lr 6.482e-03 | ms/batch 399.7 | tok/s  122984 | loss  3.43 | ppl     30.89
| epoch   9 step    17780 | batches    972 / 2101 | lr 6.478e-03 | ms/batch 398.2 | tok/s  123426 | loss  3.41 | ppl     30.32
| epoch   9 step    17790 | batches    982 / 2101 | lr 6.475e-03 | ms/batch 398.9 | tok/s  123232 | loss  3.37 | ppl     29.05
| epoch   9 step    17800 | batches    992 / 2101 | lr 6.471e-03 | ms/batch 398.7 | tok/s  123274 | loss  3.43 | ppl     30.92
| epoch   9 step    17810 | batches   1002 / 2101 | lr 6.467e-03 | ms/batch 398.0 | tok/s  123514 | loss  3.42 | ppl     30.55
| epoch   9 step    17820 | batches   1012 / 2101 | lr 6.464e-03 | ms/batch 399.7 | tok/s  122962 | loss  3.40 | ppl     30.03
| epoch   9 step    17830 | batches   1022 / 2101 | lr 6.460e-03 | ms/batch 399.3 | tok/s  123084 | loss  3.39 | ppl     29.70
| epoch   9 step    17840 | batches   1032 / 2101 | lr 6.457e-03 | ms/batch 398.5 | tok/s  123338 | loss  3.41 | ppl     30.30
| epoch   9 step    17850 | batches   1042 / 2101 | lr 6.453e-03 | ms/batch 399.9 | tok/s  122921 | loss  3.41 | ppl     30.19
| epoch   9 step    17860 | batches   1052 / 2101 | lr 6.450e-03 | ms/batch 399.3 | tok/s  123099 | loss  3.42 | ppl     30.53
| epoch   9 step    17870 | batches   1062 / 2101 | lr 6.446e-03 | ms/batch 399.0 | tok/s  123185 | loss  3.43 | ppl     30.75
| epoch   9 step    17880 | batches   1072 / 2101 | lr 6.443e-03 | ms/batch 400.3 | tok/s  122796 | loss  3.40 | ppl     30.09
| epoch   9 step    17890 | batches   1082 / 2101 | lr 6.439e-03 | ms/batch 399.1 | tok/s  123161 | loss  3.45 | ppl     31.46
| epoch   9 step    17900 | batches   1092 / 2101 | lr 6.436e-03 | ms/batch 399.6 | tok/s  123012 | loss  3.39 | ppl     29.71
| epoch   9 step    17910 | batches   1102 / 2101 | lr 6.432e-03 | ms/batch 399.7 | tok/s  122977 | loss  3.40 | ppl     30.04
| epoch   9 step    17920 | batches   1112 / 2101 | lr 6.429e-03 | ms/batch 398.9 | tok/s  123207 | loss  3.40 | ppl     30.10
| epoch   9 step    17930 | batches   1122 / 2101 | lr 6.425e-03 | ms/batch 399.4 | tok/s  123081 | loss  3.44 | ppl     31.17
| epoch   9 step    17940 | batches   1132 / 2101 | lr 6.421e-03 | ms/batch 399.4 | tok/s  123074 | loss  3.40 | ppl     30.00
| epoch   9 step    17950 | batches   1142 / 2101 | lr 6.418e-03 | ms/batch 399.1 | tok/s  123144 | loss  3.44 | ppl     31.16
| epoch   9 step    17960 | batches   1152 / 2101 | lr 6.414e-03 | ms/batch 398.9 | tok/s  123231 | loss  3.43 | ppl     30.81
| epoch   9 step    17970 | batches   1162 / 2101 | lr 6.411e-03 | ms/batch 399.4 | tok/s  123053 | loss  3.42 | ppl     30.61
| epoch   9 step    17980 | batches   1172 / 2101 | lr 6.407e-03 | ms/batch 399.0 | tok/s  123180 | loss  3.40 | ppl     30.11
| epoch   9 step    17990 | batches   1182 / 2101 | lr 6.404e-03 | ms/batch 398.9 | tok/s  123206 | loss  3.38 | ppl     29.32
| epoch   9 step    18000 | batches   1192 / 2101 | lr 6.400e-03 | ms/batch 412.5 | tok/s  119168 | loss  3.40 | ppl     29.99
----------------------------------------------------------------------------------------------------
| Eval  36 at step    18000 | time:  0.82s | valid loss  3.31 | valid ppl    27.444
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.05618500809519422, 0.05884368595168006, 0.05575120866625188, 0.053300246600958064, 0.05468701244493794, 0.057130424685606314, 0.05896074754725893, 0.04841285860032418, 0.05214956422545998, 0.052625617638567816, 0.059405144511990964, 0.05817759484053297, 0.048887743893611696, 0.06962365536894416, 0.05716709315877243, 0.057856516354244256, 0.060774771451492154, 0.05280056339775656, 0.06240589384788841, 0.05657650561036407, 0.06218947350297443, 0.05815393460729578, 0.06423453859527938, 0.06042554410631486, 0.05668296791480907, 0.05854224044308808, 0.06077826322098452, 0.06569001185275887, 0.05711784563882688, 0.05728317198513785, 0.05709613669842992, 0.05897380987520097, 0.05084148073159024, 0.055266579973992196, 0.05424159196596584, 0.054297632422059726, 0.055625461515725956, 0.0486362611420709, 0.05146673954636311, 0.05615403595643082, 0.06129310043563821, 0.05705681853959438, 0.04226226393631695, 0.05335415278009949, 0.0520086775030556, 0.05526195347914895, 0.05601648317696011, 0.05065314890516027, 0.04864779429755972, 0.05355976247449376, 0.052024006822734836, 0.05451030095822082, 0.03792157078867675, 0.04511378409613999, 0.04959053465966519, 0.06121267137248212, 0.05479233006944428, 0.05312993672790893, 0.05009523481109149, 0.05012308118219596, 0.041801969778460256, 0.02643264476538529, 0.01671775777175195, 0.038875333825461975, 0.04584064450499476, 0.049624485166941894, 0.04301164915524338, 0.01683955368372739, 0.039897729564469846, 0.04755791918821444, 0.053733760753456344, 0.05379057673132156, 0.045147006868921806, 0.03760034733368509, 0.04309334329644515, 0.04910131929684043, 0.04334766722471516, 0.03414934341521872, 0.03694542407607744, 0.044260933484245056, 0.05522826997681579]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [50, 57, 8, 16, 12, 55, 77, 9, 24, 11], [42, 43, 20, 9, 8, 50, 57, 10, 8, 9], [34, 44, 8, 9, 8, 39, 50, 8, 8, 8], [32, 46, 9, 8, 8, 19, 16, 10, 8, 8], [8, 13, 9, 8, 8, 16, 20, 8, 8, 8], [10, 14, 8, 8, 8, 8, 13, 8, 8, 8], [8, 8, 9, 8, 8, 8, 9, 8, 8, 8], [9, 12, 8, 8, 8, 10, 10, 8, 8, 8], [8]]
optimal compression parameters =  [[], [50, 57, 8, 16, 12, 55, 77, 9, 24, 11], [42, 43, 20, 9, 8, 50, 57, 10, 8, 9], [34, 44, 8, 9, 8, 39, 50, 8, 8, 8], [32, 46, 9, 8, 8, 19, 16, 10, 8, 8], [8, 13, 9, 8, 8, 16, 20, 8, 8, 8], [10, 14, 8, 8, 8, 8, 13, 8, 8, 8], [8, 8, 9, 8, 8, 8, 9, 8, 8, 8], [9, 12, 8, 8, 8, 10, 10, 8, 8, 8], [8]]
| epoch   9 step    18010 | batches   1202 / 2101 | lr 6.397e-03 | ms/batch 4889.7 | tok/s   10052 | loss  3.40 | ppl     29.99
| epoch   9 step    18020 | batches   1212 / 2101 | lr 6.393e-03 | ms/batch 396.4 | tok/s  123992 | loss  3.43 | ppl     30.96
| epoch   9 step    18030 | batches   1222 / 2101 | lr 6.389e-03 | ms/batch 395.7 | tok/s  124227 | loss  3.40 | ppl     30.11
| epoch   9 step    18040 | batches   1232 / 2101 | lr 6.386e-03 | ms/batch 396.1 | tok/s  124078 | loss  3.42 | ppl     30.44
| epoch   9 step    18050 | batches   1242 / 2101 | lr 6.382e-03 | ms/batch 395.6 | tok/s  124241 | loss  3.41 | ppl     30.31
| epoch   9 step    18060 | batches   1252 / 2101 | lr 6.379e-03 | ms/batch 397.1 | tok/s  123783 | loss  3.43 | ppl     30.82
| epoch   9 step    18070 | batches   1262 / 2101 | lr 6.375e-03 | ms/batch 396.9 | tok/s  123846 | loss  3.47 | ppl     32.06
| epoch   9 step    18080 | batches   1272 / 2101 | lr 6.372e-03 | ms/batch 397.3 | tok/s  123702 | loss  3.45 | ppl     31.52
| epoch   9 step    18090 | batches   1282 / 2101 | lr 6.368e-03 | ms/batch 397.9 | tok/s  123515 | loss  3.43 | ppl     30.91
| epoch   9 step    18100 | batches   1292 / 2101 | lr 6.365e-03 | ms/batch 397.6 | tok/s  123614 | loss  3.43 | ppl     30.98
| epoch   9 step    18110 | batches   1302 / 2101 | lr 6.361e-03 | ms/batch 397.6 | tok/s  123627 | loss  3.46 | ppl     31.68
| epoch   9 step    18120 | batches   1312 / 2101 | lr 6.357e-03 | ms/batch 398.4 | tok/s  123381 | loss  3.45 | ppl     31.54
| epoch   9 step    18130 | batches   1322 / 2101 | lr 6.354e-03 | ms/batch 399.8 | tok/s  122931 | loss  3.49 | ppl     32.69
| epoch   9 step    18140 | batches   1332 / 2101 | lr 6.350e-03 | ms/batch 398.9 | tok/s  123230 | loss  3.47 | ppl     32.07
| epoch   9 step    18150 | batches   1342 / 2101 | lr 6.347e-03 | ms/batch 399.9 | tok/s  122906 | loss  3.45 | ppl     31.63
| epoch   9 step    18160 | batches   1352 / 2101 | lr 6.343e-03 | ms/batch 398.7 | tok/s  123285 | loss  3.44 | ppl     31.11
| epoch   9 step    18170 | batches   1362 / 2101 | lr 6.340e-03 | ms/batch 399.2 | tok/s  123115 | loss  3.46 | ppl     31.78
| epoch   9 step    18180 | batches   1372 / 2101 | lr 6.336e-03 | ms/batch 398.6 | tok/s  123304 | loss  3.42 | ppl     30.59
| epoch   9 step    18190 | batches   1382 / 2101 | lr 6.333e-03 | ms/batch 398.9 | tok/s  123217 | loss  3.45 | ppl     31.59
| epoch   9 step    18200 | batches   1392 / 2101 | lr 6.329e-03 | ms/batch 398.9 | tok/s  123213 | loss  3.48 | ppl     32.48
| epoch   9 step    18210 | batches   1402 / 2101 | lr 6.325e-03 | ms/batch 398.8 | tok/s  123244 | loss  3.49 | ppl     32.83
| epoch   9 step    18220 | batches   1412 / 2101 | lr 6.322e-03 | ms/batch 399.1 | tok/s  123165 | loss  3.45 | ppl     31.56
| epoch   9 step    18230 | batches   1422 / 2101 | lr 6.318e-03 | ms/batch 399.2 | tok/s  123119 | loss  3.44 | ppl     31.24
| epoch   9 step    18240 | batches   1432 / 2101 | lr 6.315e-03 | ms/batch 398.7 | tok/s  123287 | loss  3.46 | ppl     31.67
| epoch   9 step    18250 | batches   1442 / 2101 | lr 6.311e-03 | ms/batch 397.8 | tok/s  123569 | loss  3.40 | ppl     30.04
| epoch   9 step    18260 | batches   1452 / 2101 | lr 6.308e-03 | ms/batch 398.4 | tok/s  123376 | loss  3.42 | ppl     30.54
| epoch   9 step    18270 | batches   1462 / 2101 | lr 6.304e-03 | ms/batch 399.3 | tok/s  123110 | loss  3.42 | ppl     30.68
| epoch   9 step    18280 | batches   1472 / 2101 | lr 6.300e-03 | ms/batch 399.5 | tok/s  123045 | loss  3.43 | ppl     30.74
| epoch   9 step    18290 | batches   1482 / 2101 | lr 6.297e-03 | ms/batch 398.1 | tok/s  123479 | loss  3.39 | ppl     29.67
| epoch   9 step    18300 | batches   1492 / 2101 | lr 6.293e-03 | ms/batch 397.8 | tok/s  123571 | loss  3.42 | ppl     30.64
| epoch   9 step    18310 | batches   1502 / 2101 | lr 6.290e-03 | ms/batch 398.5 | tok/s  123340 | loss  3.41 | ppl     30.40
| epoch   9 step    18320 | batches   1512 / 2101 | lr 6.286e-03 | ms/batch 398.2 | tok/s  123449 | loss  3.41 | ppl     30.35
| epoch   9 step    18330 | batches   1522 / 2101 | lr 6.283e-03 | ms/batch 398.3 | tok/s  123421 | loss  3.40 | ppl     30.07
| epoch   9 step    18340 | batches   1532 / 2101 | lr 6.279e-03 | ms/batch 397.7 | tok/s  123606 | loss  3.40 | ppl     29.91
| epoch   9 step    18350 | batches   1542 / 2101 | lr 6.275e-03 | ms/batch 398.7 | tok/s  123297 | loss  3.41 | ppl     30.36
| epoch   9 step    18360 | batches   1552 / 2101 | lr 6.272e-03 | ms/batch 398.3 | tok/s  123402 | loss  3.38 | ppl     29.52
| epoch   9 step    18370 | batches   1562 / 2101 | lr 6.268e-03 | ms/batch 398.4 | tok/s  123384 | loss  3.40 | ppl     30.08
| epoch   9 step    18380 | batches   1572 / 2101 | lr 6.265e-03 | ms/batch 399.4 | tok/s  123056 | loss  3.42 | ppl     30.52
| epoch   9 step    18390 | batches   1582 / 2101 | lr 6.261e-03 | ms/batch 398.1 | tok/s  123460 | loss  3.42 | ppl     30.64
| epoch   9 step    18400 | batches   1592 / 2101 | lr 6.258e-03 | ms/batch 398.9 | tok/s  123233 | loss  3.43 | ppl     30.73
| epoch   9 step    18410 | batches   1602 / 2101 | lr 6.254e-03 | ms/batch 409.8 | tok/s  119943 | loss  3.45 | ppl     31.38
| epoch   9 step    18420 | batches   1612 / 2101 | lr 6.250e-03 | ms/batch 399.3 | tok/s  123086 | loss  3.39 | ppl     29.59
| epoch   9 step    18430 | batches   1622 / 2101 | lr 6.247e-03 | ms/batch 398.9 | tok/s  123228 | loss  3.41 | ppl     30.12
| epoch   9 step    18440 | batches   1632 / 2101 | lr 6.243e-03 | ms/batch 398.9 | tok/s  123211 | loss  3.42 | ppl     30.63
| epoch   9 step    18450 | batches   1642 / 2101 | lr 6.240e-03 | ms/batch 399.1 | tok/s  123162 | loss  3.42 | ppl     30.62
| epoch   9 step    18460 | batches   1652 / 2101 | lr 6.236e-03 | ms/batch 398.7 | tok/s  123285 | loss  3.46 | ppl     31.92
| epoch   9 step    18470 | batches   1662 / 2101 | lr 6.233e-03 | ms/batch 399.0 | tok/s  123186 | loss  3.45 | ppl     31.63
| epoch   9 step    18480 | batches   1672 / 2101 | lr 6.229e-03 | ms/batch 398.3 | tok/s  123408 | loss  3.41 | ppl     30.31
| epoch   9 step    18490 | batches   1682 / 2101 | lr 6.225e-03 | ms/batch 398.7 | tok/s  123277 | loss  3.42 | ppl     30.45
| epoch   9 step    18500 | batches   1692 / 2101 | lr 6.222e-03 | ms/batch 398.7 | tok/s  123296 | loss  3.42 | ppl     30.46
----------------------------------------------------------------------------------------------------
| Eval  37 at step    18500 | time:  0.82s | valid loss  3.31 | valid ppl    27.265
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch   9 step    18510 | batches   1702 / 2101 | lr 6.218e-03 | ms/batch 398.8 | tok/s  123249 | loss  3.42 | ppl     30.58
| epoch   9 step    18520 | batches   1712 / 2101 | lr 6.215e-03 | ms/batch 419.7 | tok/s  117101 | loss  3.43 | ppl     31.00
| epoch   9 step    18530 | batches   1722 / 2101 | lr 6.211e-03 | ms/batch 398.9 | tok/s  123209 | loss  3.43 | ppl     31.00
| epoch   9 step    18540 | batches   1732 / 2101 | lr 6.208e-03 | ms/batch 400.0 | tok/s  122891 | loss  3.43 | ppl     30.85
| epoch   9 step    18550 | batches   1742 / 2101 | lr 6.204e-03 | ms/batch 398.7 | tok/s  123290 | loss  3.44 | ppl     31.13
| epoch   9 step    18560 | batches   1752 / 2101 | lr 6.200e-03 | ms/batch 401.0 | tok/s  122581 | loss  3.42 | ppl     30.70
| epoch   9 step    18570 | batches   1762 / 2101 | lr 6.197e-03 | ms/batch 398.9 | tok/s  123211 | loss  3.40 | ppl     30.01
| epoch   9 step    18580 | batches   1772 / 2101 | lr 6.193e-03 | ms/batch 398.4 | tok/s  123359 | loss  3.39 | ppl     29.73
| epoch   9 step    18590 | batches   1782 / 2101 | lr 6.190e-03 | ms/batch 398.2 | tok/s  123450 | loss  3.43 | ppl     30.80
| epoch   9 step    18600 | batches   1792 / 2101 | lr 6.186e-03 | ms/batch 398.3 | tok/s  123419 | loss  3.42 | ppl     30.43
| epoch   9 step    18610 | batches   1802 / 2101 | lr 6.182e-03 | ms/batch 397.9 | tok/s  123516 | loss  3.43 | ppl     30.93
| epoch   9 step    18620 | batches   1812 / 2101 | lr 6.179e-03 | ms/batch 399.1 | tok/s  123158 | loss  3.38 | ppl     29.26
| epoch   9 step    18630 | batches   1822 / 2101 | lr 6.175e-03 | ms/batch 409.8 | tok/s  119950 | loss  3.43 | ppl     30.90
| epoch   9 step    18640 | batches   1832 / 2101 | lr 6.172e-03 | ms/batch 399.4 | tok/s  123068 | loss  3.41 | ppl     30.28
| epoch   9 step    18650 | batches   1842 / 2101 | lr 6.168e-03 | ms/batch 399.1 | tok/s  123147 | loss  3.46 | ppl     31.73
| epoch   9 step    18660 | batches   1852 / 2101 | lr 6.165e-03 | ms/batch 399.1 | tok/s  123156 | loss  3.43 | ppl     30.81
| epoch   9 step    18670 | batches   1862 / 2101 | lr 6.161e-03 | ms/batch 398.6 | tok/s  123318 | loss  3.38 | ppl     29.41
| epoch   9 step    18680 | batches   1872 / 2101 | lr 6.157e-03 | ms/batch 399.0 | tok/s  123178 | loss  3.38 | ppl     29.41
| epoch   9 step    18690 | batches   1882 / 2101 | lr 6.154e-03 | ms/batch 398.2 | tok/s  123423 | loss  3.40 | ppl     30.09
| epoch   9 step    18700 | batches   1892 / 2101 | lr 6.150e-03 | ms/batch 399.1 | tok/s  123144 | loss  3.44 | ppl     31.21
| epoch   9 step    18710 | batches   1902 / 2101 | lr 6.147e-03 | ms/batch 398.5 | tok/s  123332 | loss  3.45 | ppl     31.49
| epoch   9 step    18720 | batches   1912 / 2101 | lr 6.143e-03 | ms/batch 398.6 | tok/s  123317 | loss  3.45 | ppl     31.35
| epoch   9 step    18730 | batches   1922 / 2101 | lr 6.139e-03 | ms/batch 400.5 | tok/s  122728 | loss  3.48 | ppl     32.41
| epoch   9 step    18740 | batches   1932 / 2101 | lr 6.136e-03 | ms/batch 399.5 | tok/s  123037 | loss  3.46 | ppl     31.81
| epoch   9 step    18750 | batches   1942 / 2101 | lr 6.132e-03 | ms/batch 398.9 | tok/s  123211 | loss  3.44 | ppl     31.18
| epoch   9 step    18760 | batches   1952 / 2101 | lr 6.129e-03 | ms/batch 398.6 | tok/s  123308 | loss  3.41 | ppl     30.39
| epoch   9 step    18770 | batches   1962 / 2101 | lr 6.125e-03 | ms/batch 398.5 | tok/s  123344 | loss  3.38 | ppl     29.42
| epoch   9 step    18780 | batches   1972 / 2101 | lr 6.121e-03 | ms/batch 399.4 | tok/s  123078 | loss  3.37 | ppl     29.02
| epoch   9 step    18790 | batches   1982 / 2101 | lr 6.118e-03 | ms/batch 399.2 | tok/s  123113 | loss  3.36 | ppl     28.92
| epoch   9 step    18800 | batches   1992 / 2101 | lr 6.114e-03 | ms/batch 399.7 | tok/s  122967 | loss  3.41 | ppl     30.15
| epoch   9 step    18810 | batches   2002 / 2101 | lr 6.111e-03 | ms/batch 399.1 | tok/s  123161 | loss  3.41 | ppl     30.22
| epoch   9 step    18820 | batches   2012 / 2101 | lr 6.107e-03 | ms/batch 398.6 | tok/s  123323 | loss  3.45 | ppl     31.54
| epoch   9 step    18830 | batches   2022 / 2101 | lr 6.104e-03 | ms/batch 399.1 | tok/s  123168 | loss  3.43 | ppl     31.01
| epoch   9 step    18840 | batches   2032 / 2101 | lr 6.100e-03 | ms/batch 399.9 | tok/s  122927 | loss  3.43 | ppl     30.77
| epoch   9 step    18850 | batches   2042 / 2101 | lr 6.096e-03 | ms/batch 398.8 | tok/s  123265 | loss  3.43 | ppl     30.73
| epoch   9 step    18860 | batches   2052 / 2101 | lr 6.093e-03 | ms/batch 399.2 | tok/s  123118 | loss  3.44 | ppl     31.30
| epoch   9 step    18870 | batches   2062 / 2101 | lr 6.089e-03 | ms/batch 399.8 | tok/s  122942 | loss  3.46 | ppl     31.71
| epoch   9 step    18880 | batches   2072 / 2101 | lr 6.086e-03 | ms/batch 398.5 | tok/s  123335 | loss  3.38 | ppl     29.46
| epoch   9 step    18890 | batches   2082 / 2101 | lr 6.082e-03 | ms/batch 398.9 | tok/s  123231 | loss  3.43 | ppl     30.82
| epoch   9 step    18900 | batches   2092 / 2101 | lr 6.078e-03 | ms/batch 399.6 | tok/s  123010 | loss  3.40 | ppl     29.95
| epoch  10 step    18910 | batches      1 / 2101 | lr 6.075e-03 | ms/batch 404.5 | tok/s  122612 | loss  3.91 | ppl     49.81
| epoch  10 step    18920 | batches     11 / 2101 | lr 6.071e-03 | ms/batch 399.2 | tok/s  123139 | loss  3.36 | ppl     28.79
| epoch  10 step    18930 | batches     21 / 2101 | lr 6.068e-03 | ms/batch 399.9 | tok/s  122918 | loss  3.36 | ppl     28.88
| epoch  10 step    18940 | batches     31 / 2101 | lr 6.064e-03 | ms/batch 399.5 | tok/s  123041 | loss  3.37 | ppl     29.19
| epoch  10 step    18950 | batches     41 / 2101 | lr 6.060e-03 | ms/batch 398.9 | tok/s  123221 | loss  3.38 | ppl     29.33
| epoch  10 step    18960 | batches     51 / 2101 | lr 6.057e-03 | ms/batch 399.0 | tok/s  123198 | loss  3.39 | ppl     29.77
| epoch  10 step    18970 | batches     61 / 2101 | lr 6.053e-03 | ms/batch 398.8 | tok/s  123240 | loss  3.37 | ppl     29.16
| epoch  10 step    18980 | batches     71 / 2101 | lr 6.050e-03 | ms/batch 398.1 | tok/s  123469 | loss  3.31 | ppl     27.35
| epoch  10 step    18990 | batches     81 / 2101 | lr 6.046e-03 | ms/batch 398.9 | tok/s  123213 | loss  3.33 | ppl     27.93
| epoch  10 step    19000 | batches     91 / 2101 | lr 6.042e-03 | ms/batch 413.3 | tok/s  118924 | loss  3.37 | ppl     28.95
----------------------------------------------------------------------------------------------------
| Eval  38 at step    19000 | time:  0.82s | valid loss  3.30 | valid ppl    27.116
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.05089182695322258, 0.052820169095159894, 0.05469449430776467, 0.04832877996880269, 0.04966336159908635, 0.05057927327205519, 0.05349765447851009, 0.06312771118771165, 0.05566215976180411, 0.04782220340116247, 0.05559216702451169, 0.05350876015522592, 0.047074957873775074, 0.05876520632910748, 0.051668119737603366, 0.05426581580091401, 0.0547620324048752, 0.056020832503311996, 0.05348853747477023, 0.05105908223702568, 0.05319208212480612, 0.05215148675868681, 0.04821351906569516, 0.05139062998421918, 0.05164058880549123, 0.05375296781295102, 0.05510572417154354, 0.05164315616072553, 0.05390977534730503, 0.05259032624342596, 0.05345759724394925, 0.052642695660897194, 0.04973633438044101, 0.049925416335906414, 0.049543134769812605, 0.04837277395130102, 0.04989405443200559, 0.04865632491202309, 0.05031041804727029, 0.051011838835652676, 0.057102407622693495, 0.05129429303423646, 0.0445257168555929, 0.04865069586429818, 0.046686663010373566, 0.049063576651260536, 0.0498552203124356, 0.04256064824344388, 0.04576866511345066, 0.0484825382490178, 0.050028903595789584, 0.04571578886698355, 0.06357515554873559, 0.040514172145162286, 0.04379691413644689, 0.05146862969345338, 0.048765752751782535, 0.05480660909375878, 0.042247307837478765, 0.044979959464994536, 0.040520258831451106, 0.02608941414732533, 0.012992679135657872, 0.03473352359953297, 0.04151629901823352, 0.04445789494541539, 0.0371325112449556, 0.0023781872682347984, 0.037167170396368264, 0.04338981321411445, 0.04828235898233068, 0.04660347138861146, 0.019264551766979023, 0.03361822821486036, 0.039302046812485426, 0.04242942011146783, 0.03923361755172194, 0.0432096517065633, 0.03333058652378337, 0.041171273749981835, 0.052416941265461287]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [51, 64, 8, 15, 9, 53, 81, 9, 23, 10], [41, 39, 18, 8, 8, 44, 55, 8, 8, 8], [29, 43, 8, 8, 8, 33, 54, 8, 8, 8], [34, 52, 9, 8, 8, 22, 19, 10, 8, 8], [10, 19, 9, 8, 8, 22, 26, 8, 8, 8], [13, 15, 8, 8, 8, 10, 13, 9, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [8, 12, 8, 8, 8, 10, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [51, 64, 8, 15, 9, 53, 81, 9, 23, 10], [41, 39, 18, 8, 8, 44, 55, 8, 8, 8], [29, 43, 8, 8, 8, 33, 54, 8, 8, 8], [34, 52, 9, 8, 8, 22, 19, 10, 8, 8], [10, 19, 9, 8, 8, 22, 26, 8, 8, 8], [13, 15, 8, 8, 8, 10, 13, 9, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [8, 12, 8, 8, 8, 10, 9, 8, 8, 8], [8]]
| epoch  10 step    19010 | batches    101 / 2101 | lr 6.039e-03 | ms/batch 4887.9 | tok/s   10056 | loss  3.35 | ppl     28.40
| epoch  10 step    19020 | batches    111 / 2101 | lr 6.035e-03 | ms/batch 419.3 | tok/s  117233 | loss  3.33 | ppl     28.01
| epoch  10 step    19030 | batches    121 / 2101 | lr 6.032e-03 | ms/batch 409.6 | tok/s  120014 | loss  3.32 | ppl     27.71
| epoch  10 step    19040 | batches    131 / 2101 | lr 6.028e-03 | ms/batch 397.2 | tok/s  123735 | loss  3.34 | ppl     28.20
| epoch  10 step    19050 | batches    141 / 2101 | lr 6.024e-03 | ms/batch 397.9 | tok/s  123541 | loss  3.35 | ppl     28.52
| epoch  10 step    19060 | batches    151 / 2101 | lr 6.021e-03 | ms/batch 397.7 | tok/s  123590 | loss  3.35 | ppl     28.51
| epoch  10 step    19070 | batches    161 / 2101 | lr 6.017e-03 | ms/batch 397.3 | tok/s  123706 | loss  3.36 | ppl     28.82
| epoch  10 step    19080 | batches    171 / 2101 | lr 6.014e-03 | ms/batch 396.7 | tok/s  123906 | loss  3.37 | ppl     29.15
| epoch  10 step    19090 | batches    181 / 2101 | lr 6.010e-03 | ms/batch 408.0 | tok/s  120482 | loss  3.38 | ppl     29.32
| epoch  10 step    19100 | batches    191 / 2101 | lr 6.006e-03 | ms/batch 398.3 | tok/s  123407 | loss  3.38 | ppl     29.35
| epoch  10 step    19110 | batches    201 / 2101 | lr 6.003e-03 | ms/batch 398.4 | tok/s  123389 | loss  3.38 | ppl     29.35
| epoch  10 step    19120 | batches    211 / 2101 | lr 5.999e-03 | ms/batch 397.6 | tok/s  123618 | loss  3.34 | ppl     28.18
| epoch  10 step    19130 | batches    221 / 2101 | lr 5.996e-03 | ms/batch 397.8 | tok/s  123548 | loss  3.37 | ppl     28.98
| epoch  10 step    19140 | batches    231 / 2101 | lr 5.992e-03 | ms/batch 409.6 | tok/s  120016 | loss  3.39 | ppl     29.65
| epoch  10 step    19150 | batches    241 / 2101 | lr 5.988e-03 | ms/batch 410.1 | tok/s  119847 | loss  3.37 | ppl     29.06
| epoch  10 step    19160 | batches    251 / 2101 | lr 5.985e-03 | ms/batch 399.2 | tok/s  123135 | loss  3.37 | ppl     29.04
| epoch  10 step    19170 | batches    261 / 2101 | lr 5.981e-03 | ms/batch 399.8 | tok/s  122957 | loss  3.36 | ppl     28.75
| epoch  10 step    19180 | batches    271 / 2101 | lr 5.978e-03 | ms/batch 399.0 | tok/s  123186 | loss  3.40 | ppl     29.95
| epoch  10 step    19190 | batches    281 / 2101 | lr 5.974e-03 | ms/batch 409.0 | tok/s  120184 | loss  3.34 | ppl     28.28
| epoch  10 step    19200 | batches    291 / 2101 | lr 5.970e-03 | ms/batch 398.5 | tok/s  123337 | loss  3.39 | ppl     29.61
| epoch  10 step    19210 | batches    301 / 2101 | lr 5.967e-03 | ms/batch 398.4 | tok/s  123387 | loss  3.38 | ppl     29.42
| epoch  10 step    19220 | batches    311 / 2101 | lr 5.963e-03 | ms/batch 398.3 | tok/s  123416 | loss  3.37 | ppl     29.11
| epoch  10 step    19230 | batches    321 / 2101 | lr 5.960e-03 | ms/batch 398.3 | tok/s  123394 | loss  3.37 | ppl     28.99
| epoch  10 step    19240 | batches    331 / 2101 | lr 5.956e-03 | ms/batch 399.1 | tok/s  123165 | loss  3.35 | ppl     28.54
| epoch  10 step    19250 | batches    341 / 2101 | lr 5.952e-03 | ms/batch 398.2 | tok/s  123435 | loss  3.42 | ppl     30.61
| epoch  10 step    19260 | batches    351 / 2101 | lr 5.949e-03 | ms/batch 398.0 | tok/s  123513 | loss  3.34 | ppl     28.10
| epoch  10 step    19270 | batches    361 / 2101 | lr 5.945e-03 | ms/batch 398.5 | tok/s  123346 | loss  3.35 | ppl     28.55
| epoch  10 step    19280 | batches    371 / 2101 | lr 5.942e-03 | ms/batch 399.2 | tok/s  123115 | loss  3.39 | ppl     29.56
| epoch  10 step    19290 | batches    381 / 2101 | lr 5.938e-03 | ms/batch 399.7 | tok/s  122987 | loss  3.38 | ppl     29.32
| epoch  10 step    19300 | batches    391 / 2101 | lr 5.934e-03 | ms/batch 399.2 | tok/s  123135 | loss  3.40 | ppl     29.97
| epoch  10 step    19310 | batches    401 / 2101 | lr 5.931e-03 | ms/batch 398.8 | tok/s  123247 | loss  3.34 | ppl     28.18
| epoch  10 step    19320 | batches    411 / 2101 | lr 5.927e-03 | ms/batch 399.2 | tok/s  123138 | loss  3.37 | ppl     29.10
| epoch  10 step    19330 | batches    421 / 2101 | lr 5.923e-03 | ms/batch 399.4 | tok/s  123064 | loss  3.34 | ppl     28.11
| epoch  10 step    19340 | batches    431 / 2101 | lr 5.920e-03 | ms/batch 399.8 | tok/s  122938 | loss  3.37 | ppl     29.18
| epoch  10 step    19350 | batches    441 / 2101 | lr 5.916e-03 | ms/batch 399.0 | tok/s  123178 | loss  3.40 | ppl     30.02
| epoch  10 step    19360 | batches    451 / 2101 | lr 5.913e-03 | ms/batch 399.0 | tok/s  123184 | loss  3.38 | ppl     29.43
| epoch  10 step    19370 | batches    461 / 2101 | lr 5.909e-03 | ms/batch 398.7 | tok/s  123271 | loss  3.38 | ppl     29.37
| epoch  10 step    19380 | batches    471 / 2101 | lr 5.905e-03 | ms/batch 398.6 | tok/s  123301 | loss  3.36 | ppl     28.77
| epoch  10 step    19390 | batches    481 / 2101 | lr 5.902e-03 | ms/batch 398.2 | tok/s  123434 | loss  3.37 | ppl     29.08
| epoch  10 step    19400 | batches    491 / 2101 | lr 5.898e-03 | ms/batch 398.2 | tok/s  123424 | loss  3.36 | ppl     28.83
| epoch  10 step    19410 | batches    501 / 2101 | lr 5.895e-03 | ms/batch 399.0 | tok/s  123200 | loss  3.40 | ppl     29.87
| epoch  10 step    19420 | batches    511 / 2101 | lr 5.891e-03 | ms/batch 398.7 | tok/s  123270 | loss  3.38 | ppl     29.27
| epoch  10 step    19430 | batches    521 / 2101 | lr 5.887e-03 | ms/batch 398.8 | tok/s  123244 | loss  3.40 | ppl     29.89
| epoch  10 step    19440 | batches    531 / 2101 | lr 5.884e-03 | ms/batch 399.0 | tok/s  123180 | loss  3.40 | ppl     29.90
| epoch  10 step    19450 | batches    541 / 2101 | lr 5.880e-03 | ms/batch 398.7 | tok/s  123267 | loss  3.36 | ppl     28.93
| epoch  10 step    19460 | batches    551 / 2101 | lr 5.877e-03 | ms/batch 398.7 | tok/s  123296 | loss  3.35 | ppl     28.62
| epoch  10 step    19470 | batches    561 / 2101 | lr 5.873e-03 | ms/batch 398.6 | tok/s  123317 | loss  3.36 | ppl     28.76
| epoch  10 step    19480 | batches    571 / 2101 | lr 5.869e-03 | ms/batch 399.9 | tok/s  122899 | loss  3.35 | ppl     28.41
| epoch  10 step    19490 | batches    581 / 2101 | lr 5.866e-03 | ms/batch 399.4 | tok/s  123079 | loss  3.30 | ppl     27.18
| epoch  10 step    19500 | batches    591 / 2101 | lr 5.862e-03 | ms/batch 399.1 | tok/s  123157 | loss  3.34 | ppl     28.26
----------------------------------------------------------------------------------------------------
| Eval  39 at step    19500 | time:  0.82s | valid loss  3.29 | valid ppl    26.813
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  10 step    19510 | batches    601 / 2101 | lr 5.858e-03 | ms/batch 400.8 | tok/s  122658 | loss  3.38 | ppl     29.33
| epoch  10 step    19520 | batches    611 / 2101 | lr 5.855e-03 | ms/batch 420.0 | tok/s  117019 | loss  3.36 | ppl     28.74
| epoch  10 step    19530 | batches    621 / 2101 | lr 5.851e-03 | ms/batch 409.2 | tok/s  120113 | loss  3.38 | ppl     29.35
| epoch  10 step    19540 | batches    631 / 2101 | lr 5.848e-03 | ms/batch 397.9 | tok/s  123537 | loss  3.38 | ppl     29.27
| epoch  10 step    19550 | batches    641 / 2101 | lr 5.844e-03 | ms/batch 408.5 | tok/s  120337 | loss  3.36 | ppl     28.88
| epoch  10 step    19560 | batches    651 / 2101 | lr 5.840e-03 | ms/batch 409.4 | tok/s  120059 | loss  3.40 | ppl     30.07
| epoch  10 step    19570 | batches    661 / 2101 | lr 5.837e-03 | ms/batch 398.0 | tok/s  123489 | loss  3.35 | ppl     28.55
| epoch  10 step    19580 | batches    671 / 2101 | lr 5.833e-03 | ms/batch 397.9 | tok/s  123540 | loss  3.32 | ppl     27.75
| epoch  10 step    19590 | batches    681 / 2101 | lr 5.830e-03 | ms/batch 398.6 | tok/s  123302 | loss  3.37 | ppl     29.22
| epoch  10 step    19600 | batches    691 / 2101 | lr 5.826e-03 | ms/batch 397.4 | tok/s  123692 | loss  3.34 | ppl     28.35
| epoch  10 step    19610 | batches    701 / 2101 | lr 5.822e-03 | ms/batch 397.7 | tok/s  123605 | loss  3.32 | ppl     27.71
| epoch  10 step    19620 | batches    711 / 2101 | lr 5.819e-03 | ms/batch 397.0 | tok/s  123811 | loss  3.34 | ppl     28.11
| epoch  10 step    19630 | batches    721 / 2101 | lr 5.815e-03 | ms/batch 397.5 | tok/s  123640 | loss  3.38 | ppl     29.34
| epoch  10 step    19640 | batches    731 / 2101 | lr 5.811e-03 | ms/batch 398.1 | tok/s  123458 | loss  3.39 | ppl     29.59
| epoch  10 step    19650 | batches    741 / 2101 | lr 5.808e-03 | ms/batch 398.1 | tok/s  123471 | loss  3.36 | ppl     28.91
| epoch  10 step    19660 | batches    751 / 2101 | lr 5.804e-03 | ms/batch 398.1 | tok/s  123459 | loss  3.36 | ppl     28.78
| epoch  10 step    19670 | batches    761 / 2101 | lr 5.801e-03 | ms/batch 397.6 | tok/s  123631 | loss  3.37 | ppl     29.14
| epoch  10 step    19680 | batches    771 / 2101 | lr 5.797e-03 | ms/batch 397.3 | tok/s  123724 | loss  3.39 | ppl     29.69
| epoch  10 step    19690 | batches    781 / 2101 | lr 5.793e-03 | ms/batch 398.0 | tok/s  123506 | loss  3.42 | ppl     30.45
| epoch  10 step    19700 | batches    791 / 2101 | lr 5.790e-03 | ms/batch 398.1 | tok/s  123467 | loss  3.40 | ppl     29.82
| epoch  10 step    19710 | batches    801 / 2101 | lr 5.786e-03 | ms/batch 397.4 | tok/s  123672 | loss  3.42 | ppl     30.56
| epoch  10 step    19720 | batches    811 / 2101 | lr 5.783e-03 | ms/batch 398.9 | tok/s  123209 | loss  3.42 | ppl     30.54
| epoch  10 step    19730 | batches    821 / 2101 | lr 5.779e-03 | ms/batch 398.3 | tok/s  123404 | loss  3.39 | ppl     29.63
| epoch  10 step    19740 | batches    831 / 2101 | lr 5.775e-03 | ms/batch 399.4 | tok/s  123056 | loss  3.40 | ppl     30.08
| epoch  10 step    19750 | batches    841 / 2101 | lr 5.772e-03 | ms/batch 397.8 | tok/s  123565 | loss  3.39 | ppl     29.64
| epoch  10 step    19760 | batches    851 / 2101 | lr 5.768e-03 | ms/batch 408.7 | tok/s  120272 | loss  3.38 | ppl     29.37
| epoch  10 step    19770 | batches    861 / 2101 | lr 5.764e-03 | ms/batch 398.3 | tok/s  123411 | loss  3.38 | ppl     29.31
| epoch  10 step    19780 | batches    871 / 2101 | lr 5.761e-03 | ms/batch 409.2 | tok/s  120125 | loss  3.35 | ppl     28.47
| epoch  10 step    19790 | batches    881 / 2101 | lr 5.757e-03 | ms/batch 398.8 | tok/s  123251 | loss  3.33 | ppl     27.99
| epoch  10 step    19800 | batches    891 / 2101 | lr 5.754e-03 | ms/batch 398.5 | tok/s  123344 | loss  3.37 | ppl     29.18
| epoch  10 step    19810 | batches    901 / 2101 | lr 5.750e-03 | ms/batch 398.1 | tok/s  123462 | loss  3.37 | ppl     29.07
| epoch  10 step    19820 | batches    911 / 2101 | lr 5.746e-03 | ms/batch 398.8 | tok/s  123251 | loss  3.38 | ppl     29.43
| epoch  10 step    19830 | batches    921 / 2101 | lr 5.743e-03 | ms/batch 399.1 | tok/s  123164 | loss  3.37 | ppl     29.00
| epoch  10 step    19840 | batches    931 / 2101 | lr 5.739e-03 | ms/batch 399.8 | tok/s  122933 | loss  3.38 | ppl     29.46
| epoch  10 step    19850 | batches    941 / 2101 | lr 5.736e-03 | ms/batch 410.7 | tok/s  119668 | loss  3.40 | ppl     29.82
| epoch  10 step    19860 | batches    951 / 2101 | lr 5.732e-03 | ms/batch 410.6 | tok/s  119715 | loss  3.44 | ppl     31.07
| epoch  10 step    19870 | batches    961 / 2101 | lr 5.728e-03 | ms/batch 399.2 | tok/s  123123 | loss  3.43 | ppl     30.84
| epoch  10 step    19880 | batches    971 / 2101 | lr 5.725e-03 | ms/batch 399.1 | tok/s  123148 | loss  3.42 | ppl     30.47
| epoch  10 step    19890 | batches    981 / 2101 | lr 5.721e-03 | ms/batch 398.1 | tok/s  123476 | loss  3.40 | ppl     29.96
| epoch  10 step    19900 | batches    991 / 2101 | lr 5.717e-03 | ms/batch 398.9 | tok/s  123208 | loss  3.40 | ppl     29.82
| epoch  10 step    19910 | batches   1001 / 2101 | lr 5.714e-03 | ms/batch 409.9 | tok/s  119909 | loss  3.39 | ppl     29.67
| epoch  10 step    19920 | batches   1011 / 2101 | lr 5.710e-03 | ms/batch 399.5 | tok/s  123033 | loss  3.35 | ppl     28.36
| epoch  10 step    19930 | batches   1021 / 2101 | lr 5.707e-03 | ms/batch 397.7 | tok/s  123581 | loss  3.32 | ppl     27.64
| epoch  10 step    19940 | batches   1031 / 2101 | lr 5.703e-03 | ms/batch 409.0 | tok/s  120165 | loss  3.31 | ppl     27.32
| epoch  10 step    19950 | batches   1041 / 2101 | lr 5.699e-03 | ms/batch 410.1 | tok/s  119855 | loss  3.38 | ppl     29.41
| epoch  10 step    19960 | batches   1051 / 2101 | lr 5.696e-03 | ms/batch 399.1 | tok/s  123148 | loss  3.36 | ppl     28.67
| epoch  10 step    19970 | batches   1061 / 2101 | lr 5.692e-03 | ms/batch 410.1 | tok/s  119853 | loss  3.39 | ppl     29.61
| epoch  10 step    19980 | batches   1071 / 2101 | lr 5.688e-03 | ms/batch 398.8 | tok/s  123241 | loss  3.40 | ppl     29.89
| epoch  10 step    19990 | batches   1081 / 2101 | lr 5.685e-03 | ms/batch 409.7 | tok/s  119973 | loss  3.39 | ppl     29.65
| epoch  10 step    20000 | batches   1091 / 2101 | lr 5.681e-03 | ms/batch 412.1 | tok/s  119285 | loss  3.39 | ppl     29.54
----------------------------------------------------------------------------------------------------
| Eval  40 at step    20000 | time:  0.83s | valid loss  3.28 | valid ppl    26.599
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.05327826628482129, 0.053951353542941914, 0.05607946020991675, 0.05071346668942131, 0.05148187026172385, 0.05514167527725049, 0.054440089606894206, 0.05611211971216325, 0.053440081230517585, 0.049056041428962485, 0.0510330284984297, 0.053686670794399684, 0.046096776557350075, 0.062163044934130496, 0.05323768689063631, 0.05410008568809612, 0.05598857524849417, 0.06484553812622627, 0.057384310533451, 0.05276492611373666, 0.05493436929929079, 0.053495750100864506, 0.051940841037808806, 0.05571527638842067, 0.05191772371053676, 0.05278137549499935, 0.055778497126057744, 0.05942340538945385, 0.05136273200405889, 0.0522492268114989, 0.05423859394454865, 0.05362312167829243, 0.04733363493022637, 0.049583759764546154, 0.05040780155037606, 0.051148653145433674, 0.05097576832403722, 0.043623615238485465, 0.05008514590225357, 0.0523165912544236, 0.05793537827700127, 0.05064461804003295, 0.04919000533737976, 0.04937610771488094, 0.04658815050826885, 0.049041036737212544, 0.05241272812334083, 0.0566557887412025, 0.04598299126466091, 0.04951179089968698, 0.0534742486411083, 0.04907589729818858, 0.03383773636091325, 0.04100652695113509, 0.04524021516444994, 0.05951876251995158, 0.05188211315367102, 0.04863397477450429, 0.047618478208467284, 0.04651296817099626, 0.037358404363176986, 0.025370470172561357, 0.022060465413781784, 0.034479312838184346, 0.04220113181229705, 0.040230406905764585, 0.039581700639552755, 0.03466910811135874, 0.03815659837449541, 0.04435895238808641, 0.0496402819634132, 0.04823793881433381, 0.040213126836358346, 0.034377784325383874, 0.038478448964923945, 0.04376617876184404, 0.0407586714735049, 0.03965671045439285, 0.03406257882261736, 0.0407834934780238, 0.055068809125034666]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [47, 65, 8, 17, 10, 57, 83, 9, 24, 11], [44, 35, 16, 8, 9, 46, 62, 10, 9, 9], [33, 50, 8, 9, 8, 37, 47, 8, 8, 8], [33, 48, 9, 8, 8, 19, 19, 11, 8, 8], [11, 13, 9, 8, 8, 18, 20, 9, 8, 8], [9, 16, 8, 8, 8, 10, 13, 9, 8, 8], [8, 8, 8, 8, 8, 8, 9, 9, 8, 8], [10, 13, 8, 8, 8, 10, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [47, 65, 8, 17, 10, 57, 83, 9, 24, 11], [44, 35, 16, 8, 9, 46, 62, 10, 9, 9], [33, 50, 8, 9, 8, 37, 47, 8, 8, 8], [33, 48, 9, 8, 8, 19, 19, 11, 8, 8], [11, 13, 9, 8, 8, 18, 20, 9, 8, 8], [9, 16, 8, 8, 8, 10, 13, 9, 8, 8], [8, 8, 8, 8, 8, 8, 9, 9, 8, 8], [10, 13, 8, 8, 8, 10, 8, 8, 8, 8], [8]]
| epoch  10 step    20010 | batches   1101 / 2101 | lr 5.678e-03 | ms/batch 4891.3 | tok/s   10049 | loss  3.37 | ppl     29.20
| epoch  10 step    20020 | batches   1111 / 2101 | lr 5.674e-03 | ms/batch 410.1 | tok/s  119842 | loss  3.36 | ppl     28.85
| epoch  10 step    20030 | batches   1121 / 2101 | lr 5.670e-03 | ms/batch 396.3 | tok/s  124035 | loss  3.37 | ppl     29.10
| epoch  10 step    20040 | batches   1131 / 2101 | lr 5.667e-03 | ms/batch 395.5 | tok/s  124281 | loss  3.37 | ppl     29.13
| epoch  10 step    20050 | batches   1141 / 2101 | lr 5.663e-03 | ms/batch 396.4 | tok/s  123996 | loss  3.41 | ppl     30.27
| epoch  10 step    20060 | batches   1151 / 2101 | lr 5.659e-03 | ms/batch 398.9 | tok/s  123235 | loss  3.44 | ppl     31.31
| epoch  10 step    20070 | batches   1161 / 2101 | lr 5.656e-03 | ms/batch 398.0 | tok/s  123502 | loss  3.44 | ppl     31.32
| epoch  10 step    20080 | batches   1171 / 2101 | lr 5.652e-03 | ms/batch 396.8 | tok/s  123877 | loss  3.40 | ppl     29.92
| epoch  10 step    20090 | batches   1181 / 2101 | lr 5.649e-03 | ms/batch 398.6 | tok/s  123310 | loss  3.39 | ppl     29.72
| epoch  10 step    20100 | batches   1191 / 2101 | lr 5.645e-03 | ms/batch 398.0 | tok/s  123502 | loss  3.41 | ppl     30.36
| epoch  10 step    20110 | batches   1201 / 2101 | lr 5.641e-03 | ms/batch 398.3 | tok/s  123402 | loss  3.44 | ppl     31.04
| epoch  10 step    20120 | batches   1211 / 2101 | lr 5.638e-03 | ms/batch 397.8 | tok/s  123576 | loss  3.41 | ppl     30.26
| epoch  10 step    20130 | batches   1221 / 2101 | lr 5.634e-03 | ms/batch 398.0 | tok/s  123489 | loss  3.35 | ppl     28.54
| epoch  10 step    20140 | batches   1231 / 2101 | lr 5.630e-03 | ms/batch 398.4 | tok/s  123378 | loss  3.37 | ppl     29.07
| epoch  10 step    20150 | batches   1241 / 2101 | lr 5.627e-03 | ms/batch 398.7 | tok/s  123271 | loss  3.41 | ppl     30.26
| epoch  10 step    20160 | batches   1251 / 2101 | lr 5.623e-03 | ms/batch 398.5 | tok/s  123348 | loss  3.41 | ppl     30.15
| epoch  10 step    20170 | batches   1261 / 2101 | lr 5.620e-03 | ms/batch 398.5 | tok/s  123339 | loss  3.41 | ppl     30.23
| epoch  10 step    20180 | batches   1271 / 2101 | lr 5.616e-03 | ms/batch 398.4 | tok/s  123380 | loss  3.37 | ppl     29.08
| epoch  10 step    20190 | batches   1281 / 2101 | lr 5.612e-03 | ms/batch 398.7 | tok/s  123275 | loss  3.39 | ppl     29.67
| epoch  10 step    20200 | batches   1291 / 2101 | lr 5.609e-03 | ms/batch 398.4 | tok/s  123366 | loss  3.39 | ppl     29.57
| epoch  10 step    20210 | batches   1301 / 2101 | lr 5.605e-03 | ms/batch 400.4 | tok/s  122756 | loss  3.40 | ppl     29.95
| epoch  10 step    20220 | batches   1311 / 2101 | lr 5.601e-03 | ms/batch 399.3 | tok/s  123088 | loss  3.38 | ppl     29.27
| epoch  10 step    20230 | batches   1321 / 2101 | lr 5.598e-03 | ms/batch 399.6 | tok/s  123018 | loss  3.39 | ppl     29.57
| epoch  10 step    20240 | batches   1331 / 2101 | lr 5.594e-03 | ms/batch 399.1 | tok/s  123166 | loss  3.36 | ppl     28.76
| epoch  10 step    20250 | batches   1341 / 2101 | lr 5.591e-03 | ms/batch 399.0 | tok/s  123178 | loss  3.38 | ppl     29.23
| epoch  10 step    20260 | batches   1351 / 2101 | lr 5.587e-03 | ms/batch 398.8 | tok/s  123239 | loss  3.34 | ppl     28.24
| epoch  10 step    20270 | batches   1361 / 2101 | lr 5.583e-03 | ms/batch 410.8 | tok/s  119637 | loss  3.33 | ppl     28.01
| epoch  10 step    20280 | batches   1371 / 2101 | lr 5.580e-03 | ms/batch 399.5 | tok/s  123040 | loss  3.36 | ppl     28.65
| epoch  10 step    20290 | batches   1381 / 2101 | lr 5.576e-03 | ms/batch 399.7 | tok/s  122972 | loss  3.34 | ppl     28.32
| epoch  10 step    20300 | batches   1391 / 2101 | lr 5.572e-03 | ms/batch 399.1 | tok/s  123155 | loss  3.38 | ppl     29.43
| epoch  10 step    20310 | batches   1401 / 2101 | lr 5.569e-03 | ms/batch 399.3 | tok/s  123081 | loss  3.36 | ppl     28.84
| epoch  10 step    20320 | batches   1411 / 2101 | lr 5.565e-03 | ms/batch 399.5 | tok/s  123037 | loss  3.32 | ppl     27.73
| epoch  10 step    20330 | batches   1421 / 2101 | lr 5.562e-03 | ms/batch 400.0 | tok/s  122879 | loss  3.37 | ppl     29.02
| epoch  10 step    20340 | batches   1431 / 2101 | lr 5.558e-03 | ms/batch 400.1 | tok/s  122840 | loss  3.34 | ppl     28.20
| epoch  10 step    20350 | batches   1441 / 2101 | lr 5.554e-03 | ms/batch 399.7 | tok/s  122960 | loss  3.35 | ppl     28.46
| epoch  10 step    20360 | batches   1451 / 2101 | lr 5.551e-03 | ms/batch 399.4 | tok/s  123059 | loss  3.38 | ppl     29.35
| epoch  10 step    20370 | batches   1461 / 2101 | lr 5.547e-03 | ms/batch 400.4 | tok/s  122760 | loss  3.40 | ppl     29.92
| epoch  10 step    20380 | batches   1471 / 2101 | lr 5.543e-03 | ms/batch 399.7 | tok/s  122988 | loss  3.37 | ppl     29.09
| epoch  10 step    20390 | batches   1481 / 2101 | lr 5.540e-03 | ms/batch 400.3 | tok/s  122795 | loss  3.38 | ppl     29.45
| epoch  10 step    20400 | batches   1491 / 2101 | lr 5.536e-03 | ms/batch 399.4 | tok/s  123076 | loss  3.40 | ppl     30.00
| epoch  10 step    20410 | batches   1501 / 2101 | lr 5.533e-03 | ms/batch 399.4 | tok/s  123070 | loss  3.41 | ppl     30.28
| epoch  10 step    20420 | batches   1511 / 2101 | lr 5.529e-03 | ms/batch 399.9 | tok/s  122905 | loss  3.38 | ppl     29.31
| epoch  10 step    20430 | batches   1521 / 2101 | lr 5.525e-03 | ms/batch 399.9 | tok/s  122919 | loss  3.37 | ppl     28.97
| epoch  10 step    20440 | batches   1531 / 2101 | lr 5.522e-03 | ms/batch 398.7 | tok/s  123296 | loss  3.39 | ppl     29.61
| epoch  10 step    20450 | batches   1541 / 2101 | lr 5.518e-03 | ms/batch 398.5 | tok/s  123356 | loss  3.36 | ppl     28.86
| epoch  10 step    20460 | batches   1551 / 2101 | lr 5.514e-03 | ms/batch 399.4 | tok/s  123059 | loss  3.35 | ppl     28.41
| epoch  10 step    20470 | batches   1561 / 2101 | lr 5.511e-03 | ms/batch 399.3 | tok/s  123085 | loss  3.36 | ppl     28.77
| epoch  10 step    20480 | batches   1571 / 2101 | lr 5.507e-03 | ms/batch 399.5 | tok/s  123040 | loss  3.39 | ppl     29.78
| epoch  10 step    20490 | batches   1581 / 2101 | lr 5.504e-03 | ms/batch 399.8 | tok/s  122932 | loss  3.40 | ppl     30.01
| epoch  10 step    20500 | batches   1591 / 2101 | lr 5.500e-03 | ms/batch 399.7 | tok/s  122965 | loss  3.39 | ppl     29.56
----------------------------------------------------------------------------------------------------
| Eval  41 at step    20500 | time:  0.82s | valid loss  3.28 | valid ppl    26.459
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  10 step    20510 | batches   1601 / 2101 | lr 5.496e-03 | ms/batch 401.5 | tok/s  122434 | loss  3.34 | ppl     28.19
| epoch  10 step    20520 | batches   1611 / 2101 | lr 5.493e-03 | ms/batch 410.8 | tok/s  119658 | loss  3.32 | ppl     27.76
| epoch  10 step    20530 | batches   1621 / 2101 | lr 5.489e-03 | ms/batch 399.9 | tok/s  122905 | loss  3.38 | ppl     29.22
| epoch  10 step    20540 | batches   1631 / 2101 | lr 5.486e-03 | ms/batch 398.6 | tok/s  123319 | loss  3.40 | ppl     29.97
| epoch  10 step    20550 | batches   1641 / 2101 | lr 5.482e-03 | ms/batch 399.6 | tok/s  123005 | loss  3.38 | ppl     29.24
| epoch  10 step    20560 | batches   1651 / 2101 | lr 5.478e-03 | ms/batch 398.0 | tok/s  123483 | loss  3.35 | ppl     28.44
| epoch  10 step    20570 | batches   1661 / 2101 | lr 5.475e-03 | ms/batch 398.4 | tok/s  123369 | loss  3.41 | ppl     30.14
| epoch  10 step    20580 | batches   1671 / 2101 | lr 5.471e-03 | ms/batch 398.6 | tok/s  123318 | loss  3.40 | ppl     30.01
| epoch  10 step    20590 | batches   1681 / 2101 | lr 5.467e-03 | ms/batch 398.0 | tok/s  123510 | loss  3.38 | ppl     29.37
| epoch  10 step    20600 | batches   1691 / 2101 | lr 5.464e-03 | ms/batch 407.7 | tok/s  120560 | loss  3.35 | ppl     28.55
| epoch  10 step    20610 | batches   1701 / 2101 | lr 5.460e-03 | ms/batch 400.0 | tok/s  122887 | loss  3.35 | ppl     28.59
| epoch  10 step    20620 | batches   1711 / 2101 | lr 5.457e-03 | ms/batch 409.2 | tok/s  120123 | loss  3.37 | ppl     29.13
| epoch  10 step    20630 | batches   1721 / 2101 | lr 5.453e-03 | ms/batch 409.6 | tok/s  120010 | loss  3.37 | ppl     29.14
| epoch  10 step    20640 | batches   1731 / 2101 | lr 5.449e-03 | ms/batch 399.4 | tok/s  123076 | loss  3.38 | ppl     29.46
| epoch  10 step    20650 | batches   1741 / 2101 | lr 5.446e-03 | ms/batch 399.0 | tok/s  123194 | loss  3.39 | ppl     29.77
| epoch  10 step    20660 | batches   1751 / 2101 | lr 5.442e-03 | ms/batch 399.6 | tok/s  123002 | loss  3.40 | ppl     30.01
| epoch  10 step    20670 | batches   1761 / 2101 | lr 5.438e-03 | ms/batch 399.1 | tok/s  123149 | loss  3.38 | ppl     29.49
| epoch  10 step    20680 | batches   1771 / 2101 | lr 5.435e-03 | ms/batch 399.3 | tok/s  123102 | loss  3.38 | ppl     29.48
| epoch  10 step    20690 | batches   1781 / 2101 | lr 5.431e-03 | ms/batch 399.5 | tok/s  123049 | loss  3.37 | ppl     29.11
| epoch  10 step    20700 | batches   1791 / 2101 | lr 5.428e-03 | ms/batch 398.7 | tok/s  123273 | loss  3.38 | ppl     29.29
| epoch  10 step    20710 | batches   1801 / 2101 | lr 5.424e-03 | ms/batch 399.7 | tok/s  122972 | loss  3.38 | ppl     29.38
| epoch  10 step    20720 | batches   1811 / 2101 | lr 5.420e-03 | ms/batch 398.9 | tok/s  123234 | loss  3.37 | ppl     28.94
| epoch  10 step    20730 | batches   1821 / 2101 | lr 5.417e-03 | ms/batch 399.1 | tok/s  123154 | loss  3.38 | ppl     29.25
| epoch  10 step    20740 | batches   1831 / 2101 | lr 5.413e-03 | ms/batch 398.7 | tok/s  123269 | loss  3.38 | ppl     29.46
| epoch  10 step    20750 | batches   1841 / 2101 | lr 5.409e-03 | ms/batch 398.5 | tok/s  123342 | loss  3.42 | ppl     30.42
| epoch  10 step    20760 | batches   1851 / 2101 | lr 5.406e-03 | ms/batch 399.6 | tok/s  123000 | loss  3.39 | ppl     29.63
| epoch  10 step    20770 | batches   1861 / 2101 | lr 5.402e-03 | ms/batch 398.8 | tok/s  123247 | loss  3.38 | ppl     29.23
| epoch  10 step    20780 | batches   1871 / 2101 | lr 5.399e-03 | ms/batch 399.1 | tok/s  123166 | loss  3.36 | ppl     28.74
| epoch  10 step    20790 | batches   1881 / 2101 | lr 5.395e-03 | ms/batch 399.0 | tok/s  123195 | loss  3.35 | ppl     28.58
| epoch  10 step    20800 | batches   1891 / 2101 | lr 5.391e-03 | ms/batch 399.3 | tok/s  123110 | loss  3.34 | ppl     28.32
| epoch  10 step    20810 | batches   1901 / 2101 | lr 5.388e-03 | ms/batch 399.4 | tok/s  123059 | loss  3.35 | ppl     28.49
| epoch  10 step    20820 | batches   1911 / 2101 | lr 5.384e-03 | ms/batch 400.1 | tok/s  122857 | loss  3.40 | ppl     30.01
| epoch  10 step    20830 | batches   1921 / 2101 | lr 5.380e-03 | ms/batch 397.8 | tok/s  123574 | loss  3.38 | ppl     29.35
| epoch  10 step    20840 | batches   1931 / 2101 | lr 5.377e-03 | ms/batch 399.8 | tok/s  122939 | loss  3.38 | ppl     29.38
| epoch  10 step    20850 | batches   1941 / 2101 | lr 5.373e-03 | ms/batch 398.5 | tok/s  123345 | loss  3.34 | ppl     28.34
| epoch  10 step    20860 | batches   1951 / 2101 | lr 5.370e-03 | ms/batch 399.8 | tok/s  122932 | loss  3.39 | ppl     29.79
| epoch  10 step    20870 | batches   1961 / 2101 | lr 5.366e-03 | ms/batch 399.4 | tok/s  123065 | loss  3.38 | ppl     29.29
| epoch  10 step    20880 | batches   1971 / 2101 | lr 5.362e-03 | ms/batch 399.0 | tok/s  123174 | loss  3.37 | ppl     29.22
| epoch  10 step    20890 | batches   1981 / 2101 | lr 5.359e-03 | ms/batch 399.1 | tok/s  123151 | loss  3.41 | ppl     30.32
| epoch  10 step    20900 | batches   1991 / 2101 | lr 5.355e-03 | ms/batch 398.8 | tok/s  123255 | loss  3.37 | ppl     29.12
| epoch  10 step    20910 | batches   2001 / 2101 | lr 5.351e-03 | ms/batch 399.4 | tok/s  123057 | loss  3.40 | ppl     29.86
| epoch  10 step    20920 | batches   2011 / 2101 | lr 5.348e-03 | ms/batch 398.2 | tok/s  123438 | loss  3.41 | ppl     30.22
| epoch  10 step    20930 | batches   2021 / 2101 | lr 5.344e-03 | ms/batch 399.0 | tok/s  123178 | loss  3.41 | ppl     30.15
| epoch  10 step    20940 | batches   2031 / 2101 | lr 5.341e-03 | ms/batch 398.9 | tok/s  123232 | loss  3.38 | ppl     29.27
| epoch  10 step    20950 | batches   2041 / 2101 | lr 5.337e-03 | ms/batch 399.4 | tok/s  123060 | loss  3.35 | ppl     28.43
| epoch  10 step    20960 | batches   2051 / 2101 | lr 5.333e-03 | ms/batch 398.7 | tok/s  123270 | loss  3.38 | ppl     29.43
| epoch  10 step    20970 | batches   2061 / 2101 | lr 5.330e-03 | ms/batch 398.9 | tok/s  123209 | loss  3.38 | ppl     29.41
| epoch  10 step    20980 | batches   2071 / 2101 | lr 5.326e-03 | ms/batch 398.8 | tok/s  123249 | loss  3.37 | ppl     29.08
| epoch  10 step    20990 | batches   2081 / 2101 | lr 5.322e-03 | ms/batch 400.0 | tok/s  122886 | loss  3.37 | ppl     29.22
| epoch  10 step    21000 | batches   2091 / 2101 | lr 5.319e-03 | ms/batch 412.0 | tok/s  119289 | loss  3.35 | ppl     28.50
----------------------------------------------------------------------------------------------------
| Eval  42 at step    21000 | time:  0.82s | valid loss  3.27 | valid ppl    26.200
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.04758000200837593, 0.04808441673885219, 0.046472450233822245, 0.044551668382625455, 0.04472164881220867, 0.04787652996359663, 0.04843350609819041, 0.05274803187738165, 0.04228536370133454, 0.04259532889851329, 0.05251696112363701, 0.04915173476128393, 0.04245201638481846, 0.05116294357430772, 0.04784271274367804, 0.05176281293029169, 0.05047987522292146, 0.05006281633325893, 0.04861275585179685, 0.04666737237938301, 0.048331181079674185, 0.04836968613945294, 0.07518003617900909, 0.048385938737051756, 0.047734173889809904, 0.04966856003450668, 0.05076575591166239, 0.05844610015283462, 0.0491630242984656, 0.04862199963848921, 0.05124452330592323, 0.04597047741420382, 0.046589410727286944, 0.04475985584291483, 0.045716562118779135, 0.04540899355483338, 0.04706385974192713, 0.035006120633888985, 0.0446203693618747, 0.047227893032713464, 0.05817626143028409, 0.04789729547338102, 0.04391761026503708, 0.048376554130840264, 0.0449102052609378, 0.05068257461535799, 0.04621276669449054, 0.04397239303789265, 0.04446462030021826, 0.04599072097593987, 0.04397519379728844, 0.044914385716821666, 0.05134653694331319, 0.039911052498748496, 0.041682432749485514, 0.05165791070929402, 0.046206853183438715, 0.056285000374476674, 0.04667325181733309, 0.04296821193922074, 0.03392264660517618, 0.024400347975593064, 0.0175991691144569, 0.03185645551734068, 0.038995242627235464, 0.038130408401361435, 0.03696076048235362, 0.02189512605843367, 0.03519378438342832, 0.04026306180655559, 0.05112637529658385, 0.04432065862938726, 0.05895261986162417, 0.031090840723862964, 0.03768166113124571, 0.03993611247427287, 0.037092146349937946, 0.034627827720566065, 0.03099173930263143, 0.037372234526013126, 0.046561787752500194]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [54, 67, 8, 15, 10, 55, 79, 9, 24, 13], [39, 42, 16, 8, 8, 46, 61, 13, 9, 9], [32, 41, 8, 8, 8, 36, 54, 8, 8, 9], [28, 50, 9, 8, 8, 18, 16, 9, 8, 8], [9, 16, 9, 8, 8, 16, 20, 9, 8, 8], [8, 13, 8, 8, 8, 10, 13, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [10, 10, 8, 8, 8, 10, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [54, 67, 8, 15, 10, 55, 79, 9, 24, 13], [39, 42, 16, 8, 8, 46, 61, 13, 9, 9], [32, 41, 8, 8, 8, 36, 54, 8, 8, 9], [28, 50, 9, 8, 8, 18, 16, 9, 8, 8], [9, 16, 9, 8, 8, 16, 20, 9, 8, 8], [8, 13, 8, 8, 8, 10, 13, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [10, 10, 8, 8, 8, 10, 9, 8, 8, 8], [8]]
Compression stats: iter 21000, total before compression 3839197910298, total after compression 272944086522, rate 14.065876858587119
Compression stats: iter 21000, total before compression 3839197910298, total after compression 272944086522, rate 14.065876858587119
Compression stats: iter 21000, total before compression 3839197910298, total after compression 272944086522, rate 14.065876858587119
Compression stats: iter 21000, total before compression 3839197910298, total after compression 272944086522, rate 14.065876858587119
Compression stats: iter 21000, total before compression 3839197910298, total after compression 272944086522, rate 14.065876858587119
Compression stats: iter 21000, total before compression 3839197910298, total after compression 272944086522, rate 14.065876858587119
Compression stats: iter 21000, total before compression 3839197910298, total after compression 272944086522, rate 14.065876858587119
Compression stats: iter 21000, total before compression 3839197910298, total after compression 272944086522, rate 14.065876858587119
| epoch  10 step    21010 | batches   2101 / 2101 | lr 5.315e-03 | ms/batch 4863.8 | tok/s    9248 | loss  3.35 | ppl     28.56
| epoch  11 step    21020 | batches     10 / 2101 | lr 5.312e-03 | ms/batch 396.7 | tok/s  124075 | loss  3.39 | ppl     29.80
| epoch  11 step    21030 | batches     20 / 2101 | lr 5.308e-03 | ms/batch 395.7 | tok/s  124209 | loss  3.33 | ppl     27.82
| epoch  11 step    21040 | batches     30 / 2101 | lr 5.304e-03 | ms/batch 395.8 | tok/s  124178 | loss  3.33 | ppl     27.86
| epoch  11 step    21050 | batches     40 / 2101 | lr 5.301e-03 | ms/batch 396.4 | tok/s  124001 | loss  3.31 | ppl     27.44
| epoch  11 step    21060 | batches     50 / 2101 | lr 5.297e-03 | ms/batch 397.2 | tok/s  123735 | loss  3.31 | ppl     27.41
| epoch  11 step    21070 | batches     60 / 2101 | lr 5.293e-03 | ms/batch 397.6 | tok/s  123621 | loss  3.36 | ppl     28.85
| epoch  11 step    21080 | batches     70 / 2101 | lr 5.290e-03 | ms/batch 397.1 | tok/s  123792 | loss  3.34 | ppl     28.24
| epoch  11 step    21090 | batches     80 / 2101 | lr 5.286e-03 | ms/batch 396.7 | tok/s  123890 | loss  3.32 | ppl     27.70
| epoch  11 step    21100 | batches     90 / 2101 | lr 5.283e-03 | ms/batch 396.8 | tok/s  123860 | loss  3.34 | ppl     28.08
| epoch  11 step    21110 | batches    100 / 2101 | lr 5.279e-03 | ms/batch 397.6 | tok/s  123626 | loss  3.30 | ppl     27.23
| epoch  11 step    21120 | batches    110 / 2101 | lr 5.275e-03 | ms/batch 397.3 | tok/s  123710 | loss  3.34 | ppl     28.14
| epoch  11 step    21130 | batches    120 / 2101 | lr 5.272e-03 | ms/batch 397.7 | tok/s  123591 | loss  3.34 | ppl     28.21
| epoch  11 step    21140 | batches    130 / 2101 | lr 5.268e-03 | ms/batch 398.4 | tok/s  123378 | loss  3.36 | ppl     28.68
| epoch  11 step    21150 | batches    140 / 2101 | lr 5.264e-03 | ms/batch 397.8 | tok/s  123557 | loss  3.36 | ppl     28.82
| epoch  11 step    21160 | batches    150 / 2101 | lr 5.261e-03 | ms/batch 399.5 | tok/s  123047 | loss  3.37 | ppl     28.95
| epoch  11 step    21170 | batches    160 / 2101 | lr 5.257e-03 | ms/batch 399.2 | tok/s  123131 | loss  3.35 | ppl     28.47
| epoch  11 step    21180 | batches    170 / 2101 | lr 5.254e-03 | ms/batch 399.0 | tok/s  123198 | loss  3.32 | ppl     27.74
| epoch  11 step    21190 | batches    180 / 2101 | lr 5.250e-03 | ms/batch 397.9 | tok/s  123539 | loss  3.31 | ppl     27.45
| epoch  11 step    21200 | batches    190 / 2101 | lr 5.246e-03 | ms/batch 398.1 | tok/s  123481 | loss  3.34 | ppl     28.09
| epoch  11 step    21210 | batches    200 / 2101 | lr 5.243e-03 | ms/batch 397.7 | tok/s  123577 | loss  3.32 | ppl     27.72
| epoch  11 step    21220 | batches    210 / 2101 | lr 5.239e-03 | ms/batch 398.1 | tok/s  123460 | loss  3.34 | ppl     28.27
| epoch  11 step    21230 | batches    220 / 2101 | lr 5.236e-03 | ms/batch 399.2 | tok/s  123127 | loss  3.31 | ppl     27.49
| epoch  11 step    21240 | batches    230 / 2101 | lr 5.232e-03 | ms/batch 398.2 | tok/s  123421 | loss  3.32 | ppl     27.77
| epoch  11 step    21250 | batches    240 / 2101 | lr 5.228e-03 | ms/batch 397.5 | tok/s  123656 | loss  3.31 | ppl     27.36
| epoch  11 step    21260 | batches    250 / 2101 | lr 5.225e-03 | ms/batch 398.0 | tok/s  123502 | loss  3.28 | ppl     26.55
| epoch  11 step    21270 | batches    260 / 2101 | lr 5.221e-03 | ms/batch 397.3 | tok/s  123713 | loss  3.29 | ppl     26.92
| epoch  11 step    21280 | batches    270 / 2101 | lr 5.217e-03 | ms/batch 397.5 | tok/s  123654 | loss  3.27 | ppl     26.38
| epoch  11 step    21290 | batches    280 / 2101 | lr 5.214e-03 | ms/batch 397.7 | tok/s  123596 | loss  3.27 | ppl     26.22
| epoch  11 step    21300 | batches    290 / 2101 | lr 5.210e-03 | ms/batch 397.9 | tok/s  123530 | loss  3.29 | ppl     26.93
| epoch  11 step    21310 | batches    300 / 2101 | lr 5.207e-03 | ms/batch 398.0 | tok/s  123495 | loss  3.32 | ppl     27.74
| epoch  11 step    21320 | batches    310 / 2101 | lr 5.203e-03 | ms/batch 398.5 | tok/s  123335 | loss  3.31 | ppl     27.51
| epoch  11 step    21330 | batches    320 / 2101 | lr 5.199e-03 | ms/batch 397.7 | tok/s  123600 | loss  3.32 | ppl     27.68
| epoch  11 step    21340 | batches    330 / 2101 | lr 5.196e-03 | ms/batch 398.0 | tok/s  123504 | loss  3.34 | ppl     28.15
| epoch  11 step    21350 | batches    340 / 2101 | lr 5.192e-03 | ms/batch 398.4 | tok/s  123361 | loss  3.31 | ppl     27.52
| epoch  11 step    21360 | batches    350 / 2101 | lr 5.189e-03 | ms/batch 398.7 | tok/s  123273 | loss  3.33 | ppl     27.80
| epoch  11 step    21370 | batches    360 / 2101 | lr 5.185e-03 | ms/batch 397.8 | tok/s  123574 | loss  3.32 | ppl     27.67
| epoch  11 step    21380 | batches    370 / 2101 | lr 5.181e-03 | ms/batch 398.1 | tok/s  123475 | loss  3.33 | ppl     28.01
| epoch  11 step    21390 | batches    380 / 2101 | lr 5.178e-03 | ms/batch 398.4 | tok/s  123365 | loss  3.30 | ppl     27.01
| epoch  11 step    21400 | batches    390 / 2101 | lr 5.174e-03 | ms/batch 398.0 | tok/s  123497 | loss  3.29 | ppl     26.94
| epoch  11 step    21410 | batches    400 / 2101 | lr 5.170e-03 | ms/batch 397.9 | tok/s  123523 | loss  3.31 | ppl     27.37
| epoch  11 step    21420 | batches    410 / 2101 | lr 5.167e-03 | ms/batch 398.4 | tok/s  123382 | loss  3.33 | ppl     27.99
| epoch  11 step    21430 | batches    420 / 2101 | lr 5.163e-03 | ms/batch 398.3 | tok/s  123407 | loss  3.33 | ppl     27.85
| epoch  11 step    21440 | batches    430 / 2101 | lr 5.160e-03 | ms/batch 397.8 | tok/s  123551 | loss  3.30 | ppl     27.14
| epoch  11 step    21450 | batches    440 / 2101 | lr 5.156e-03 | ms/batch 398.5 | tok/s  123353 | loss  3.31 | ppl     27.37
| epoch  11 step    21460 | batches    450 / 2101 | lr 5.152e-03 | ms/batch 408.5 | tok/s  120317 | loss  3.33 | ppl     27.82
| epoch  11 step    21470 | batches    460 / 2101 | lr 5.149e-03 | ms/batch 408.3 | tok/s  120380 | loss  3.30 | ppl     27.14
| epoch  11 step    21480 | batches    470 / 2101 | lr 5.145e-03 | ms/batch 398.4 | tok/s  123376 | loss  3.29 | ppl     26.73
| epoch  11 step    21490 | batches    480 / 2101 | lr 5.142e-03 | ms/batch 398.0 | tok/s  123489 | loss  3.35 | ppl     28.52
| epoch  11 step    21500 | batches    490 / 2101 | lr 5.138e-03 | ms/batch 397.2 | tok/s  123750 | loss  3.35 | ppl     28.58
----------------------------------------------------------------------------------------------------
| Eval  43 at step    21500 | time:  0.82s | valid loss  3.27 | valid ppl    26.265
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
| epoch  11 step    21510 | batches    500 / 2101 | lr 5.134e-03 | ms/batch 398.1 | tok/s  123466 | loss  3.34 | ppl     28.25
| epoch  11 step    21520 | batches    510 / 2101 | lr 5.131e-03 | ms/batch 409.2 | tok/s  120125 | loss  3.36 | ppl     28.71
| epoch  11 step    21530 | batches    520 / 2101 | lr 5.127e-03 | ms/batch 407.9 | tok/s  120491 | loss  3.36 | ppl     28.74
| epoch  11 step    21540 | batches    530 / 2101 | lr 5.123e-03 | ms/batch 397.9 | tok/s  123529 | loss  3.31 | ppl     27.29
| epoch  11 step    21550 | batches    540 / 2101 | lr 5.120e-03 | ms/batch 408.2 | tok/s  120424 | loss  3.34 | ppl     28.10
| epoch  11 step    21560 | batches    550 / 2101 | lr 5.116e-03 | ms/batch 397.3 | tok/s  123705 | loss  3.36 | ppl     28.85
| epoch  11 step    21570 | batches    560 / 2101 | lr 5.113e-03 | ms/batch 397.8 | tok/s  123567 | loss  3.37 | ppl     29.16
| epoch  11 step    21580 | batches    570 / 2101 | lr 5.109e-03 | ms/batch 396.9 | tok/s  123825 | loss  3.37 | ppl     29.22
| epoch  11 step    21590 | batches    580 / 2101 | lr 5.105e-03 | ms/batch 397.7 | tok/s  123604 | loss  3.36 | ppl     28.78
| epoch  11 step    21600 | batches    590 / 2101 | lr 5.102e-03 | ms/batch 397.3 | tok/s  123702 | loss  3.37 | ppl     29.08
| epoch  11 step    21610 | batches    600 / 2101 | lr 5.098e-03 | ms/batch 397.9 | tok/s  123532 | loss  3.35 | ppl     28.62
| epoch  11 step    21620 | batches    610 / 2101 | lr 5.095e-03 | ms/batch 398.2 | tok/s  123443 | loss  3.36 | ppl     28.87
| epoch  11 step    21630 | batches    620 / 2101 | lr 5.091e-03 | ms/batch 397.5 | tok/s  123652 | loss  3.35 | ppl     28.60
| epoch  11 step    21640 | batches    630 / 2101 | lr 5.087e-03 | ms/batch 397.4 | tok/s  123671 | loss  3.34 | ppl     28.20
| epoch  11 step    21650 | batches    640 / 2101 | lr 5.084e-03 | ms/batch 397.0 | tok/s  123795 | loss  3.34 | ppl     28.26
| epoch  11 step    21660 | batches    650 / 2101 | lr 5.080e-03 | ms/batch 397.4 | tok/s  123697 | loss  3.35 | ppl     28.54
| epoch  11 step    21670 | batches    660 / 2101 | lr 5.077e-03 | ms/batch 397.6 | tok/s  123634 | loss  3.34 | ppl     28.27
| epoch  11 step    21680 | batches    670 / 2101 | lr 5.073e-03 | ms/batch 397.8 | tok/s  123559 | loss  3.37 | ppl     29.19
| epoch  11 step    21690 | batches    680 / 2101 | lr 5.069e-03 | ms/batch 397.8 | tok/s  123545 | loss  3.35 | ppl     28.38
| epoch  11 step    21700 | batches    690 / 2101 | lr 5.066e-03 | ms/batch 398.2 | tok/s  123442 | loss  3.34 | ppl     28.13
| epoch  11 step    21710 | batches    700 / 2101 | lr 5.062e-03 | ms/batch 397.7 | tok/s  123580 | loss  3.33 | ppl     27.90
| epoch  11 step    21720 | batches    710 / 2101 | lr 5.058e-03 | ms/batch 397.9 | tok/s  123519 | loss  3.34 | ppl     28.19
| epoch  11 step    21730 | batches    720 / 2101 | lr 5.055e-03 | ms/batch 398.0 | tok/s  123496 | loss  3.36 | ppl     28.78
| epoch  11 step    21740 | batches    730 / 2101 | lr 5.051e-03 | ms/batch 397.6 | tok/s  123618 | loss  3.33 | ppl     27.90
| epoch  11 step    21750 | batches    740 / 2101 | lr 5.048e-03 | ms/batch 397.9 | tok/s  123524 | loss  3.35 | ppl     28.45
| epoch  11 step    21760 | batches    750 / 2101 | lr 5.044e-03 | ms/batch 397.2 | tok/s  123743 | loss  3.33 | ppl     27.91
| epoch  11 step    21770 | batches    760 / 2101 | lr 5.040e-03 | ms/batch 398.1 | tok/s  123466 | loss  3.32 | ppl     27.57
| epoch  11 step    21780 | batches    770 / 2101 | lr 5.037e-03 | ms/batch 409.3 | tok/s  120102 | loss  3.27 | ppl     26.34
| epoch  11 step    21790 | batches    780 / 2101 | lr 5.033e-03 | ms/batch 397.9 | tok/s  123525 | loss  3.30 | ppl     27.09
| epoch  11 step    21800 | batches    790 / 2101 | lr 5.030e-03 | ms/batch 397.1 | tok/s  123772 | loss  3.31 | ppl     27.36
| epoch  11 step    21810 | batches    800 / 2101 | lr 5.026e-03 | ms/batch 397.3 | tok/s  123714 | loss  3.36 | ppl     28.73
| epoch  11 step    21820 | batches    810 / 2101 | lr 5.022e-03 | ms/batch 398.3 | tok/s  123410 | loss  3.36 | ppl     28.93
| epoch  11 step    21830 | batches    820 / 2101 | lr 5.019e-03 | ms/batch 397.7 | tok/s  123598 | loss  3.37 | ppl     29.07
| epoch  11 step    21840 | batches    830 / 2101 | lr 5.015e-03 | ms/batch 398.1 | tok/s  123482 | loss  3.33 | ppl     27.87
| epoch  11 step    21850 | batches    840 / 2101 | lr 5.012e-03 | ms/batch 398.1 | tok/s  123467 | loss  3.31 | ppl     27.42
| epoch  11 step    21860 | batches    850 / 2101 | lr 5.008e-03 | ms/batch 398.2 | tok/s  123433 | loss  3.31 | ppl     27.51
| epoch  11 step    21870 | batches    860 / 2101 | lr 5.004e-03 | ms/batch 398.0 | tok/s  123507 | loss  3.35 | ppl     28.52
| epoch  11 step    21880 | batches    870 / 2101 | lr 5.001e-03 | ms/batch 398.4 | tok/s  123383 | loss  3.37 | ppl     29.11
| epoch  11 step    21890 | batches    880 / 2101 | lr 4.997e-03 | ms/batch 397.1 | tok/s  123771 | loss  3.31 | ppl     27.37
| epoch  11 step    21900 | batches    890 / 2101 | lr 4.994e-03 | ms/batch 397.5 | tok/s  123642 | loss  3.34 | ppl     28.31
| epoch  11 step    21910 | batches    900 / 2101 | lr 4.990e-03 | ms/batch 397.5 | tok/s  123655 | loss  3.32 | ppl     27.53
| epoch  11 step    21920 | batches    910 / 2101 | lr 4.986e-03 | ms/batch 397.8 | tok/s  123570 | loss  3.34 | ppl     28.29
| epoch  11 step    21930 | batches    920 / 2101 | lr 4.983e-03 | ms/batch 398.0 | tok/s  123512 | loss  3.34 | ppl     28.31
| epoch  11 step    21940 | batches    930 / 2101 | lr 4.979e-03 | ms/batch 398.5 | tok/s  123337 | loss  3.31 | ppl     27.43
| epoch  11 step    21950 | batches    940 / 2101 | lr 4.976e-03 | ms/batch 397.6 | tok/s  123630 | loss  3.33 | ppl     27.94
| epoch  11 step    21960 | batches    950 / 2101 | lr 4.972e-03 | ms/batch 396.9 | tok/s  123828 | loss  3.31 | ppl     27.36
| epoch  11 step    21970 | batches    960 / 2101 | lr 4.968e-03 | ms/batch 397.4 | tok/s  123686 | loss  3.34 | ppl     28.22
| epoch  11 step    21980 | batches    970 / 2101 | lr 4.965e-03 | ms/batch 397.1 | tok/s  123764 | loss  3.35 | ppl     28.48
| epoch  11 step    21990 | batches    980 / 2101 | lr 4.961e-03 | ms/batch 397.6 | tok/s  123621 | loss  3.36 | ppl     28.72
| epoch  11 step    22000 | batches    990 / 2101 | lr 4.958e-03 | ms/batch 412.9 | tok/s  119042 | loss  3.32 | ppl     27.61
----------------------------------------------------------------------------------------------------
| Eval  44 at step    22000 | time:  0.82s | valid loss  3.26 | valid ppl    25.944
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.04734982859106653, 0.05057229254622084, 0.047254895210470424, 0.04558804468569806, 0.04686213614663654, 0.04767197083175373, 0.04966347575519793, 0.04878694267174853, 0.045545045519795886, 0.04468548229332457, 0.04892265089325741, 0.050642531559240915, 0.04421976433984313, 0.053457914964427866, 0.04801295192527111, 0.05020292341467998, 0.05137306755872319, 0.05005290793263624, 0.04972536190105878, 0.04798227449764489, 0.0495992390683729, 0.04982842360371463, 0.04372291576698324, 0.048980562040607994, 0.04816373955320996, 0.04735979176848984, 0.05245305508714134, 0.048747236688837764, 0.04851077250197264, 0.048551524836858075, 0.0472339942786145, 0.0494646056475126, 0.046441354576718774, 0.041239764862017414, 0.045781901607165804, 0.043006746981060336, 0.049305500691338475, 0.04502504582498276, 0.04620794450649421, 0.04668528719894945, 0.05123878192237929, 0.050628847057471005, 0.04534275555469446, 0.04215247938000011, 0.044442731635645424, 0.04411184653628287, 0.04750581255634426, 0.03775842067947134, 0.041389527180275776, 0.04455027669299365, 0.04605593779492225, 0.047092040910457184, 0.043896371913463, 0.037957532746904055, 0.0428064370089885, 0.04498410597890688, 0.04863752113616746, 0.05017657594002681, 0.0441473981372839, 0.043160096821412225, 0.0390010959435179, 0.026835225112312195, 0.015356344019595342, 0.032556463040086914, 0.04025375758060555, 0.040641278713598745, 0.03884283544544171, 0.039054578514307346, 0.03792934825910286, 0.041364748909084204, 0.04926578659048231, 0.046292019259757955, 0.06698863762567367, 0.03222530226135013, 0.03840910371030835, 0.04334290177897375, 0.03834997856588384, 0.048398122187639794, 0.03303068002469556, 0.040199622171811694, 0.0479155215072009]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [54, 63, 8, 13, 9, 58, 84, 9, 22, 9], [41, 41, 16, 8, 8, 46, 63, 13, 10, 8], [31, 43, 8, 9, 8, 37, 44, 8, 8, 8], [30, 40, 9, 8, 8, 15, 16, 9, 8, 8], [9, 12, 8, 8, 8, 19, 23, 9, 8, 8], [10, 13, 8, 8, 8, 9, 13, 8, 8, 8], [8, 9, 8, 8, 8, 8, 9, 8, 8, 8], [8, 14, 8, 8, 8, 8, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [54, 63, 8, 13, 9, 58, 84, 9, 22, 9], [41, 41, 16, 8, 8, 46, 63, 13, 10, 8], [31, 43, 8, 9, 8, 37, 44, 8, 8, 8], [30, 40, 9, 8, 8, 15, 16, 9, 8, 8], [9, 12, 8, 8, 8, 19, 23, 9, 8, 8], [10, 13, 8, 8, 8, 9, 13, 8, 8, 8], [8, 9, 8, 8, 8, 8, 9, 8, 8, 8], [8, 14, 8, 8, 8, 8, 8, 8, 8, 8], [8]]
| epoch  11 step    22010 | batches   1000 / 2101 | lr 4.954e-03 | ms/batch 4890.5 | tok/s   10051 | loss  3.33 | ppl     27.97
| epoch  11 step    22020 | batches   1010 / 2101 | lr 4.950e-03 | ms/batch 406.3 | tok/s  120966 | loss  3.32 | ppl     27.75
| epoch  11 step    22030 | batches   1020 / 2101 | lr 4.947e-03 | ms/batch 395.1 | tok/s  124409 | loss  3.35 | ppl     28.54
| epoch  11 step    22040 | batches   1030 / 2101 | lr 4.943e-03 | ms/batch 393.7 | tok/s  124847 | loss  3.32 | ppl     27.75
| epoch  11 step    22050 | batches   1040 / 2101 | lr 4.940e-03 | ms/batch 394.2 | tok/s  124688 | loss  3.37 | ppl     29.03
| epoch  11 step    22060 | batches   1050 / 2101 | lr 4.936e-03 | ms/batch 394.0 | tok/s  124759 | loss  3.34 | ppl     28.29
| epoch  11 step    22070 | batches   1060 / 2101 | lr 4.932e-03 | ms/batch 396.4 | tok/s  124008 | loss  3.30 | ppl     27.16
| epoch  11 step    22080 | batches   1070 / 2101 | lr 4.929e-03 | ms/batch 406.0 | tok/s  121070 | loss  3.36 | ppl     28.74
| epoch  11 step    22090 | batches   1080 / 2101 | lr 4.925e-03 | ms/batch 396.4 | tok/s  123998 | loss  3.29 | ppl     26.77
| epoch  11 step    22100 | batches   1090 / 2101 | lr 4.922e-03 | ms/batch 395.3 | tok/s  124348 | loss  3.30 | ppl     27.02
| epoch  11 step    22110 | batches   1100 / 2101 | lr 4.918e-03 | ms/batch 406.7 | tok/s  120864 | loss  3.36 | ppl     28.67
| epoch  11 step    22120 | batches   1110 / 2101 | lr 4.914e-03 | ms/batch 396.6 | tok/s  123925 | loss  3.33 | ppl     27.94
| epoch  11 step    22130 | batches   1120 / 2101 | lr 4.911e-03 | ms/batch 407.2 | tok/s  120696 | loss  3.31 | ppl     27.44
| epoch  11 step    22140 | batches   1130 / 2101 | lr 4.907e-03 | ms/batch 407.6 | tok/s  120602 | loss  3.31 | ppl     27.52
| epoch  11 step    22150 | batches   1140 / 2101 | lr 4.904e-03 | ms/batch 396.1 | tok/s  124104 | loss  3.35 | ppl     28.39
| epoch  11 step    22160 | batches   1150 / 2101 | lr 4.900e-03 | ms/batch 396.3 | tok/s  124037 | loss  3.30 | ppl     27.19
| epoch  11 step    22170 | batches   1160 / 2101 | lr 4.896e-03 | ms/batch 395.8 | tok/s  124184 | loss  3.29 | ppl     26.79
| epoch  11 step    22180 | batches   1170 / 2101 | lr 4.893e-03 | ms/batch 397.4 | tok/s  123676 | loss  3.34 | ppl     28.26
| epoch  11 step    22190 | batches   1180 / 2101 | lr 4.889e-03 | ms/batch 396.5 | tok/s  123979 | loss  3.35 | ppl     28.57
| epoch  11 step    22200 | batches   1190 / 2101 | lr 4.886e-03 | ms/batch 395.5 | tok/s  124264 | loss  3.34 | ppl     28.22
| epoch  11 step    22210 | batches   1200 / 2101 | lr 4.882e-03 | ms/batch 396.9 | tok/s  123834 | loss  3.34 | ppl     28.12
| epoch  11 step    22220 | batches   1210 / 2101 | lr 4.879e-03 | ms/batch 406.8 | tok/s  120819 | loss  3.34 | ppl     28.16
| epoch  11 step    22230 | batches   1220 / 2101 | lr 4.875e-03 | ms/batch 407.3 | tok/s  120682 | loss  3.36 | ppl     28.82
| epoch  11 step    22240 | batches   1230 / 2101 | lr 4.871e-03 | ms/batch 397.1 | tok/s  123790 | loss  3.34 | ppl     28.10
| epoch  11 step    22250 | batches   1240 / 2101 | lr 4.868e-03 | ms/batch 396.9 | tok/s  123833 | loss  3.31 | ppl     27.28
| epoch  11 step    22260 | batches   1250 / 2101 | lr 4.864e-03 | ms/batch 396.9 | tok/s  123840 | loss  3.30 | ppl     27.09
| epoch  11 step    22270 | batches   1260 / 2101 | lr 4.861e-03 | ms/batch 396.8 | tok/s  123881 | loss  3.33 | ppl     27.91
| epoch  11 step    22280 | batches   1270 / 2101 | lr 4.857e-03 | ms/batch 397.5 | tok/s  123661 | loss  3.35 | ppl     28.55
| epoch  11 step    22290 | batches   1280 / 2101 | lr 4.853e-03 | ms/batch 397.0 | tok/s  123813 | loss  3.33 | ppl     27.80
| epoch  11 step    22300 | batches   1290 / 2101 | lr 4.850e-03 | ms/batch 397.6 | tok/s  123627 | loss  3.33 | ppl     28.04
| epoch  11 step    22310 | batches   1300 / 2101 | lr 4.846e-03 | ms/batch 397.8 | tok/s  123551 | loss  3.34 | ppl     28.25
| epoch  11 step    22320 | batches   1310 / 2101 | lr 4.843e-03 | ms/batch 397.1 | tok/s  123777 | loss  3.35 | ppl     28.43
| epoch  11 step    22330 | batches   1320 / 2101 | lr 4.839e-03 | ms/batch 396.9 | tok/s  123840 | loss  3.34 | ppl     28.30
| epoch  11 step    22340 | batches   1330 / 2101 | lr 4.835e-03 | ms/batch 397.4 | tok/s  123682 | loss  3.32 | ppl     27.69
| epoch  11 step    22350 | batches   1340 / 2101 | lr 4.832e-03 | ms/batch 397.4 | tok/s  123698 | loss  3.35 | ppl     28.53
| epoch  11 step    22360 | batches   1350 / 2101 | lr 4.828e-03 | ms/batch 396.9 | tok/s  123851 | loss  3.32 | ppl     27.76
| epoch  11 step    22370 | batches   1360 / 2101 | lr 4.825e-03 | ms/batch 407.5 | tok/s  120612 | loss  3.32 | ppl     27.72
| epoch  11 step    22380 | batches   1370 / 2101 | lr 4.821e-03 | ms/batch 396.9 | tok/s  123836 | loss  3.32 | ppl     27.69
| epoch  11 step    22390 | batches   1380 / 2101 | lr 4.818e-03 | ms/batch 396.8 | tok/s  123887 | loss  3.34 | ppl     28.13
| epoch  11 step    22400 | batches   1390 / 2101 | lr 4.814e-03 | ms/batch 397.3 | tok/s  123706 | loss  3.35 | ppl     28.36
| epoch  11 step    22410 | batches   1400 / 2101 | lr 4.810e-03 | ms/batch 397.7 | tok/s  123606 | loss  3.36 | ppl     28.84
| epoch  11 step    22420 | batches   1410 / 2101 | lr 4.807e-03 | ms/batch 396.5 | tok/s  123953 | loss  3.31 | ppl     27.45
| epoch  11 step    22430 | batches   1420 / 2101 | lr 4.803e-03 | ms/batch 397.4 | tok/s  123673 | loss  3.33 | ppl     27.92
| epoch  11 step    22440 | batches   1430 / 2101 | lr 4.800e-03 | ms/batch 397.3 | tok/s  123702 | loss  3.28 | ppl     26.54
| epoch  11 step    22450 | batches   1440 / 2101 | lr 4.796e-03 | ms/batch 396.9 | tok/s  123839 | loss  3.29 | ppl     26.83
| epoch  11 step    22460 | batches   1450 / 2101 | lr 4.792e-03 | ms/batch 397.0 | tok/s  123812 | loss  3.30 | ppl     27.16
| epoch  11 step    22470 | batches   1460 / 2101 | lr 4.789e-03 | ms/batch 396.9 | tok/s  123835 | loss  3.33 | ppl     28.06
| epoch  11 step    22480 | batches   1470 / 2101 | lr 4.785e-03 | ms/batch 398.0 | tok/s  123511 | loss  3.35 | ppl     28.51
| epoch  11 step    22490 | batches   1480 / 2101 | lr 4.782e-03 | ms/batch 397.1 | tok/s  123773 | loss  3.32 | ppl     27.77
| epoch  11 step    22500 | batches   1490 / 2101 | lr 4.778e-03 | ms/batch 397.3 | tok/s  123719 | loss  3.35 | ppl     28.45
----------------------------------------------------------------------------------------------------
| Eval  45 at step    22500 | time:  0.82s | valid loss  3.25 | valid ppl    25.785
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  11 step    22510 | batches   1500 / 2101 | lr 4.775e-03 | ms/batch 400.3 | tok/s  122782 | loss  3.37 | ppl     29.01
| epoch  11 step    22520 | batches   1510 / 2101 | lr 4.771e-03 | ms/batch 409.0 | tok/s  120168 | loss  3.33 | ppl     28.01
| epoch  11 step    22530 | batches   1520 / 2101 | lr 4.767e-03 | ms/batch 406.1 | tok/s  121026 | loss  3.30 | ppl     27.14
| epoch  11 step    22540 | batches   1530 / 2101 | lr 4.764e-03 | ms/batch 396.0 | tok/s  124135 | loss  3.30 | ppl     27.01
| epoch  11 step    22550 | batches   1540 / 2101 | lr 4.760e-03 | ms/batch 407.2 | tok/s  120693 | loss  3.34 | ppl     28.26
| epoch  11 step    22560 | batches   1550 / 2101 | lr 4.757e-03 | ms/batch 397.2 | tok/s  123760 | loss  3.34 | ppl     28.29
| epoch  11 step    22570 | batches   1560 / 2101 | lr 4.753e-03 | ms/batch 398.3 | tok/s  123414 | loss  3.34 | ppl     28.23
| epoch  11 step    22580 | batches   1570 / 2101 | lr 4.750e-03 | ms/batch 396.8 | tok/s  123862 | loss  3.34 | ppl     28.28
| epoch  11 step    22590 | batches   1580 / 2101 | lr 4.746e-03 | ms/batch 397.3 | tok/s  123716 | loss  3.35 | ppl     28.57
| epoch  11 step    22600 | batches   1590 / 2101 | lr 4.742e-03 | ms/batch 397.1 | tok/s  123790 | loss  3.35 | ppl     28.45
| epoch  11 step    22610 | batches   1600 / 2101 | lr 4.739e-03 | ms/batch 397.9 | tok/s  123544 | loss  3.36 | ppl     28.78
| epoch  11 step    22620 | batches   1610 / 2101 | lr 4.735e-03 | ms/batch 398.3 | tok/s  123395 | loss  3.33 | ppl     27.85
| epoch  11 step    22630 | batches   1620 / 2101 | lr 4.732e-03 | ms/batch 398.0 | tok/s  123495 | loss  3.35 | ppl     28.51
| epoch  11 step    22640 | batches   1630 / 2101 | lr 4.728e-03 | ms/batch 397.3 | tok/s  123702 | loss  3.32 | ppl     27.64
| epoch  11 step    22650 | batches   1640 / 2101 | lr 4.725e-03 | ms/batch 397.6 | tok/s  123632 | loss  3.31 | ppl     27.26
| epoch  11 step    22660 | batches   1650 / 2101 | lr 4.721e-03 | ms/batch 397.1 | tok/s  123767 | loss  3.32 | ppl     27.78
| epoch  11 step    22670 | batches   1660 / 2101 | lr 4.717e-03 | ms/batch 397.2 | tok/s  123746 | loss  3.35 | ppl     28.36
| epoch  11 step    22680 | batches   1670 / 2101 | lr 4.714e-03 | ms/batch 398.0 | tok/s  123496 | loss  3.33 | ppl     27.95
| epoch  11 step    22690 | batches   1680 / 2101 | lr 4.710e-03 | ms/batch 397.5 | tok/s  123650 | loss  3.31 | ppl     27.42
| epoch  11 step    22700 | batches   1690 / 2101 | lr 4.707e-03 | ms/batch 397.0 | tok/s  123805 | loss  3.31 | ppl     27.37
| epoch  11 step    22710 | batches   1700 / 2101 | lr 4.703e-03 | ms/batch 397.5 | tok/s  123660 | loss  3.34 | ppl     28.25
| epoch  11 step    22720 | batches   1710 / 2101 | lr 4.700e-03 | ms/batch 398.5 | tok/s  123336 | loss  3.33 | ppl     27.81
| epoch  11 step    22730 | batches   1720 / 2101 | lr 4.696e-03 | ms/batch 397.6 | tok/s  123620 | loss  3.35 | ppl     28.42
| epoch  11 step    22740 | batches   1730 / 2101 | lr 4.692e-03 | ms/batch 397.0 | tok/s  123820 | loss  3.32 | ppl     27.70
| epoch  11 step    22750 | batches   1740 / 2101 | lr 4.689e-03 | ms/batch 397.5 | tok/s  123652 | loss  3.33 | ppl     28.02
| epoch  11 step    22760 | batches   1750 / 2101 | lr 4.685e-03 | ms/batch 397.0 | tok/s  123805 | loss  3.32 | ppl     27.61
| epoch  11 step    22770 | batches   1760 / 2101 | lr 4.682e-03 | ms/batch 396.9 | tok/s  123836 | loss  3.34 | ppl     28.11
| epoch  11 step    22780 | batches   1770 / 2101 | lr 4.678e-03 | ms/batch 396.9 | tok/s  123828 | loss  3.35 | ppl     28.54
| epoch  11 step    22790 | batches   1780 / 2101 | lr 4.675e-03 | ms/batch 398.0 | tok/s  123488 | loss  3.31 | ppl     27.51
| epoch  11 step    22800 | batches   1790 / 2101 | lr 4.671e-03 | ms/batch 398.1 | tok/s  123470 | loss  3.32 | ppl     27.62
| epoch  11 step    22810 | batches   1800 / 2101 | lr 4.667e-03 | ms/batch 397.5 | tok/s  123644 | loss  3.32 | ppl     27.55
| epoch  11 step    22820 | batches   1810 / 2101 | lr 4.664e-03 | ms/batch 397.8 | tok/s  123572 | loss  3.35 | ppl     28.57
| epoch  11 step    22830 | batches   1820 / 2101 | lr 4.660e-03 | ms/batch 397.9 | tok/s  123544 | loss  3.35 | ppl     28.59
| epoch  11 step    22840 | batches   1830 / 2101 | lr 4.657e-03 | ms/batch 398.6 | tok/s  123323 | loss  3.33 | ppl     27.94
| epoch  11 step    22850 | batches   1840 / 2101 | lr 4.653e-03 | ms/batch 398.1 | tok/s  123453 | loss  3.32 | ppl     27.55
| epoch  11 step    22860 | batches   1850 / 2101 | lr 4.650e-03 | ms/batch 397.6 | tok/s  123614 | loss  3.29 | ppl     26.83
| epoch  11 step    22870 | batches   1860 / 2101 | lr 4.646e-03 | ms/batch 397.2 | tok/s  123744 | loss  3.30 | ppl     27.17
| epoch  11 step    22880 | batches   1870 / 2101 | lr 4.643e-03 | ms/batch 396.7 | tok/s  123899 | loss  3.30 | ppl     27.14
| epoch  11 step    22890 | batches   1880 / 2101 | lr 4.639e-03 | ms/batch 397.1 | tok/s  123781 | loss  3.31 | ppl     27.45
| epoch  11 step    22900 | batches   1890 / 2101 | lr 4.635e-03 | ms/batch 397.0 | tok/s  123819 | loss  3.33 | ppl     27.87
| epoch  11 step    22910 | batches   1900 / 2101 | lr 4.632e-03 | ms/batch 396.9 | tok/s  123844 | loss  3.32 | ppl     27.58
| epoch  11 step    22920 | batches   1910 / 2101 | lr 4.628e-03 | ms/batch 397.9 | tok/s  123517 | loss  3.31 | ppl     27.51
| epoch  11 step    22930 | batches   1920 / 2101 | lr 4.625e-03 | ms/batch 397.8 | tok/s  123568 | loss  3.34 | ppl     28.17
| epoch  11 step    22940 | batches   1930 / 2101 | lr 4.621e-03 | ms/batch 397.4 | tok/s  123679 | loss  3.31 | ppl     27.44
| epoch  11 step    22950 | batches   1940 / 2101 | lr 4.618e-03 | ms/batch 397.1 | tok/s  123776 | loss  3.31 | ppl     27.33
| epoch  11 step    22960 | batches   1950 / 2101 | lr 4.614e-03 | ms/batch 397.6 | tok/s  123626 | loss  3.35 | ppl     28.52
| epoch  11 step    22970 | batches   1960 / 2101 | lr 4.611e-03 | ms/batch 398.1 | tok/s  123474 | loss  3.34 | ppl     28.17
| epoch  11 step    22980 | batches   1970 / 2101 | lr 4.607e-03 | ms/batch 397.5 | tok/s  123642 | loss  3.33 | ppl     27.93
| epoch  11 step    22990 | batches   1980 / 2101 | lr 4.603e-03 | ms/batch 398.1 | tok/s  123474 | loss  3.35 | ppl     28.62
| epoch  11 step    23000 | batches   1990 / 2101 | lr 4.600e-03 | ms/batch 412.0 | tok/s  119304 | loss  3.39 | ppl     29.60
----------------------------------------------------------------------------------------------------
| Eval  46 at step    23000 | time:  0.82s | valid loss  3.24 | valid ppl    25.648
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.04439020976877082, 0.0457397415022478, 0.051038860602946504, 0.042601587627495496, 0.042880635495340665, 0.043229263947947204, 0.04509591501819673, 0.04975465509061132, 0.043772473269261786, 0.0407218441222459, 0.041542783987323265, 0.04574372539957646, 0.044007478052498106, 0.05046919827643041, 0.044522703193442634, 0.04556148393783734, 0.04703698641027083, 0.050854635311077104, 0.04608834486428952, 0.04380793271927789, 0.04668011290419855, 0.044612653017824584, 0.060739346583578165, 0.051077367288571984, 0.044074442571605484, 0.04319995137862627, 0.04688704030783923, 0.054797662690231765, 0.04688694863144279, 0.04428467759408673, 0.04731137773820152, 0.044177839919248535, 0.04756883790995591, 0.04343052233502424, 0.04312270555262591, 0.042988030317617214, 0.04234961175640925, 0.03707596640177924, 0.04281241487660048, 0.04391238189054357, 0.04768280642045163, 0.04540917715260267, 0.035146657111264606, 0.04239191087300969, 0.04050410966738688, 0.044580376759164285, 0.045548917403299756, 0.039405159113401436, 0.04101425306726222, 0.042091349923148016, 0.04199805826491182, 0.04038144444156116, 0.03088061422788779, 0.0366706510053938, 0.03888258146954453, 0.045566534640421374, 0.04333668220139323, 0.048932220826977395, 0.040129171287396834, 0.03978470016142237, 0.02366058138438861, 0.024468237012885353, 0.007155783319711128, 0.03082321980204514, 0.03759009111710861, 0.03349522818671095, 0.03655336637996395, 0.030034002015153067, 0.03293166594397178, 0.03841533912664531, 0.042530990829984516, 0.04133432359391406, 0.03778232205415591, 0.02954276161353706, 0.03438504333607557, 0.03587589590801519, 0.03597695592821736, 0.035076886485622, 0.0298177461169528, 0.03471505344522909, 0.04328799615108631]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [48, 62, 8, 12, 8, 60, 83, 9, 23, 10], [40, 37, 17, 9, 8, 52, 59, 11, 10, 8], [34, 35, 8, 8, 8, 34, 43, 9, 8, 8], [29, 46, 8, 8, 8, 20, 15, 10, 8, 8], [9, 15, 8, 8, 8, 17, 19, 8, 8, 8], [9, 17, 8, 8, 8, 9, 16, 8, 8, 8], [8, 9, 8, 8, 8, 8, 9, 8, 8, 8], [8, 14, 8, 8, 8, 9, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [48, 62, 8, 12, 8, 60, 83, 9, 23, 10], [40, 37, 17, 9, 8, 52, 59, 11, 10, 8], [34, 35, 8, 8, 8, 34, 43, 9, 8, 8], [29, 46, 8, 8, 8, 20, 15, 10, 8, 8], [9, 15, 8, 8, 8, 17, 19, 8, 8, 8], [9, 17, 8, 8, 8, 9, 16, 8, 8, 8], [8, 9, 8, 8, 8, 8, 9, 8, 8, 8], [8, 14, 8, 8, 8, 9, 9, 8, 8, 8], [8]]
| epoch  11 step    23010 | batches   2000 / 2101 | lr 4.596e-03 | ms/batch 4892.1 | tok/s   10047 | loss  3.39 | ppl     29.69
| epoch  11 step    23020 | batches   2010 / 2101 | lr 4.593e-03 | ms/batch 397.4 | tok/s  123683 | loss  3.36 | ppl     28.93
| epoch  11 step    23030 | batches   2020 / 2101 | lr 4.589e-03 | ms/batch 396.7 | tok/s  123900 | loss  3.36 | ppl     28.72
| epoch  11 step    23040 | batches   2030 / 2101 | lr 4.586e-03 | ms/batch 395.7 | tok/s  124215 | loss  3.31 | ppl     27.44
| epoch  11 step    23050 | batches   2040 / 2101 | lr 4.582e-03 | ms/batch 395.9 | tok/s  124165 | loss  3.32 | ppl     27.74
| epoch  11 step    23060 | batches   2050 / 2101 | lr 4.579e-03 | ms/batch 406.6 | tok/s  120898 | loss  3.32 | ppl     27.56
| epoch  11 step    23070 | batches   2060 / 2101 | lr 4.575e-03 | ms/batch 398.2 | tok/s  123450 | loss  3.32 | ppl     27.59
| epoch  11 step    23080 | batches   2070 / 2101 | lr 4.571e-03 | ms/batch 396.2 | tok/s  124070 | loss  3.32 | ppl     27.58
| epoch  11 step    23090 | batches   2080 / 2101 | lr 4.568e-03 | ms/batch 396.9 | tok/s  123840 | loss  3.31 | ppl     27.45
| epoch  11 step    23100 | batches   2090 / 2101 | lr 4.564e-03 | ms/batch 396.5 | tok/s  123975 | loss  3.28 | ppl     26.68
| epoch  11 step    23110 | batches   2100 / 2101 | lr 4.561e-03 | ms/batch 396.4 | tok/s  124000 | loss  3.34 | ppl     28.11
| epoch  12 step    23120 | batches      9 / 2101 | lr 4.557e-03 | ms/batch 398.0 | tok/s  123698 | loss  3.34 | ppl     28.17
| epoch  12 step    23130 | batches     19 / 2101 | lr 4.554e-03 | ms/batch 396.6 | tok/s  123944 | loss  3.28 | ppl     26.65
| epoch  12 step    23140 | batches     29 / 2101 | lr 4.550e-03 | ms/batch 396.9 | tok/s  123828 | loss  3.23 | ppl     25.29
| epoch  12 step    23150 | batches     39 / 2101 | lr 4.547e-03 | ms/batch 397.0 | tok/s  123803 | loss  3.26 | ppl     26.12
| epoch  12 step    23160 | batches     49 / 2101 | lr 4.543e-03 | ms/batch 397.9 | tok/s  123524 | loss  3.27 | ppl     26.39
| epoch  12 step    23170 | batches     59 / 2101 | lr 4.540e-03 | ms/batch 397.5 | tok/s  123668 | loss  3.28 | ppl     26.70
| epoch  12 step    23180 | batches     69 / 2101 | lr 4.536e-03 | ms/batch 398.0 | tok/s  123490 | loss  3.29 | ppl     26.73
| epoch  12 step    23190 | batches     79 / 2101 | lr 4.533e-03 | ms/batch 397.8 | tok/s  123547 | loss  3.31 | ppl     27.41
| epoch  12 step    23200 | batches     89 / 2101 | lr 4.529e-03 | ms/batch 398.2 | tok/s  123445 | loss  3.33 | ppl     27.87
| epoch  12 step    23210 | batches     99 / 2101 | lr 4.525e-03 | ms/batch 397.4 | tok/s  123696 | loss  3.30 | ppl     27.09
| epoch  12 step    23220 | batches    109 / 2101 | lr 4.522e-03 | ms/batch 398.5 | tok/s  123354 | loss  3.30 | ppl     27.04
| epoch  12 step    23230 | batches    119 / 2101 | lr 4.518e-03 | ms/batch 397.9 | tok/s  123527 | loss  3.32 | ppl     27.69
| epoch  12 step    23240 | batches    129 / 2101 | lr 4.515e-03 | ms/batch 398.2 | tok/s  123436 | loss  3.28 | ppl     26.66
| epoch  12 step    23250 | batches    139 / 2101 | lr 4.511e-03 | ms/batch 398.1 | tok/s  123470 | loss  3.28 | ppl     26.62
| epoch  12 step    23260 | batches    149 / 2101 | lr 4.508e-03 | ms/batch 398.0 | tok/s  123513 | loss  3.27 | ppl     26.41
| epoch  12 step    23270 | batches    159 / 2101 | lr 4.504e-03 | ms/batch 398.1 | tok/s  123460 | loss  3.30 | ppl     27.14
| epoch  12 step    23280 | batches    169 / 2101 | lr 4.501e-03 | ms/batch 409.4 | tok/s  120063 | loss  3.34 | ppl     28.12
| epoch  12 step    23290 | batches    179 / 2101 | lr 4.497e-03 | ms/batch 398.8 | tok/s  123250 | loss  3.30 | ppl     27.04
| epoch  12 step    23300 | batches    189 / 2101 | lr 4.494e-03 | ms/batch 398.9 | tok/s  123211 | loss  3.30 | ppl     27.25
| epoch  12 step    23310 | batches    199 / 2101 | lr 4.490e-03 | ms/batch 399.0 | tok/s  123178 | loss  3.31 | ppl     27.31
| epoch  12 step    23320 | batches    209 / 2101 | lr 4.487e-03 | ms/batch 399.0 | tok/s  123203 | loss  3.30 | ppl     27.14
| epoch  12 step    23330 | batches    219 / 2101 | lr 4.483e-03 | ms/batch 398.4 | tok/s  123388 | loss  3.27 | ppl     26.26
| epoch  12 step    23340 | batches    229 / 2101 | lr 4.479e-03 | ms/batch 398.0 | tok/s  123503 | loss  3.28 | ppl     26.54
| epoch  12 step    23350 | batches    239 / 2101 | lr 4.476e-03 | ms/batch 397.9 | tok/s  123544 | loss  3.28 | ppl     26.68
| epoch  12 step    23360 | batches    249 / 2101 | lr 4.472e-03 | ms/batch 398.0 | tok/s  123483 | loss  3.30 | ppl     27.11
| epoch  12 step    23370 | batches    259 / 2101 | lr 4.469e-03 | ms/batch 398.5 | tok/s  123341 | loss  3.29 | ppl     26.96
| epoch  12 step    23380 | batches    269 / 2101 | lr 4.465e-03 | ms/batch 398.7 | tok/s  123292 | loss  3.31 | ppl     27.52
| epoch  12 step    23390 | batches    279 / 2101 | lr 4.462e-03 | ms/batch 398.6 | tok/s  123316 | loss  3.30 | ppl     27.24
| epoch  12 step    23400 | batches    289 / 2101 | lr 4.458e-03 | ms/batch 398.8 | tok/s  123262 | loss  3.29 | ppl     26.93
| epoch  12 step    23410 | batches    299 / 2101 | lr 4.455e-03 | ms/batch 398.2 | tok/s  123430 | loss  3.26 | ppl     25.98
| epoch  12 step    23420 | batches    309 / 2101 | lr 4.451e-03 | ms/batch 398.2 | tok/s  123424 | loss  3.26 | ppl     26.18
| epoch  12 step    23430 | batches    319 / 2101 | lr 4.448e-03 | ms/batch 398.4 | tok/s  123384 | loss  3.28 | ppl     26.64
| epoch  12 step    23440 | batches    329 / 2101 | lr 4.444e-03 | ms/batch 398.1 | tok/s  123471 | loss  3.26 | ppl     26.02
| epoch  12 step    23450 | batches    339 / 2101 | lr 4.441e-03 | ms/batch 398.4 | tok/s  123386 | loss  3.26 | ppl     26.01
| epoch  12 step    23460 | batches    349 / 2101 | lr 4.437e-03 | ms/batch 398.5 | tok/s  123337 | loss  3.28 | ppl     26.53
| epoch  12 step    23470 | batches    359 / 2101 | lr 4.434e-03 | ms/batch 398.7 | tok/s  123292 | loss  3.32 | ppl     27.63
| epoch  12 step    23480 | batches    369 / 2101 | lr 4.430e-03 | ms/batch 398.7 | tok/s  123292 | loss  3.30 | ppl     27.00
| epoch  12 step    23490 | batches    379 / 2101 | lr 4.427e-03 | ms/batch 398.2 | tok/s  123449 | loss  3.28 | ppl     26.64
| epoch  12 step    23500 | batches    389 / 2101 | lr 4.423e-03 | ms/batch 398.9 | tok/s  123232 | loss  3.30 | ppl     27.00
----------------------------------------------------------------------------------------------------
| Eval  47 at step    23500 | time:  0.82s | valid loss  3.24 | valid ppl    25.504
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  12 step    23510 | batches    399 / 2101 | lr 4.420e-03 | ms/batch 400.7 | tok/s  122676 | loss  3.27 | ppl     26.43
| epoch  12 step    23520 | batches    409 / 2101 | lr 4.416e-03 | ms/batch 419.6 | tok/s  117133 | loss  3.28 | ppl     26.61
| epoch  12 step    23530 | batches    419 / 2101 | lr 4.413e-03 | ms/batch 409.9 | tok/s  119926 | loss  3.33 | ppl     28.02
| epoch  12 step    23540 | batches    429 / 2101 | lr 4.409e-03 | ms/batch 398.8 | tok/s  123260 | loss  3.30 | ppl     27.25
| epoch  12 step    23550 | batches    439 / 2101 | lr 4.405e-03 | ms/batch 410.3 | tok/s  119801 | loss  3.30 | ppl     27.18
| epoch  12 step    23560 | batches    449 / 2101 | lr 4.402e-03 | ms/batch 399.7 | tok/s  122974 | loss  3.31 | ppl     27.35
| epoch  12 step    23570 | batches    459 / 2101 | lr 4.398e-03 | ms/batch 399.2 | tok/s  123122 | loss  3.33 | ppl     27.93
| epoch  12 step    23580 | batches    469 / 2101 | lr 4.395e-03 | ms/batch 398.7 | tok/s  123272 | loss  3.34 | ppl     28.27
| epoch  12 step    23590 | batches    479 / 2101 | lr 4.391e-03 | ms/batch 398.6 | tok/s  123308 | loss  3.30 | ppl     27.06
| epoch  12 step    23600 | batches    489 / 2101 | lr 4.388e-03 | ms/batch 397.7 | tok/s  123602 | loss  3.26 | ppl     26.05
| epoch  12 step    23610 | batches    499 / 2101 | lr 4.384e-03 | ms/batch 397.4 | tok/s  123689 | loss  3.27 | ppl     26.23
| epoch  12 step    23620 | batches    509 / 2101 | lr 4.381e-03 | ms/batch 397.4 | tok/s  123686 | loss  3.28 | ppl     26.45
| epoch  12 step    23630 | batches    519 / 2101 | lr 4.377e-03 | ms/batch 397.8 | tok/s  123555 | loss  3.31 | ppl     27.28
| epoch  12 step    23640 | batches    529 / 2101 | lr 4.374e-03 | ms/batch 397.4 | tok/s  123677 | loss  3.30 | ppl     27.03
| epoch  12 step    23650 | batches    539 / 2101 | lr 4.370e-03 | ms/batch 398.0 | tok/s  123496 | loss  3.29 | ppl     26.76
| epoch  12 step    23660 | batches    549 / 2101 | lr 4.367e-03 | ms/batch 398.2 | tok/s  123442 | loss  3.27 | ppl     26.29
| epoch  12 step    23670 | batches    559 / 2101 | lr 4.363e-03 | ms/batch 398.3 | tok/s  123400 | loss  3.27 | ppl     26.39
| epoch  12 step    23680 | batches    569 / 2101 | lr 4.360e-03 | ms/batch 409.9 | tok/s  119927 | loss  3.32 | ppl     27.54
| epoch  12 step    23690 | batches    579 / 2101 | lr 4.356e-03 | ms/batch 399.0 | tok/s  123187 | loss  3.28 | ppl     26.59
| epoch  12 step    23700 | batches    589 / 2101 | lr 4.353e-03 | ms/batch 409.6 | tok/s  120010 | loss  3.31 | ppl     27.34
| epoch  12 step    23710 | batches    599 / 2101 | lr 4.349e-03 | ms/batch 399.0 | tok/s  123175 | loss  3.29 | ppl     26.75
| epoch  12 step    23720 | batches    609 / 2101 | lr 4.346e-03 | ms/batch 398.8 | tok/s  123245 | loss  3.28 | ppl     26.63
| epoch  12 step    23730 | batches    619 / 2101 | lr 4.342e-03 | ms/batch 399.4 | tok/s  123078 | loss  3.32 | ppl     27.58
| epoch  12 step    23740 | batches    629 / 2101 | lr 4.339e-03 | ms/batch 398.4 | tok/s  123379 | loss  3.28 | ppl     26.57
| epoch  12 step    23750 | batches    639 / 2101 | lr 4.335e-03 | ms/batch 398.9 | tok/s  123220 | loss  3.31 | ppl     27.30
| epoch  12 step    23760 | batches    649 / 2101 | lr 4.332e-03 | ms/batch 399.4 | tok/s  123062 | loss  3.33 | ppl     27.87
| epoch  12 step    23770 | batches    659 / 2101 | lr 4.328e-03 | ms/batch 398.6 | tok/s  123314 | loss  3.29 | ppl     26.90
| epoch  12 step    23780 | batches    669 / 2101 | lr 4.325e-03 | ms/batch 398.6 | tok/s  123323 | loss  3.31 | ppl     27.25
| epoch  12 step    23790 | batches    679 / 2101 | lr 4.321e-03 | ms/batch 398.7 | tok/s  123280 | loss  3.26 | ppl     26.06
| epoch  12 step    23800 | batches    689 / 2101 | lr 4.318e-03 | ms/batch 398.5 | tok/s  123353 | loss  3.29 | ppl     26.74
| epoch  12 step    23810 | batches    699 / 2101 | lr 4.314e-03 | ms/batch 398.3 | tok/s  123404 | loss  3.27 | ppl     26.22
| epoch  12 step    23820 | batches    709 / 2101 | lr 4.311e-03 | ms/batch 398.8 | tok/s  123240 | loss  3.27 | ppl     26.26
| epoch  12 step    23830 | batches    719 / 2101 | lr 4.307e-03 | ms/batch 399.9 | tok/s  122912 | loss  3.26 | ppl     26.07
| epoch  12 step    23840 | batches    729 / 2101 | lr 4.304e-03 | ms/batch 399.5 | tok/s  123026 | loss  3.29 | ppl     26.85
| epoch  12 step    23850 | batches    739 / 2101 | lr 4.300e-03 | ms/batch 398.7 | tok/s  123272 | loss  3.29 | ppl     26.88
| epoch  12 step    23860 | batches    749 / 2101 | lr 4.297e-03 | ms/batch 398.3 | tok/s  123398 | loss  3.31 | ppl     27.43
| epoch  12 step    23870 | batches    759 / 2101 | lr 4.293e-03 | ms/batch 398.4 | tok/s  123367 | loss  3.28 | ppl     26.69
| epoch  12 step    23880 | batches    769 / 2101 | lr 4.290e-03 | ms/batch 398.7 | tok/s  123291 | loss  3.32 | ppl     27.75
| epoch  12 step    23890 | batches    779 / 2101 | lr 4.286e-03 | ms/batch 398.6 | tok/s  123305 | loss  3.31 | ppl     27.50
| epoch  12 step    23900 | batches    789 / 2101 | lr 4.283e-03 | ms/batch 398.2 | tok/s  123443 | loss  3.31 | ppl     27.47
| epoch  12 step    23910 | batches    799 / 2101 | lr 4.279e-03 | ms/batch 397.7 | tok/s  123596 | loss  3.35 | ppl     28.53
| epoch  12 step    23920 | batches    809 / 2101 | lr 4.276e-03 | ms/batch 397.8 | tok/s  123573 | loss  3.30 | ppl     27.18
| epoch  12 step    23930 | batches    819 / 2101 | lr 4.272e-03 | ms/batch 397.7 | tok/s  123577 | loss  3.29 | ppl     26.74
| epoch  12 step    23940 | batches    829 / 2101 | lr 4.269e-03 | ms/batch 398.4 | tok/s  123378 | loss  3.26 | ppl     25.96
| epoch  12 step    23950 | batches    839 / 2101 | lr 4.265e-03 | ms/batch 398.0 | tok/s  123510 | loss  3.30 | ppl     27.14
| epoch  12 step    23960 | batches    849 / 2101 | lr 4.262e-03 | ms/batch 399.0 | tok/s  123186 | loss  3.34 | ppl     28.12
| epoch  12 step    23970 | batches    859 / 2101 | lr 4.258e-03 | ms/batch 401.2 | tok/s  122526 | loss  3.31 | ppl     27.45
| epoch  12 step    23980 | batches    869 / 2101 | lr 4.255e-03 | ms/batch 398.7 | tok/s  123296 | loss  3.28 | ppl     26.46
| epoch  12 step    23990 | batches    879 / 2101 | lr 4.252e-03 | ms/batch 398.4 | tok/s  123368 | loss  3.28 | ppl     26.69
| epoch  12 step    24000 | batches    889 / 2101 | lr 4.248e-03 | ms/batch 412.1 | tok/s  119283 | loss  3.32 | ppl     27.53
----------------------------------------------------------------------------------------------------
| Eval  48 at step    24000 | time:  0.82s | valid loss  3.23 | valid ppl    25.382
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.04486492584476502, 0.04538711118891815, 0.0488447737035423, 0.04339732631464047, 0.04375896583368773, 0.046056758426040074, 0.04463528289884233, 0.054975115381145245, 0.0474501093531832, 0.041282001332319886, 0.04450997360095714, 0.0457690904248657, 0.03985072544311805, 0.047705635193799646, 0.04552239905082983, 0.046027040746032574, 0.0465527897611541, 0.051356018885431336, 0.0489007018275311, 0.044521059765103614, 0.046891640083585616, 0.04712467097069535, 0.05064996285120922, 0.04645049960982258, 0.045069460858545865, 0.044283374042371544, 0.0482360412954724, 0.0478998949931527, 0.04730427075713776, 0.04536887623873115, 0.04529857972145102, 0.04573296660321976, 0.03884104132124257, 0.04132411637310811, 0.043557194318774486, 0.04457585879702546, 0.04532293914303263, 0.040213697803199513, 0.04330153334614775, 0.04422066023212607, 0.050144603460561404, 0.04634823415683386, 0.05257510889707511, 0.03791874227265265, 0.04132096316065529, 0.048784130198924636, 0.04443139031900942, 0.051184693028099186, 0.04104819326355821, 0.04244484571838217, 0.04379589007567016, 0.04300602789770453, 0.03719719351858165, 0.037216604725740496, 0.03980048760232448, 0.0431946096224462, 0.043145210451771394, 0.023902309931963548, 0.04529135578093849, 0.040728497997708765, 0.04095577188021661, 0.02429224665682106, 0.01073915955734334, 0.03253280974035081, 0.03764312152078443, 0.042972130436830215, 0.038231464256400706, 0.025593746617139194, 0.03398386766996973, 0.03955036505512993, 0.0400949843776164, 0.04122843079352318, 0.04395561210696605, 0.03042731961418775, 0.035081358711045715, 0.03598008632301196, 0.036802430709572675, 0.041303759156916885, 0.03084383158349865, 0.036902787490444344, 0.04413340081897293]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [52, 64, 8, 15, 9, 58, 82, 9, 19, 11], [42, 42, 17, 8, 8, 46, 58, 8, 9, 8], [33, 37, 8, 8, 8, 35, 48, 9, 9, 8], [34, 48, 8, 8, 8, 15, 15, 10, 8, 8], [10, 11, 8, 8, 8, 19, 19, 8, 8, 8], [9, 14, 8, 8, 8, 9, 13, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [9, 12, 8, 8, 8, 10, 8, 9, 8, 8], [8]]
optimal compression parameters =  [[], [52, 64, 8, 15, 9, 58, 82, 9, 19, 11], [42, 42, 17, 8, 8, 46, 58, 8, 9, 8], [33, 37, 8, 8, 8, 35, 48, 9, 9, 8], [34, 48, 8, 8, 8, 15, 15, 10, 8, 8], [10, 11, 8, 8, 8, 19, 19, 8, 8, 8], [9, 14, 8, 8, 8, 9, 13, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [9, 12, 8, 8, 8, 10, 8, 9, 8, 8], [8]]
| epoch  12 step    24010 | batches    899 / 2101 | lr 4.245e-03 | ms/batch 4891.4 | tok/s   10049 | loss  3.32 | ppl     27.63
| epoch  12 step    24020 | batches    909 / 2101 | lr 4.241e-03 | ms/batch 406.8 | tok/s  120821 | loss  3.29 | ppl     26.85
| epoch  12 step    24030 | batches    919 / 2101 | lr 4.238e-03 | ms/batch 397.3 | tok/s  123720 | loss  3.30 | ppl     27.10
| epoch  12 step    24040 | batches    929 / 2101 | lr 4.234e-03 | ms/batch 395.7 | tok/s  124213 | loss  3.30 | ppl     27.14
| epoch  12 step    24050 | batches    939 / 2101 | lr 4.231e-03 | ms/batch 395.6 | tok/s  124247 | loss  3.28 | ppl     26.56
| epoch  12 step    24060 | batches    949 / 2101 | lr 4.227e-03 | ms/batch 395.9 | tok/s  124155 | loss  3.27 | ppl     26.40
| epoch  12 step    24070 | batches    959 / 2101 | lr 4.224e-03 | ms/batch 396.3 | tok/s  124040 | loss  3.27 | ppl     26.18
| epoch  12 step    24080 | batches    969 / 2101 | lr 4.220e-03 | ms/batch 395.8 | tok/s  124193 | loss  3.28 | ppl     26.54
| epoch  12 step    24090 | batches    979 / 2101 | lr 4.217e-03 | ms/batch 395.4 | tok/s  124318 | loss  3.27 | ppl     26.28
| epoch  12 step    24100 | batches    989 / 2101 | lr 4.213e-03 | ms/batch 396.3 | tok/s  124024 | loss  3.26 | ppl     26.04
| epoch  12 step    24110 | batches    999 / 2101 | lr 4.210e-03 | ms/batch 396.5 | tok/s  123973 | loss  3.26 | ppl     25.99
| epoch  12 step    24120 | batches   1009 / 2101 | lr 4.206e-03 | ms/batch 397.3 | tok/s  123707 | loss  3.26 | ppl     26.18
| epoch  12 step    24130 | batches   1019 / 2101 | lr 4.203e-03 | ms/batch 396.5 | tok/s  123955 | loss  3.26 | ppl     25.94
| epoch  12 step    24140 | batches   1029 / 2101 | lr 4.199e-03 | ms/batch 396.9 | tok/s  123856 | loss  3.30 | ppl     27.06
| epoch  12 step    24150 | batches   1039 / 2101 | lr 4.196e-03 | ms/batch 397.2 | tok/s  123736 | loss  3.29 | ppl     26.91
| epoch  12 step    24160 | batches   1049 / 2101 | lr 4.192e-03 | ms/batch 397.5 | tok/s  123655 | loss  3.28 | ppl     26.59
| epoch  12 step    24170 | batches   1059 / 2101 | lr 4.189e-03 | ms/batch 397.5 | tok/s  123639 | loss  3.31 | ppl     27.32
| epoch  12 step    24180 | batches   1069 / 2101 | lr 4.185e-03 | ms/batch 397.6 | tok/s  123621 | loss  3.31 | ppl     27.32
| epoch  12 step    24190 | batches   1079 / 2101 | lr 4.182e-03 | ms/batch 397.2 | tok/s  123749 | loss  3.29 | ppl     26.77
| epoch  12 step    24200 | batches   1089 / 2101 | lr 4.179e-03 | ms/batch 397.3 | tok/s  123705 | loss  3.27 | ppl     26.35
| epoch  12 step    24210 | batches   1099 / 2101 | lr 4.175e-03 | ms/batch 397.3 | tok/s  123709 | loss  3.31 | ppl     27.32
| epoch  12 step    24220 | batches   1109 / 2101 | lr 4.172e-03 | ms/batch 397.2 | tok/s  123757 | loss  3.27 | ppl     26.35
| epoch  12 step    24230 | batches   1119 / 2101 | lr 4.168e-03 | ms/batch 397.6 | tok/s  123629 | loss  3.31 | ppl     27.39
| epoch  12 step    24240 | batches   1129 / 2101 | lr 4.165e-03 | ms/batch 397.7 | tok/s  123598 | loss  3.26 | ppl     26.02
| epoch  12 step    24250 | batches   1139 / 2101 | lr 4.161e-03 | ms/batch 397.0 | tok/s  123806 | loss  3.25 | ppl     25.85
| epoch  12 step    24260 | batches   1149 / 2101 | lr 4.158e-03 | ms/batch 397.9 | tok/s  123529 | loss  3.32 | ppl     27.57
| epoch  12 step    24270 | batches   1159 / 2101 | lr 4.154e-03 | ms/batch 397.7 | tok/s  123606 | loss  3.27 | ppl     26.27
| epoch  12 step    24280 | batches   1169 / 2101 | lr 4.151e-03 | ms/batch 397.6 | tok/s  123630 | loss  3.30 | ppl     27.11
| epoch  12 step    24290 | batches   1179 / 2101 | lr 4.147e-03 | ms/batch 398.2 | tok/s  123440 | loss  3.28 | ppl     26.50
| epoch  12 step    24300 | batches   1189 / 2101 | lr 4.144e-03 | ms/batch 409.0 | tok/s  120189 | loss  3.29 | ppl     26.84
| epoch  12 step    24310 | batches   1199 / 2101 | lr 4.140e-03 | ms/batch 398.2 | tok/s  123427 | loss  3.34 | ppl     28.11
| epoch  12 step    24320 | batches   1209 / 2101 | lr 4.137e-03 | ms/batch 397.5 | tok/s  123639 | loss  3.33 | ppl     27.95
| epoch  12 step    24330 | batches   1219 / 2101 | lr 4.134e-03 | ms/batch 398.1 | tok/s  123479 | loss  3.32 | ppl     27.64
| epoch  12 step    24340 | batches   1229 / 2101 | lr 4.130e-03 | ms/batch 397.7 | tok/s  123579 | loss  3.31 | ppl     27.41
| epoch  12 step    24350 | batches   1239 / 2101 | lr 4.127e-03 | ms/batch 398.0 | tok/s  123505 | loss  3.29 | ppl     26.84
| epoch  12 step    24360 | batches   1249 / 2101 | lr 4.123e-03 | ms/batch 397.9 | tok/s  123518 | loss  3.31 | ppl     27.41
| epoch  12 step    24370 | batches   1259 / 2101 | lr 4.120e-03 | ms/batch 397.5 | tok/s  123642 | loss  3.30 | ppl     27.12
| epoch  12 step    24380 | batches   1269 / 2101 | lr 4.116e-03 | ms/batch 396.8 | tok/s  123867 | loss  3.25 | ppl     25.87
| epoch  12 step    24390 | batches   1279 / 2101 | lr 4.113e-03 | ms/batch 397.6 | tok/s  123633 | loss  3.31 | ppl     27.39
| epoch  12 step    24400 | batches   1289 / 2101 | lr 4.109e-03 | ms/batch 398.4 | tok/s  123374 | loss  3.30 | ppl     27.13
| epoch  12 step    24410 | batches   1299 / 2101 | lr 4.106e-03 | ms/batch 398.1 | tok/s  123466 | loss  3.32 | ppl     27.59
| epoch  12 step    24420 | batches   1309 / 2101 | lr 4.103e-03 | ms/batch 397.8 | tok/s  123558 | loss  3.29 | ppl     26.79
| epoch  12 step    24430 | batches   1319 / 2101 | lr 4.099e-03 | ms/batch 398.4 | tok/s  123361 | loss  3.35 | ppl     28.52
| epoch  12 step    24440 | batches   1329 / 2101 | lr 4.096e-03 | ms/batch 398.3 | tok/s  123402 | loss  3.32 | ppl     27.64
| epoch  12 step    24450 | batches   1339 / 2101 | lr 4.092e-03 | ms/batch 398.1 | tok/s  123469 | loss  3.30 | ppl     27.19
| epoch  12 step    24460 | batches   1349 / 2101 | lr 4.089e-03 | ms/batch 398.2 | tok/s  123431 | loss  3.28 | ppl     26.67
| epoch  12 step    24470 | batches   1359 / 2101 | lr 4.085e-03 | ms/batch 398.3 | tok/s  123391 | loss  3.32 | ppl     27.57
| epoch  12 step    24480 | batches   1369 / 2101 | lr 4.082e-03 | ms/batch 398.2 | tok/s  123440 | loss  3.30 | ppl     27.21
| epoch  12 step    24490 | batches   1379 / 2101 | lr 4.078e-03 | ms/batch 399.4 | tok/s  123050 | loss  3.31 | ppl     27.43
| epoch  12 step    24500 | batches   1389 / 2101 | lr 4.075e-03 | ms/batch 398.6 | tok/s  123313 | loss  3.29 | ppl     26.72
----------------------------------------------------------------------------------------------------
| Eval  49 at step    24500 | time:  0.81s | valid loss  3.23 | valid ppl    25.254
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  12 step    24510 | batches   1399 / 2101 | lr 4.072e-03 | ms/batch 399.5 | tok/s  123042 | loss  3.29 | ppl     26.74
| epoch  12 step    24520 | batches   1409 / 2101 | lr 4.068e-03 | ms/batch 410.4 | tok/s  119766 | loss  3.30 | ppl     27.02
| epoch  12 step    24530 | batches   1419 / 2101 | lr 4.065e-03 | ms/batch 399.1 | tok/s  123150 | loss  3.31 | ppl     27.51
| epoch  12 step    24540 | batches   1429 / 2101 | lr 4.061e-03 | ms/batch 407.8 | tok/s  120532 | loss  3.30 | ppl     27.09
| epoch  12 step    24550 | batches   1439 / 2101 | lr 4.058e-03 | ms/batch 409.1 | tok/s  120161 | loss  3.30 | ppl     27.07
| epoch  12 step    24560 | batches   1449 / 2101 | lr 4.054e-03 | ms/batch 397.8 | tok/s  123561 | loss  3.25 | ppl     25.82
| epoch  12 step    24570 | batches   1459 / 2101 | lr 4.051e-03 | ms/batch 397.3 | tok/s  123707 | loss  3.28 | ppl     26.55
| epoch  12 step    24580 | batches   1469 / 2101 | lr 4.048e-03 | ms/batch 396.4 | tok/s  124004 | loss  3.27 | ppl     26.31
| epoch  12 step    24590 | batches   1479 / 2101 | lr 4.044e-03 | ms/batch 397.0 | tok/s  123809 | loss  3.29 | ppl     26.74
| epoch  12 step    24600 | batches   1489 / 2101 | lr 4.041e-03 | ms/batch 396.9 | tok/s  123855 | loss  3.28 | ppl     26.62
| epoch  12 step    24610 | batches   1499 / 2101 | lr 4.037e-03 | ms/batch 407.5 | tok/s  120614 | loss  3.24 | ppl     25.48
| epoch  12 step    24620 | batches   1509 / 2101 | lr 4.034e-03 | ms/batch 398.2 | tok/s  123428 | loss  3.26 | ppl     26.08
| epoch  12 step    24630 | batches   1519 / 2101 | lr 4.030e-03 | ms/batch 407.9 | tok/s  120503 | loss  3.26 | ppl     25.95
| epoch  12 step    24640 | batches   1529 / 2101 | lr 4.027e-03 | ms/batch 399.8 | tok/s  122941 | loss  3.25 | ppl     25.76
| epoch  12 step    24650 | batches   1539 / 2101 | lr 4.024e-03 | ms/batch 408.9 | tok/s  120207 | loss  3.26 | ppl     25.93
| epoch  12 step    24660 | batches   1549 / 2101 | lr 4.020e-03 | ms/batch 397.9 | tok/s  123519 | loss  3.26 | ppl     25.97
| epoch  12 step    24670 | batches   1559 / 2101 | lr 4.017e-03 | ms/batch 397.6 | tok/s  123635 | loss  3.26 | ppl     25.99
| epoch  12 step    24680 | batches   1569 / 2101 | lr 4.013e-03 | ms/batch 397.4 | tok/s  123679 | loss  3.27 | ppl     26.27
| epoch  12 step    24690 | batches   1579 / 2101 | lr 4.010e-03 | ms/batch 397.7 | tok/s  123579 | loss  3.26 | ppl     25.98
| epoch  12 step    24700 | batches   1589 / 2101 | lr 4.006e-03 | ms/batch 397.9 | tok/s  123517 | loss  3.23 | ppl     25.30
| epoch  12 step    24710 | batches   1599 / 2101 | lr 4.003e-03 | ms/batch 397.3 | tok/s  123722 | loss  3.26 | ppl     26.13
| epoch  12 step    24720 | batches   1609 / 2101 | lr 4.000e-03 | ms/batch 397.4 | tok/s  123696 | loss  3.26 | ppl     25.99
| epoch  12 step    24730 | batches   1619 / 2101 | lr 3.996e-03 | ms/batch 397.6 | tok/s  123625 | loss  3.25 | ppl     25.91
| epoch  12 step    24740 | batches   1629 / 2101 | lr 3.993e-03 | ms/batch 397.5 | tok/s  123648 | loss  3.25 | ppl     25.67
| epoch  12 step    24750 | batches   1639 / 2101 | lr 3.989e-03 | ms/batch 397.8 | tok/s  123567 | loss  3.25 | ppl     25.68
| epoch  12 step    24760 | batches   1649 / 2101 | lr 3.986e-03 | ms/batch 397.4 | tok/s  123676 | loss  3.27 | ppl     26.25
| epoch  12 step    24770 | batches   1659 / 2101 | lr 3.983e-03 | ms/batch 397.5 | tok/s  123649 | loss  3.32 | ppl     27.57
| epoch  12 step    24780 | batches   1669 / 2101 | lr 3.979e-03 | ms/batch 397.8 | tok/s  123552 | loss  3.34 | ppl     28.34
| epoch  12 step    24790 | batches   1679 / 2101 | lr 3.976e-03 | ms/batch 397.8 | tok/s  123573 | loss  3.29 | ppl     26.96
| epoch  12 step    24800 | batches   1689 / 2101 | lr 3.972e-03 | ms/batch 397.5 | tok/s  123643 | loss  3.28 | ppl     26.62
| epoch  12 step    24810 | batches   1699 / 2101 | lr 3.969e-03 | ms/batch 397.7 | tok/s  123597 | loss  3.29 | ppl     26.76
| epoch  12 step    24820 | batches   1709 / 2101 | lr 3.965e-03 | ms/batch 397.8 | tok/s  123573 | loss  3.27 | ppl     26.39
| epoch  12 step    24830 | batches   1719 / 2101 | lr 3.962e-03 | ms/batch 398.6 | tok/s  123312 | loss  3.26 | ppl     26.09
| epoch  12 step    24840 | batches   1729 / 2101 | lr 3.959e-03 | ms/batch 397.4 | tok/s  123673 | loss  3.27 | ppl     26.30
| epoch  12 step    24850 | batches   1739 / 2101 | lr 3.955e-03 | ms/batch 397.6 | tok/s  123612 | loss  3.27 | ppl     26.39
| epoch  12 step    24860 | batches   1749 / 2101 | lr 3.952e-03 | ms/batch 398.0 | tok/s  123491 | loss  3.30 | ppl     27.13
| epoch  12 step    24870 | batches   1759 / 2101 | lr 3.948e-03 | ms/batch 398.8 | tok/s  123264 | loss  3.33 | ppl     27.84
| epoch  12 step    24880 | batches   1769 / 2101 | lr 3.945e-03 | ms/batch 398.0 | tok/s  123501 | loss  3.30 | ppl     27.14
| epoch  12 step    24890 | batches   1779 / 2101 | lr 3.942e-03 | ms/batch 397.6 | tok/s  123615 | loss  3.34 | ppl     28.14
| epoch  12 step    24900 | batches   1789 / 2101 | lr 3.938e-03 | ms/batch 398.1 | tok/s  123475 | loss  3.30 | ppl     27.14
| epoch  12 step    24910 | batches   1799 / 2101 | lr 3.935e-03 | ms/batch 397.9 | tok/s  123515 | loss  3.28 | ppl     26.53
| epoch  12 step    24920 | batches   1809 / 2101 | lr 3.931e-03 | ms/batch 398.3 | tok/s  123405 | loss  3.30 | ppl     27.20
| epoch  12 step    24930 | batches   1819 / 2101 | lr 3.928e-03 | ms/batch 398.0 | tok/s  123492 | loss  3.35 | ppl     28.63
| epoch  12 step    24940 | batches   1829 / 2101 | lr 3.925e-03 | ms/batch 397.8 | tok/s  123555 | loss  3.33 | ppl     27.81
| epoch  12 step    24950 | batches   1839 / 2101 | lr 3.921e-03 | ms/batch 397.8 | tok/s  123574 | loss  3.28 | ppl     26.64
| epoch  12 step    24960 | batches   1849 / 2101 | lr 3.918e-03 | ms/batch 397.6 | tok/s  123628 | loss  3.27 | ppl     26.30
| epoch  12 step    24970 | batches   1859 / 2101 | lr 3.914e-03 | ms/batch 398.3 | tok/s  123412 | loss  3.27 | ppl     26.33
| epoch  12 step    24980 | batches   1869 / 2101 | lr 3.911e-03 | ms/batch 398.5 | tok/s  123347 | loss  3.31 | ppl     27.47
| epoch  12 step    24990 | batches   1879 / 2101 | lr 3.908e-03 | ms/batch 400.0 | tok/s  122880 | loss  3.28 | ppl     26.62
| epoch  12 step    25000 | batches   1889 / 2101 | lr 3.904e-03 | ms/batch 413.5 | tok/s  118858 | loss  3.29 | ppl     26.90
----------------------------------------------------------------------------------------------------
| Eval  50 at step    25000 | time:  0.81s | valid loss  3.22 | valid ppl    24.966
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.04179233149960733, 0.0423414262531233, 0.04715897230569474, 0.040330879873287456, 0.03966659408060328, 0.04032801610215016, 0.042230068098096554, 0.04271541794880125, 0.03814922618503498, 0.03825394742743329, 0.041853641657177906, 0.04355565571245715, 0.039411353066641536, 0.04270710264274973, 0.041574410812628776, 0.041463082935041966, 0.04414157144506308, 0.04668697433619689, 0.045490616356077346, 0.041287054879776484, 0.04497095805764222, 0.04275326837725001, 0.04580910052393282, 0.04296458935155078, 0.041632367246636555, 0.04167258748316915, 0.044571986002074, 0.049033390936143784, 0.04502572415549089, 0.04125681654123516, 0.04291479590689938, 0.04222949832092785, 0.04455562632098424, 0.04054221692965926, 0.04069133974971106, 0.041626755209648036, 0.041927594328658155, 0.035204602335757416, 0.040365673882176864, 0.041615103766903305, 0.0340199518952791, 0.04010829098983283, 0.0462384513885452, 0.04162420306850794, 0.03842424599741673, 0.04027200937523025, 0.04072095882915164, 0.033888072045386644, 0.03777550854643344, 0.03981143493220955, 0.04214336001775668, 0.041027676547071644, 0.04132800792276572, 0.03583820272219746, 0.03754065348839824, 0.044345829329648145, 0.04146289737014789, 0.06516009601980881, 0.03849053836177177, 0.03789665263658631, 0.0330502976975777, 0.023296489610573828, 0.005991841817299997, 0.02971746637961308, 0.03599288701049448, 0.03592210223657568, 0.03429481771239949, 0.016347884255381438, 0.03276647937043166, 0.0364489408726036, 0.039797270397692375, 0.039301493781098526, 0.020524331052822992, 0.028276349542746416, 0.03360138020069568, 0.03575032104922314, 0.034229150056226613, 0.03482117447606351, 0.029510258124619135, 0.03501382843784886, 0.04081906118424457]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [56, 68, 8, 12, 8, 58, 84, 9, 21, 9], [44, 38, 17, 8, 8, 49, 53, 10, 9, 9], [29, 43, 8, 9, 8, 37, 40, 9, 8, 8], [27, 47, 8, 8, 8, 18, 15, 11, 8, 8], [8, 15, 8, 8, 8, 14, 22, 8, 8, 8], [9, 14, 8, 8, 8, 9, 16, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [8, 15, 8, 8, 8, 8, 9, 9, 8, 8], [8]]
optimal compression parameters =  [[], [56, 68, 8, 12, 8, 58, 84, 9, 21, 9], [44, 38, 17, 8, 8, 49, 53, 10, 9, 9], [29, 43, 8, 9, 8, 37, 40, 9, 8, 8], [27, 47, 8, 8, 8, 18, 15, 11, 8, 8], [8, 15, 8, 8, 8, 14, 22, 8, 8, 8], [9, 14, 8, 8, 8, 9, 16, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [8, 15, 8, 8, 8, 8, 9, 9, 8, 8], [8]]
| epoch  12 step    25010 | batches   1899 / 2101 | lr 3.901e-03 | ms/batch 4893.1 | tok/s   10045 | loss  3.27 | ppl     26.29
| epoch  12 step    25020 | batches   1909 / 2101 | lr 3.898e-03 | ms/batch 409.3 | tok/s  120084 | loss  3.27 | ppl     26.26
| epoch  12 step    25030 | batches   1919 / 2101 | lr 3.894e-03 | ms/batch 408.0 | tok/s  120474 | loss  3.32 | ppl     27.54
| epoch  12 step    25040 | batches   1929 / 2101 | lr 3.891e-03 | ms/batch 398.3 | tok/s  123415 | loss  3.30 | ppl     27.22
| epoch  12 step    25050 | batches   1939 / 2101 | lr 3.887e-03 | ms/batch 408.4 | tok/s  120360 | loss  3.28 | ppl     26.57
| epoch  12 step    25060 | batches   1949 / 2101 | lr 3.884e-03 | ms/batch 396.8 | tok/s  123878 | loss  3.33 | ppl     27.98
| epoch  12 step    25070 | batches   1959 / 2101 | lr 3.881e-03 | ms/batch 408.7 | tok/s  120256 | loss  3.32 | ppl     27.69
| epoch  12 step    25080 | batches   1969 / 2101 | lr 3.877e-03 | ms/batch 407.3 | tok/s  120667 | loss  3.33 | ppl     27.92
| epoch  12 step    25090 | batches   1979 / 2101 | lr 3.874e-03 | ms/batch 409.2 | tok/s  120119 | loss  3.33 | ppl     27.92
| epoch  12 step    25100 | batches   1989 / 2101 | lr 3.870e-03 | ms/batch 397.9 | tok/s  123545 | loss  3.32 | ppl     27.77
| epoch  12 step    25110 | batches   1999 / 2101 | lr 3.867e-03 | ms/batch 397.7 | tok/s  123579 | loss  3.28 | ppl     26.69
| epoch  12 step    25120 | batches   2009 / 2101 | lr 3.864e-03 | ms/batch 407.7 | tok/s  120570 | loss  3.27 | ppl     26.35
| epoch  12 step    25130 | batches   2019 / 2101 | lr 3.860e-03 | ms/batch 397.9 | tok/s  123521 | loss  3.28 | ppl     26.60
| epoch  12 step    25140 | batches   2029 / 2101 | lr 3.857e-03 | ms/batch 398.4 | tok/s  123390 | loss  3.31 | ppl     27.44
| epoch  12 step    25150 | batches   2039 / 2101 | lr 3.854e-03 | ms/batch 398.5 | tok/s  123335 | loss  3.31 | ppl     27.49
| epoch  12 step    25160 | batches   2049 / 2101 | lr 3.850e-03 | ms/batch 397.4 | tok/s  123696 | loss  3.32 | ppl     27.61
| epoch  12 step    25170 | batches   2059 / 2101 | lr 3.847e-03 | ms/batch 397.3 | tok/s  123712 | loss  3.28 | ppl     26.49
| epoch  12 step    25180 | batches   2069 / 2101 | lr 3.843e-03 | ms/batch 398.1 | tok/s  123458 | loss  3.28 | ppl     26.66
| epoch  12 step    25190 | batches   2079 / 2101 | lr 3.840e-03 | ms/batch 397.6 | tok/s  123612 | loss  3.28 | ppl     26.51
| epoch  12 step    25200 | batches   2089 / 2101 | lr 3.837e-03 | ms/batch 398.1 | tok/s  123475 | loss  3.31 | ppl     27.43
| epoch  12 step    25210 | batches   2099 / 2101 | lr 3.833e-03 | ms/batch 408.5 | tok/s  120312 | loss  3.29 | ppl     26.93
| epoch  13 step    25220 | batches      8 / 2101 | lr 3.830e-03 | ms/batch 412.4 | tok/s  119378 | loss  3.35 | ppl     28.51
| epoch  13 step    25230 | batches     18 / 2101 | lr 3.827e-03 | ms/batch 398.3 | tok/s  123416 | loss  3.30 | ppl     27.06
| epoch  13 step    25240 | batches     28 / 2101 | lr 3.823e-03 | ms/batch 398.2 | tok/s  123424 | loss  3.28 | ppl     26.52
| epoch  13 step    25250 | batches     38 / 2101 | lr 3.820e-03 | ms/batch 408.5 | tok/s  120324 | loss  3.29 | ppl     26.80
| epoch  13 step    25260 | batches     48 / 2101 | lr 3.817e-03 | ms/batch 399.5 | tok/s  123033 | loss  3.24 | ppl     25.42
| epoch  13 step    25270 | batches     58 / 2101 | lr 3.813e-03 | ms/batch 420.5 | tok/s  116896 | loss  3.25 | ppl     25.82
| epoch  13 step    25280 | batches     68 / 2101 | lr 3.810e-03 | ms/batch 400.3 | tok/s  122781 | loss  3.29 | ppl     26.74
| epoch  13 step    25290 | batches     78 / 2101 | lr 3.806e-03 | ms/batch 409.5 | tok/s  120038 | loss  3.26 | ppl     26.06
| epoch  13 step    25300 | batches     88 / 2101 | lr 3.803e-03 | ms/batch 398.9 | tok/s  123211 | loss  3.26 | ppl     25.99
| epoch  13 step    25310 | batches     98 / 2101 | lr 3.800e-03 | ms/batch 398.8 | tok/s  123263 | loss  3.23 | ppl     25.20
| epoch  13 step    25320 | batches    108 / 2101 | lr 3.796e-03 | ms/batch 398.6 | tok/s  123313 | loss  3.24 | ppl     25.43
| epoch  13 step    25330 | batches    118 / 2101 | lr 3.793e-03 | ms/batch 410.0 | tok/s  119895 | loss  3.23 | ppl     25.27
| epoch  13 step    25340 | batches    128 / 2101 | lr 3.790e-03 | ms/batch 400.2 | tok/s  122819 | loss  3.25 | ppl     25.92
| epoch  13 step    25350 | batches    138 / 2101 | lr 3.786e-03 | ms/batch 399.6 | tok/s  122999 | loss  3.22 | ppl     25.05
| epoch  13 step    25360 | batches    148 / 2101 | lr 3.783e-03 | ms/batch 400.8 | tok/s  122644 | loss  3.23 | ppl     25.21
| epoch  13 step    25370 | batches    158 / 2101 | lr 3.780e-03 | ms/batch 399.4 | tok/s  123071 | loss  3.20 | ppl     24.44
| epoch  13 step    25380 | batches    168 / 2101 | lr 3.776e-03 | ms/batch 399.5 | tok/s  123031 | loss  3.22 | ppl     25.13
| epoch  13 step    25390 | batches    178 / 2101 | lr 3.773e-03 | ms/batch 399.5 | tok/s  123038 | loss  3.25 | ppl     25.91
| epoch  13 step    25400 | batches    188 / 2101 | lr 3.770e-03 | ms/batch 398.3 | tok/s  123393 | loss  3.24 | ppl     25.48
| epoch  13 step    25410 | batches    198 / 2101 | lr 3.766e-03 | ms/batch 398.4 | tok/s  123384 | loss  3.24 | ppl     25.57
| epoch  13 step    25420 | batches    208 / 2101 | lr 3.763e-03 | ms/batch 398.5 | tok/s  123335 | loss  3.23 | ppl     25.40
| epoch  13 step    25430 | batches    218 / 2101 | lr 3.760e-03 | ms/batch 398.8 | tok/s  123245 | loss  3.26 | ppl     25.98
| epoch  13 step    25440 | batches    228 / 2101 | lr 3.756e-03 | ms/batch 400.6 | tok/s  122706 | loss  3.24 | ppl     25.57
| epoch  13 step    25450 | batches    238 / 2101 | lr 3.753e-03 | ms/batch 398.0 | tok/s  123488 | loss  3.27 | ppl     26.34
| epoch  13 step    25460 | batches    248 / 2101 | lr 3.749e-03 | ms/batch 398.4 | tok/s  123386 | loss  3.26 | ppl     25.94
| epoch  13 step    25470 | batches    258 / 2101 | lr 3.746e-03 | ms/batch 398.2 | tok/s  123423 | loss  3.27 | ppl     26.38
| epoch  13 step    25480 | batches    268 / 2101 | lr 3.743e-03 | ms/batch 398.2 | tok/s  123427 | loss  3.23 | ppl     25.31
| epoch  13 step    25490 | batches    278 / 2101 | lr 3.739e-03 | ms/batch 398.1 | tok/s  123454 | loss  3.25 | ppl     25.70
| epoch  13 step    25500 | batches    288 / 2101 | lr 3.736e-03 | ms/batch 398.0 | tok/s  123509 | loss  3.26 | ppl     26.01
----------------------------------------------------------------------------------------------------
| Eval  51 at step    25500 | time:  0.85s | valid loss  3.22 | valid ppl    24.938
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  13 step    25510 | batches    298 / 2101 | lr 3.733e-03 | ms/batch 397.2 | tok/s  123765 | loss  3.24 | ppl     25.54
| epoch  13 step    25520 | batches    308 / 2101 | lr 3.729e-03 | ms/batch 408.4 | tok/s  120359 | loss  3.23 | ppl     25.29
| epoch  13 step    25530 | batches    318 / 2101 | lr 3.726e-03 | ms/batch 407.3 | tok/s  120667 | loss  3.21 | ppl     24.89
| epoch  13 step    25540 | batches    328 / 2101 | lr 3.723e-03 | ms/batch 398.2 | tok/s  123448 | loss  3.23 | ppl     25.37
| epoch  13 step    25550 | batches    338 / 2101 | lr 3.719e-03 | ms/batch 398.1 | tok/s  123456 | loss  3.24 | ppl     25.44
| epoch  13 step    25560 | batches    348 / 2101 | lr 3.716e-03 | ms/batch 397.8 | tok/s  123547 | loss  3.24 | ppl     25.65
| epoch  13 step    25570 | batches    358 / 2101 | lr 3.713e-03 | ms/batch 399.1 | tok/s  123143 | loss  3.23 | ppl     25.19
| epoch  13 step    25580 | batches    368 / 2101 | lr 3.710e-03 | ms/batch 397.7 | tok/s  123597 | loss  3.25 | ppl     25.70
| epoch  13 step    25590 | batches    378 / 2101 | lr 3.706e-03 | ms/batch 398.0 | tok/s  123489 | loss  3.22 | ppl     25.08
| epoch  13 step    25600 | batches    388 / 2101 | lr 3.703e-03 | ms/batch 398.3 | tok/s  123411 | loss  3.24 | ppl     25.54
| epoch  13 step    25610 | batches    398 / 2101 | lr 3.700e-03 | ms/batch 398.0 | tok/s  123513 | loss  3.23 | ppl     25.17
| epoch  13 step    25620 | batches    408 / 2101 | lr 3.696e-03 | ms/batch 397.5 | tok/s  123658 | loss  3.23 | ppl     25.17
| epoch  13 step    25630 | batches    418 / 2101 | lr 3.693e-03 | ms/batch 397.1 | tok/s  123779 | loss  3.25 | ppl     25.84
| epoch  13 step    25640 | batches    428 / 2101 | lr 3.690e-03 | ms/batch 397.5 | tok/s  123650 | loss  3.27 | ppl     26.19
| epoch  13 step    25650 | batches    438 / 2101 | lr 3.686e-03 | ms/batch 398.0 | tok/s  123498 | loss  3.29 | ppl     26.77
| epoch  13 step    25660 | batches    448 / 2101 | lr 3.683e-03 | ms/batch 397.6 | tok/s  123623 | loss  3.27 | ppl     26.35
| epoch  13 step    25670 | batches    458 / 2101 | lr 3.680e-03 | ms/batch 397.7 | tok/s  123605 | loss  3.25 | ppl     25.79
| epoch  13 step    25680 | batches    468 / 2101 | lr 3.676e-03 | ms/batch 397.8 | tok/s  123554 | loss  3.26 | ppl     26.06
| epoch  13 step    25690 | batches    478 / 2101 | lr 3.673e-03 | ms/batch 398.6 | tok/s  123326 | loss  3.28 | ppl     26.53
| epoch  13 step    25700 | batches    488 / 2101 | lr 3.670e-03 | ms/batch 397.7 | tok/s  123578 | loss  3.26 | ppl     26.06
| epoch  13 step    25710 | batches    498 / 2101 | lr 3.666e-03 | ms/batch 397.9 | tok/s  123517 | loss  3.30 | ppl     27.07
| epoch  13 step    25720 | batches    508 / 2101 | lr 3.663e-03 | ms/batch 397.5 | tok/s  123653 | loss  3.25 | ppl     25.83
| epoch  13 step    25730 | batches    518 / 2101 | lr 3.660e-03 | ms/batch 397.8 | tok/s  123551 | loss  3.23 | ppl     25.38
| epoch  13 step    25740 | batches    528 / 2101 | lr 3.656e-03 | ms/batch 398.4 | tok/s  123377 | loss  3.24 | ppl     25.61
| epoch  13 step    25750 | batches    538 / 2101 | lr 3.653e-03 | ms/batch 399.5 | tok/s  123042 | loss  3.27 | ppl     26.24
| epoch  13 step    25760 | batches    548 / 2101 | lr 3.650e-03 | ms/batch 402.3 | tok/s  122180 | loss  3.27 | ppl     26.28
| epoch  13 step    25770 | batches    558 / 2101 | lr 3.647e-03 | ms/batch 398.8 | tok/s  123240 | loss  3.28 | ppl     26.65
| epoch  13 step    25780 | batches    568 / 2101 | lr 3.643e-03 | ms/batch 398.0 | tok/s  123494 | loss  3.28 | ppl     26.63
| epoch  13 step    25790 | batches    578 / 2101 | lr 3.640e-03 | ms/batch 398.0 | tok/s  123497 | loss  3.26 | ppl     26.09
| epoch  13 step    25800 | batches    588 / 2101 | lr 3.637e-03 | ms/batch 398.1 | tok/s  123466 | loss  3.26 | ppl     26.11
| epoch  13 step    25810 | batches    598 / 2101 | lr 3.633e-03 | ms/batch 397.6 | tok/s  123630 | loss  3.27 | ppl     26.40
| epoch  13 step    25820 | batches    608 / 2101 | lr 3.630e-03 | ms/batch 397.9 | tok/s  123515 | loss  3.25 | ppl     25.87
| epoch  13 step    25830 | batches    618 / 2101 | lr 3.627e-03 | ms/batch 398.1 | tok/s  123457 | loss  3.24 | ppl     25.42
| epoch  13 step    25840 | batches    628 / 2101 | lr 3.623e-03 | ms/batch 398.1 | tok/s  123459 | loss  3.24 | ppl     25.63
| epoch  13 step    25850 | batches    638 / 2101 | lr 3.620e-03 | ms/batch 398.0 | tok/s  123500 | loss  3.25 | ppl     25.69
| epoch  13 step    25860 | batches    648 / 2101 | lr 3.617e-03 | ms/batch 398.4 | tok/s  123366 | loss  3.27 | ppl     26.39
| epoch  13 step    25870 | batches    658 / 2101 | lr 3.614e-03 | ms/batch 398.6 | tok/s  123323 | loss  3.25 | ppl     25.73
| epoch  13 step    25880 | batches    668 / 2101 | lr 3.610e-03 | ms/batch 397.8 | tok/s  123557 | loss  3.24 | ppl     25.45
| epoch  13 step    25890 | batches    678 / 2101 | lr 3.607e-03 | ms/batch 398.2 | tok/s  123425 | loss  3.22 | ppl     24.94
| epoch  13 step    25900 | batches    688 / 2101 | lr 3.604e-03 | ms/batch 398.2 | tok/s  123437 | loss  3.21 | ppl     24.79
| epoch  13 step    25910 | batches    698 / 2101 | lr 3.600e-03 | ms/batch 399.5 | tok/s  123041 | loss  3.24 | ppl     25.64
| epoch  13 step    25920 | batches    708 / 2101 | lr 3.597e-03 | ms/batch 397.5 | tok/s  123642 | loss  3.24 | ppl     25.54
| epoch  13 step    25930 | batches    718 / 2101 | lr 3.594e-03 | ms/batch 398.6 | tok/s  123321 | loss  3.25 | ppl     25.74
| epoch  13 step    25940 | batches    728 / 2101 | lr 3.591e-03 | ms/batch 397.4 | tok/s  123688 | loss  3.28 | ppl     26.55
| epoch  13 step    25950 | batches    738 / 2101 | lr 3.587e-03 | ms/batch 398.4 | tok/s  123375 | loss  3.29 | ppl     26.73
| epoch  13 step    25960 | batches    748 / 2101 | lr 3.584e-03 | ms/batch 398.0 | tok/s  123491 | loss  3.29 | ppl     26.91
| epoch  13 step    25970 | batches    758 / 2101 | lr 3.581e-03 | ms/batch 398.3 | tok/s  123411 | loss  3.25 | ppl     25.86
| epoch  13 step    25980 | batches    768 / 2101 | lr 3.577e-03 | ms/batch 398.7 | tok/s  123293 | loss  3.28 | ppl     26.63
| epoch  13 step    25990 | batches    778 / 2101 | lr 3.574e-03 | ms/batch 398.3 | tok/s  123414 | loss  3.24 | ppl     25.47
| epoch  13 step    26000 | batches    788 / 2101 | lr 3.571e-03 | ms/batch 412.5 | tok/s  119152 | loss  3.27 | ppl     26.39
----------------------------------------------------------------------------------------------------
| Eval  52 at step    26000 | time:  0.83s | valid loss  3.21 | valid ppl    24.840
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.04274560857751062, 0.04337322693813505, 0.042868616704143665, 0.03911748508170208, 0.039903697992945644, 0.04035069423685681, 0.04260774386651282, 0.048641773291826305, 0.03968710434835554, 0.03759525629407064, 0.04088937787923565, 0.04472064780213128, 0.04140807227265063, 0.042784437476819176, 0.042190413187287064, 0.04223809579435632, 0.044333196242999334, 0.050579191389231185, 0.0431655568459033, 0.04164717795567878, 0.044039246281238426, 0.043288506631933836, 0.04678463387093852, 0.043263205358430756, 0.0418835910546897, 0.044160657974683944, 0.04509776710910073, 0.04920673554647245, 0.043153155786876514, 0.04257848865323404, 0.043350601553348425, 0.042018222568290714, 0.04424641360902577, 0.03818640941474842, 0.041113627502100535, 0.042824692303817836, 0.042480621524865245, 0.03641804620754715, 0.03955794834984352, 0.04132165471713181, 0.047584599811628214, 0.044802083364641164, 0.03999576329296287, 0.036759357914539076, 0.039431208883015906, 0.044448782399212586, 0.040195683147858104, 0.038994763069118275, 0.03919862086334094, 0.040542045692562596, 0.0420713572440272, 0.04244648613045478, 0.04134176698288089, 0.03201668573277777, 0.03822840371192406, 0.04003373808568928, 0.041706611040304195, 0.017887771245922057, 0.03820600872421481, 0.03902417205440831, 0.0308381636002433, 0.02556801705196691, 0.010284633462233246, 0.029646207296436532, 0.0360903661770408, 0.031635751421026224, 0.037028211844647205, 0.01465615396752558, 0.03218752008958028, 0.03733557376437153, 0.037283649721899105, 0.0399355448883211, 0.014115394296210263, 0.028761563786854634, 0.03377540966388306, 0.037368539842246674, 0.0355997936530138, 0.042622325494182677, 0.029925496514790068, 0.035258118172683726, 0.03846838743612792]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [53, 67, 8, 14, 9, 55, 86, 9, 22, 8], [40, 37, 17, 8, 8, 49, 64, 11, 8, 8], [28, 42, 8, 9, 8, 38, 42, 9, 8, 9], [29, 46, 8, 8, 8, 16, 14, 11, 8, 8], [9, 14, 8, 8, 8, 15, 18, 9, 8, 8], [9, 14, 8, 8, 8, 10, 12, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 8, 8, 8], [8, 12, 8, 8, 8, 10, 10, 9, 8, 8], [8]]
optimal compression parameters =  [[], [53, 67, 8, 14, 9, 55, 86, 9, 22, 8], [40, 37, 17, 8, 8, 49, 64, 11, 8, 8], [28, 42, 8, 9, 8, 38, 42, 9, 8, 9], [29, 46, 8, 8, 8, 16, 14, 11, 8, 8], [9, 14, 8, 8, 8, 15, 18, 9, 8, 8], [9, 14, 8, 8, 8, 10, 12, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 8, 8, 8], [8, 12, 8, 8, 8, 10, 10, 9, 8, 8], [8]]
| epoch  13 step    26010 | batches    798 / 2101 | lr 3.568e-03 | ms/batch 4906.2 | tok/s   10018 | loss  3.24 | ppl     25.59
| epoch  13 step    26020 | batches    808 / 2101 | lr 3.564e-03 | ms/batch 406.6 | tok/s  120899 | loss  3.29 | ppl     26.96
| epoch  13 step    26030 | batches    818 / 2101 | lr 3.561e-03 | ms/batch 396.8 | tok/s  123867 | loss  3.29 | ppl     26.75
| epoch  13 step    26040 | batches    828 / 2101 | lr 3.558e-03 | ms/batch 396.3 | tok/s  124036 | loss  3.29 | ppl     26.83
| epoch  13 step    26050 | batches    838 / 2101 | lr 3.555e-03 | ms/batch 395.6 | tok/s  124261 | loss  3.27 | ppl     26.43
| epoch  13 step    26060 | batches    848 / 2101 | lr 3.551e-03 | ms/batch 396.4 | tok/s  123991 | loss  3.26 | ppl     26.06
| epoch  13 step    26070 | batches    858 / 2101 | lr 3.548e-03 | ms/batch 397.2 | tok/s  123751 | loss  3.22 | ppl     25.09
| epoch  13 step    26080 | batches    868 / 2101 | lr 3.545e-03 | ms/batch 396.3 | tok/s  124044 | loss  3.27 | ppl     26.39
| epoch  13 step    26090 | batches    878 / 2101 | lr 3.541e-03 | ms/batch 396.7 | tok/s  123907 | loss  3.28 | ppl     26.55
| epoch  13 step    26100 | batches    888 / 2101 | lr 3.538e-03 | ms/batch 398.1 | tok/s  123482 | loss  3.23 | ppl     25.23
| epoch  13 step    26110 | batches    898 / 2101 | lr 3.535e-03 | ms/batch 396.6 | tok/s  123942 | loss  3.24 | ppl     25.54
| epoch  13 step    26120 | batches    908 / 2101 | lr 3.532e-03 | ms/batch 396.8 | tok/s  123875 | loss  3.32 | ppl     27.55
| epoch  13 step    26130 | batches    918 / 2101 | lr 3.528e-03 | ms/batch 396.8 | tok/s  123870 | loss  3.32 | ppl     27.70
| epoch  13 step    26140 | batches    928 / 2101 | lr 3.525e-03 | ms/batch 397.4 | tok/s  123679 | loss  3.29 | ppl     26.71
| epoch  13 step    26150 | batches    938 / 2101 | lr 3.522e-03 | ms/batch 397.4 | tok/s  123672 | loss  3.26 | ppl     25.97
| epoch  13 step    26160 | batches    948 / 2101 | lr 3.519e-03 | ms/batch 397.0 | tok/s  123821 | loss  3.25 | ppl     25.79
| epoch  13 step    26170 | batches    958 / 2101 | lr 3.515e-03 | ms/batch 396.9 | tok/s  123826 | loss  3.22 | ppl     25.01
| epoch  13 step    26180 | batches    968 / 2101 | lr 3.512e-03 | ms/batch 397.1 | tok/s  123793 | loss  3.26 | ppl     26.16
| epoch  13 step    26190 | batches    978 / 2101 | lr 3.509e-03 | ms/batch 396.8 | tok/s  123857 | loss  3.27 | ppl     26.32
| epoch  13 step    26200 | batches    988 / 2101 | lr 3.506e-03 | ms/batch 398.0 | tok/s  123493 | loss  3.25 | ppl     25.86
| epoch  13 step    26210 | batches    998 / 2101 | lr 3.502e-03 | ms/batch 397.7 | tok/s  123598 | loss  3.25 | ppl     25.91
| epoch  13 step    26220 | batches   1008 / 2101 | lr 3.499e-03 | ms/batch 397.6 | tok/s  123636 | loss  3.29 | ppl     26.93
| epoch  13 step    26230 | batches   1018 / 2101 | lr 3.496e-03 | ms/batch 396.8 | tok/s  123878 | loss  3.32 | ppl     27.60
| epoch  13 step    26240 | batches   1028 / 2101 | lr 3.493e-03 | ms/batch 397.4 | tok/s  123679 | loss  3.29 | ppl     26.81
| epoch  13 step    26250 | batches   1038 / 2101 | lr 3.489e-03 | ms/batch 399.3 | tok/s  123097 | loss  3.29 | ppl     26.89
| epoch  13 step    26260 | batches   1048 / 2101 | lr 3.486e-03 | ms/batch 397.4 | tok/s  123700 | loss  3.22 | ppl     25.08
| epoch  13 step    26270 | batches   1058 / 2101 | lr 3.483e-03 | ms/batch 397.8 | tok/s  123572 | loss  3.22 | ppl     25.02
| epoch  13 step    26280 | batches   1068 / 2101 | lr 3.480e-03 | ms/batch 397.6 | tok/s  123637 | loss  3.24 | ppl     25.49
| epoch  13 step    26290 | batches   1078 / 2101 | lr 3.476e-03 | ms/batch 398.5 | tok/s  123354 | loss  3.22 | ppl     24.95
| epoch  13 step    26300 | batches   1088 / 2101 | lr 3.473e-03 | ms/batch 397.4 | tok/s  123698 | loss  3.20 | ppl     24.62
| epoch  13 step    26310 | batches   1098 / 2101 | lr 3.470e-03 | ms/batch 398.0 | tok/s  123502 | loss  3.22 | ppl     25.06
| epoch  13 step    26320 | batches   1108 / 2101 | lr 3.467e-03 | ms/batch 397.9 | tok/s  123545 | loss  3.22 | ppl     24.91
| epoch  13 step    26330 | batches   1118 / 2101 | lr 3.464e-03 | ms/batch 398.2 | tok/s  123428 | loss  3.25 | ppl     25.67
| epoch  13 step    26340 | batches   1128 / 2101 | lr 3.460e-03 | ms/batch 397.2 | tok/s  123740 | loss  3.25 | ppl     25.75
| epoch  13 step    26350 | batches   1138 / 2101 | lr 3.457e-03 | ms/batch 398.0 | tok/s  123507 | loss  3.26 | ppl     26.05
| epoch  13 step    26360 | batches   1148 / 2101 | lr 3.454e-03 | ms/batch 397.5 | tok/s  123653 | loss  3.28 | ppl     26.51
| epoch  13 step    26370 | batches   1158 / 2101 | lr 3.451e-03 | ms/batch 398.3 | tok/s  123420 | loss  3.27 | ppl     26.21
| epoch  13 step    26380 | batches   1168 / 2101 | lr 3.447e-03 | ms/batch 398.6 | tok/s  123327 | loss  3.27 | ppl     26.23
| epoch  13 step    26390 | batches   1178 / 2101 | lr 3.444e-03 | ms/batch 408.4 | tok/s  120343 | loss  3.24 | ppl     25.62
| epoch  13 step    26400 | batches   1188 / 2101 | lr 3.441e-03 | ms/batch 398.9 | tok/s  123227 | loss  3.23 | ppl     25.35
| epoch  13 step    26410 | batches   1198 / 2101 | lr 3.438e-03 | ms/batch 398.7 | tok/s  123297 | loss  3.25 | ppl     25.85
| epoch  13 step    26420 | batches   1208 / 2101 | lr 3.434e-03 | ms/batch 398.2 | tok/s  123428 | loss  3.27 | ppl     26.27
| epoch  13 step    26430 | batches   1218 / 2101 | lr 3.431e-03 | ms/batch 397.5 | tok/s  123668 | loss  3.26 | ppl     26.01
| epoch  13 step    26440 | batches   1228 / 2101 | lr 3.428e-03 | ms/batch 399.1 | tok/s  123154 | loss  3.25 | ppl     25.87
| epoch  13 step    26450 | batches   1238 / 2101 | lr 3.425e-03 | ms/batch 397.6 | tok/s  123638 | loss  3.26 | ppl     25.95
| epoch  13 step    26460 | batches   1248 / 2101 | lr 3.422e-03 | ms/batch 397.3 | tok/s  123714 | loss  3.26 | ppl     26.16
| epoch  13 step    26470 | batches   1258 / 2101 | lr 3.418e-03 | ms/batch 398.3 | tok/s  123419 | loss  3.27 | ppl     26.35
| epoch  13 step    26480 | batches   1268 / 2101 | lr 3.415e-03 | ms/batch 398.7 | tok/s  123291 | loss  3.29 | ppl     26.97
| epoch  13 step    26490 | batches   1278 / 2101 | lr 3.412e-03 | ms/batch 397.7 | tok/s  123589 | loss  3.33 | ppl     27.84
| epoch  13 step    26500 | batches   1288 / 2101 | lr 3.409e-03 | ms/batch 398.2 | tok/s  123440 | loss  3.27 | ppl     26.26
----------------------------------------------------------------------------------------------------
| Eval  53 at step    26500 | time:  0.81s | valid loss  3.20 | valid ppl    24.629
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  13 step    26510 | batches   1298 / 2101 | lr 3.406e-03 | ms/batch 397.9 | tok/s  123528 | loss  3.23 | ppl     25.40
| epoch  13 step    26520 | batches   1308 / 2101 | lr 3.402e-03 | ms/batch 410.1 | tok/s  119849 | loss  3.20 | ppl     24.53
| epoch  13 step    26530 | batches   1318 / 2101 | lr 3.399e-03 | ms/batch 409.5 | tok/s  120036 | loss  3.24 | ppl     25.48
| epoch  13 step    26540 | batches   1328 / 2101 | lr 3.396e-03 | ms/batch 399.7 | tok/s  122972 | loss  3.21 | ppl     24.79
| epoch  13 step    26550 | batches   1338 / 2101 | lr 3.393e-03 | ms/batch 409.6 | tok/s  120003 | loss  3.19 | ppl     24.25
| epoch  13 step    26560 | batches   1348 / 2101 | lr 3.390e-03 | ms/batch 409.5 | tok/s  120044 | loss  3.24 | ppl     25.44
| epoch  13 step    26570 | batches   1358 / 2101 | lr 3.386e-03 | ms/batch 400.3 | tok/s  122777 | loss  3.24 | ppl     25.60
| epoch  13 step    26580 | batches   1368 / 2101 | lr 3.383e-03 | ms/batch 399.4 | tok/s  123076 | loss  3.26 | ppl     26.07
| epoch  13 step    26590 | batches   1378 / 2101 | lr 3.380e-03 | ms/batch 398.4 | tok/s  123379 | loss  3.26 | ppl     25.94
| epoch  13 step    26600 | batches   1388 / 2101 | lr 3.377e-03 | ms/batch 398.9 | tok/s  123225 | loss  3.25 | ppl     25.83
| epoch  13 step    26610 | batches   1398 / 2101 | lr 3.374e-03 | ms/batch 398.2 | tok/s  123430 | loss  3.25 | ppl     25.87
| epoch  13 step    26620 | batches   1408 / 2101 | lr 3.370e-03 | ms/batch 397.9 | tok/s  123523 | loss  3.22 | ppl     25.00
| epoch  13 step    26630 | batches   1418 / 2101 | lr 3.367e-03 | ms/batch 398.0 | tok/s  123507 | loss  3.21 | ppl     24.86
| epoch  13 step    26640 | batches   1428 / 2101 | lr 3.364e-03 | ms/batch 398.1 | tok/s  123465 | loss  3.30 | ppl     26.99
| epoch  13 step    26650 | batches   1438 / 2101 | lr 3.361e-03 | ms/batch 398.1 | tok/s  123467 | loss  3.32 | ppl     27.79
| epoch  13 step    26660 | batches   1448 / 2101 | lr 3.358e-03 | ms/batch 398.5 | tok/s  123356 | loss  3.26 | ppl     26.14
| epoch  13 step    26670 | batches   1458 / 2101 | lr 3.354e-03 | ms/batch 397.1 | tok/s  123777 | loss  3.22 | ppl     24.99
| epoch  13 step    26680 | batches   1468 / 2101 | lr 3.351e-03 | ms/batch 398.0 | tok/s  123485 | loss  3.24 | ppl     25.52
| epoch  13 step    26690 | batches   1478 / 2101 | lr 3.348e-03 | ms/batch 397.4 | tok/s  123683 | loss  3.28 | ppl     26.57
| epoch  13 step    26700 | batches   1488 / 2101 | lr 3.345e-03 | ms/batch 397.3 | tok/s  123702 | loss  3.25 | ppl     25.90
| epoch  13 step    26710 | batches   1498 / 2101 | lr 3.342e-03 | ms/batch 397.6 | tok/s  123609 | loss  3.27 | ppl     26.20
| epoch  13 step    26720 | batches   1508 / 2101 | lr 3.338e-03 | ms/batch 397.8 | tok/s  123553 | loss  3.25 | ppl     25.89
| epoch  13 step    26730 | batches   1518 / 2101 | lr 3.335e-03 | ms/batch 398.1 | tok/s  123460 | loss  3.24 | ppl     25.56
| epoch  13 step    26740 | batches   1528 / 2101 | lr 3.332e-03 | ms/batch 402.0 | tok/s  122285 | loss  3.27 | ppl     26.35
| epoch  13 step    26750 | batches   1538 / 2101 | lr 3.329e-03 | ms/batch 397.8 | tok/s  123550 | loss  3.27 | ppl     26.36
| epoch  13 step    26760 | batches   1548 / 2101 | lr 3.326e-03 | ms/batch 398.4 | tok/s  123383 | loss  3.30 | ppl     26.98
| epoch  13 step    26770 | batches   1558 / 2101 | lr 3.323e-03 | ms/batch 409.8 | tok/s  119940 | loss  3.29 | ppl     26.93
| epoch  13 step    26780 | batches   1568 / 2101 | lr 3.319e-03 | ms/batch 409.6 | tok/s  120010 | loss  3.25 | ppl     25.88
| epoch  13 step    26790 | batches   1578 / 2101 | lr 3.316e-03 | ms/batch 399.9 | tok/s  122900 | loss  3.26 | ppl     26.10
| epoch  13 step    26800 | batches   1588 / 2101 | lr 3.313e-03 | ms/batch 400.0 | tok/s  122870 | loss  3.26 | ppl     25.95
| epoch  13 step    26810 | batches   1598 / 2101 | lr 3.310e-03 | ms/batch 399.4 | tok/s  123074 | loss  3.28 | ppl     26.46
| epoch  13 step    26820 | batches   1608 / 2101 | lr 3.307e-03 | ms/batch 399.2 | tok/s  123136 | loss  3.25 | ppl     25.87
| epoch  13 step    26830 | batches   1618 / 2101 | lr 3.304e-03 | ms/batch 397.2 | tok/s  123761 | loss  3.26 | ppl     25.97
| epoch  13 step    26840 | batches   1628 / 2101 | lr 3.300e-03 | ms/batch 397.6 | tok/s  123610 | loss  3.24 | ppl     25.55
| epoch  13 step    26850 | batches   1638 / 2101 | lr 3.297e-03 | ms/batch 397.4 | tok/s  123689 | loss  3.26 | ppl     25.94
| epoch  13 step    26860 | batches   1648 / 2101 | lr 3.294e-03 | ms/batch 397.7 | tok/s  123582 | loss  3.21 | ppl     24.66
| epoch  13 step    26870 | batches   1658 / 2101 | lr 3.291e-03 | ms/batch 398.0 | tok/s  123497 | loss  3.22 | ppl     25.05
| epoch  13 step    26880 | batches   1668 / 2101 | lr 3.288e-03 | ms/batch 397.4 | tok/s  123672 | loss  3.23 | ppl     25.33
| epoch  13 step    26890 | batches   1678 / 2101 | lr 3.285e-03 | ms/batch 398.0 | tok/s  123513 | loss  3.25 | ppl     25.84
| epoch  13 step    26900 | batches   1688 / 2101 | lr 3.281e-03 | ms/batch 400.5 | tok/s  122723 | loss  3.24 | ppl     25.61
| epoch  13 step    26910 | batches   1698 / 2101 | lr 3.278e-03 | ms/batch 398.4 | tok/s  123385 | loss  3.27 | ppl     26.33
| epoch  13 step    26920 | batches   1708 / 2101 | lr 3.275e-03 | ms/batch 398.0 | tok/s  123489 | loss  3.27 | ppl     26.38
| epoch  13 step    26930 | batches   1718 / 2101 | lr 3.272e-03 | ms/batch 397.6 | tok/s  123623 | loss  3.24 | ppl     25.49
| epoch  13 step    26940 | batches   1728 / 2101 | lr 3.269e-03 | ms/batch 398.4 | tok/s  123387 | loss  3.23 | ppl     25.21
| epoch  13 step    26950 | batches   1738 / 2101 | lr 3.266e-03 | ms/batch 398.1 | tok/s  123462 | loss  3.25 | ppl     25.68
| epoch  13 step    26960 | batches   1748 / 2101 | lr 3.263e-03 | ms/batch 398.0 | tok/s  123489 | loss  3.25 | ppl     25.85
| epoch  13 step    26970 | batches   1758 / 2101 | lr 3.259e-03 | ms/batch 398.4 | tok/s  123367 | loss  3.26 | ppl     26.12
| epoch  13 step    26980 | batches   1768 / 2101 | lr 3.256e-03 | ms/batch 398.6 | tok/s  123301 | loss  3.28 | ppl     26.50
| epoch  13 step    26990 | batches   1778 / 2101 | lr 3.253e-03 | ms/batch 399.0 | tok/s  123183 | loss  3.29 | ppl     26.90
| epoch  13 step    27000 | batches   1788 / 2101 | lr 3.250e-03 | ms/batch 415.0 | tok/s  118437 | loss  3.29 | ppl     26.79
----------------------------------------------------------------------------------------------------
| Eval  54 at step    27000 | time:  0.81s | valid loss  3.20 | valid ppl    24.581
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.04009216729485051, 0.04042107603811608, 0.041553696708087944, 0.03949484542479982, 0.038922457204942494, 0.03981858344299191, 0.03961715622274831, 0.0489392875067263, 0.04365996677003295, 0.03678412283412459, 0.04191102191126803, 0.04185981655113565, 0.036555451093640355, 0.047185308254563026, 0.04020536948376626, 0.04129695268453981, 0.04215403628155306, 0.04363312727181399, 0.04309887304808784, 0.03935972419741606, 0.04236652903949709, 0.04149732827633441, 0.05922188659894018, 0.04321594872154661, 0.04023541110726007, 0.0418824377605282, 0.04249891119132898, 0.041532608010233674, 0.04243989049104098, 0.04048810223159404, 0.04225795456856142, 0.040760657244965165, 0.04904893932245836, 0.036885484385724164, 0.039690004493434745, 0.04146923004188527, 0.041026698813642674, 0.035023344834748595, 0.040300105259194044, 0.04022236482785836, 0.03972603915773956, 0.042243979963919855, 0.046826302845625854, 0.03577367940363031, 0.03803574171643612, 0.04077436531189611, 0.04131023146806926, 0.040705812073782204, 0.0389210710582949, 0.039220047150846093, 0.038823752359108, 0.0389382298820038, 0.03645308686630833, 0.03495053619330081, 0.03701973147501436, 0.04027082214557877, 0.04018567155705951, 0.03431969075621462, 0.037860339250554466, 0.03773208859485033, 0.02839515803231398, 0.025114056525545474, 0.012293836675273302, 0.029182210449280283, 0.03510158456817192, 0.036873079244433504, 0.035295122712152335, 0.024885702116785872, 0.03287130348378625, 0.03636615430850923, 0.041640977397443685, 0.03728087813253552, 0.036595330332114484, 0.028411438662396718, 0.0332018342143484, 0.03630147692923772, 0.03329576784935031, 0.03422189658682007, 0.02881762916790117, 0.03502410391663071, 0.03997200111026868]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [53, 69, 8, 13, 8, 59, 85, 9, 18, 11], [35, 39, 14, 8, 8, 48, 54, 8, 8, 9], [33, 38, 8, 8, 8, 36, 44, 9, 8, 8], [28, 52, 8, 8, 8, 19, 14, 8, 8, 8], [12, 13, 8, 8, 8, 16, 21, 9, 8, 8], [8, 15, 9, 8, 8, 10, 13, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 8, 8, 8], [8, 9, 8, 8, 8, 8, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [53, 69, 8, 13, 8, 59, 85, 9, 18, 11], [35, 39, 14, 8, 8, 48, 54, 8, 8, 9], [33, 38, 8, 8, 8, 36, 44, 9, 8, 8], [28, 52, 8, 8, 8, 19, 14, 8, 8, 8], [12, 13, 8, 8, 8, 16, 21, 9, 8, 8], [8, 15, 9, 8, 8, 10, 13, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 8, 8, 8], [8, 9, 8, 8, 8, 8, 8, 8, 8, 8], [8]]
| epoch  13 step    27010 | batches   1798 / 2101 | lr 3.247e-03 | ms/batch 4899.1 | tok/s   10033 | loss  3.24 | ppl     25.57
| epoch  13 step    27020 | batches   1808 / 2101 | lr 3.244e-03 | ms/batch 407.3 | tok/s  120674 | loss  3.21 | ppl     24.82
| epoch  13 step    27030 | batches   1818 / 2101 | lr 3.241e-03 | ms/batch 395.8 | tok/s  124197 | loss  3.27 | ppl     26.44
| epoch  13 step    27040 | batches   1828 / 2101 | lr 3.237e-03 | ms/batch 395.7 | tok/s  124220 | loss  3.22 | ppl     25.07
| epoch  13 step    27050 | batches   1838 / 2101 | lr 3.234e-03 | ms/batch 396.0 | tok/s  124110 | loss  3.23 | ppl     25.27
| epoch  13 step    27060 | batches   1848 / 2101 | lr 3.231e-03 | ms/batch 396.5 | tok/s  123972 | loss  3.25 | ppl     25.80
| epoch  13 step    27070 | batches   1858 / 2101 | lr 3.228e-03 | ms/batch 397.1 | tok/s  123786 | loss  3.26 | ppl     26.03
| epoch  13 step    27080 | batches   1868 / 2101 | lr 3.225e-03 | ms/batch 397.3 | tok/s  123703 | loss  3.27 | ppl     26.42
| epoch  13 step    27090 | batches   1878 / 2101 | lr 3.222e-03 | ms/batch 397.0 | tok/s  123806 | loss  3.31 | ppl     27.46
| epoch  13 step    27100 | batches   1888 / 2101 | lr 3.219e-03 | ms/batch 400.6 | tok/s  122690 | loss  3.34 | ppl     28.24
| epoch  13 step    27110 | batches   1898 / 2101 | lr 3.216e-03 | ms/batch 397.6 | tok/s  123627 | loss  3.29 | ppl     26.76
| epoch  13 step    27120 | batches   1908 / 2101 | lr 3.212e-03 | ms/batch 397.6 | tok/s  123621 | loss  3.26 | ppl     26.04
| epoch  13 step    27130 | batches   1918 / 2101 | lr 3.209e-03 | ms/batch 396.6 | tok/s  123947 | loss  3.25 | ppl     25.75
| epoch  13 step    27140 | batches   1928 / 2101 | lr 3.206e-03 | ms/batch 397.0 | tok/s  123804 | loss  3.26 | ppl     26.10
| epoch  13 step    27150 | batches   1938 / 2101 | lr 3.203e-03 | ms/batch 396.6 | tok/s  123938 | loss  3.27 | ppl     26.27
| epoch  13 step    27160 | batches   1948 / 2101 | lr 3.200e-03 | ms/batch 395.9 | tok/s  124161 | loss  3.30 | ppl     27.04
| epoch  13 step    27170 | batches   1958 / 2101 | lr 3.197e-03 | ms/batch 397.4 | tok/s  123678 | loss  3.26 | ppl     26.17
| epoch  13 step    27180 | batches   1968 / 2101 | lr 3.194e-03 | ms/batch 397.5 | tok/s  123659 | loss  3.23 | ppl     25.30
| epoch  13 step    27190 | batches   1978 / 2101 | lr 3.191e-03 | ms/batch 397.3 | tok/s  123715 | loss  3.24 | ppl     25.48
| epoch  13 step    27200 | batches   1988 / 2101 | lr 3.188e-03 | ms/batch 397.6 | tok/s  123609 | loss  3.24 | ppl     25.44
| epoch  13 step    27210 | batches   1998 / 2101 | lr 3.184e-03 | ms/batch 397.7 | tok/s  123607 | loss  3.24 | ppl     25.50
| epoch  13 step    27220 | batches   2008 / 2101 | lr 3.181e-03 | ms/batch 397.9 | tok/s  123536 | loss  3.23 | ppl     25.36
| epoch  13 step    27230 | batches   2018 / 2101 | lr 3.178e-03 | ms/batch 397.6 | tok/s  123624 | loss  3.26 | ppl     25.95
| epoch  13 step    27240 | batches   2028 / 2101 | lr 3.175e-03 | ms/batch 400.2 | tok/s  122831 | loss  3.29 | ppl     26.71
| epoch  13 step    27250 | batches   2038 / 2101 | lr 3.172e-03 | ms/batch 398.1 | tok/s  123471 | loss  3.28 | ppl     26.53
| epoch  13 step    27260 | batches   2048 / 2101 | lr 3.169e-03 | ms/batch 398.5 | tok/s  123342 | loss  3.27 | ppl     26.25
| epoch  13 step    27270 | batches   2058 / 2101 | lr 3.166e-03 | ms/batch 398.1 | tok/s  123474 | loss  3.24 | ppl     25.58
| epoch  13 step    27280 | batches   2068 / 2101 | lr 3.163e-03 | ms/batch 397.3 | tok/s  123717 | loss  3.25 | ppl     25.70
| epoch  13 step    27290 | batches   2078 / 2101 | lr 3.160e-03 | ms/batch 398.1 | tok/s  123478 | loss  3.25 | ppl     25.91
| epoch  13 step    27300 | batches   2088 / 2101 | lr 3.156e-03 | ms/batch 398.8 | tok/s  123242 | loss  3.27 | ppl     26.24
| epoch  13 step    27310 | batches   2098 / 2101 | lr 3.153e-03 | ms/batch 398.1 | tok/s  123465 | loss  3.29 | ppl     26.76
| epoch  14 step    27320 | batches      7 / 2101 | lr 3.150e-03 | ms/batch 399.6 | tok/s  123147 | loss  3.34 | ppl     28.10
| epoch  14 step    27330 | batches     17 / 2101 | lr 3.147e-03 | ms/batch 398.1 | tok/s  123465 | loss  3.24 | ppl     25.57
| epoch  14 step    27340 | batches     27 / 2101 | lr 3.144e-03 | ms/batch 398.6 | tok/s  123317 | loss  3.23 | ppl     25.17
| epoch  14 step    27350 | batches     37 / 2101 | lr 3.141e-03 | ms/batch 397.9 | tok/s  123524 | loss  3.23 | ppl     25.21
| epoch  14 step    27360 | batches     47 / 2101 | lr 3.138e-03 | ms/batch 398.2 | tok/s  123435 | loss  3.22 | ppl     24.99
| epoch  14 step    27370 | batches     57 / 2101 | lr 3.135e-03 | ms/batch 397.6 | tok/s  123624 | loss  3.19 | ppl     24.35
| epoch  14 step    27380 | batches     67 / 2101 | lr 3.132e-03 | ms/batch 398.3 | tok/s  123395 | loss  3.21 | ppl     24.70
| epoch  14 step    27390 | batches     77 / 2101 | lr 3.129e-03 | ms/batch 398.6 | tok/s  123325 | loss  3.19 | ppl     24.28
| epoch  14 step    27400 | batches     87 / 2101 | lr 3.126e-03 | ms/batch 398.6 | tok/s  123297 | loss  3.21 | ppl     24.78
| epoch  14 step    27410 | batches     97 / 2101 | lr 3.123e-03 | ms/batch 398.3 | tok/s  123406 | loss  3.22 | ppl     25.00
| epoch  14 step    27420 | batches    107 / 2101 | lr 3.119e-03 | ms/batch 399.2 | tok/s  123123 | loss  3.20 | ppl     24.57
| epoch  14 step    27430 | batches    117 / 2101 | lr 3.116e-03 | ms/batch 397.6 | tok/s  123623 | loss  3.25 | ppl     25.79
| epoch  14 step    27440 | batches    127 / 2101 | lr 3.113e-03 | ms/batch 398.0 | tok/s  123495 | loss  3.24 | ppl     25.45
| epoch  14 step    27450 | batches    137 / 2101 | lr 3.110e-03 | ms/batch 397.6 | tok/s  123637 | loss  3.24 | ppl     25.47
| epoch  14 step    27460 | batches    147 / 2101 | lr 3.107e-03 | ms/batch 397.9 | tok/s  123517 | loss  3.23 | ppl     25.17
| epoch  14 step    27470 | batches    157 / 2101 | lr 3.104e-03 | ms/batch 398.4 | tok/s  123384 | loss  3.26 | ppl     26.07
| epoch  14 step    27480 | batches    167 / 2101 | lr 3.101e-03 | ms/batch 398.0 | tok/s  123490 | loss  3.26 | ppl     25.95
| epoch  14 step    27490 | batches    177 / 2101 | lr 3.098e-03 | ms/batch 398.6 | tok/s  123321 | loss  3.21 | ppl     24.84
| epoch  14 step    27500 | batches    187 / 2101 | lr 3.095e-03 | ms/batch 398.5 | tok/s  123354 | loss  3.22 | ppl     25.01
----------------------------------------------------------------------------------------------------
| Eval  55 at step    27500 | time:  0.81s | valid loss  3.19 | valid ppl    24.410
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  14 step    27510 | batches    197 / 2101 | lr 3.092e-03 | ms/batch 399.8 | tok/s  122946 | loss  3.24 | ppl     25.50
| epoch  14 step    27520 | batches    207 / 2101 | lr 3.089e-03 | ms/batch 420.4 | tok/s  116917 | loss  3.27 | ppl     26.33
| epoch  14 step    27530 | batches    217 / 2101 | lr 3.086e-03 | ms/batch 398.5 | tok/s  123341 | loss  3.27 | ppl     26.36
| epoch  14 step    27540 | batches    227 / 2101 | lr 3.083e-03 | ms/batch 397.3 | tok/s  123722 | loss  3.24 | ppl     25.58
| epoch  14 step    27550 | batches    237 / 2101 | lr 3.080e-03 | ms/batch 398.3 | tok/s  123401 | loss  3.22 | ppl     25.05
| epoch  14 step    27560 | batches    247 / 2101 | lr 3.077e-03 | ms/batch 408.5 | tok/s  120330 | loss  3.23 | ppl     25.18
| epoch  14 step    27570 | batches    257 / 2101 | lr 3.073e-03 | ms/batch 397.8 | tok/s  123568 | loss  3.21 | ppl     24.73
| epoch  14 step    27580 | batches    267 / 2101 | lr 3.070e-03 | ms/batch 397.2 | tok/s  123748 | loss  3.23 | ppl     25.20
| epoch  14 step    27590 | batches    277 / 2101 | lr 3.067e-03 | ms/batch 397.4 | tok/s  123700 | loss  3.20 | ppl     24.55
| epoch  14 step    27600 | batches    287 / 2101 | lr 3.064e-03 | ms/batch 396.7 | tok/s  123891 | loss  3.21 | ppl     24.81
| epoch  14 step    27610 | batches    297 / 2101 | lr 3.061e-03 | ms/batch 398.4 | tok/s  123362 | loss  3.25 | ppl     25.83
| epoch  14 step    27620 | batches    307 / 2101 | lr 3.058e-03 | ms/batch 398.2 | tok/s  123424 | loss  3.26 | ppl     26.04
| epoch  14 step    27630 | batches    317 / 2101 | lr 3.055e-03 | ms/batch 397.8 | tok/s  123568 | loss  3.25 | ppl     25.73
| epoch  14 step    27640 | batches    327 / 2101 | lr 3.052e-03 | ms/batch 398.0 | tok/s  123490 | loss  3.24 | ppl     25.64
| epoch  14 step    27650 | batches    337 / 2101 | lr 3.049e-03 | ms/batch 397.5 | tok/s  123658 | loss  3.22 | ppl     25.07
| epoch  14 step    27660 | batches    347 / 2101 | lr 3.046e-03 | ms/batch 397.5 | tok/s  123648 | loss  3.21 | ppl     24.79
| epoch  14 step    27670 | batches    357 / 2101 | lr 3.043e-03 | ms/batch 397.3 | tok/s  123706 | loss  3.22 | ppl     24.99
| epoch  14 step    27680 | batches    367 / 2101 | lr 3.040e-03 | ms/batch 398.4 | tok/s  123379 | loss  3.20 | ppl     24.57
| epoch  14 step    27690 | batches    377 / 2101 | lr 3.037e-03 | ms/batch 398.2 | tok/s  123439 | loss  3.21 | ppl     24.77
| epoch  14 step    27700 | batches    387 / 2101 | lr 3.034e-03 | ms/batch 398.7 | tok/s  123293 | loss  3.25 | ppl     25.80
| epoch  14 step    27710 | batches    397 / 2101 | lr 3.031e-03 | ms/batch 398.5 | tok/s  123350 | loss  3.25 | ppl     25.92
| epoch  14 step    27720 | batches    407 / 2101 | lr 3.028e-03 | ms/batch 397.8 | tok/s  123570 | loss  3.19 | ppl     24.33
| epoch  14 step    27730 | batches    417 / 2101 | lr 3.025e-03 | ms/batch 397.3 | tok/s  123714 | loss  3.22 | ppl     25.04
| epoch  14 step    27740 | batches    427 / 2101 | lr 3.022e-03 | ms/batch 397.4 | tok/s  123699 | loss  3.15 | ppl     23.30
| epoch  14 step    27750 | batches    437 / 2101 | lr 3.019e-03 | ms/batch 398.2 | tok/s  123446 | loss  3.18 | ppl     24.02
| epoch  14 step    27760 | batches    447 / 2101 | lr 3.016e-03 | ms/batch 408.3 | tok/s  120392 | loss  3.19 | ppl     24.35
| epoch  14 step    27770 | batches    457 / 2101 | lr 3.013e-03 | ms/batch 408.4 | tok/s  120358 | loss  3.19 | ppl     24.26
| epoch  14 step    27780 | batches    467 / 2101 | lr 3.010e-03 | ms/batch 399.4 | tok/s  123055 | loss  3.22 | ppl     25.00
| epoch  14 step    27790 | batches    477 / 2101 | lr 3.007e-03 | ms/batch 399.6 | tok/s  123005 | loss  3.23 | ppl     25.34
| epoch  14 step    27800 | batches    487 / 2101 | lr 3.004e-03 | ms/batch 399.0 | tok/s  123193 | loss  3.23 | ppl     25.28
| epoch  14 step    27810 | batches    497 / 2101 | lr 3.001e-03 | ms/batch 397.6 | tok/s  123625 | loss  3.19 | ppl     24.17
| epoch  14 step    27820 | batches    507 / 2101 | lr 2.998e-03 | ms/batch 397.1 | tok/s  123772 | loss  3.22 | ppl     24.96
| epoch  14 step    27830 | batches    517 / 2101 | lr 2.995e-03 | ms/batch 397.2 | tok/s  123753 | loss  3.19 | ppl     24.29
| epoch  14 step    27840 | batches    527 / 2101 | lr 2.992e-03 | ms/batch 396.7 | tok/s  123897 | loss  3.21 | ppl     24.75
| epoch  14 step    27850 | batches    537 / 2101 | lr 2.989e-03 | ms/batch 397.3 | tok/s  123710 | loss  3.27 | ppl     26.20
| epoch  14 step    27860 | batches    547 / 2101 | lr 2.986e-03 | ms/batch 397.8 | tok/s  123549 | loss  3.27 | ppl     26.25
| epoch  14 step    27870 | batches    557 / 2101 | lr 2.983e-03 | ms/batch 398.6 | tok/s  123322 | loss  3.26 | ppl     26.10
| epoch  14 step    27880 | batches    567 / 2101 | lr 2.980e-03 | ms/batch 397.4 | tok/s  123684 | loss  3.26 | ppl     26.06
| epoch  14 step    27890 | batches    577 / 2101 | lr 2.977e-03 | ms/batch 397.5 | tok/s  123640 | loss  3.27 | ppl     26.20
| epoch  14 step    27900 | batches    587 / 2101 | lr 2.974e-03 | ms/batch 397.9 | tok/s  123527 | loss  3.29 | ppl     26.95
| epoch  14 step    27910 | batches    597 / 2101 | lr 2.971e-03 | ms/batch 397.2 | tok/s  123735 | loss  3.29 | ppl     26.75
| epoch  14 step    27920 | batches    607 / 2101 | lr 2.968e-03 | ms/batch 398.1 | tok/s  123477 | loss  3.26 | ppl     26.01
| epoch  14 step    27930 | batches    617 / 2101 | lr 2.965e-03 | ms/batch 397.6 | tok/s  123629 | loss  3.21 | ppl     24.71
| epoch  14 step    27940 | batches    627 / 2101 | lr 2.962e-03 | ms/batch 397.6 | tok/s  123608 | loss  3.23 | ppl     25.17
| epoch  14 step    27950 | batches    637 / 2101 | lr 2.959e-03 | ms/batch 398.3 | tok/s  123415 | loss  3.20 | ppl     24.59
| epoch  14 step    27960 | batches    647 / 2101 | lr 2.956e-03 | ms/batch 398.6 | tok/s  123315 | loss  3.21 | ppl     24.73
| epoch  14 step    27970 | batches    657 / 2101 | lr 2.953e-03 | ms/batch 398.0 | tok/s  123487 | loss  3.21 | ppl     24.84
| epoch  14 step    27980 | batches    667 / 2101 | lr 2.950e-03 | ms/batch 398.8 | tok/s  123258 | loss  3.25 | ppl     25.75
| epoch  14 step    27990 | batches    677 / 2101 | lr 2.947e-03 | ms/batch 397.4 | tok/s  123699 | loss  3.17 | ppl     23.89
| epoch  14 step    28000 | batches    687 / 2101 | lr 2.944e-03 | ms/batch 412.4 | tok/s  119184 | loss  3.23 | ppl     25.36
----------------------------------------------------------------------------------------------------
| Eval  56 at step    28000 | time:  0.82s | valid loss  3.20 | valid ppl    24.415
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
ratio list [0.03846798875484994, 0.03898020317923391, 0.03479168564428625, 0.03753757751067466, 0.036999200840518956, 0.038913826789391905, 0.03798430746150143, 0.042174417915791663, 0.03417880663450818, 0.034906946663418405, 0.03809292408274902, 0.03984040723607789, 0.03644103596053573, 0.041591854368953414, 0.039258836523527525, 0.03884968605515518, 0.040127985674957525, 0.03872745763414535, 0.043039918831941325, 0.03835603734204189, 0.037213431286205204, 0.041858407621959734, 0.040913481428071705, 0.03869582569863633, 0.03880895083247661, 0.0397283053943073, 0.041823052161091855, 0.04584126849078433, 0.03794464853651434, 0.039449991401053715, 0.038062797274878185, 0.03975587072151551, 0.04539256747718157, 0.03703849045639239, 0.03809469646256399, 0.03680909888462531, 0.03961602226165566, 0.03585141579152238, 0.03745165865373014, 0.03868750437326365, 0.03711536672264161, 0.04047270446856051, 0.03508527962970137, 0.033605926364436836, 0.036665400544385086, 0.036188808655654214, 0.038002031720999634, 0.04085110328569404, 0.03482742943876164, 0.036429858831020276, 0.03878474349286126, 0.035827378611421226, 0.03747712608393836, 0.03404103632829574, 0.03636082914054253, 0.036253650859741415, 0.04009383692049401, 0.038770380008460587, 0.034984007470493225, 0.036390238326092506, 0.03402277301577276, 0.025429244414377605, 0.0055586511502914515, 0.029611389713877664, 0.035206666457521046, 0.03387392419583616, 0.03585363457239092, 0.014724599912062604, 0.031653000067072334, 0.03604451263577278, 0.0370288272192814, 0.03765109845269164, 0.03004720085197143, 0.027352768255892005, 0.033220222226384544, 0.03682065436154878, 0.03457462910609214, 0.03501032520869912, 0.02935484177029625, 0.034191251790247644, 0.035919011471717915]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [50, 68, 8, 13, 8, 57, 81, 9, 20, 10], [43, 41, 14, 8, 8, 51, 53, 11, 8, 8], [30, 37, 8, 8, 8, 37, 42, 9, 8, 8], [29, 48, 8, 8, 8, 17, 13, 9, 8, 8], [10, 16, 8, 8, 8, 17, 27, 9, 8, 8], [9, 11, 9, 8, 8, 8, 12, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 9, 8, 8], [9, 10, 8, 8, 8, 9, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [50, 68, 8, 13, 8, 57, 81, 9, 20, 10], [43, 41, 14, 8, 8, 51, 53, 11, 8, 8], [30, 37, 8, 8, 8, 37, 42, 9, 8, 8], [29, 48, 8, 8, 8, 17, 13, 9, 8, 8], [10, 16, 8, 8, 8, 17, 27, 9, 8, 8], [9, 11, 9, 8, 8, 8, 12, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 9, 8, 8], [9, 10, 8, 8, 8, 9, 8, 8, 8, 8], [8]]
| epoch  14 step    28010 | batches    697 / 2101 | lr 2.941e-03 | ms/batch 4883.1 | tok/s   10066 | loss  3.26 | ppl     26.00
| epoch  14 step    28020 | batches    707 / 2101 | lr 2.938e-03 | ms/batch 396.0 | tok/s  124117 | loss  3.27 | ppl     26.19
| epoch  14 step    28030 | batches    717 / 2101 | lr 2.935e-03 | ms/batch 394.2 | tok/s  124685 | loss  3.22 | ppl     25.09
| epoch  14 step    28040 | batches    727 / 2101 | lr 2.932e-03 | ms/batch 395.1 | tok/s  124389 | loss  3.25 | ppl     25.85
| epoch  14 step    28050 | batches    737 / 2101 | lr 2.929e-03 | ms/batch 396.1 | tok/s  124082 | loss  3.24 | ppl     25.66
| epoch  14 step    28060 | batches    747 / 2101 | lr 2.926e-03 | ms/batch 407.2 | tok/s  120706 | loss  3.22 | ppl     25.01
| epoch  14 step    28070 | batches    757 / 2101 | lr 2.923e-03 | ms/batch 406.7 | tok/s  120867 | loss  3.23 | ppl     25.16
| epoch  14 step    28080 | batches    767 / 2101 | lr 2.920e-03 | ms/batch 396.1 | tok/s  124100 | loss  3.25 | ppl     25.85
| epoch  14 step    28090 | batches    777 / 2101 | lr 2.917e-03 | ms/batch 406.3 | tok/s  120974 | loss  3.27 | ppl     26.26
| epoch  14 step    28100 | batches    787 / 2101 | lr 2.914e-03 | ms/batch 406.3 | tok/s  120973 | loss  3.22 | ppl     25.12
| epoch  14 step    28110 | batches    797 / 2101 | lr 2.911e-03 | ms/batch 407.0 | tok/s  120774 | loss  3.24 | ppl     25.65
| epoch  14 step    28120 | batches    807 / 2101 | lr 2.908e-03 | ms/batch 397.0 | tok/s  123824 | loss  3.26 | ppl     26.07
| epoch  14 step    28130 | batches    817 / 2101 | lr 2.905e-03 | ms/batch 408.0 | tok/s  120462 | loss  3.24 | ppl     25.49
| epoch  14 step    28140 | batches    827 / 2101 | lr 2.902e-03 | ms/batch 396.1 | tok/s  124105 | loss  3.25 | ppl     25.84
| epoch  14 step    28150 | batches    837 / 2101 | lr 2.899e-03 | ms/batch 396.8 | tok/s  123881 | loss  3.23 | ppl     25.25
| epoch  14 step    28160 | batches    847 / 2101 | lr 2.896e-03 | ms/batch 396.1 | tok/s  124099 | loss  3.23 | ppl     25.20
| epoch  14 step    28170 | batches    857 / 2101 | lr 2.893e-03 | ms/batch 397.2 | tok/s  123761 | loss  3.21 | ppl     24.82
| epoch  14 step    28180 | batches    867 / 2101 | lr 2.890e-03 | ms/batch 396.3 | tok/s  124033 | loss  3.19 | ppl     24.20
| epoch  14 step    28190 | batches    877 / 2101 | lr 2.887e-03 | ms/batch 396.5 | tok/s  123965 | loss  3.18 | ppl     24.12
| epoch  14 step    28200 | batches    887 / 2101 | lr 2.884e-03 | ms/batch 396.4 | tok/s  123988 | loss  3.21 | ppl     24.80
| epoch  14 step    28210 | batches    897 / 2101 | lr 2.881e-03 | ms/batch 396.5 | tok/s  123979 | loss  3.20 | ppl     24.42
| epoch  14 step    28220 | batches    907 / 2101 | lr 2.878e-03 | ms/batch 396.5 | tok/s  123956 | loss  3.20 | ppl     24.41
| epoch  14 step    28230 | batches    917 / 2101 | lr 2.876e-03 | ms/batch 396.7 | tok/s  123902 | loss  3.21 | ppl     24.77
| epoch  14 step    28240 | batches    927 / 2101 | lr 2.873e-03 | ms/batch 397.1 | tok/s  123785 | loss  3.18 | ppl     24.03
| epoch  14 step    28250 | batches    937 / 2101 | lr 2.870e-03 | ms/batch 396.8 | tok/s  123865 | loss  3.21 | ppl     24.68
| epoch  14 step    28260 | batches    947 / 2101 | lr 2.867e-03 | ms/batch 407.7 | tok/s  120560 | loss  3.22 | ppl     25.00
| epoch  14 step    28270 | batches    957 / 2101 | lr 2.864e-03 | ms/batch 408.0 | tok/s  120460 | loss  3.18 | ppl     24.04
| epoch  14 step    28280 | batches    967 / 2101 | lr 2.861e-03 | ms/batch 398.4 | tok/s  123367 | loss  3.20 | ppl     24.43
| epoch  14 step    28290 | batches    977 / 2101 | lr 2.858e-03 | ms/batch 397.9 | tok/s  123543 | loss  3.18 | ppl     24.14
| epoch  14 step    28300 | batches    987 / 2101 | lr 2.855e-03 | ms/batch 397.2 | tok/s  123760 | loss  3.20 | ppl     24.65
| epoch  14 step    28310 | batches    997 / 2101 | lr 2.852e-03 | ms/batch 397.4 | tok/s  123697 | loss  3.24 | ppl     25.56
| epoch  14 step    28320 | batches   1007 / 2101 | lr 2.849e-03 | ms/batch 396.8 | tok/s  123859 | loss  3.20 | ppl     24.54
| epoch  14 step    28330 | batches   1017 / 2101 | lr 2.846e-03 | ms/batch 397.3 | tok/s  123724 | loss  3.18 | ppl     24.15
| epoch  14 step    28340 | batches   1027 / 2101 | lr 2.843e-03 | ms/batch 397.3 | tok/s  123716 | loss  3.24 | ppl     25.46
| epoch  14 step    28350 | batches   1037 / 2101 | lr 2.840e-03 | ms/batch 397.3 | tok/s  123701 | loss  3.23 | ppl     25.26
| epoch  14 step    28360 | batches   1047 / 2101 | lr 2.837e-03 | ms/batch 397.3 | tok/s  123728 | loss  3.23 | ppl     25.23
| epoch  14 step    28370 | batches   1057 / 2101 | lr 2.834e-03 | ms/batch 397.6 | tok/s  123622 | loss  3.20 | ppl     24.47
| epoch  14 step    28380 | batches   1067 / 2101 | lr 2.832e-03 | ms/batch 397.4 | tok/s  123690 | loss  3.20 | ppl     24.53
| epoch  14 step    28390 | batches   1077 / 2101 | lr 2.829e-03 | ms/batch 397.5 | tok/s  123667 | loss  3.23 | ppl     25.28
| epoch  14 step    28400 | batches   1087 / 2101 | lr 2.826e-03 | ms/batch 397.4 | tok/s  123691 | loss  3.26 | ppl     26.05
| epoch  14 step    28410 | batches   1097 / 2101 | lr 2.823e-03 | ms/batch 397.4 | tok/s  123690 | loss  3.24 | ppl     25.52
| epoch  14 step    28420 | batches   1107 / 2101 | lr 2.820e-03 | ms/batch 397.4 | tok/s  123699 | loss  3.22 | ppl     25.12
| epoch  14 step    28430 | batches   1117 / 2101 | lr 2.817e-03 | ms/batch 397.1 | tok/s  123776 | loss  3.25 | ppl     25.76
| epoch  14 step    28440 | batches   1127 / 2101 | lr 2.814e-03 | ms/batch 397.1 | tok/s  123791 | loss  3.22 | ppl     25.12
| epoch  14 step    28450 | batches   1137 / 2101 | lr 2.811e-03 | ms/batch 397.5 | tok/s  123661 | loss  3.25 | ppl     25.87
| epoch  14 step    28460 | batches   1147 / 2101 | lr 2.808e-03 | ms/batch 397.5 | tok/s  123659 | loss  3.24 | ppl     25.59
| epoch  14 step    28470 | batches   1157 / 2101 | lr 2.805e-03 | ms/batch 397.5 | tok/s  123641 | loss  3.22 | ppl     25.06
| epoch  14 step    28480 | batches   1167 / 2101 | lr 2.802e-03 | ms/batch 397.5 | tok/s  123660 | loss  3.23 | ppl     25.18
| epoch  14 step    28490 | batches   1177 / 2101 | lr 2.800e-03 | ms/batch 397.4 | tok/s  123670 | loss  3.22 | ppl     25.02
| epoch  14 step    28500 | batches   1187 / 2101 | lr 2.797e-03 | ms/batch 408.1 | tok/s  120427 | loss  3.23 | ppl     25.34
----------------------------------------------------------------------------------------------------
| Eval  57 at step    28500 | time:  0.81s | valid loss  3.19 | valid ppl    24.277
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  14 step    28510 | batches   1197 / 2101 | lr 2.794e-03 | ms/batch 400.7 | tok/s  122664 | loss  3.26 | ppl     25.94
| epoch  14 step    28520 | batches   1207 / 2101 | lr 2.791e-03 | ms/batch 420.5 | tok/s  116903 | loss  3.25 | ppl     25.69
| epoch  14 step    28530 | batches   1217 / 2101 | lr 2.788e-03 | ms/batch 411.0 | tok/s  119594 | loss  3.26 | ppl     25.96
| epoch  14 step    28540 | batches   1227 / 2101 | lr 2.785e-03 | ms/batch 397.1 | tok/s  123781 | loss  3.27 | ppl     26.19
| epoch  14 step    28550 | batches   1237 / 2101 | lr 2.782e-03 | ms/batch 407.7 | tok/s  120563 | loss  3.24 | ppl     25.59
| epoch  14 step    28560 | batches   1247 / 2101 | lr 2.779e-03 | ms/batch 396.3 | tok/s  124040 | loss  3.22 | ppl     24.99
| epoch  14 step    28570 | batches   1257 / 2101 | lr 2.776e-03 | ms/batch 407.8 | tok/s  120535 | loss  3.21 | ppl     24.81
| epoch  14 step    28580 | batches   1267 / 2101 | lr 2.774e-03 | ms/batch 397.9 | tok/s  123527 | loss  3.22 | ppl     24.91
| epoch  14 step    28590 | batches   1277 / 2101 | lr 2.771e-03 | ms/batch 396.9 | tok/s  123840 | loss  3.21 | ppl     24.72
| epoch  14 step    28600 | batches   1287 / 2101 | lr 2.768e-03 | ms/batch 397.1 | tok/s  123784 | loss  3.21 | ppl     24.73
| epoch  14 step    28610 | batches   1297 / 2101 | lr 2.765e-03 | ms/batch 396.6 | tok/s  123921 | loss  3.24 | ppl     25.53
| epoch  14 step    28620 | batches   1307 / 2101 | lr 2.762e-03 | ms/batch 396.8 | tok/s  123884 | loss  3.21 | ppl     24.82
| epoch  14 step    28630 | batches   1317 / 2101 | lr 2.759e-03 | ms/batch 396.1 | tok/s  124076 | loss  3.19 | ppl     24.23
| epoch  14 step    28640 | batches   1327 / 2101 | lr 2.756e-03 | ms/batch 396.6 | tok/s  123926 | loss  3.18 | ppl     24.09
| epoch  14 step    28650 | batches   1337 / 2101 | lr 2.753e-03 | ms/batch 397.1 | tok/s  123766 | loss  3.19 | ppl     24.30
| epoch  14 step    28660 | batches   1347 / 2101 | lr 2.751e-03 | ms/batch 396.9 | tok/s  123850 | loss  3.17 | ppl     23.86
| epoch  14 step    28670 | batches   1357 / 2101 | lr 2.748e-03 | ms/batch 408.3 | tok/s  120388 | loss  3.20 | ppl     24.62
| epoch  14 step    28680 | batches   1367 / 2101 | lr 2.745e-03 | ms/batch 398.5 | tok/s  123344 | loss  3.21 | ppl     24.86
| epoch  14 step    28690 | batches   1377 / 2101 | lr 2.742e-03 | ms/batch 398.6 | tok/s  123318 | loss  3.24 | ppl     25.54
| epoch  14 step    28700 | batches   1387 / 2101 | lr 2.739e-03 | ms/batch 398.2 | tok/s  123436 | loss  3.21 | ppl     24.84
| epoch  14 step    28710 | batches   1397 / 2101 | lr 2.736e-03 | ms/batch 397.3 | tok/s  123713 | loss  3.20 | ppl     24.54
| epoch  14 step    28720 | batches   1407 / 2101 | lr 2.733e-03 | ms/batch 398.0 | tok/s  123498 | loss  3.24 | ppl     25.63
| epoch  14 step    28730 | batches   1417 / 2101 | lr 2.730e-03 | ms/batch 396.9 | tok/s  123830 | loss  3.26 | ppl     26.12
| epoch  14 step    28740 | batches   1427 / 2101 | lr 2.728e-03 | ms/batch 396.6 | tok/s  123928 | loss  3.27 | ppl     26.25
| epoch  14 step    28750 | batches   1437 / 2101 | lr 2.725e-03 | ms/batch 397.2 | tok/s  123742 | loss  3.23 | ppl     25.17
| epoch  14 step    28760 | batches   1447 / 2101 | lr 2.722e-03 | ms/batch 397.4 | tok/s  123672 | loss  3.18 | ppl     24.05
| epoch  14 step    28770 | batches   1457 / 2101 | lr 2.719e-03 | ms/batch 397.9 | tok/s  123538 | loss  3.22 | ppl     24.90
| epoch  14 step    28780 | batches   1467 / 2101 | lr 2.716e-03 | ms/batch 397.0 | tok/s  123823 | loss  3.23 | ppl     25.22
| epoch  14 step    28790 | batches   1477 / 2101 | lr 2.713e-03 | ms/batch 397.8 | tok/s  123559 | loss  3.22 | ppl     25.13
| epoch  14 step    28800 | batches   1487 / 2101 | lr 2.711e-03 | ms/batch 397.7 | tok/s  123583 | loss  3.22 | ppl     24.92
| epoch  14 step    28810 | batches   1497 / 2101 | lr 2.708e-03 | ms/batch 396.9 | tok/s  123830 | loss  3.23 | ppl     25.21
| epoch  14 step    28820 | batches   1507 / 2101 | lr 2.705e-03 | ms/batch 407.8 | tok/s  120544 | loss  3.23 | ppl     25.32
| epoch  14 step    28830 | batches   1517 / 2101 | lr 2.702e-03 | ms/batch 397.6 | tok/s  123612 | loss  3.21 | ppl     24.74
| epoch  14 step    28840 | batches   1527 / 2101 | lr 2.699e-03 | ms/batch 408.4 | tok/s  120347 | loss  3.20 | ppl     24.64
| epoch  14 step    28850 | batches   1537 / 2101 | lr 2.696e-03 | ms/batch 397.3 | tok/s  123717 | loss  3.20 | ppl     24.54
| epoch  14 step    28860 | batches   1547 / 2101 | lr 2.693e-03 | ms/batch 397.5 | tok/s  123664 | loss  3.23 | ppl     25.38
| epoch  14 step    28870 | batches   1557 / 2101 | lr 2.691e-03 | ms/batch 396.7 | tok/s  123897 | loss  3.23 | ppl     25.23
| epoch  14 step    28880 | batches   1567 / 2101 | lr 2.688e-03 | ms/batch 396.7 | tok/s  123896 | loss  3.23 | ppl     25.19
| epoch  14 step    28890 | batches   1577 / 2101 | lr 2.685e-03 | ms/batch 397.6 | tok/s  123634 | loss  3.21 | ppl     24.78
| epoch  14 step    28900 | batches   1587 / 2101 | lr 2.682e-03 | ms/batch 397.1 | tok/s  123769 | loss  3.23 | ppl     25.21
| epoch  14 step    28910 | batches   1597 / 2101 | lr 2.679e-03 | ms/batch 397.4 | tok/s  123682 | loss  3.25 | ppl     25.81
| epoch  14 step    28920 | batches   1607 / 2101 | lr 2.677e-03 | ms/batch 396.7 | tok/s  123916 | loss  3.21 | ppl     24.87
| epoch  14 step    28930 | batches   1617 / 2101 | lr 2.674e-03 | ms/batch 397.0 | tok/s  123816 | loss  3.19 | ppl     24.39
| epoch  14 step    28940 | batches   1627 / 2101 | lr 2.671e-03 | ms/batch 397.0 | tok/s  123821 | loss  3.23 | ppl     25.24
| epoch  14 step    28950 | batches   1637 / 2101 | lr 2.668e-03 | ms/batch 396.6 | tok/s  123948 | loss  3.19 | ppl     24.25
| epoch  14 step    28960 | batches   1647 / 2101 | lr 2.665e-03 | ms/batch 397.0 | tok/s  123813 | loss  3.22 | ppl     25.04
| epoch  14 step    28970 | batches   1657 / 2101 | lr 2.662e-03 | ms/batch 397.3 | tok/s  123714 | loss  3.23 | ppl     25.16
| epoch  14 step    28980 | batches   1667 / 2101 | lr 2.660e-03 | ms/batch 396.6 | tok/s  123932 | loss  3.24 | ppl     25.53
| epoch  14 step    28990 | batches   1677 / 2101 | lr 2.657e-03 | ms/batch 396.6 | tok/s  123924 | loss  3.23 | ppl     25.39
| epoch  14 step    29000 | batches   1687 / 2101 | lr 2.654e-03 | ms/batch 412.0 | tok/s  119308 | loss  3.23 | ppl     25.19
----------------------------------------------------------------------------------------------------
| Eval  58 at step    29000 | time:  0.81s | valid loss  3.19 | valid ppl    24.192
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.03909116255426545, 0.038611586673029434, 0.040515927636706306, 0.036739396270139446, 0.03689067987579952, 0.04149616121296013, 0.03774046094637528, 0.04474731155908192, 0.037603703377972135, 0.03481776421142044, 0.04284108782555067, 0.04046705591898023, 0.03785791483288845, 0.043043230325687326, 0.038644433948456694, 0.04087951770798378, 0.0397936846780216, 0.04780881122780928, 0.04076686813922607, 0.03792767748734267, 0.04113136691673542, 0.03926134496649656, 0.03700362773654143, 0.04047335647312638, 0.03891296102864402, 0.041752683175932837, 0.04041192908165644, 0.041605980020692296, 0.04282102406915426, 0.03902326187290522, 0.03925970624430905, 0.03855283201491208, 0.035065725752595006, 0.03685850857495731, 0.03753425518017042, 0.03916723302320793, 0.039371511614589565, 0.031967649426692286, 0.03764772367662747, 0.0383339261589174, 0.04193562642840552, 0.038663832665446256, 0.04250733605241497, 0.037640172186038455, 0.036317541411533386, 0.038346931865637916, 0.03908120803121389, 0.032352494755349, 0.037615965547666816, 0.03717123834566275, 0.03888447000804007, 0.037178816320836375, 0.044056536054630745, 0.03366018596541867, 0.035848064947399165, 0.040960037326511656, 0.03922958765418011, 0.02825872873931148, 0.035259797688822064, 0.03624806481355919, 0.03459717172947325, 0.025441894993346845, 0.0002583801570238463, 0.02800506261155443, 0.034348612572671744, 0.03536043841223097, 0.03494392227544005, 0.02081198370212458, 0.03236366129949609, 0.035285698978621154, 0.03846178467183979, 0.03568876911231164, 0.047658130120884164, 0.027262344360764044, 0.03265779840546135, 0.035402906208718624, 0.033858607059364346, 0.029883781405436658, 0.028584648013783104, 0.033296726595365686, 0.03736310157473446]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [50, 67, 8, 16, 10, 56, 86, 9, 21, 12], [42, 37, 18, 8, 8, 44, 52, 8, 8, 8], [29, 39, 8, 8, 8, 36, 45, 9, 8, 8], [28, 47, 8, 8, 8, 20, 12, 10, 8, 8], [9, 12, 8, 8, 8, 16, 20, 9, 8, 8], [9, 14, 9, 8, 8, 8, 15, 8, 8, 8], [8, 8, 8, 8, 8, 8, 10, 8, 8, 8], [8, 13, 8, 8, 8, 8, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [50, 67, 8, 16, 10, 56, 86, 9, 21, 12], [42, 37, 18, 8, 8, 44, 52, 8, 8, 8], [29, 39, 8, 8, 8, 36, 45, 9, 8, 8], [28, 47, 8, 8, 8, 20, 12, 10, 8, 8], [9, 12, 8, 8, 8, 16, 20, 9, 8, 8], [9, 14, 9, 8, 8, 8, 15, 8, 8, 8], [8, 8, 8, 8, 8, 8, 10, 8, 8, 8], [8, 13, 8, 8, 8, 8, 9, 8, 8, 8], [8]]
| epoch  14 step    29010 | batches   1697 / 2101 | lr 2.651e-03 | ms/batch 4889.7 | tok/s   10052 | loss  3.24 | ppl     25.44
| epoch  14 step    29020 | batches   1707 / 2101 | lr 2.648e-03 | ms/batch 407.8 | tok/s  120545 | loss  3.24 | ppl     25.42
| epoch  14 step    29030 | batches   1717 / 2101 | lr 2.646e-03 | ms/batch 395.9 | tok/s  124167 | loss  3.24 | ppl     25.43
| epoch  14 step    29040 | batches   1727 / 2101 | lr 2.643e-03 | ms/batch 395.9 | tok/s  124145 | loss  3.21 | ppl     24.86
| epoch  14 step    29050 | batches   1737 / 2101 | lr 2.640e-03 | ms/batch 406.3 | tok/s  120986 | loss  3.22 | ppl     24.92
| epoch  14 step    29060 | batches   1747 / 2101 | lr 2.637e-03 | ms/batch 395.9 | tok/s  124138 | loss  3.19 | ppl     24.32
| epoch  14 step    29070 | batches   1757 / 2101 | lr 2.634e-03 | ms/batch 407.2 | tok/s  120708 | loss  3.17 | ppl     23.90
| epoch  14 step    29080 | batches   1767 / 2101 | lr 2.632e-03 | ms/batch 396.3 | tok/s  124036 | loss  3.21 | ppl     24.75
| epoch  14 step    29090 | batches   1777 / 2101 | lr 2.629e-03 | ms/batch 395.5 | tok/s  124279 | loss  3.20 | ppl     24.47
| epoch  14 step    29100 | batches   1787 / 2101 | lr 2.626e-03 | ms/batch 395.9 | tok/s  124149 | loss  3.20 | ppl     24.64
| epoch  14 step    29110 | batches   1797 / 2101 | lr 2.623e-03 | ms/batch 396.8 | tok/s  123882 | loss  3.23 | ppl     25.21
| epoch  14 step    29120 | batches   1807 / 2101 | lr 2.620e-03 | ms/batch 396.5 | tok/s  123955 | loss  3.24 | ppl     25.50
| epoch  14 step    29130 | batches   1817 / 2101 | lr 2.618e-03 | ms/batch 396.9 | tok/s  123846 | loss  3.20 | ppl     24.42
| epoch  14 step    29140 | batches   1827 / 2101 | lr 2.615e-03 | ms/batch 396.4 | tok/s  124012 | loss  3.22 | ppl     24.96
| epoch  14 step    29150 | batches   1837 / 2101 | lr 2.612e-03 | ms/batch 396.3 | tok/s  124015 | loss  3.22 | ppl     25.15
| epoch  14 step    29160 | batches   1847 / 2101 | lr 2.609e-03 | ms/batch 396.4 | tok/s  123992 | loss  3.22 | ppl     25.12
| epoch  14 step    29170 | batches   1857 / 2101 | lr 2.607e-03 | ms/batch 397.2 | tok/s  123755 | loss  3.24 | ppl     25.64
| epoch  14 step    29180 | batches   1867 / 2101 | lr 2.604e-03 | ms/batch 396.8 | tok/s  123870 | loss  3.26 | ppl     26.07
| epoch  14 step    29190 | batches   1877 / 2101 | lr 2.601e-03 | ms/batch 397.1 | tok/s  123775 | loss  3.25 | ppl     25.77
| epoch  14 step    29200 | batches   1887 / 2101 | lr 2.598e-03 | ms/batch 397.6 | tok/s  123609 | loss  3.27 | ppl     26.23
| epoch  14 step    29210 | batches   1897 / 2101 | lr 2.595e-03 | ms/batch 396.8 | tok/s  123860 | loss  3.25 | ppl     25.76
| epoch  14 step    29220 | batches   1907 / 2101 | lr 2.593e-03 | ms/batch 397.2 | tok/s  123750 | loss  3.19 | ppl     24.31
| epoch  14 step    29230 | batches   1917 / 2101 | lr 2.590e-03 | ms/batch 397.6 | tok/s  123638 | loss  3.19 | ppl     24.25
| epoch  14 step    29240 | batches   1927 / 2101 | lr 2.587e-03 | ms/batch 397.8 | tok/s  123572 | loss  3.21 | ppl     24.87
| epoch  14 step    29250 | batches   1937 / 2101 | lr 2.584e-03 | ms/batch 397.6 | tok/s  123626 | loss  3.21 | ppl     24.71
| epoch  14 step    29260 | batches   1947 / 2101 | lr 2.582e-03 | ms/batch 398.1 | tok/s  123467 | loss  3.28 | ppl     26.56
| epoch  14 step    29270 | batches   1957 / 2101 | lr 2.579e-03 | ms/batch 397.5 | tok/s  123661 | loss  3.30 | ppl     27.04
| epoch  14 step    29280 | batches   1967 / 2101 | lr 2.576e-03 | ms/batch 398.5 | tok/s  123355 | loss  3.28 | ppl     26.65
| epoch  14 step    29290 | batches   1977 / 2101 | lr 2.573e-03 | ms/batch 397.7 | tok/s  123594 | loss  3.25 | ppl     25.66
| epoch  14 step    29300 | batches   1987 / 2101 | lr 2.571e-03 | ms/batch 397.9 | tok/s  123519 | loss  3.25 | ppl     25.84
| epoch  14 step    29310 | batches   1997 / 2101 | lr 2.568e-03 | ms/batch 397.5 | tok/s  123658 | loss  3.21 | ppl     24.89
| epoch  14 step    29320 | batches   2007 / 2101 | lr 2.565e-03 | ms/batch 408.8 | tok/s  120222 | loss  3.21 | ppl     24.70
| epoch  14 step    29330 | batches   2017 / 2101 | lr 2.562e-03 | ms/batch 398.2 | tok/s  123433 | loss  3.20 | ppl     24.43
| epoch  14 step    29340 | batches   2027 / 2101 | lr 2.560e-03 | ms/batch 397.4 | tok/s  123683 | loss  3.21 | ppl     24.85
| epoch  14 step    29350 | batches   2037 / 2101 | lr 2.557e-03 | ms/batch 397.0 | tok/s  123796 | loss  3.21 | ppl     24.71
| epoch  14 step    29360 | batches   2047 / 2101 | lr 2.554e-03 | ms/batch 397.6 | tok/s  123638 | loss  3.24 | ppl     25.60
| epoch  14 step    29370 | batches   2057 / 2101 | lr 2.551e-03 | ms/batch 397.7 | tok/s  123600 | loss  3.22 | ppl     25.03
| epoch  14 step    29380 | batches   2067 / 2101 | lr 2.549e-03 | ms/batch 407.7 | tok/s  120553 | loss  3.25 | ppl     25.91
| epoch  14 step    29390 | batches   2077 / 2101 | lr 2.546e-03 | ms/batch 397.9 | tok/s  123533 | loss  3.22 | ppl     25.07
| epoch  14 step    29400 | batches   2087 / 2101 | lr 2.543e-03 | ms/batch 408.9 | tok/s  120220 | loss  3.23 | ppl     25.27
| epoch  14 step    29410 | batches   2097 / 2101 | lr 2.540e-03 | ms/batch 397.7 | tok/s  123588 | loss  3.21 | ppl     24.81
| epoch  15 step    29420 | batches      6 / 2101 | lr 2.538e-03 | ms/batch 398.7 | tok/s  123608 | loss  3.34 | ppl     28.33
| epoch  15 step    29430 | batches     16 / 2101 | lr 2.535e-03 | ms/batch 397.8 | tok/s  123563 | loss  3.22 | ppl     25.14
| epoch  15 step    29440 | batches     26 / 2101 | lr 2.532e-03 | ms/batch 397.3 | tok/s  123728 | loss  3.18 | ppl     24.04
| epoch  15 step    29450 | batches     36 / 2101 | lr 2.530e-03 | ms/batch 397.4 | tok/s  123690 | loss  3.19 | ppl     24.32
| epoch  15 step    29460 | batches     46 / 2101 | lr 2.527e-03 | ms/batch 397.0 | tok/s  123803 | loss  3.15 | ppl     23.42
| epoch  15 step    29470 | batches     56 / 2101 | lr 2.524e-03 | ms/batch 397.3 | tok/s  123702 | loss  3.22 | ppl     25.10
| epoch  15 step    29480 | batches     66 / 2101 | lr 2.521e-03 | ms/batch 397.2 | tok/s  123754 | loss  3.22 | ppl     24.96
| epoch  15 step    29490 | batches     76 / 2101 | lr 2.519e-03 | ms/batch 396.8 | tok/s  123859 | loss  3.22 | ppl     25.09
| epoch  15 step    29500 | batches     86 / 2101 | lr 2.516e-03 | ms/batch 408.6 | tok/s  120299 | loss  3.22 | ppl     24.95
----------------------------------------------------------------------------------------------------
| Eval  59 at step    29500 | time:  0.82s | valid loss  3.18 | valid ppl    24.157
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  15 step    29510 | batches     96 / 2101 | lr 2.513e-03 | ms/batch 397.0 | tok/s  123805 | loss  3.21 | ppl     24.68
| epoch  15 step    29520 | batches    106 / 2101 | lr 2.511e-03 | ms/batch 424.0 | tok/s  115923 | loss  3.20 | ppl     24.55
| epoch  15 step    29530 | batches    116 / 2101 | lr 2.508e-03 | ms/batch 408.7 | tok/s  120254 | loss  3.22 | ppl     25.01
| epoch  15 step    29540 | batches    126 / 2101 | lr 2.505e-03 | ms/batch 397.3 | tok/s  123718 | loss  3.17 | ppl     23.92
| epoch  15 step    29550 | batches    136 / 2101 | lr 2.502e-03 | ms/batch 407.9 | tok/s  120491 | loss  3.16 | ppl     23.63
| epoch  15 step    29560 | batches    146 / 2101 | lr 2.500e-03 | ms/batch 408.8 | tok/s  120222 | loss  3.20 | ppl     24.47
| epoch  15 step    29570 | batches    156 / 2101 | lr 2.497e-03 | ms/batch 409.9 | tok/s  119904 | loss  3.19 | ppl     24.28
| epoch  15 step    29580 | batches    166 / 2101 | lr 2.494e-03 | ms/batch 397.7 | tok/s  123594 | loss  3.19 | ppl     24.37
| epoch  15 step    29590 | batches    176 / 2101 | lr 2.492e-03 | ms/batch 407.9 | tok/s  120489 | loss  3.21 | ppl     24.84
| epoch  15 step    29600 | batches    186 / 2101 | lr 2.489e-03 | ms/batch 397.3 | tok/s  123701 | loss  3.23 | ppl     25.35
| epoch  15 step    29610 | batches    196 / 2101 | lr 2.486e-03 | ms/batch 397.4 | tok/s  123674 | loss  3.22 | ppl     24.93
| epoch  15 step    29620 | batches    206 / 2101 | lr 2.484e-03 | ms/batch 398.1 | tok/s  123455 | loss  3.22 | ppl     25.03
| epoch  15 step    29630 | batches    216 / 2101 | lr 2.481e-03 | ms/batch 397.7 | tok/s  123583 | loss  3.25 | ppl     25.72
| epoch  15 step    29640 | batches    226 / 2101 | lr 2.478e-03 | ms/batch 397.8 | tok/s  123568 | loss  3.19 | ppl     24.35
| epoch  15 step    29650 | batches    236 / 2101 | lr 2.475e-03 | ms/batch 397.8 | tok/s  123568 | loss  3.19 | ppl     24.23
| epoch  15 step    29660 | batches    246 / 2101 | lr 2.473e-03 | ms/batch 397.8 | tok/s  123574 | loss  3.19 | ppl     24.26
| epoch  15 step    29670 | batches    256 / 2101 | lr 2.470e-03 | ms/batch 398.6 | tok/s  123309 | loss  3.19 | ppl     24.19
| epoch  15 step    29680 | batches    266 / 2101 | lr 2.467e-03 | ms/batch 398.6 | tok/s  123325 | loss  3.15 | ppl     23.30
| epoch  15 step    29690 | batches    276 / 2101 | lr 2.465e-03 | ms/batch 398.8 | tok/s  123249 | loss  3.17 | ppl     23.72
| epoch  15 step    29700 | batches    286 / 2101 | lr 2.462e-03 | ms/batch 398.7 | tok/s  123269 | loss  3.18 | ppl     24.01
| epoch  15 step    29710 | batches    296 / 2101 | lr 2.459e-03 | ms/batch 399.4 | tok/s  123053 | loss  3.21 | ppl     24.70
| epoch  15 step    29720 | batches    306 / 2101 | lr 2.457e-03 | ms/batch 399.6 | tok/s  122990 | loss  3.20 | ppl     24.45
| epoch  15 step    29730 | batches    316 / 2101 | lr 2.454e-03 | ms/batch 399.3 | tok/s  123086 | loss  3.19 | ppl     24.32
| epoch  15 step    29740 | batches    326 / 2101 | lr 2.451e-03 | ms/batch 397.8 | tok/s  123556 | loss  3.18 | ppl     24.16
| epoch  15 step    29750 | batches    336 / 2101 | lr 2.449e-03 | ms/batch 397.6 | tok/s  123623 | loss  3.18 | ppl     24.07
| epoch  15 step    29760 | batches    346 / 2101 | lr 2.446e-03 | ms/batch 397.7 | tok/s  123604 | loss  3.19 | ppl     24.39
| epoch  15 step    29770 | batches    356 / 2101 | lr 2.443e-03 | ms/batch 398.1 | tok/s  123474 | loss  3.22 | ppl     24.92
| epoch  15 step    29780 | batches    366 / 2101 | lr 2.441e-03 | ms/batch 397.8 | tok/s  123566 | loss  3.19 | ppl     24.17
| epoch  15 step    29790 | batches    376 / 2101 | lr 2.438e-03 | ms/batch 396.9 | tok/s  123844 | loss  3.16 | ppl     23.58
| epoch  15 step    29800 | batches    386 / 2101 | lr 2.435e-03 | ms/batch 397.4 | tok/s  123687 | loss  3.17 | ppl     23.82
| epoch  15 step    29810 | batches    396 / 2101 | lr 2.433e-03 | ms/batch 398.3 | tok/s  123402 | loss  3.18 | ppl     23.95
| epoch  15 step    29820 | batches    406 / 2101 | lr 2.430e-03 | ms/batch 398.1 | tok/s  123477 | loss  3.19 | ppl     24.28
| epoch  15 step    29830 | batches    416 / 2101 | lr 2.427e-03 | ms/batch 397.8 | tok/s  123575 | loss  3.17 | ppl     23.85
| epoch  15 step    29840 | batches    426 / 2101 | lr 2.425e-03 | ms/batch 397.9 | tok/s  123528 | loss  3.15 | ppl     23.25
| epoch  15 step    29850 | batches    436 / 2101 | lr 2.422e-03 | ms/batch 397.5 | tok/s  123665 | loss  3.15 | ppl     23.29
| epoch  15 step    29860 | batches    446 / 2101 | lr 2.420e-03 | ms/batch 396.8 | tok/s  123860 | loss  3.17 | ppl     23.74
| epoch  15 step    29870 | batches    456 / 2101 | lr 2.417e-03 | ms/batch 398.4 | tok/s  123367 | loss  3.19 | ppl     24.20
| epoch  15 step    29880 | batches    466 / 2101 | lr 2.414e-03 | ms/batch 397.5 | tok/s  123664 | loss  3.21 | ppl     24.77
| epoch  15 step    29890 | batches    476 / 2101 | lr 2.412e-03 | ms/batch 397.5 | tok/s  123652 | loss  3.20 | ppl     24.51
| epoch  15 step    29900 | batches    486 / 2101 | lr 2.409e-03 | ms/batch 398.3 | tok/s  123398 | loss  3.20 | ppl     24.54
| epoch  15 step    29910 | batches    496 / 2101 | lr 2.406e-03 | ms/batch 397.9 | tok/s  123532 | loss  3.18 | ppl     24.08
| epoch  15 step    29920 | batches    506 / 2101 | lr 2.404e-03 | ms/batch 398.1 | tok/s  123480 | loss  3.19 | ppl     24.33
| epoch  15 step    29930 | batches    516 / 2101 | lr 2.401e-03 | ms/batch 398.8 | tok/s  123235 | loss  3.23 | ppl     25.19
| epoch  15 step    29940 | batches    526 / 2101 | lr 2.398e-03 | ms/batch 398.4 | tok/s  123384 | loss  3.25 | ppl     25.92
| epoch  15 step    29950 | batches    536 / 2101 | lr 2.396e-03 | ms/batch 409.4 | tok/s  120053 | loss  3.24 | ppl     25.61
| epoch  15 step    29960 | batches    546 / 2101 | lr 2.393e-03 | ms/batch 399.9 | tok/s  122919 | loss  3.23 | ppl     25.20
| epoch  15 step    29970 | batches    556 / 2101 | lr 2.391e-03 | ms/batch 399.5 | tok/s  123048 | loss  3.21 | ppl     24.78
| epoch  15 step    29980 | batches    566 / 2101 | lr 2.388e-03 | ms/batch 399.6 | tok/s  123008 | loss  3.18 | ppl     24.04
| epoch  15 step    29990 | batches    576 / 2101 | lr 2.385e-03 | ms/batch 399.5 | tok/s  123043 | loss  3.21 | ppl     24.81
| epoch  15 step    30000 | batches    586 / 2101 | lr 2.383e-03 | ms/batch 412.7 | tok/s  119086 | loss  3.18 | ppl     23.98
----------------------------------------------------------------------------------------------------
| Eval  60 at step    30000 | time:  0.81s | valid loss  3.18 | valid ppl    23.970
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.03679840831722895, 0.03720995031619534, 0.03802730159675475, 0.03613846093039327, 0.035065447080818476, 0.035062991140927854, 0.036510639634723834, 0.04714389479496064, 0.04299521590118149, 0.033954473261103665, 0.038367193701725026, 0.03867326727657008, 0.031196801342297235, 0.042438665903701954, 0.03707413816345053, 0.037665001110697933, 0.03792399189562251, 0.0389008067551147, 0.038767315335403174, 0.03678016290102354, 0.03854524125698445, 0.039411829893453175, 0.04921297366438187, 0.04048429233376807, 0.03714135991403221, 0.0383234798884596, 0.03939411871571876, 0.04046574634811159, 0.0388371696846409, 0.03750913069246094, 0.03756160582876161, 0.03756712864667122, 0.033014497496371295, 0.035704107994097255, 0.036585639688865114, 0.0370646787130896, 0.03923697479339828, 0.032141978756831856, 0.036271335451756065, 0.037258188493902424, 0.036267303004305536, 0.041228968387841694, 0.04321443467721077, 0.03254883798380235, 0.035747061519592935, 0.040992713819762175, 0.03772439797552281, 0.031360403888816106, 0.03660419964815045, 0.036095228730587306, 0.04003540557962879, 0.038675565637743124, 0.03961582043416054, 0.0350522853909073, 0.0353761398261012, 0.03861000184360168, 0.038758994013965375, 0.0371308531105167, 0.036019072163473505, 0.03549499922843515, 0.02836608304793379, 0.025786660028630587, 0.00020453564466362627, 0.027936352171363078, 0.03364655872567032, 0.035329511111224794, 0.03452696803632472, 0.022332761555511067, 0.030612298058338414, 0.03459251567395603, 0.0369979408861948, 0.03429890835554757, 0.0319654611119896, 0.027509002698737312, 0.031268435715097284, 0.03457471914018609, 0.03299451847741302, 0.044562281188574866, 0.027276767154439538, 0.033133643438521064, 0.036240908748062774]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [52, 61, 8, 16, 8, 60, 83, 9, 19, 11], [44, 42, 18, 8, 8, 49, 54, 11, 8, 8], [26, 41, 8, 8, 8, 39, 43, 9, 8, 8], [27, 43, 8, 8, 8, 15, 15, 10, 8, 8], [10, 15, 8, 8, 8, 18, 23, 8, 8, 8], [10, 14, 9, 8, 8, 10, 8, 8, 8, 8], [8, 8, 9, 8, 8, 8, 10, 8, 8, 8], [8, 10, 8, 8, 8, 8, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [52, 61, 8, 16, 8, 60, 83, 9, 19, 11], [44, 42, 18, 8, 8, 49, 54, 11, 8, 8], [26, 41, 8, 8, 8, 39, 43, 9, 8, 8], [27, 43, 8, 8, 8, 15, 15, 10, 8, 8], [10, 15, 8, 8, 8, 18, 23, 8, 8, 8], [10, 14, 9, 8, 8, 10, 8, 8, 8, 8], [8, 8, 9, 8, 8, 8, 10, 8, 8, 8], [8, 10, 8, 8, 8, 8, 9, 8, 8, 8], [8]]
| epoch  15 step    30010 | batches    596 / 2101 | lr 2.380e-03 | ms/batch 4941.1 | tok/s    9948 | loss  3.19 | ppl     24.18
| epoch  15 step    30020 | batches    606 / 2101 | lr 2.378e-03 | ms/batch 408.2 | tok/s  120410 | loss  3.23 | ppl     25.28
| epoch  15 step    30030 | batches    616 / 2101 | lr 2.375e-03 | ms/batch 397.0 | tok/s  123824 | loss  3.22 | ppl     24.92
| epoch  15 step    30040 | batches    626 / 2101 | lr 2.372e-03 | ms/batch 397.0 | tok/s  123801 | loss  3.22 | ppl     25.08
| epoch  15 step    30050 | batches    636 / 2101 | lr 2.370e-03 | ms/batch 397.2 | tok/s  123760 | loss  3.19 | ppl     24.24
| epoch  15 step    30060 | batches    646 / 2101 | lr 2.367e-03 | ms/batch 396.7 | tok/s  123891 | loss  3.19 | ppl     24.18
| epoch  15 step    30070 | batches    656 / 2101 | lr 2.364e-03 | ms/batch 408.0 | tok/s  120466 | loss  3.18 | ppl     24.04
| epoch  15 step    30080 | batches    666 / 2101 | lr 2.362e-03 | ms/batch 397.8 | tok/s  123548 | loss  3.17 | ppl     23.77
| epoch  15 step    30090 | batches    676 / 2101 | lr 2.359e-03 | ms/batch 397.5 | tok/s  123652 | loss  3.17 | ppl     23.89
| epoch  15 step    30100 | batches    686 / 2101 | lr 2.357e-03 | ms/batch 397.7 | tok/s  123584 | loss  3.24 | ppl     25.63
| epoch  15 step    30110 | batches    696 / 2101 | lr 2.354e-03 | ms/batch 397.9 | tok/s  123519 | loss  3.22 | ppl     24.99
| epoch  15 step    30120 | batches    706 / 2101 | lr 2.352e-03 | ms/batch 398.0 | tok/s  123500 | loss  3.20 | ppl     24.61
| epoch  15 step    30130 | batches    716 / 2101 | lr 2.349e-03 | ms/batch 397.9 | tok/s  123520 | loss  3.18 | ppl     24.06
| epoch  15 step    30140 | batches    726 / 2101 | lr 2.346e-03 | ms/batch 412.3 | tok/s  119222 | loss  3.19 | ppl     24.41
| epoch  15 step    30150 | batches    736 / 2101 | lr 2.344e-03 | ms/batch 409.7 | tok/s  119969 | loss  3.18 | ppl     24.04
| epoch  15 step    30160 | batches    746 / 2101 | lr 2.341e-03 | ms/batch 399.9 | tok/s  122922 | loss  3.20 | ppl     24.51
| epoch  15 step    30170 | batches    756 / 2101 | lr 2.339e-03 | ms/batch 411.1 | tok/s  119572 | loss  3.24 | ppl     25.49
| epoch  15 step    30180 | batches    766 / 2101 | lr 2.336e-03 | ms/batch 409.1 | tok/s  120136 | loss  3.22 | ppl     25.01
| epoch  15 step    30190 | batches    776 / 2101 | lr 2.333e-03 | ms/batch 409.3 | tok/s  120092 | loss  3.19 | ppl     24.18
| epoch  15 step    30200 | batches    786 / 2101 | lr 2.331e-03 | ms/batch 399.8 | tok/s  122939 | loss  3.21 | ppl     24.72
| epoch  15 step    30210 | batches    796 / 2101 | lr 2.328e-03 | ms/batch 398.7 | tok/s  123281 | loss  3.18 | ppl     24.12
| epoch  15 step    30220 | batches    806 / 2101 | lr 2.326e-03 | ms/batch 398.6 | tok/s  123298 | loss  3.16 | ppl     23.68
| epoch  15 step    30230 | batches    816 / 2101 | lr 2.323e-03 | ms/batch 398.7 | tok/s  123294 | loss  3.18 | ppl     23.93
| epoch  15 step    30240 | batches    826 / 2101 | lr 2.321e-03 | ms/batch 397.9 | tok/s  123517 | loss  3.19 | ppl     24.26
| epoch  15 step    30250 | batches    836 / 2101 | lr 2.318e-03 | ms/batch 398.7 | tok/s  123286 | loss  3.17 | ppl     23.78
| epoch  15 step    30260 | batches    846 / 2101 | lr 2.315e-03 | ms/batch 399.0 | tok/s  123198 | loss  3.18 | ppl     24.17
| epoch  15 step    30270 | batches    856 / 2101 | lr 2.313e-03 | ms/batch 399.7 | tok/s  122985 | loss  3.22 | ppl     25.14
| epoch  15 step    30280 | batches    866 / 2101 | lr 2.310e-03 | ms/batch 399.1 | tok/s  123146 | loss  3.17 | ppl     23.80
| epoch  15 step    30290 | batches    876 / 2101 | lr 2.308e-03 | ms/batch 398.6 | tok/s  123301 | loss  3.16 | ppl     23.55
| epoch  15 step    30300 | batches    886 / 2101 | lr 2.305e-03 | ms/batch 398.7 | tok/s  123268 | loss  3.13 | ppl     22.97
| epoch  15 step    30310 | batches    896 / 2101 | lr 2.303e-03 | ms/batch 398.4 | tok/s  123365 | loss  3.13 | ppl     22.90
| epoch  15 step    30320 | batches    906 / 2101 | lr 2.300e-03 | ms/batch 398.1 | tok/s  123453 | loss  3.15 | ppl     23.22
| epoch  15 step    30330 | batches    916 / 2101 | lr 2.298e-03 | ms/batch 398.4 | tok/s  123365 | loss  3.17 | ppl     23.78
| epoch  15 step    30340 | batches    926 / 2101 | lr 2.295e-03 | ms/batch 398.6 | tok/s  123314 | loss  3.18 | ppl     24.16
| epoch  15 step    30350 | batches    936 / 2101 | lr 2.292e-03 | ms/batch 398.7 | tok/s  123285 | loss  3.19 | ppl     24.21
| epoch  15 step    30360 | batches    946 / 2101 | lr 2.290e-03 | ms/batch 398.4 | tok/s  123383 | loss  3.20 | ppl     24.54
| epoch  15 step    30370 | batches    956 / 2101 | lr 2.287e-03 | ms/batch 398.2 | tok/s  123445 | loss  3.18 | ppl     24.10
| epoch  15 step    30380 | batches    966 / 2101 | lr 2.285e-03 | ms/batch 398.3 | tok/s  123414 | loss  3.19 | ppl     24.39
| epoch  15 step    30390 | batches    976 / 2101 | lr 2.282e-03 | ms/batch 398.9 | tok/s  123206 | loss  3.24 | ppl     25.62
| epoch  15 step    30400 | batches    986 / 2101 | lr 2.280e-03 | ms/batch 399.6 | tok/s  122998 | loss  3.20 | ppl     24.51
| epoch  15 step    30410 | batches    996 / 2101 | lr 2.277e-03 | ms/batch 398.8 | tok/s  123251 | loss  3.19 | ppl     24.17
| epoch  15 step    30420 | batches   1006 / 2101 | lr 2.275e-03 | ms/batch 399.3 | tok/s  123098 | loss  3.19 | ppl     24.23
| epoch  15 step    30430 | batches   1016 / 2101 | lr 2.272e-03 | ms/batch 398.2 | tok/s  123423 | loss  3.17 | ppl     23.77
| epoch  15 step    30440 | batches   1026 / 2101 | lr 2.270e-03 | ms/batch 399.0 | tok/s  123200 | loss  3.22 | ppl     24.93
| epoch  15 step    30450 | batches   1036 / 2101 | lr 2.267e-03 | ms/batch 398.5 | tok/s  123355 | loss  3.19 | ppl     24.38
| epoch  15 step    30460 | batches   1046 / 2101 | lr 2.265e-03 | ms/batch 398.2 | tok/s  123421 | loss  3.18 | ppl     24.09
| epoch  15 step    30470 | batches   1056 / 2101 | lr 2.262e-03 | ms/batch 398.9 | tok/s  123214 | loss  3.19 | ppl     24.22
| epoch  15 step    30480 | batches   1066 / 2101 | lr 2.260e-03 | ms/batch 398.0 | tok/s  123489 | loss  3.17 | ppl     23.82
| epoch  15 step    30490 | batches   1076 / 2101 | lr 2.257e-03 | ms/batch 398.5 | tok/s  123332 | loss  3.19 | ppl     24.30
| epoch  15 step    30500 | batches   1086 / 2101 | lr 2.255e-03 | ms/batch 399.4 | tok/s  123068 | loss  3.17 | ppl     23.90
----------------------------------------------------------------------------------------------------
| Eval  61 at step    30500 | time:  0.83s | valid loss  3.18 | valid ppl    24.014
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
| epoch  15 step    30510 | batches   1096 / 2101 | lr 2.252e-03 | ms/batch 400.4 | tok/s  122771 | loss  3.19 | ppl     24.33
| epoch  15 step    30520 | batches   1106 / 2101 | lr 2.250e-03 | ms/batch 421.1 | tok/s  116713 | loss  3.18 | ppl     23.98
| epoch  15 step    30530 | batches   1116 / 2101 | lr 2.247e-03 | ms/batch 411.3 | tok/s  119517 | loss  3.23 | ppl     25.29
| epoch  15 step    30540 | batches   1126 / 2101 | lr 2.245e-03 | ms/batch 399.9 | tok/s  122918 | loss  3.22 | ppl     24.96
| epoch  15 step    30550 | batches   1136 / 2101 | lr 2.242e-03 | ms/batch 410.7 | tok/s  119671 | loss  3.22 | ppl     25.05
| epoch  15 step    30560 | batches   1146 / 2101 | lr 2.240e-03 | ms/batch 409.3 | tok/s  120095 | loss  3.23 | ppl     25.16
| epoch  15 step    30570 | batches   1156 / 2101 | lr 2.237e-03 | ms/batch 398.9 | tok/s  123226 | loss  3.21 | ppl     24.71
| epoch  15 step    30580 | batches   1166 / 2101 | lr 2.235e-03 | ms/batch 399.1 | tok/s  123151 | loss  3.24 | ppl     25.43
| epoch  15 step    30590 | batches   1176 / 2101 | lr 2.232e-03 | ms/batch 409.8 | tok/s  119928 | loss  3.25 | ppl     25.71
| epoch  15 step    30600 | batches   1186 / 2101 | lr 2.230e-03 | ms/batch 398.8 | tok/s  123244 | loss  3.18 | ppl     24.10
| epoch  15 step    30610 | batches   1196 / 2101 | lr 2.227e-03 | ms/batch 400.2 | tok/s  122812 | loss  3.16 | ppl     23.60
| epoch  15 step    30620 | batches   1206 / 2101 | lr 2.225e-03 | ms/batch 398.6 | tok/s  123320 | loss  3.24 | ppl     25.41
| epoch  15 step    30630 | batches   1216 / 2101 | lr 2.222e-03 | ms/batch 408.5 | tok/s  120314 | loss  3.21 | ppl     24.81
| epoch  15 step    30640 | batches   1226 / 2101 | lr 2.220e-03 | ms/batch 400.8 | tok/s  122635 | loss  3.19 | ppl     24.32
| epoch  15 step    30650 | batches   1236 / 2101 | lr 2.217e-03 | ms/batch 399.2 | tok/s  123140 | loss  3.21 | ppl     24.84
| epoch  15 step    30660 | batches   1246 / 2101 | lr 2.215e-03 | ms/batch 399.5 | tok/s  123020 | loss  3.23 | ppl     25.40
| epoch  15 step    30670 | batches   1256 / 2101 | lr 2.212e-03 | ms/batch 399.1 | tok/s  123159 | loss  3.23 | ppl     25.37
| epoch  15 step    30680 | batches   1266 / 2101 | lr 2.210e-03 | ms/batch 409.6 | tok/s  119996 | loss  3.21 | ppl     24.70
| epoch  15 step    30690 | batches   1276 / 2101 | lr 2.207e-03 | ms/batch 410.0 | tok/s  119889 | loss  3.20 | ppl     24.58
| epoch  15 step    30700 | batches   1286 / 2101 | lr 2.205e-03 | ms/batch 400.3 | tok/s  122802 | loss  3.26 | ppl     26.01
| epoch  15 step    30710 | batches   1296 / 2101 | lr 2.202e-03 | ms/batch 399.2 | tok/s  123132 | loss  3.26 | ppl     26.00
| epoch  15 step    30720 | batches   1306 / 2101 | lr 2.200e-03 | ms/batch 399.5 | tok/s  123035 | loss  3.25 | ppl     25.83
| epoch  15 step    30730 | batches   1316 / 2101 | lr 2.197e-03 | ms/batch 399.5 | tok/s  123033 | loss  3.27 | ppl     26.21
| epoch  15 step    30740 | batches   1326 / 2101 | lr 2.195e-03 | ms/batch 399.2 | tok/s  123129 | loss  3.22 | ppl     25.14
| epoch  15 step    30750 | batches   1336 / 2101 | lr 2.192e-03 | ms/batch 399.8 | tok/s  122941 | loss  3.22 | ppl     24.98
| epoch  15 step    30760 | batches   1346 / 2101 | lr 2.190e-03 | ms/batch 399.3 | tok/s  123088 | loss  3.20 | ppl     24.46
| epoch  15 step    30770 | batches   1356 / 2101 | lr 2.188e-03 | ms/batch 398.6 | tok/s  123323 | loss  3.21 | ppl     24.68
| epoch  15 step    30780 | batches   1366 / 2101 | lr 2.185e-03 | ms/batch 397.8 | tok/s  123550 | loss  3.22 | ppl     25.06
| epoch  15 step    30790 | batches   1376 / 2101 | lr 2.183e-03 | ms/batch 398.3 | tok/s  123417 | loss  3.23 | ppl     25.21
| epoch  15 step    30800 | batches   1386 / 2101 | lr 2.180e-03 | ms/batch 398.6 | tok/s  123305 | loss  3.20 | ppl     24.57
| epoch  15 step    30810 | batches   1396 / 2101 | lr 2.178e-03 | ms/batch 398.9 | tok/s  123208 | loss  3.19 | ppl     24.32
| epoch  15 step    30820 | batches   1406 / 2101 | lr 2.175e-03 | ms/batch 398.1 | tok/s  123474 | loss  3.19 | ppl     24.38
| epoch  15 step    30830 | batches   1416 / 2101 | lr 2.173e-03 | ms/batch 398.5 | tok/s  123354 | loss  3.21 | ppl     24.68
| epoch  15 step    30840 | batches   1426 / 2101 | lr 2.170e-03 | ms/batch 398.4 | tok/s  123361 | loss  3.20 | ppl     24.65
| epoch  15 step    30850 | batches   1436 / 2101 | lr 2.168e-03 | ms/batch 398.8 | tok/s  123263 | loss  3.17 | ppl     23.86
| epoch  15 step    30860 | batches   1446 / 2101 | lr 2.166e-03 | ms/batch 398.4 | tok/s  123387 | loss  3.20 | ppl     24.53
| epoch  15 step    30870 | batches   1456 / 2101 | lr 2.163e-03 | ms/batch 397.7 | tok/s  123580 | loss  3.17 | ppl     23.74
| epoch  15 step    30880 | batches   1466 / 2101 | lr 2.161e-03 | ms/batch 399.6 | tok/s  123008 | loss  3.21 | ppl     24.68
| epoch  15 step    30890 | batches   1476 / 2101 | lr 2.158e-03 | ms/batch 398.9 | tok/s  123225 | loss  3.18 | ppl     23.98
| epoch  15 step    30900 | batches   1486 / 2101 | lr 2.156e-03 | ms/batch 398.7 | tok/s  123270 | loss  3.20 | ppl     24.64
| epoch  15 step    30910 | batches   1496 / 2101 | lr 2.153e-03 | ms/batch 399.0 | tok/s  123179 | loss  3.20 | ppl     24.61
| epoch  15 step    30920 | batches   1506 / 2101 | lr 2.151e-03 | ms/batch 399.3 | tok/s  123083 | loss  3.22 | ppl     25.07
| epoch  15 step    30930 | batches   1516 / 2101 | lr 2.149e-03 | ms/batch 399.3 | tok/s  123099 | loss  3.19 | ppl     24.17
| epoch  15 step    30940 | batches   1526 / 2101 | lr 2.146e-03 | ms/batch 399.8 | tok/s  122953 | loss  3.20 | ppl     24.65
| epoch  15 step    30950 | batches   1536 / 2101 | lr 2.144e-03 | ms/batch 399.2 | tok/s  123129 | loss  3.19 | ppl     24.28
| epoch  15 step    30960 | batches   1546 / 2101 | lr 2.141e-03 | ms/batch 398.7 | tok/s  123276 | loss  3.20 | ppl     24.41
| epoch  15 step    30970 | batches   1556 / 2101 | lr 2.139e-03 | ms/batch 398.0 | tok/s  123497 | loss  3.17 | ppl     23.89
| epoch  15 step    30980 | batches   1566 / 2101 | lr 2.137e-03 | ms/batch 398.5 | tok/s  123330 | loss  3.19 | ppl     24.22
| epoch  15 step    30990 | batches   1576 / 2101 | lr 2.134e-03 | ms/batch 397.9 | tok/s  123515 | loss  3.24 | ppl     25.41
| epoch  15 step    31000 | batches   1586 / 2101 | lr 2.132e-03 | ms/batch 412.0 | tok/s  119302 | loss  3.19 | ppl     24.19
----------------------------------------------------------------------------------------------------
| Eval  62 at step    31000 | time:  0.81s | valid loss  3.17 | valid ppl    23.900
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.035727244846509805, 0.036062998957749844, 0.03877247368770592, 0.03499868552256558, 0.03438067372188358, 0.03595440392475268, 0.03507271499310844, 0.03670408213388646, 0.03461766731210308, 0.03249374320355676, 0.0362464082174974, 0.03729830200329169, 0.033783178581470646, 0.038821507243446816, 0.0361399085601666, 0.03660031016117007, 0.0370590725080982, 0.03989808270346026, 0.037657722073919486, 0.03550465540422017, 0.03972827600183795, 0.03747745482730549, 0.04104784511495517, 0.03450937318237436, 0.03620124904688855, 0.036792824706928184, 0.038628404632904484, 0.035355621488523774, 0.03794347869585217, 0.03638864670247512, 0.03649617417083057, 0.036006109216385765, 0.034363220360668516, 0.03569779923300146, 0.03551158364599639, 0.037845943902019626, 0.037657323521567386, 0.030731172256915792, 0.03632834128143811, 0.03600605082802924, 0.03546801651423815, 0.03736813001455617, 0.043936365158765055, 0.033876472444552753, 0.034352491594272574, 0.035286510671995876, 0.035775129271523716, 0.03679469515567062, 0.03134407426640886, 0.03481951311288578, 0.03538842616529592, 0.0340770249147121, 0.03153502219621976, 0.029243901588311087, 0.03379465123923837, 0.034626160896066294, 0.036645511759639496, 0.039897744314734286, 0.03473188125335956, 0.033922270116630064, 0.03252999269923383, 0.026325997586649805, 0.0008283936954598842, 0.028915929708454077, 0.032992749604375586, 0.034237652305167544, 0.0349966667013112, 0.018160432550483285, 0.029565941377182745, 0.033165256474197095, 0.033618147304386496, 0.036124879449692684, 0.02576740506271277, 0.026443422457249826, 0.030993327405037966, 0.03368535382106094, 0.033844425771620924, 0.02053679003582367, 0.027657707960316077, 0.032615628526433155, 0.034357835690078296]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [52, 66, 8, 11, 9, 56, 82, 9, 17, 10], [39, 44, 18, 8, 8, 45, 57, 11, 8, 8], [28, 40, 8, 8, 8, 36, 54, 9, 8, 8], [28, 45, 8, 8, 8, 19, 15, 10, 8, 8], [8, 14, 8, 8, 8, 18, 19, 8, 8, 8], [11, 14, 8, 8, 8, 8, 15, 8, 8, 8], [8, 9, 8, 8, 8, 8, 8, 8, 8, 8], [9, 11, 8, 8, 8, 8, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [52, 66, 8, 11, 9, 56, 82, 9, 17, 10], [39, 44, 18, 8, 8, 45, 57, 11, 8, 8], [28, 40, 8, 8, 8, 36, 54, 9, 8, 8], [28, 45, 8, 8, 8, 19, 15, 10, 8, 8], [8, 14, 8, 8, 8, 18, 19, 8, 8, 8], [11, 14, 8, 8, 8, 8, 15, 8, 8, 8], [8, 9, 8, 8, 8, 8, 8, 8, 8, 8], [9, 11, 8, 8, 8, 8, 8, 8, 8, 8], [8]]
Compression stats: iter 31000, total before compression 5758700890298, total after compression 409409306522, rate 14.065876858587119
Compression stats: iter 31000, total before compression 5758700890298, total after compression 409409306522, rate 14.065876858587119
Compression stats: iter 31000, total before compression 5758700890298, total after compression 409409306522, rate 14.065876858587119
Compression stats: iter 31000, total before compression 5758700890298, total after compression 409409306522, rate 14.065876858587119
Compression stats: iter 31000, total before compression 5758700890298, total after compression 409409306522, rate 14.065876858587119
Compression stats: iter 31000, total before compression 5758700890298, total after compression 409409306522, rate 14.065876858587119
Compression stats: iter 31000, total before compression 5758700890298, total after compression 409409306522, rate 14.065876858587119
Compression stats: iter 31000, total before compression 5758700890298, total after compression 409409306522, rate 14.065876858587119
| epoch  15 step    31010 | batches   1596 / 2101 | lr 2.129e-03 | ms/batch 4867.2 | tok/s   10099 | loss  3.17 | ppl     23.89
| epoch  15 step    31020 | batches   1606 / 2101 | lr 2.127e-03 | ms/batch 409.1 | tok/s  120140 | loss  3.18 | ppl     24.15
| epoch  15 step    31030 | batches   1616 / 2101 | lr 2.125e-03 | ms/batch 396.2 | tok/s  124047 | loss  3.14 | ppl     23.01
| epoch  15 step    31040 | batches   1626 / 2101 | lr 2.122e-03 | ms/batch 406.6 | tok/s  120878 | loss  3.15 | ppl     23.44
| epoch  15 step    31050 | batches   1636 / 2101 | lr 2.120e-03 | ms/batch 396.7 | tok/s  123894 | loss  3.19 | ppl     24.19
| epoch  15 step    31060 | batches   1646 / 2101 | lr 2.117e-03 | ms/batch 396.5 | tok/s  123956 | loss  3.19 | ppl     24.28
| epoch  15 step    31070 | batches   1656 / 2101 | lr 2.115e-03 | ms/batch 407.2 | tok/s  120708 | loss  3.24 | ppl     25.61
| epoch  15 step    31080 | batches   1666 / 2101 | lr 2.113e-03 | ms/batch 398.2 | tok/s  123442 | loss  3.20 | ppl     24.60
| epoch  15 step    31090 | batches   1676 / 2101 | lr 2.110e-03 | ms/batch 397.1 | tok/s  123777 | loss  3.19 | ppl     24.19
| epoch  15 step    31100 | batches   1686 / 2101 | lr 2.108e-03 | ms/batch 397.6 | tok/s  123626 | loss  3.21 | ppl     24.80
| epoch  15 step    31110 | batches   1696 / 2101 | lr 2.105e-03 | ms/batch 397.0 | tok/s  123818 | loss  3.19 | ppl     24.21
| epoch  15 step    31120 | batches   1706 / 2101 | lr 2.103e-03 | ms/batch 397.3 | tok/s  123723 | loss  3.20 | ppl     24.49
| epoch  15 step    31130 | batches   1716 / 2101 | lr 2.101e-03 | ms/batch 398.0 | tok/s  123504 | loss  3.24 | ppl     25.56
| epoch  15 step    31140 | batches   1726 / 2101 | lr 2.098e-03 | ms/batch 398.1 | tok/s  123470 | loss  3.17 | ppl     23.90
| epoch  15 step    31150 | batches   1736 / 2101 | lr 2.096e-03 | ms/batch 397.5 | tok/s  123647 | loss  3.20 | ppl     24.65
| epoch  15 step    31160 | batches   1746 / 2101 | lr 2.094e-03 | ms/batch 397.6 | tok/s  123634 | loss  3.20 | ppl     24.55
| epoch  15 step    31170 | batches   1756 / 2101 | lr 2.091e-03 | ms/batch 398.3 | tok/s  123417 | loss  3.20 | ppl     24.62
| epoch  15 step    31180 | batches   1766 / 2101 | lr 2.089e-03 | ms/batch 397.9 | tok/s  123530 | loss  3.22 | ppl     24.95
| epoch  15 step    31190 | batches   1776 / 2101 | lr 2.086e-03 | ms/batch 398.0 | tok/s  123511 | loss  3.21 | ppl     24.77
| epoch  15 step    31200 | batches   1786 / 2101 | lr 2.084e-03 | ms/batch 397.4 | tok/s  123676 | loss  3.21 | ppl     24.83
| epoch  15 step    31210 | batches   1796 / 2101 | lr 2.082e-03 | ms/batch 398.0 | tok/s  123491 | loss  3.20 | ppl     24.45
| epoch  15 step    31220 | batches   1806 / 2101 | lr 2.079e-03 | ms/batch 397.8 | tok/s  123567 | loss  3.19 | ppl     24.29
| epoch  15 step    31230 | batches   1816 / 2101 | lr 2.077e-03 | ms/batch 398.3 | tok/s  123404 | loss  3.23 | ppl     25.29
| epoch  15 step    31240 | batches   1826 / 2101 | lr 2.075e-03 | ms/batch 398.0 | tok/s  123501 | loss  3.21 | ppl     24.71
| epoch  15 step    31250 | batches   1836 / 2101 | lr 2.072e-03 | ms/batch 398.6 | tok/s  123313 | loss  3.22 | ppl     24.92
| epoch  15 step    31260 | batches   1846 / 2101 | lr 2.070e-03 | ms/batch 398.3 | tok/s  123417 | loss  3.23 | ppl     25.31
| epoch  15 step    31270 | batches   1856 / 2101 | lr 2.068e-03 | ms/batch 397.6 | tok/s  123633 | loss  3.23 | ppl     25.26
| epoch  15 step    31280 | batches   1866 / 2101 | lr 2.065e-03 | ms/batch 398.7 | tok/s  123273 | loss  3.18 | ppl     24.02
| epoch  15 step    31290 | batches   1876 / 2101 | lr 2.063e-03 | ms/batch 409.0 | tok/s  120178 | loss  3.22 | ppl     24.97
| epoch  15 step    31300 | batches   1886 / 2101 | lr 2.061e-03 | ms/batch 409.6 | tok/s  119990 | loss  3.25 | ppl     25.83
| epoch  15 step    31310 | batches   1896 / 2101 | lr 2.058e-03 | ms/batch 400.1 | tok/s  122856 | loss  3.24 | ppl     25.45
| epoch  15 step    31320 | batches   1906 / 2101 | lr 2.056e-03 | ms/batch 398.9 | tok/s  123215 | loss  3.21 | ppl     24.74
| epoch  15 step    31330 | batches   1916 / 2101 | lr 2.054e-03 | ms/batch 397.6 | tok/s  123625 | loss  3.21 | ppl     24.79
| epoch  15 step    31340 | batches   1926 / 2101 | lr 2.051e-03 | ms/batch 397.8 | tok/s  123571 | loss  3.20 | ppl     24.53
| epoch  15 step    31350 | batches   1936 / 2101 | lr 2.049e-03 | ms/batch 397.5 | tok/s  123663 | loss  3.16 | ppl     23.50
| epoch  15 step    31360 | batches   1946 / 2101 | lr 2.047e-03 | ms/batch 398.4 | tok/s  123368 | loss  3.17 | ppl     23.91
| epoch  15 step    31370 | batches   1956 / 2101 | lr 2.044e-03 | ms/batch 397.9 | tok/s  123518 | loss  3.22 | ppl     25.03
| epoch  15 step    31380 | batches   1966 / 2101 | lr 2.042e-03 | ms/batch 398.8 | tok/s  123236 | loss  3.22 | ppl     25.01
| epoch  15 step    31390 | batches   1976 / 2101 | lr 2.040e-03 | ms/batch 398.6 | tok/s  123304 | loss  3.20 | ppl     24.64
| epoch  15 step    31400 | batches   1986 / 2101 | lr 2.037e-03 | ms/batch 398.6 | tok/s  123301 | loss  3.17 | ppl     23.91
| epoch  15 step    31410 | batches   1996 / 2101 | lr 2.035e-03 | ms/batch 398.4 | tok/s  123384 | loss  3.15 | ppl     23.40
| epoch  15 step    31420 | batches   2006 / 2101 | lr 2.033e-03 | ms/batch 397.7 | tok/s  123586 | loss  3.18 | ppl     24.07
| epoch  15 step    31430 | batches   2016 / 2101 | lr 2.030e-03 | ms/batch 397.7 | tok/s  123596 | loss  3.17 | ppl     23.80
| epoch  15 step    31440 | batches   2026 / 2101 | lr 2.028e-03 | ms/batch 398.2 | tok/s  123423 | loss  3.18 | ppl     24.11
| epoch  15 step    31450 | batches   2036 / 2101 | lr 2.026e-03 | ms/batch 397.4 | tok/s  123699 | loss  3.17 | ppl     23.80
| epoch  15 step    31460 | batches   2046 / 2101 | lr 2.023e-03 | ms/batch 398.9 | tok/s  123211 | loss  3.13 | ppl     22.87
| epoch  15 step    31470 | batches   2056 / 2101 | lr 2.021e-03 | ms/batch 397.9 | tok/s  123517 | loss  3.17 | ppl     23.76
| epoch  15 step    31480 | batches   2066 / 2101 | lr 2.019e-03 | ms/batch 397.5 | tok/s  123649 | loss  3.18 | ppl     23.98
| epoch  15 step    31490 | batches   2076 / 2101 | lr 2.017e-03 | ms/batch 398.7 | tok/s  123292 | loss  3.20 | ppl     24.45
| epoch  15 step    31500 | batches   2086 / 2101 | lr 2.014e-03 | ms/batch 397.8 | tok/s  123545 | loss  3.25 | ppl     25.92
----------------------------------------------------------------------------------------------------
| Eval  63 at step    31500 | time:  0.82s | valid loss  3.17 | valid ppl    23.774
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  15 step    31510 | batches   2096 / 2101 | lr 2.012e-03 | ms/batch 398.2 | tok/s  123431 | loss  3.22 | ppl     25.09
| epoch  16 step    31520 | batches      5 / 2101 | lr 2.010e-03 | ms/batch 399.2 | tok/s  123282 | loss  3.31 | ppl     27.40
| epoch  16 step    31530 | batches     15 / 2101 | lr 2.007e-03 | ms/batch 397.8 | tok/s  123552 | loss  3.19 | ppl     24.38
| epoch  16 step    31540 | batches     25 / 2101 | lr 2.005e-03 | ms/batch 396.8 | tok/s  123878 | loss  3.18 | ppl     24.04
| epoch  16 step    31550 | batches     35 / 2101 | lr 2.003e-03 | ms/batch 397.6 | tok/s  123636 | loss  3.18 | ppl     24.03
| epoch  16 step    31560 | batches     45 / 2101 | lr 2.001e-03 | ms/batch 397.4 | tok/s  123676 | loss  3.17 | ppl     23.87
| epoch  16 step    31570 | batches     55 / 2101 | lr 1.998e-03 | ms/batch 407.4 | tok/s  120654 | loss  3.17 | ppl     23.86
| epoch  16 step    31580 | batches     65 / 2101 | lr 1.996e-03 | ms/batch 398.7 | tok/s  123278 | loss  3.11 | ppl     22.36
| epoch  16 step    31590 | batches     75 / 2101 | lr 1.994e-03 | ms/batch 409.5 | tok/s  120022 | loss  3.14 | ppl     23.02
| epoch  16 step    31600 | batches     85 / 2101 | lr 1.991e-03 | ms/batch 398.1 | tok/s  123463 | loss  3.17 | ppl     23.73
| epoch  16 step    31610 | batches     95 / 2101 | lr 1.989e-03 | ms/batch 398.3 | tok/s  123415 | loss  3.14 | ppl     23.22
| epoch  16 step    31620 | batches    105 / 2101 | lr 1.987e-03 | ms/batch 397.9 | tok/s  123530 | loss  3.17 | ppl     23.88
| epoch  16 step    31630 | batches    115 / 2101 | lr 1.985e-03 | ms/batch 397.9 | tok/s  123533 | loss  3.17 | ppl     23.77
| epoch  16 step    31640 | batches    125 / 2101 | lr 1.982e-03 | ms/batch 398.7 | tok/s  123271 | loss  3.18 | ppl     24.17
| epoch  16 step    31650 | batches    135 / 2101 | lr 1.980e-03 | ms/batch 398.3 | tok/s  123400 | loss  3.17 | ppl     23.84
| epoch  16 step    31660 | batches    145 / 2101 | lr 1.978e-03 | ms/batch 398.5 | tok/s  123342 | loss  3.16 | ppl     23.51
| epoch  16 step    31670 | batches    155 / 2101 | lr 1.976e-03 | ms/batch 398.0 | tok/s  123511 | loss  3.14 | ppl     23.10
| epoch  16 step    31680 | batches    165 / 2101 | lr 1.973e-03 | ms/batch 396.6 | tok/s  123930 | loss  3.15 | ppl     23.30
| epoch  16 step    31690 | batches    175 / 2101 | lr 1.971e-03 | ms/batch 397.8 | tok/s  123567 | loss  3.14 | ppl     23.17
| epoch  16 step    31700 | batches    185 / 2101 | lr 1.969e-03 | ms/batch 397.9 | tok/s  123530 | loss  3.16 | ppl     23.48
| epoch  16 step    31710 | batches    195 / 2101 | lr 1.967e-03 | ms/batch 397.8 | tok/s  123547 | loss  3.19 | ppl     24.21
| epoch  16 step    31720 | batches    205 / 2101 | lr 1.964e-03 | ms/batch 398.4 | tok/s  123366 | loss  3.20 | ppl     24.50
| epoch  16 step    31730 | batches    215 / 2101 | lr 1.962e-03 | ms/batch 398.0 | tok/s  123503 | loss  3.17 | ppl     23.90
| epoch  16 step    31740 | batches    225 / 2101 | lr 1.960e-03 | ms/batch 397.4 | tok/s  123677 | loss  3.16 | ppl     23.59
| epoch  16 step    31750 | batches    235 / 2101 | lr 1.958e-03 | ms/batch 397.6 | tok/s  123630 | loss  3.20 | ppl     24.54
| epoch  16 step    31760 | batches    245 / 2101 | lr 1.955e-03 | ms/batch 398.3 | tok/s  123411 | loss  3.23 | ppl     25.24
| epoch  16 step    31770 | batches    255 / 2101 | lr 1.953e-03 | ms/batch 398.5 | tok/s  123351 | loss  3.20 | ppl     24.58
| epoch  16 step    31780 | batches    265 / 2101 | lr 1.951e-03 | ms/batch 398.4 | tok/s  123365 | loss  3.18 | ppl     24.03
| epoch  16 step    31790 | batches    275 / 2101 | lr 1.949e-03 | ms/batch 398.1 | tok/s  123456 | loss  3.14 | ppl     23.09
| epoch  16 step    31800 | batches    285 / 2101 | lr 1.947e-03 | ms/batch 397.1 | tok/s  123768 | loss  3.16 | ppl     23.67
| epoch  16 step    31810 | batches    295 / 2101 | lr 1.944e-03 | ms/batch 397.6 | tok/s  123611 | loss  3.17 | ppl     23.87
| epoch  16 step    31820 | batches    305 / 2101 | lr 1.942e-03 | ms/batch 397.4 | tok/s  123694 | loss  3.16 | ppl     23.64
| epoch  16 step    31830 | batches    315 / 2101 | lr 1.940e-03 | ms/batch 397.1 | tok/s  123763 | loss  3.17 | ppl     23.83
| epoch  16 step    31840 | batches    325 / 2101 | lr 1.938e-03 | ms/batch 398.9 | tok/s  123224 | loss  3.21 | ppl     24.71
| epoch  16 step    31850 | batches    335 / 2101 | lr 1.935e-03 | ms/batch 398.3 | tok/s  123409 | loss  3.22 | ppl     24.91
| epoch  16 step    31860 | batches    345 / 2101 | lr 1.933e-03 | ms/batch 398.6 | tok/s  123322 | loss  3.22 | ppl     24.95
| epoch  16 step    31870 | batches    355 / 2101 | lr 1.931e-03 | ms/batch 399.1 | tok/s  123171 | loss  3.19 | ppl     24.29
| epoch  16 step    31880 | batches    365 / 2101 | lr 1.929e-03 | ms/batch 398.9 | tok/s  123209 | loss  3.19 | ppl     24.33
| epoch  16 step    31890 | batches    375 / 2101 | lr 1.927e-03 | ms/batch 409.2 | tok/s  120111 | loss  3.17 | ppl     23.78
| epoch  16 step    31900 | batches    385 / 2101 | lr 1.924e-03 | ms/batch 399.8 | tok/s  122944 | loss  3.13 | ppl     22.82
| epoch  16 step    31910 | batches    395 / 2101 | lr 1.922e-03 | ms/batch 399.9 | tok/s  122910 | loss  3.15 | ppl     23.39
| epoch  16 step    31920 | batches    405 / 2101 | lr 1.920e-03 | ms/batch 399.9 | tok/s  122905 | loss  3.15 | ppl     23.27
| epoch  16 step    31930 | batches    415 / 2101 | lr 1.918e-03 | ms/batch 399.7 | tok/s  122968 | loss  3.17 | ppl     23.77
| epoch  16 step    31940 | batches    425 / 2101 | lr 1.916e-03 | ms/batch 399.2 | tok/s  123132 | loss  3.18 | ppl     24.11
| epoch  16 step    31950 | batches    435 / 2101 | lr 1.913e-03 | ms/batch 400.2 | tok/s  122811 | loss  3.15 | ppl     23.44
| epoch  16 step    31960 | batches    445 / 2101 | lr 1.911e-03 | ms/batch 398.6 | tok/s  123321 | loss  3.15 | ppl     23.24
| epoch  16 step    31970 | batches    455 / 2101 | lr 1.909e-03 | ms/batch 398.5 | tok/s  123336 | loss  3.12 | ppl     22.69
| epoch  16 step    31980 | batches    465 / 2101 | lr 1.907e-03 | ms/batch 398.7 | tok/s  123296 | loss  3.14 | ppl     23.12
| epoch  16 step    31990 | batches    475 / 2101 | lr 1.905e-03 | ms/batch 398.0 | tok/s  123484 | loss  3.18 | ppl     24.02
| epoch  16 step    32000 | batches    485 / 2101 | lr 1.903e-03 | ms/batch 411.2 | tok/s  119522 | loss  3.17 | ppl     23.91
----------------------------------------------------------------------------------------------------
| Eval  64 at step    32000 | time:  0.81s | valid loss  3.17 | valid ppl    23.797
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
ratio list [0.03655045501878201, 0.03571383834040232, 0.03475959422808385, 0.034049481862096206, 0.033918319355451, 0.036516621550610646, 0.035148841016631065, 0.040197086249427125, 0.033299641510945936, 0.03129224720222553, 0.038672465087527655, 0.037870838244991836, 0.03154057675418779, 0.03784357553435046, 0.036000031853401546, 0.03830229727663761, 0.03709794248720225, 0.040878633861946664, 0.037314523165910204, 0.035069547949585056, 0.03751693520075738, 0.03789721284506712, 0.040822257243645646, 0.03683338484289959, 0.03571781328117544, 0.03640859358834891, 0.038336763325165925, 0.04345262377827749, 0.036884003661707604, 0.036028979404850794, 0.038464975038771596, 0.036774639237631676, 0.0384328993975886, 0.03496397913867618, 0.036014264684012004, 0.03653984805239635, 0.03747944220616929, 0.030282558494750315, 0.03453320891190358, 0.03535958472614985, 0.04135191956812981, 0.037494960354791024, 0.035019967286911396, 0.0361660688720256, 0.035027166795159936, 0.03916602661987331, 0.037643655002749105, 0.031468176337284756, 0.03329463855335353, 0.03428688066783588, 0.03798985693840184, 0.038330377660034394, 0.037133760676559595, 0.030560173623958194, 0.03422450150306152, 0.04160809552298356, 0.03797939858570151, 0.04697682475513233, 0.03482510455883025, 0.034094877816418505, 0.030819794405945324, 0.026593960378266526, 0.006210348131191679, 0.027110454612537138, 0.03334182750805868, 0.03350233877278753, 0.03499292084133798, 0.02887612841089512, 0.031390579403752714, 0.03382296986081906, 0.03422513526160934, 0.0331005595758023, 0.02030430624191983, 0.02644813992365079, 0.031301312847560624, 0.03425722858980111, 0.03361149460880348, 0.025513908930539515, 0.027363653296316147, 0.032544212092999375, 0.03249973970691504]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [54, 63, 9, 11, 9, 62, 87, 9, 18, 10], [37, 32, 15, 8, 8, 48, 53, 12, 8, 8], [25, 39, 8, 8, 8, 35, 41, 9, 8, 8], [29, 45, 8, 8, 8, 17, 14, 11, 8, 8], [12, 13, 8, 8, 8, 20, 19, 8, 8, 8], [9, 14, 8, 8, 8, 8, 11, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [9, 14, 8, 8, 8, 10, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [54, 63, 9, 11, 9, 62, 87, 9, 18, 10], [37, 32, 15, 8, 8, 48, 53, 12, 8, 8], [25, 39, 8, 8, 8, 35, 41, 9, 8, 8], [29, 45, 8, 8, 8, 17, 14, 11, 8, 8], [12, 13, 8, 8, 8, 20, 19, 8, 8, 8], [9, 14, 8, 8, 8, 8, 11, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [9, 14, 8, 8, 8, 10, 8, 8, 8, 8], [8]]
| epoch  16 step    32010 | batches    495 / 2101 | lr 1.900e-03 | ms/batch 4894.4 | tok/s   10043 | loss  3.16 | ppl     23.68
| epoch  16 step    32020 | batches    505 / 2101 | lr 1.898e-03 | ms/batch 416.2 | tok/s  118103 | loss  3.21 | ppl     24.67
| epoch  16 step    32030 | batches    515 / 2101 | lr 1.896e-03 | ms/batch 394.7 | tok/s  124528 | loss  3.20 | ppl     24.43
| epoch  16 step    32040 | batches    525 / 2101 | lr 1.894e-03 | ms/batch 396.0 | tok/s  124119 | loss  3.19 | ppl     24.37
| epoch  16 step    32050 | batches    535 / 2101 | lr 1.892e-03 | ms/batch 396.3 | tok/s  124028 | loss  3.19 | ppl     24.23
| epoch  16 step    32060 | batches    545 / 2101 | lr 1.889e-03 | ms/batch 395.6 | tok/s  124255 | loss  3.20 | ppl     24.47
| epoch  16 step    32070 | batches    555 / 2101 | lr 1.887e-03 | ms/batch 396.3 | tok/s  124036 | loss  3.15 | ppl     23.36
| epoch  16 step    32080 | batches    565 / 2101 | lr 1.885e-03 | ms/batch 395.5 | tok/s  124285 | loss  3.12 | ppl     22.69
| epoch  16 step    32090 | batches    575 / 2101 | lr 1.883e-03 | ms/batch 396.2 | tok/s  124046 | loss  3.14 | ppl     23.10
| epoch  16 step    32100 | batches    585 / 2101 | lr 1.881e-03 | ms/batch 396.7 | tok/s  123896 | loss  3.21 | ppl     24.70
| epoch  16 step    32110 | batches    595 / 2101 | lr 1.879e-03 | ms/batch 396.0 | tok/s  124111 | loss  3.17 | ppl     23.86
| epoch  16 step    32120 | batches    605 / 2101 | lr 1.877e-03 | ms/batch 396.2 | tok/s  124053 | loss  3.20 | ppl     24.50
| epoch  16 step    32130 | batches    615 / 2101 | lr 1.874e-03 | ms/batch 396.5 | tok/s  123953 | loss  3.18 | ppl     24.02
| epoch  16 step    32140 | batches    625 / 2101 | lr 1.872e-03 | ms/batch 396.4 | tok/s  123997 | loss  3.15 | ppl     23.44
| epoch  16 step    32150 | batches    635 / 2101 | lr 1.870e-03 | ms/batch 397.4 | tok/s  123696 | loss  3.20 | ppl     24.56
| epoch  16 step    32160 | batches    645 / 2101 | lr 1.868e-03 | ms/batch 407.1 | tok/s  120752 | loss  3.14 | ppl     23.17
| epoch  16 step    32170 | batches    655 / 2101 | lr 1.866e-03 | ms/batch 397.2 | tok/s  123737 | loss  3.14 | ppl     23.06
| epoch  16 step    32180 | batches    665 / 2101 | lr 1.864e-03 | ms/batch 396.4 | tok/s  124004 | loss  3.14 | ppl     23.13
| epoch  16 step    32190 | batches    675 / 2101 | lr 1.862e-03 | ms/batch 396.1 | tok/s  124088 | loss  3.18 | ppl     23.98
| epoch  16 step    32200 | batches    685 / 2101 | lr 1.859e-03 | ms/batch 395.9 | tok/s  124139 | loss  3.15 | ppl     23.25
| epoch  16 step    32210 | batches    695 / 2101 | lr 1.857e-03 | ms/batch 396.5 | tok/s  123952 | loss  3.21 | ppl     24.67
| epoch  16 step    32220 | batches    705 / 2101 | lr 1.855e-03 | ms/batch 397.1 | tok/s  123783 | loss  3.18 | ppl     24.03
| epoch  16 step    32230 | batches    715 / 2101 | lr 1.853e-03 | ms/batch 397.1 | tok/s  123790 | loss  3.19 | ppl     24.27
| epoch  16 step    32240 | batches    725 / 2101 | lr 1.851e-03 | ms/batch 397.1 | tok/s  123782 | loss  3.18 | ppl     24.07
| epoch  16 step    32250 | batches    735 / 2101 | lr 1.849e-03 | ms/batch 397.2 | tok/s  123740 | loss  3.20 | ppl     24.43
| epoch  16 step    32260 | batches    745 / 2101 | lr 1.847e-03 | ms/batch 401.2 | tok/s  122503 | loss  3.15 | ppl     23.33
| epoch  16 step    32270 | batches    755 / 2101 | lr 1.845e-03 | ms/batch 396.8 | tok/s  123862 | loss  3.14 | ppl     23.09
| epoch  16 step    32280 | batches    765 / 2101 | lr 1.842e-03 | ms/batch 396.7 | tok/s  123916 | loss  3.16 | ppl     23.47
| epoch  16 step    32290 | batches    775 / 2101 | lr 1.840e-03 | ms/batch 397.7 | tok/s  123600 | loss  3.20 | ppl     24.61
| epoch  16 step    32300 | batches    785 / 2101 | lr 1.838e-03 | ms/batch 398.0 | tok/s  123491 | loss  3.19 | ppl     24.34
| epoch  16 step    32310 | batches    795 / 2101 | lr 1.836e-03 | ms/batch 398.6 | tok/s  123313 | loss  3.19 | ppl     24.20
| epoch  16 step    32320 | batches    805 / 2101 | lr 1.834e-03 | ms/batch 398.1 | tok/s  123453 | loss  3.18 | ppl     23.94
| epoch  16 step    32330 | batches    815 / 2101 | lr 1.832e-03 | ms/batch 397.5 | tok/s  123648 | loss  3.18 | ppl     23.96
| epoch  16 step    32340 | batches    825 / 2101 | lr 1.830e-03 | ms/batch 397.2 | tok/s  123740 | loss  3.21 | ppl     24.84
| epoch  16 step    32350 | batches    835 / 2101 | lr 1.828e-03 | ms/batch 397.3 | tok/s  123725 | loss  3.17 | ppl     23.91
| epoch  16 step    32360 | batches    845 / 2101 | lr 1.826e-03 | ms/batch 397.1 | tok/s  123792 | loss  3.16 | ppl     23.61
| epoch  16 step    32370 | batches    855 / 2101 | lr 1.824e-03 | ms/batch 396.9 | tok/s  123851 | loss  3.17 | ppl     23.69
| epoch  16 step    32380 | batches    865 / 2101 | lr 1.821e-03 | ms/batch 397.5 | tok/s  123659 | loss  3.20 | ppl     24.52
| epoch  16 step    32390 | batches    875 / 2101 | lr 1.819e-03 | ms/batch 397.2 | tok/s  123734 | loss  3.16 | ppl     23.47
| epoch  16 step    32400 | batches    885 / 2101 | lr 1.817e-03 | ms/batch 397.1 | tok/s  123779 | loss  3.19 | ppl     24.39
| epoch  16 step    32410 | batches    895 / 2101 | lr 1.815e-03 | ms/batch 397.4 | tok/s  123669 | loss  3.21 | ppl     24.71
| epoch  16 step    32420 | batches    905 / 2101 | lr 1.813e-03 | ms/batch 397.7 | tok/s  123586 | loss  3.17 | ppl     23.88
| epoch  16 step    32430 | batches    915 / 2101 | lr 1.811e-03 | ms/batch 397.7 | tok/s  123578 | loss  3.18 | ppl     24.07
| epoch  16 step    32440 | batches    925 / 2101 | lr 1.809e-03 | ms/batch 397.8 | tok/s  123557 | loss  3.21 | ppl     24.72
| epoch  16 step    32450 | batches    935 / 2101 | lr 1.807e-03 | ms/batch 397.6 | tok/s  123634 | loss  3.19 | ppl     24.21
| epoch  16 step    32460 | batches    945 / 2101 | lr 1.805e-03 | ms/batch 397.4 | tok/s  123687 | loss  3.22 | ppl     24.93
| epoch  16 step    32470 | batches    955 / 2101 | lr 1.803e-03 | ms/batch 397.4 | tok/s  123678 | loss  3.18 | ppl     24.02
| epoch  16 step    32480 | batches    965 / 2101 | lr 1.801e-03 | ms/batch 397.3 | tok/s  123714 | loss  3.18 | ppl     24.00
| epoch  16 step    32490 | batches    975 / 2101 | lr 1.799e-03 | ms/batch 397.3 | tok/s  123704 | loss  3.17 | ppl     23.70
| epoch  16 step    32500 | batches    985 / 2101 | lr 1.797e-03 | ms/batch 397.2 | tok/s  123752 | loss  3.16 | ppl     23.61
----------------------------------------------------------------------------------------------------
| Eval  65 at step    32500 | time:  0.81s | valid loss  3.17 | valid ppl    23.723
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  16 step    32510 | batches    995 / 2101 | lr 1.795e-03 | ms/batch 397.2 | tok/s  123736 | loss  3.15 | ppl     23.45
| epoch  16 step    32520 | batches   1005 / 2101 | lr 1.792e-03 | ms/batch 408.2 | tok/s  120403 | loss  3.16 | ppl     23.58
| epoch  16 step    32530 | batches   1015 / 2101 | lr 1.790e-03 | ms/batch 407.3 | tok/s  120680 | loss  3.17 | ppl     23.76
| epoch  16 step    32540 | batches   1025 / 2101 | lr 1.788e-03 | ms/batch 397.7 | tok/s  123580 | loss  3.20 | ppl     24.59
| epoch  16 step    32550 | batches   1035 / 2101 | lr 1.786e-03 | ms/batch 397.8 | tok/s  123561 | loss  3.18 | ppl     24.04
| epoch  16 step    32560 | batches   1045 / 2101 | lr 1.784e-03 | ms/batch 397.8 | tok/s  123556 | loss  3.17 | ppl     23.80
| epoch  16 step    32570 | batches   1055 / 2101 | lr 1.782e-03 | ms/batch 397.0 | tok/s  123816 | loss  3.18 | ppl     24.04
| epoch  16 step    32580 | batches   1065 / 2101 | lr 1.780e-03 | ms/batch 396.8 | tok/s  123868 | loss  3.16 | ppl     23.49
| epoch  16 step    32590 | batches   1075 / 2101 | lr 1.778e-03 | ms/batch 396.9 | tok/s  123845 | loss  3.15 | ppl     23.39
| epoch  16 step    32600 | batches   1085 / 2101 | lr 1.776e-03 | ms/batch 396.7 | tok/s  123900 | loss  3.15 | ppl     23.42
| epoch  16 step    32610 | batches   1095 / 2101 | lr 1.774e-03 | ms/batch 406.4 | tok/s  120943 | loss  3.13 | ppl     22.97
| epoch  16 step    32620 | batches   1105 / 2101 | lr 1.772e-03 | ms/batch 397.3 | tok/s  123729 | loss  3.14 | ppl     23.07
| epoch  16 step    32630 | batches   1115 / 2101 | lr 1.770e-03 | ms/batch 396.3 | tok/s  124033 | loss  3.17 | ppl     23.89
| epoch  16 step    32640 | batches   1125 / 2101 | lr 1.768e-03 | ms/batch 397.0 | tok/s  123809 | loss  3.16 | ppl     23.51
| epoch  16 step    32650 | batches   1135 / 2101 | lr 1.766e-03 | ms/batch 396.9 | tok/s  123851 | loss  3.19 | ppl     24.29
| epoch  16 step    32660 | batches   1145 / 2101 | lr 1.764e-03 | ms/batch 396.7 | tok/s  123890 | loss  3.20 | ppl     24.50
| epoch  16 step    32670 | batches   1155 / 2101 | lr 1.762e-03 | ms/batch 397.0 | tok/s  123801 | loss  3.17 | ppl     23.71
| epoch  16 step    32680 | batches   1165 / 2101 | lr 1.760e-03 | ms/batch 397.2 | tok/s  123757 | loss  3.17 | ppl     23.84
| epoch  16 step    32690 | batches   1175 / 2101 | lr 1.758e-03 | ms/batch 397.3 | tok/s  123712 | loss  3.19 | ppl     24.22
| epoch  16 step    32700 | batches   1185 / 2101 | lr 1.756e-03 | ms/batch 397.9 | tok/s  123543 | loss  3.19 | ppl     24.34
| epoch  16 step    32710 | batches   1195 / 2101 | lr 1.754e-03 | ms/batch 397.3 | tok/s  123702 | loss  3.15 | ppl     23.44
| epoch  16 step    32720 | batches   1205 / 2101 | lr 1.752e-03 | ms/batch 398.3 | tok/s  123410 | loss  3.15 | ppl     23.37
| epoch  16 step    32730 | batches   1215 / 2101 | lr 1.750e-03 | ms/batch 398.5 | tok/s  123357 | loss  3.13 | ppl     22.90
| epoch  16 step    32740 | batches   1225 / 2101 | lr 1.748e-03 | ms/batch 397.0 | tok/s  123812 | loss  3.16 | ppl     23.66
| epoch  16 step    32750 | batches   1235 / 2101 | lr 1.746e-03 | ms/batch 397.9 | tok/s  123514 | loss  3.20 | ppl     24.42
| epoch  16 step    32760 | batches   1245 / 2101 | lr 1.744e-03 | ms/batch 397.5 | tok/s  123642 | loss  3.21 | ppl     24.67
| epoch  16 step    32770 | batches   1255 / 2101 | lr 1.742e-03 | ms/batch 397.8 | tok/s  123575 | loss  3.21 | ppl     24.68
| epoch  16 step    32780 | batches   1265 / 2101 | lr 1.740e-03 | ms/batch 397.1 | tok/s  123769 | loss  3.20 | ppl     24.53
| epoch  16 step    32790 | batches   1275 / 2101 | lr 1.738e-03 | ms/batch 397.3 | tok/s  123714 | loss  3.15 | ppl     23.40
| epoch  16 step    32800 | batches   1285 / 2101 | lr 1.736e-03 | ms/batch 397.6 | tok/s  123622 | loss  3.14 | ppl     23.04
| epoch  16 step    32810 | batches   1295 / 2101 | lr 1.734e-03 | ms/batch 397.8 | tok/s  123545 | loss  3.16 | ppl     23.62
| epoch  16 step    32820 | batches   1305 / 2101 | lr 1.732e-03 | ms/batch 397.2 | tok/s  123733 | loss  3.20 | ppl     24.51
| epoch  16 step    32830 | batches   1315 / 2101 | lr 1.730e-03 | ms/batch 397.7 | tok/s  123601 | loss  3.19 | ppl     24.41
| epoch  16 step    32840 | batches   1325 / 2101 | lr 1.728e-03 | ms/batch 397.6 | tok/s  123630 | loss  3.20 | ppl     24.46
| epoch  16 step    32850 | batches   1335 / 2101 | lr 1.726e-03 | ms/batch 397.7 | tok/s  123583 | loss  3.20 | ppl     24.64
| epoch  16 step    32860 | batches   1345 / 2101 | lr 1.724e-03 | ms/batch 397.5 | tok/s  123650 | loss  3.16 | ppl     23.65
| epoch  16 step    32870 | batches   1355 / 2101 | lr 1.722e-03 | ms/batch 396.6 | tok/s  123940 | loss  3.21 | ppl     24.86
| epoch  16 step    32880 | batches   1365 / 2101 | lr 1.720e-03 | ms/batch 397.0 | tok/s  123796 | loss  3.19 | ppl     24.39
| epoch  16 step    32890 | batches   1375 / 2101 | lr 1.718e-03 | ms/batch 397.9 | tok/s  123522 | loss  3.18 | ppl     24.06
| epoch  16 step    32900 | batches   1385 / 2101 | lr 1.716e-03 | ms/batch 397.7 | tok/s  123577 | loss  3.17 | ppl     23.82
| epoch  16 step    32910 | batches   1395 / 2101 | lr 1.714e-03 | ms/batch 397.6 | tok/s  123629 | loss  3.16 | ppl     23.48
| epoch  16 step    32920 | batches   1405 / 2101 | lr 1.712e-03 | ms/batch 397.7 | tok/s  123604 | loss  3.17 | ppl     23.73
| epoch  16 step    32930 | batches   1415 / 2101 | lr 1.710e-03 | ms/batch 397.5 | tok/s  123652 | loss  3.17 | ppl     23.88
| epoch  16 step    32940 | batches   1425 / 2101 | lr 1.708e-03 | ms/batch 397.2 | tok/s  123751 | loss  3.15 | ppl     23.38
| epoch  16 step    32950 | batches   1435 / 2101 | lr 1.706e-03 | ms/batch 397.3 | tok/s  123715 | loss  3.19 | ppl     24.37
| epoch  16 step    32960 | batches   1445 / 2101 | lr 1.704e-03 | ms/batch 397.0 | tok/s  123801 | loss  3.20 | ppl     24.52
| epoch  16 step    32970 | batches   1455 / 2101 | lr 1.702e-03 | ms/batch 397.8 | tok/s  123567 | loss  3.21 | ppl     24.71
| epoch  16 step    32980 | batches   1465 / 2101 | lr 1.701e-03 | ms/batch 397.9 | tok/s  123526 | loss  3.19 | ppl     24.22
| epoch  16 step    32990 | batches   1475 / 2101 | lr 1.699e-03 | ms/batch 398.3 | tok/s  123400 | loss  3.16 | ppl     23.46
| epoch  16 step    33000 | batches   1485 / 2101 | lr 1.697e-03 | ms/batch 411.2 | tok/s  119528 | loss  3.17 | ppl     23.88
----------------------------------------------------------------------------------------------------
| Eval  66 at step    33000 | time:  0.81s | valid loss  3.16 | valid ppl    23.646
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.03582317449486019, 0.03502617238675759, 0.0344436106701884, 0.033233110817525446, 0.03302491550510257, 0.036714680351941226, 0.033996067527096024, 0.0472996824085066, 0.03223675301076168, 0.03090617682133771, 0.03959859261794695, 0.036712490103807685, 0.03144088247507056, 0.037324402438877295, 0.03503486735868977, 0.03703904795996618, 0.03590734321646631, 0.035072237880156024, 0.03669183183356487, 0.034248864355856654, 0.03910104481308464, 0.03668682140692623, 0.03868700635356965, 0.037483971396627264, 0.0356650189478851, 0.037931752222575346, 0.03750151185030724, 0.037801644919995096, 0.037174117621600666, 0.03585572512724889, 0.039016991800232756, 0.03553905432449802, 0.03729740889301675, 0.03320486344395493, 0.03561762103960459, 0.03881010920372274, 0.03672787797270148, 0.03239716042966083, 0.034365115334568104, 0.03587095869995163, 0.036675471364514094, 0.03992531143203616, 0.041328333964882766, 0.0337461750473608, 0.035053811640957847, 0.04251295863771346, 0.03660641854295001, 0.035446502902015745, 0.03606934627650422, 0.03518330247804433, 0.038716746755793764, 0.03684469664549272, 0.04536857848478509, 0.031162024747345026, 0.03352337401500402, 0.03994028006284206, 0.036704699457755716, 0.029032062651339934, 0.033166372846474536, 0.03424926057766121, 0.026965297683977676, 0.026813767606075744, 0.005493486536379439, 0.02814113184862662, 0.03251422576914648, 0.03402106093841629, 0.03375414325607469, 0.02458660347612493, 0.03038948717981028, 0.03283853715184522, 0.035057668194987124, 0.033906658718042264, 0.03737637654803262, 0.02627773173470488, 0.0312059341545646, 0.035721906865353786, 0.03310800528395634, 0.03906029009368732, 0.02751084353913342, 0.032770930213323536, 0.03215145484425686]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [47, 70, 9, 13, 9, 52, 89, 9, 17, 9], [39, 31, 18, 8, 8, 50, 61, 14, 8, 8], [33, 40, 8, 8, 8, 38, 43, 9, 8, 8], [29, 44, 8, 8, 8, 19, 10, 11, 8, 8], [11, 16, 8, 8, 8, 19, 21, 8, 8, 8], [10, 13, 8, 8, 8, 8, 10, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [8, 11, 8, 8, 8, 8, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [47, 70, 9, 13, 9, 52, 89, 9, 17, 9], [39, 31, 18, 8, 8, 50, 61, 14, 8, 8], [33, 40, 8, 8, 8, 38, 43, 9, 8, 8], [29, 44, 8, 8, 8, 19, 10, 11, 8, 8], [11, 16, 8, 8, 8, 19, 21, 8, 8, 8], [10, 13, 8, 8, 8, 8, 10, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [8, 11, 8, 8, 8, 8, 8, 8, 8, 8], [8]]
| epoch  16 step    33010 | batches   1495 / 2101 | lr 1.695e-03 | ms/batch 4902.1 | tok/s   10027 | loss  3.18 | ppl     24.13
| epoch  16 step    33020 | batches   1505 / 2101 | lr 1.693e-03 | ms/batch 408.7 | tok/s  120254 | loss  3.18 | ppl     24.01
| epoch  16 step    33030 | batches   1515 / 2101 | lr 1.691e-03 | ms/batch 405.6 | tok/s  121178 | loss  3.17 | ppl     23.84
| epoch  16 step    33040 | batches   1525 / 2101 | lr 1.689e-03 | ms/batch 395.2 | tok/s  124364 | loss  3.18 | ppl     24.02
| epoch  16 step    33050 | batches   1535 / 2101 | lr 1.687e-03 | ms/batch 408.0 | tok/s  120482 | loss  3.15 | ppl     23.38
| epoch  16 step    33060 | batches   1545 / 2101 | lr 1.685e-03 | ms/batch 407.3 | tok/s  120674 | loss  3.18 | ppl     24.03
| epoch  16 step    33070 | batches   1555 / 2101 | lr 1.683e-03 | ms/batch 406.3 | tok/s  120990 | loss  3.17 | ppl     23.81
| epoch  16 step    33080 | batches   1565 / 2101 | lr 1.681e-03 | ms/batch 397.4 | tok/s  123678 | loss  3.19 | ppl     24.33
| epoch  16 step    33090 | batches   1575 / 2101 | lr 1.679e-03 | ms/batch 397.4 | tok/s  123697 | loss  3.21 | ppl     24.76
| epoch  16 step    33100 | batches   1585 / 2101 | lr 1.677e-03 | ms/batch 407.3 | tok/s  120677 | loss  3.20 | ppl     24.62
| epoch  16 step    33110 | batches   1595 / 2101 | lr 1.675e-03 | ms/batch 397.7 | tok/s  123577 | loss  3.20 | ppl     24.54
| epoch  16 step    33120 | batches   1605 / 2101 | lr 1.674e-03 | ms/batch 397.0 | tok/s  123797 | loss  3.17 | ppl     23.84
| epoch  16 step    33130 | batches   1615 / 2101 | lr 1.672e-03 | ms/batch 396.3 | tok/s  124030 | loss  3.16 | ppl     23.53
| epoch  16 step    33140 | batches   1625 / 2101 | lr 1.670e-03 | ms/batch 396.8 | tok/s  123882 | loss  3.18 | ppl     23.96
| epoch  16 step    33150 | batches   1635 / 2101 | lr 1.668e-03 | ms/batch 396.8 | tok/s  123858 | loss  3.17 | ppl     23.86
| epoch  16 step    33160 | batches   1645 / 2101 | lr 1.666e-03 | ms/batch 396.9 | tok/s  123828 | loss  3.18 | ppl     24.09
| epoch  16 step    33170 | batches   1655 / 2101 | lr 1.664e-03 | ms/batch 397.4 | tok/s  123674 | loss  3.15 | ppl     23.36
| epoch  16 step    33180 | batches   1665 / 2101 | lr 1.662e-03 | ms/batch 397.0 | tok/s  123824 | loss  3.16 | ppl     23.56
| epoch  16 step    33190 | batches   1675 / 2101 | lr 1.660e-03 | ms/batch 397.0 | tok/s  123801 | loss  3.15 | ppl     23.41
| epoch  16 step    33200 | batches   1685 / 2101 | lr 1.658e-03 | ms/batch 397.5 | tok/s  123663 | loss  3.16 | ppl     23.63
| epoch  16 step    33210 | batches   1695 / 2101 | lr 1.657e-03 | ms/batch 398.0 | tok/s  123507 | loss  3.18 | ppl     23.96
| epoch  16 step    33220 | batches   1705 / 2101 | lr 1.655e-03 | ms/batch 408.3 | tok/s  120392 | loss  3.21 | ppl     24.73
| epoch  16 step    33230 | batches   1715 / 2101 | lr 1.653e-03 | ms/batch 399.2 | tok/s  123130 | loss  3.20 | ppl     24.42
| epoch  16 step    33240 | batches   1725 / 2101 | lr 1.651e-03 | ms/batch 399.0 | tok/s  123193 | loss  3.20 | ppl     24.57
| epoch  16 step    33250 | batches   1735 / 2101 | lr 1.649e-03 | ms/batch 398.7 | tok/s  123286 | loss  3.22 | ppl     24.96
| epoch  16 step    33260 | batches   1745 / 2101 | lr 1.647e-03 | ms/batch 398.6 | tok/s  123326 | loss  3.15 | ppl     23.41
| epoch  16 step    33270 | batches   1755 / 2101 | lr 1.645e-03 | ms/batch 397.3 | tok/s  123723 | loss  3.15 | ppl     23.37
| epoch  16 step    33280 | batches   1765 / 2101 | lr 1.643e-03 | ms/batch 397.0 | tok/s  123815 | loss  3.18 | ppl     24.07
| epoch  16 step    33290 | batches   1775 / 2101 | lr 1.642e-03 | ms/batch 397.1 | tok/s  123794 | loss  3.17 | ppl     23.78
| epoch  16 step    33300 | batches   1785 / 2101 | lr 1.640e-03 | ms/batch 396.8 | tok/s  123885 | loss  3.16 | ppl     23.67
| epoch  16 step    33310 | batches   1795 / 2101 | lr 1.638e-03 | ms/batch 396.4 | tok/s  123983 | loss  3.14 | ppl     23.18
| epoch  16 step    33320 | batches   1805 / 2101 | lr 1.636e-03 | ms/batch 397.3 | tok/s  123712 | loss  3.16 | ppl     23.59
| epoch  16 step    33330 | batches   1815 / 2101 | lr 1.634e-03 | ms/batch 397.7 | tok/s  123595 | loss  3.21 | ppl     24.85
| epoch  16 step    33340 | batches   1825 / 2101 | lr 1.632e-03 | ms/batch 397.8 | tok/s  123564 | loss  3.21 | ppl     24.80
| epoch  16 step    33350 | batches   1835 / 2101 | lr 1.630e-03 | ms/batch 398.1 | tok/s  123479 | loss  3.20 | ppl     24.56
| epoch  16 step    33360 | batches   1845 / 2101 | lr 1.629e-03 | ms/batch 397.2 | tok/s  123740 | loss  3.19 | ppl     24.29
| epoch  16 step    33370 | batches   1855 / 2101 | lr 1.627e-03 | ms/batch 398.3 | tok/s  123406 | loss  3.15 | ppl     23.25
| epoch  16 step    33380 | batches   1865 / 2101 | lr 1.625e-03 | ms/batch 398.2 | tok/s  123440 | loss  3.18 | ppl     24.11
| epoch  16 step    33390 | batches   1875 / 2101 | lr 1.623e-03 | ms/batch 399.1 | tok/s  123145 | loss  3.18 | ppl     24.07
| epoch  16 step    33400 | batches   1885 / 2101 | lr 1.621e-03 | ms/batch 397.9 | tok/s  123531 | loss  3.18 | ppl     24.02
| epoch  16 step    33410 | batches   1895 / 2101 | lr 1.619e-03 | ms/batch 398.0 | tok/s  123497 | loss  3.18 | ppl     24.07
| epoch  16 step    33420 | batches   1905 / 2101 | lr 1.617e-03 | ms/batch 397.5 | tok/s  123665 | loss  3.20 | ppl     24.59
| epoch  16 step    33430 | batches   1915 / 2101 | lr 1.616e-03 | ms/batch 408.9 | tok/s  120206 | loss  3.19 | ppl     24.34
| epoch  16 step    33440 | batches   1925 / 2101 | lr 1.614e-03 | ms/batch 398.1 | tok/s  123474 | loss  3.17 | ppl     23.72
| epoch  16 step    33450 | batches   1935 / 2101 | lr 1.612e-03 | ms/batch 397.9 | tok/s  123520 | loss  3.18 | ppl     24.12
| epoch  16 step    33460 | batches   1945 / 2101 | lr 1.610e-03 | ms/batch 397.8 | tok/s  123566 | loss  3.17 | ppl     23.77
| epoch  16 step    33470 | batches   1955 / 2101 | lr 1.608e-03 | ms/batch 397.9 | tok/s  123514 | loss  3.13 | ppl     22.90
| epoch  16 step    33480 | batches   1965 / 2101 | lr 1.607e-03 | ms/batch 397.5 | tok/s  123661 | loss  3.15 | ppl     23.36
| epoch  16 step    33490 | batches   1975 / 2101 | lr 1.605e-03 | ms/batch 397.8 | tok/s  123553 | loss  3.18 | ppl     23.93
| epoch  16 step    33500 | batches   1985 / 2101 | lr 1.603e-03 | ms/batch 410.2 | tok/s  119832 | loss  3.15 | ppl     23.23
----------------------------------------------------------------------------------------------------
| Eval  67 at step    33500 | time:  0.81s | valid loss  3.16 | valid ppl    23.597
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  16 step    33510 | batches   1995 / 2101 | lr 1.601e-03 | ms/batch 412.1 | tok/s  119291 | loss  3.21 | ppl     24.70
| epoch  16 step    33520 | batches   2005 / 2101 | lr 1.599e-03 | ms/batch 410.4 | tok/s  119769 | loss  3.20 | ppl     24.65
| epoch  16 step    33530 | batches   2015 / 2101 | lr 1.597e-03 | ms/batch 398.7 | tok/s  123294 | loss  3.20 | ppl     24.53
| epoch  16 step    33540 | batches   2025 / 2101 | lr 1.596e-03 | ms/batch 398.2 | tok/s  123448 | loss  3.21 | ppl     24.89
| epoch  16 step    33550 | batches   2035 / 2101 | lr 1.594e-03 | ms/batch 407.5 | tok/s  120610 | loss  3.23 | ppl     25.21
| epoch  16 step    33560 | batches   2045 / 2101 | lr 1.592e-03 | ms/batch 397.4 | tok/s  123673 | loss  3.22 | ppl     24.99
| epoch  16 step    33570 | batches   2055 / 2101 | lr 1.590e-03 | ms/batch 408.3 | tok/s  120379 | loss  3.20 | ppl     24.46
| epoch  16 step    33580 | batches   2065 / 2101 | lr 1.588e-03 | ms/batch 397.5 | tok/s  123658 | loss  3.17 | ppl     23.75
| epoch  16 step    33590 | batches   2075 / 2101 | lr 1.587e-03 | ms/batch 408.2 | tok/s  120416 | loss  3.20 | ppl     24.45
| epoch  16 step    33600 | batches   2085 / 2101 | lr 1.585e-03 | ms/batch 397.9 | tok/s  123540 | loss  3.17 | ppl     23.87
| epoch  16 step    33610 | batches   2095 / 2101 | lr 1.583e-03 | ms/batch 397.2 | tok/s  123750 | loss  3.17 | ppl     23.90
| epoch  17 step    33620 | batches      4 / 2101 | lr 1.581e-03 | ms/batch 400.0 | tok/s  123367 | loss  3.31 | ppl     27.35
| epoch  17 step    33630 | batches     14 / 2101 | lr 1.580e-03 | ms/batch 397.2 | tok/s  123737 | loss  3.18 | ppl     24.01
| epoch  17 step    33640 | batches     24 / 2101 | lr 1.578e-03 | ms/batch 398.2 | tok/s  123432 | loss  3.17 | ppl     23.81
| epoch  17 step    33650 | batches     34 / 2101 | lr 1.576e-03 | ms/batch 398.2 | tok/s  123432 | loss  3.16 | ppl     23.50
| epoch  17 step    33660 | batches     44 / 2101 | lr 1.574e-03 | ms/batch 408.7 | tok/s  120254 | loss  3.14 | ppl     23.09
| epoch  17 step    33670 | batches     54 / 2101 | lr 1.572e-03 | ms/batch 408.4 | tok/s  120339 | loss  3.13 | ppl     22.95
| epoch  17 step    33680 | batches     64 / 2101 | lr 1.571e-03 | ms/batch 397.2 | tok/s  123749 | loss  3.14 | ppl     23.11
| epoch  17 step    33690 | batches     74 / 2101 | lr 1.569e-03 | ms/batch 408.4 | tok/s  120354 | loss  3.16 | ppl     23.59
| epoch  17 step    33700 | batches     84 / 2101 | lr 1.567e-03 | ms/batch 397.8 | tok/s  123569 | loss  3.16 | ppl     23.69
| epoch  17 step    33710 | batches     94 / 2101 | lr 1.565e-03 | ms/batch 397.7 | tok/s  123599 | loss  3.11 | ppl     22.52
| epoch  17 step    33720 | batches    104 / 2101 | lr 1.564e-03 | ms/batch 397.7 | tok/s  123581 | loss  3.12 | ppl     22.58
| epoch  17 step    33730 | batches    114 / 2101 | lr 1.562e-03 | ms/batch 397.9 | tok/s  123539 | loss  3.15 | ppl     23.30
| epoch  17 step    33740 | batches    124 / 2101 | lr 1.560e-03 | ms/batch 397.2 | tok/s  123742 | loss  3.16 | ppl     23.48
| epoch  17 step    33750 | batches    134 / 2101 | lr 1.558e-03 | ms/batch 397.9 | tok/s  123543 | loss  3.19 | ppl     24.39
| epoch  17 step    33760 | batches    144 / 2101 | lr 1.557e-03 | ms/batch 408.9 | tok/s  120192 | loss  3.20 | ppl     24.54
| epoch  17 step    33770 | batches    154 / 2101 | lr 1.555e-03 | ms/batch 398.4 | tok/s  123368 | loss  3.19 | ppl     24.37
| epoch  17 step    33780 | batches    164 / 2101 | lr 1.553e-03 | ms/batch 398.3 | tok/s  123400 | loss  3.16 | ppl     23.60
| epoch  17 step    33790 | batches    174 / 2101 | lr 1.551e-03 | ms/batch 398.4 | tok/s  123389 | loss  3.17 | ppl     23.72
| epoch  17 step    33800 | batches    184 / 2101 | lr 1.550e-03 | ms/batch 398.0 | tok/s  123491 | loss  3.17 | ppl     23.86
| epoch  17 step    33810 | batches    194 / 2101 | lr 1.548e-03 | ms/batch 398.0 | tok/s  123508 | loss  3.17 | ppl     23.74
| epoch  17 step    33820 | batches    204 / 2101 | lr 1.546e-03 | ms/batch 397.8 | tok/s  123546 | loss  3.17 | ppl     23.82
| epoch  17 step    33830 | batches    214 / 2101 | lr 1.544e-03 | ms/batch 397.9 | tok/s  123524 | loss  3.15 | ppl     23.36
| epoch  17 step    33840 | batches    224 / 2101 | lr 1.543e-03 | ms/batch 397.5 | tok/s  123655 | loss  3.13 | ppl     22.94
| epoch  17 step    33850 | batches    234 / 2101 | lr 1.541e-03 | ms/batch 398.3 | tok/s  123403 | loss  3.15 | ppl     23.33
| epoch  17 step    33860 | batches    244 / 2101 | lr 1.539e-03 | ms/batch 398.5 | tok/s  123341 | loss  3.15 | ppl     23.32
| epoch  17 step    33870 | batches    254 / 2101 | lr 1.538e-03 | ms/batch 397.7 | tok/s  123584 | loss  3.13 | ppl     22.89
| epoch  17 step    33880 | batches    264 / 2101 | lr 1.536e-03 | ms/batch 398.1 | tok/s  123466 | loss  3.13 | ppl     22.98
| epoch  17 step    33890 | batches    274 / 2101 | lr 1.534e-03 | ms/batch 397.9 | tok/s  123517 | loss  3.17 | ppl     23.70
| epoch  17 step    33900 | batches    284 / 2101 | lr 1.532e-03 | ms/batch 407.9 | tok/s  120493 | loss  3.19 | ppl     24.19
| epoch  17 step    33910 | batches    294 / 2101 | lr 1.531e-03 | ms/batch 398.4 | tok/s  123360 | loss  3.16 | ppl     23.51
| epoch  17 step    33920 | batches    304 / 2101 | lr 1.529e-03 | ms/batch 408.9 | tok/s  120201 | loss  3.15 | ppl     23.27
| epoch  17 step    33930 | batches    314 / 2101 | lr 1.527e-03 | ms/batch 399.1 | tok/s  123160 | loss  3.15 | ppl     23.31
| epoch  17 step    33940 | batches    324 / 2101 | lr 1.526e-03 | ms/batch 408.5 | tok/s  120331 | loss  3.17 | ppl     23.78
| epoch  17 step    33950 | batches    334 / 2101 | lr 1.524e-03 | ms/batch 399.1 | tok/s  123145 | loss  3.15 | ppl     23.40
| epoch  17 step    33960 | batches    344 / 2101 | lr 1.522e-03 | ms/batch 398.0 | tok/s  123500 | loss  3.14 | ppl     23.10
| epoch  17 step    33970 | batches    354 / 2101 | lr 1.521e-03 | ms/batch 408.8 | tok/s  120248 | loss  3.15 | ppl     23.26
| epoch  17 step    33980 | batches    364 / 2101 | lr 1.519e-03 | ms/batch 399.1 | tok/s  123163 | loss  3.14 | ppl     23.02
| epoch  17 step    33990 | batches    374 / 2101 | lr 1.517e-03 | ms/batch 398.2 | tok/s  123446 | loss  3.17 | ppl     23.79
| epoch  17 step    34000 | batches    384 / 2101 | lr 1.515e-03 | ms/batch 411.3 | tok/s  119513 | loss  3.18 | ppl     24.11
----------------------------------------------------------------------------------------------------
| Eval  68 at step    34000 | time:  0.82s | valid loss  3.16 | valid ppl    23.534
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.03467097358043231, 0.034747729202871495, 0.03781079987033034, 0.032852019517, 0.03162196825099281, 0.03410493490816729, 0.03371144055882217, 0.04190077960688049, 0.0352044583685772, 0.030020408185863982, 0.034709859653256056, 0.036231915287388436, 0.031752496031479775, 0.03637808233365971, 0.03362646901387395, 0.035051843118429064, 0.03527559511702903, 0.03520004213949855, 0.035570110832846294, 0.03310580532095533, 0.03638281316768881, 0.036735052740862785, 0.03749087833969547, 0.035850323936247604, 0.03344201542731766, 0.03740509284111025, 0.03678164067862737, 0.04078246066541365, 0.0346994066829845, 0.03371311335166824, 0.03536041763660193, 0.03442663621038569, 0.032841959654381934, 0.03132490062249235, 0.03297198502542587, 0.036109812125270604, 0.03612568739735983, 0.02950136231750257, 0.03110793182455317, 0.03330009685851288, 0.04235293150388437, 0.03688786563034727, 0.05011831359446483, 0.03398823557090865, 0.0319269640404328, 0.036300763723704485, 0.0359085089983333, 0.0284556842133092, 0.03196443691786621, 0.03245908776793233, 0.03651772388174138, 0.034489720803273005, 0.04796568887606512, 0.030483123709731663, 0.03259352179879359, 0.0365018767621102, 0.03573887921085421, 0.03696700141158274, 0.031446907254758565, 0.03286637898986713, 0.031418540642670155, 0.02586773845314683, 0.00848861685043208, 0.027636182423597198, 0.03157506541098284, 0.035700340415566426, 0.03268596982959612, 0.024534962700971646, 0.029831277657458254, 0.031847530359839386, 0.03536181762784518, 0.03343411499236378, 0.04682598578798903, 0.02585868256211414, 0.030412188404834582, 0.034426353766981305, 0.032130873155708464, 0.03815513322803461, 0.026757585492464302, 0.03084665087694315, 0.02969503672570233]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [53, 64, 9, 11, 10, 58, 77, 9, 17, 10], [38, 33, 15, 9, 8, 43, 61, 12, 8, 8], [27, 43, 8, 8, 8, 40, 42, 9, 9, 8], [25, 43, 9, 8, 8, 19, 19, 9, 8, 8], [10, 15, 8, 8, 8, 17, 21, 8, 8, 8], [8, 16, 8, 8, 8, 8, 13, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [8, 11, 8, 8, 8, 9, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [53, 64, 9, 11, 10, 58, 77, 9, 17, 10], [38, 33, 15, 9, 8, 43, 61, 12, 8, 8], [27, 43, 8, 8, 8, 40, 42, 9, 9, 8], [25, 43, 9, 8, 8, 19, 19, 9, 8, 8], [10, 15, 8, 8, 8, 17, 21, 8, 8, 8], [8, 16, 8, 8, 8, 8, 13, 8, 8, 8], [8, 8, 8, 8, 8, 8, 8, 8, 8, 8], [8, 11, 8, 8, 8, 9, 8, 8, 8, 8], [8]]
| epoch  17 step    34010 | batches    394 / 2101 | lr 1.514e-03 | ms/batch 4870.4 | tok/s   10092 | loss  3.13 | ppl     22.81
| epoch  17 step    34020 | batches    404 / 2101 | lr 1.512e-03 | ms/batch 410.1 | tok/s  119868 | loss  3.15 | ppl     23.41
| epoch  17 step    34030 | batches    414 / 2101 | lr 1.510e-03 | ms/batch 396.3 | tok/s  124038 | loss  3.15 | ppl     23.27
| epoch  17 step    34040 | batches    424 / 2101 | lr 1.509e-03 | ms/batch 395.5 | tok/s  124276 | loss  3.13 | ppl     22.92
| epoch  17 step    34050 | batches    434 / 2101 | lr 1.507e-03 | ms/batch 395.7 | tok/s  124220 | loss  3.19 | ppl     24.17
| epoch  17 step    34060 | batches    444 / 2101 | lr 1.505e-03 | ms/batch 395.7 | tok/s  124223 | loss  3.18 | ppl     24.12
| epoch  17 step    34070 | batches    454 / 2101 | lr 1.504e-03 | ms/batch 396.9 | tok/s  123837 | loss  3.18 | ppl     24.13
| epoch  17 step    34080 | batches    464 / 2101 | lr 1.502e-03 | ms/batch 397.3 | tok/s  123709 | loss  3.20 | ppl     24.63
| epoch  17 step    34090 | batches    474 / 2101 | lr 1.500e-03 | ms/batch 397.7 | tok/s  123580 | loss  3.13 | ppl     22.78
| epoch  17 step    34100 | batches    484 / 2101 | lr 1.499e-03 | ms/batch 397.3 | tok/s  123709 | loss  3.12 | ppl     22.74
| epoch  17 step    34110 | batches    494 / 2101 | lr 1.497e-03 | ms/batch 407.5 | tok/s  120615 | loss  3.12 | ppl     22.70
| epoch  17 step    34120 | batches    504 / 2101 | lr 1.495e-03 | ms/batch 397.1 | tok/s  123770 | loss  3.11 | ppl     22.46
| epoch  17 step    34130 | batches    514 / 2101 | lr 1.494e-03 | ms/batch 396.8 | tok/s  123860 | loss  3.12 | ppl     22.70
| epoch  17 step    34140 | batches    524 / 2101 | lr 1.492e-03 | ms/batch 397.4 | tok/s  123696 | loss  3.13 | ppl     22.83
| epoch  17 step    34150 | batches    534 / 2101 | lr 1.490e-03 | ms/batch 398.1 | tok/s  123454 | loss  3.16 | ppl     23.65
| epoch  17 step    34160 | batches    544 / 2101 | lr 1.489e-03 | ms/batch 397.7 | tok/s  123607 | loss  3.13 | ppl     22.82
| epoch  17 step    34170 | batches    554 / 2101 | lr 1.487e-03 | ms/batch 397.9 | tok/s  123533 | loss  3.12 | ppl     22.69
| epoch  17 step    34180 | batches    564 / 2101 | lr 1.486e-03 | ms/batch 397.9 | tok/s  123522 | loss  3.11 | ppl     22.45
| epoch  17 step    34190 | batches    574 / 2101 | lr 1.484e-03 | ms/batch 397.2 | tok/s  123732 | loss  3.11 | ppl     22.45
| epoch  17 step    34200 | batches    584 / 2101 | lr 1.482e-03 | ms/batch 398.0 | tok/s  123511 | loss  3.14 | ppl     23.14
| epoch  17 step    34210 | batches    594 / 2101 | lr 1.481e-03 | ms/batch 397.6 | tok/s  123609 | loss  3.20 | ppl     24.62
| epoch  17 step    34220 | batches    604 / 2101 | lr 1.479e-03 | ms/batch 398.0 | tok/s  123495 | loss  3.15 | ppl     23.26
| epoch  17 step    34230 | batches    614 / 2101 | lr 1.477e-03 | ms/batch 397.9 | tok/s  123528 | loss  3.14 | ppl     23.12
| epoch  17 step    34240 | batches    624 / 2101 | lr 1.476e-03 | ms/batch 398.4 | tok/s  123360 | loss  3.15 | ppl     23.34
| epoch  17 step    34250 | batches    634 / 2101 | lr 1.474e-03 | ms/batch 398.4 | tok/s  123370 | loss  3.16 | ppl     23.55
| epoch  17 step    34260 | batches    644 / 2101 | lr 1.473e-03 | ms/batch 398.3 | tok/s  123407 | loss  3.21 | ppl     24.86
| epoch  17 step    34270 | batches    654 / 2101 | lr 1.471e-03 | ms/batch 397.7 | tok/s  123576 | loss  3.21 | ppl     24.68
| epoch  17 step    34280 | batches    664 / 2101 | lr 1.469e-03 | ms/batch 397.9 | tok/s  123538 | loss  3.17 | ppl     23.82
| epoch  17 step    34290 | batches    674 / 2101 | lr 1.468e-03 | ms/batch 398.4 | tok/s  123361 | loss  3.16 | ppl     23.68
| epoch  17 step    34300 | batches    684 / 2101 | lr 1.466e-03 | ms/batch 397.8 | tok/s  123564 | loss  3.17 | ppl     23.83
| epoch  17 step    34310 | batches    694 / 2101 | lr 1.464e-03 | ms/batch 398.1 | tok/s  123457 | loss  3.17 | ppl     23.89
| epoch  17 step    34320 | batches    704 / 2101 | lr 1.463e-03 | ms/batch 397.9 | tok/s  123521 | loss  3.17 | ppl     23.87
| epoch  17 step    34330 | batches    714 / 2101 | lr 1.461e-03 | ms/batch 397.5 | tok/s  123643 | loss  3.16 | ppl     23.61
| epoch  17 step    34340 | batches    724 / 2101 | lr 1.460e-03 | ms/batch 398.3 | tok/s  123421 | loss  3.19 | ppl     24.27
| epoch  17 step    34350 | batches    734 / 2101 | lr 1.458e-03 | ms/batch 398.8 | tok/s  123241 | loss  3.19 | ppl     24.17
| epoch  17 step    34360 | batches    744 / 2101 | lr 1.456e-03 | ms/batch 398.7 | tok/s  123279 | loss  3.18 | ppl     23.99
| epoch  17 step    34370 | batches    754 / 2101 | lr 1.455e-03 | ms/batch 398.2 | tok/s  123435 | loss  3.18 | ppl     23.94
| epoch  17 step    34380 | batches    764 / 2101 | lr 1.453e-03 | ms/batch 397.5 | tok/s  123660 | loss  3.22 | ppl     24.96
| epoch  17 step    34390 | batches    774 / 2101 | lr 1.452e-03 | ms/batch 397.4 | tok/s  123681 | loss  3.18 | ppl     23.94
| epoch  17 step    34400 | batches    784 / 2101 | lr 1.450e-03 | ms/batch 398.2 | tok/s  123450 | loss  3.17 | ppl     23.90
| epoch  17 step    34410 | batches    794 / 2101 | lr 1.449e-03 | ms/batch 398.3 | tok/s  123411 | loss  3.19 | ppl     24.36
| epoch  17 step    34420 | batches    804 / 2101 | lr 1.447e-03 | ms/batch 398.1 | tok/s  123470 | loss  3.15 | ppl     23.42
| epoch  17 step    34430 | batches    814 / 2101 | lr 1.445e-03 | ms/batch 400.6 | tok/s  122706 | loss  3.15 | ppl     23.32
| epoch  17 step    34440 | batches    824 / 2101 | lr 1.444e-03 | ms/batch 398.2 | tok/s  123441 | loss  3.18 | ppl     24.01
| epoch  17 step    34450 | batches    834 / 2101 | lr 1.442e-03 | ms/batch 398.5 | tok/s  123356 | loss  3.16 | ppl     23.49
| epoch  17 step    34460 | batches    844 / 2101 | lr 1.441e-03 | ms/batch 398.0 | tok/s  123485 | loss  3.11 | ppl     22.32
| epoch  17 step    34470 | batches    854 / 2101 | lr 1.439e-03 | ms/batch 397.8 | tok/s  123548 | loss  3.13 | ppl     22.95
| epoch  17 step    34480 | batches    864 / 2101 | lr 1.438e-03 | ms/batch 397.9 | tok/s  123517 | loss  3.17 | ppl     23.76
| epoch  17 step    34490 | batches    874 / 2101 | lr 1.436e-03 | ms/batch 398.2 | tok/s  123433 | loss  3.15 | ppl     23.40
| epoch  17 step    34500 | batches    884 / 2101 | lr 1.434e-03 | ms/batch 398.5 | tok/s  123358 | loss  3.13 | ppl     22.89
----------------------------------------------------------------------------------------------------
| Eval  69 at step    34500 | time:  0.81s | valid loss  3.16 | valid ppl    23.532
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  17 step    34510 | batches    894 / 2101 | lr 1.433e-03 | ms/batch 402.2 | tok/s  122225 | loss  3.17 | ppl     23.81
| epoch  17 step    34520 | batches    904 / 2101 | lr 1.431e-03 | ms/batch 420.2 | tok/s  116974 | loss  3.18 | ppl     23.96
| epoch  17 step    34530 | batches    914 / 2101 | lr 1.430e-03 | ms/batch 397.9 | tok/s  123533 | loss  3.18 | ppl     24.16
| epoch  17 step    34540 | batches    924 / 2101 | lr 1.428e-03 | ms/batch 397.6 | tok/s  123623 | loss  3.16 | ppl     23.63
| epoch  17 step    34550 | batches    934 / 2101 | lr 1.427e-03 | ms/batch 397.7 | tok/s  123579 | loss  3.15 | ppl     23.41
| epoch  17 step    34560 | batches    944 / 2101 | lr 1.425e-03 | ms/batch 397.5 | tok/s  123665 | loss  3.17 | ppl     23.72
| epoch  17 step    34570 | batches    954 / 2101 | lr 1.424e-03 | ms/batch 397.1 | tok/s  123782 | loss  3.18 | ppl     24.11
| epoch  17 step    34580 | batches    964 / 2101 | lr 1.422e-03 | ms/batch 398.1 | tok/s  123473 | loss  3.19 | ppl     24.37
| epoch  17 step    34590 | batches    974 / 2101 | lr 1.421e-03 | ms/batch 397.5 | tok/s  123648 | loss  3.18 | ppl     23.96
| epoch  17 step    34600 | batches    984 / 2101 | lr 1.419e-03 | ms/batch 398.2 | tok/s  123450 | loss  3.17 | ppl     23.70
| epoch  17 step    34610 | batches    994 / 2101 | lr 1.418e-03 | ms/batch 396.8 | tok/s  123885 | loss  3.14 | ppl     23.01
| epoch  17 step    34620 | batches   1004 / 2101 | lr 1.416e-03 | ms/batch 408.8 | tok/s  120239 | loss  3.13 | ppl     22.93
| epoch  17 step    34630 | batches   1014 / 2101 | lr 1.414e-03 | ms/batch 398.5 | tok/s  123350 | loss  3.16 | ppl     23.55
| epoch  17 step    34640 | batches   1024 / 2101 | lr 1.413e-03 | ms/batch 407.8 | tok/s  120535 | loss  3.15 | ppl     23.45
| epoch  17 step    34650 | batches   1034 / 2101 | lr 1.411e-03 | ms/batch 408.5 | tok/s  120318 | loss  3.18 | ppl     23.98
| epoch  17 step    34660 | batches   1044 / 2101 | lr 1.410e-03 | ms/batch 408.5 | tok/s  120310 | loss  3.18 | ppl     24.07
| epoch  17 step    34670 | batches   1054 / 2101 | lr 1.408e-03 | ms/batch 397.6 | tok/s  123609 | loss  3.15 | ppl     23.45
| epoch  17 step    34680 | batches   1064 / 2101 | lr 1.407e-03 | ms/batch 397.7 | tok/s  123581 | loss  3.17 | ppl     23.77
| epoch  17 step    34690 | batches   1074 / 2101 | lr 1.405e-03 | ms/batch 397.4 | tok/s  123690 | loss  3.15 | ppl     23.39
| epoch  17 step    34700 | batches   1084 / 2101 | lr 1.404e-03 | ms/batch 397.3 | tok/s  123730 | loss  3.15 | ppl     23.42
| epoch  17 step    34710 | batches   1094 / 2101 | lr 1.402e-03 | ms/batch 398.1 | tok/s  123480 | loss  3.16 | ppl     23.67
| epoch  17 step    34720 | batches   1104 / 2101 | lr 1.401e-03 | ms/batch 398.2 | tok/s  123426 | loss  3.18 | ppl     24.10
| epoch  17 step    34730 | batches   1114 / 2101 | lr 1.399e-03 | ms/batch 397.8 | tok/s  123572 | loss  3.14 | ppl     23.12
| epoch  17 step    34740 | batches   1124 / 2101 | lr 1.398e-03 | ms/batch 408.3 | tok/s  120374 | loss  3.16 | ppl     23.61
| epoch  17 step    34750 | batches   1134 / 2101 | lr 1.396e-03 | ms/batch 398.4 | tok/s  123362 | loss  3.19 | ppl     24.22
| epoch  17 step    34760 | batches   1144 / 2101 | lr 1.395e-03 | ms/batch 398.6 | tok/s  123327 | loss  3.14 | ppl     23.16
| epoch  17 step    34770 | batches   1154 / 2101 | lr 1.393e-03 | ms/batch 398.0 | tok/s  123484 | loss  3.16 | ppl     23.50
| epoch  17 step    34780 | batches   1164 / 2101 | lr 1.392e-03 | ms/batch 397.7 | tok/s  123578 | loss  3.13 | ppl     22.83
| epoch  17 step    34790 | batches   1174 / 2101 | lr 1.391e-03 | ms/batch 397.0 | tok/s  123819 | loss  3.10 | ppl     22.23
| epoch  17 step    34800 | batches   1184 / 2101 | lr 1.389e-03 | ms/batch 397.6 | tok/s  123629 | loss  3.09 | ppl     22.07
| epoch  17 step    34810 | batches   1194 / 2101 | lr 1.388e-03 | ms/batch 397.6 | tok/s  123629 | loss  3.12 | ppl     22.66
| epoch  17 step    34820 | batches   1204 / 2101 | lr 1.386e-03 | ms/batch 398.1 | tok/s  123470 | loss  3.11 | ppl     22.40
| epoch  17 step    34830 | batches   1214 / 2101 | lr 1.385e-03 | ms/batch 398.6 | tok/s  123312 | loss  3.18 | ppl     24.05
| epoch  17 step    34840 | batches   1224 / 2101 | lr 1.383e-03 | ms/batch 397.7 | tok/s  123576 | loss  3.20 | ppl     24.64
| epoch  17 step    34850 | batches   1234 / 2101 | lr 1.382e-03 | ms/batch 396.9 | tok/s  123829 | loss  3.13 | ppl     22.94
| epoch  17 step    34860 | batches   1244 / 2101 | lr 1.380e-03 | ms/batch 397.2 | tok/s  123753 | loss  3.14 | ppl     23.08
| epoch  17 step    34870 | batches   1254 / 2101 | lr 1.379e-03 | ms/batch 397.5 | tok/s  123661 | loss  3.15 | ppl     23.44
| epoch  17 step    34880 | batches   1264 / 2101 | lr 1.377e-03 | ms/batch 397.9 | tok/s  123538 | loss  3.17 | ppl     23.77
| epoch  17 step    34890 | batches   1274 / 2101 | lr 1.376e-03 | ms/batch 398.7 | tok/s  123293 | loss  3.18 | ppl     24.05
| epoch  17 step    34900 | batches   1284 / 2101 | lr 1.374e-03 | ms/batch 397.9 | tok/s  123528 | loss  3.16 | ppl     23.51
| epoch  17 step    34910 | batches   1294 / 2101 | lr 1.373e-03 | ms/batch 398.0 | tok/s  123498 | loss  3.21 | ppl     24.72
| epoch  17 step    34920 | batches   1304 / 2101 | lr 1.372e-03 | ms/batch 397.8 | tok/s  123563 | loss  3.17 | ppl     23.91
| epoch  17 step    34930 | batches   1314 / 2101 | lr 1.370e-03 | ms/batch 398.1 | tok/s  123461 | loss  3.18 | ppl     23.97
| epoch  17 step    34940 | batches   1324 / 2101 | lr 1.369e-03 | ms/batch 398.0 | tok/s  123504 | loss  3.17 | ppl     23.78
| epoch  17 step    34950 | batches   1334 / 2101 | lr 1.367e-03 | ms/batch 398.0 | tok/s  123506 | loss  3.16 | ppl     23.53
| epoch  17 step    34960 | batches   1344 / 2101 | lr 1.366e-03 | ms/batch 398.6 | tok/s  123326 | loss  3.17 | ppl     23.75
| epoch  17 step    34970 | batches   1354 / 2101 | lr 1.364e-03 | ms/batch 398.4 | tok/s  123386 | loss  3.16 | ppl     23.57
| epoch  17 step    34980 | batches   1364 / 2101 | lr 1.363e-03 | ms/batch 398.0 | tok/s  123511 | loss  3.13 | ppl     22.93
| epoch  17 step    34990 | batches   1374 / 2101 | lr 1.362e-03 | ms/batch 398.4 | tok/s  123363 | loss  3.16 | ppl     23.48
| epoch  17 step    35000 | batches   1384 / 2101 | lr 1.360e-03 | ms/batch 411.2 | tok/s  119531 | loss  3.13 | ppl     22.96
----------------------------------------------------------------------------------------------------
| Eval  70 at step    35000 | time:  0.81s | valid loss  3.16 | valid ppl    23.495
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.035792445165940386, 0.03320457393073021, 0.03805026947416123, 0.032868120900729755, 0.031721225767486635, 0.03480120374690706, 0.03192520010099786, 0.0401091370948289, 0.031268905507858255, 0.029650370349665486, 0.036351863565065354, 0.03542905303251742, 0.0350553867727237, 0.03596820736371792, 0.03382690735962421, 0.03569121847954514, 0.0341337964437088, 0.03806242533961341, 0.03545996599098732, 0.032603789465386876, 0.03984004499103276, 0.03541830228305134, 0.049412700714667177, 0.03561141739702035, 0.03410129413369927, 0.036574998206999394, 0.03647292536013176, 0.037645157647813454, 0.035510571059054315, 0.034343032496223086, 0.03805653864117335, 0.034344123029856045, 0.03908505759914083, 0.03396760343573157, 0.03511406487468737, 0.038465574901428434, 0.035661398798468386, 0.030502890307061225, 0.034979785883603766, 0.034796697668404625, 0.04010522470447283, 0.035953052074259535, 0.026948527470428137, 0.03665217186195422, 0.03348480008695198, 0.03988037037845564, 0.03610191245063554, 0.029432980307849625, 0.03335764287126755, 0.03463118029503671, 0.03792329136777729, 0.03377820454629121, 0.039891554128237236, 0.03266998026499738, 0.03341064450820982, 0.03741419649519992, 0.035322584223489537, 0.044510656399902856, 0.03449116439643394, 0.03316259876333984, 0.032181565608672476, 0.027211518250387395, 0.0034259901555903074, 0.027620898037876637, 0.031707903112790974, 0.03434248047300888, 0.034183941201483166, 0.02010019226694255, 0.030016976127600944, 0.03252968294148985, 0.03467200814104059, 0.031796240333522865, 0.053025520264313925, 0.025282365248646962, 0.029659564152650367, 0.032627252201116605, 0.03156262300195126, 0.037473191367069225, 0.026254396777585867, 0.030957657903340752, 0.030052074881823536]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [49, 72, 11, 12, 8, 61, 85, 8, 20, 9], [36, 32, 16, 8, 8, 45, 51, 12, 8, 8], [26, 35, 8, 8, 8, 40, 44, 9, 9, 9], [27, 49, 9, 8, 8, 18, 12, 9, 8, 8], [9, 14, 8, 8, 8, 17, 20, 8, 8, 8], [10, 16, 8, 8, 8, 9, 13, 8, 8, 8], [8, 9, 8, 8, 8, 8, 10, 8, 8, 8], [8, 8, 8, 8, 8, 9, 8, 8, 8, 8], [8]]
optimal compression parameters =  [[], [49, 72, 11, 12, 8, 61, 85, 8, 20, 9], [36, 32, 16, 8, 8, 45, 51, 12, 8, 8], [26, 35, 8, 8, 8, 40, 44, 9, 9, 9], [27, 49, 9, 8, 8, 18, 12, 9, 8, 8], [9, 14, 8, 8, 8, 17, 20, 8, 8, 8], [10, 16, 8, 8, 8, 9, 13, 8, 8, 8], [8, 9, 8, 8, 8, 8, 10, 8, 8, 8], [8, 8, 8, 8, 8, 9, 8, 8, 8, 8], [8]]
| epoch  17 step    35010 | batches   1394 / 2101 | lr 1.359e-03 | ms/batch 4867.5 | tok/s   10098 | loss  3.18 | ppl     23.97
| epoch  17 step    35020 | batches   1404 / 2101 | lr 1.357e-03 | ms/batch 405.8 | tok/s  121123 | loss  3.16 | ppl     23.57
| epoch  17 step    35030 | batches   1414 / 2101 | lr 1.356e-03 | ms/batch 394.9 | tok/s  124475 | loss  3.16 | ppl     23.61
| epoch  17 step    35040 | batches   1424 / 2101 | lr 1.354e-03 | ms/batch 394.7 | tok/s  124542 | loss  3.16 | ppl     23.52
| epoch  17 step    35050 | batches   1434 / 2101 | lr 1.353e-03 | ms/batch 395.3 | tok/s  124335 | loss  3.15 | ppl     23.39
| epoch  17 step    35060 | batches   1444 / 2101 | lr 1.352e-03 | ms/batch 396.3 | tok/s  124032 | loss  3.17 | ppl     23.89
| epoch  17 step    35070 | batches   1454 / 2101 | lr 1.350e-03 | ms/batch 396.7 | tok/s  123913 | loss  3.13 | ppl     22.90
| epoch  17 step    35080 | batches   1464 / 2101 | lr 1.349e-03 | ms/batch 397.0 | tok/s  123819 | loss  3.13 | ppl     22.95
| epoch  17 step    35090 | batches   1474 / 2101 | lr 1.347e-03 | ms/batch 396.6 | tok/s  123942 | loss  3.13 | ppl     22.89
| epoch  17 step    35100 | batches   1484 / 2101 | lr 1.346e-03 | ms/batch 396.8 | tok/s  123877 | loss  3.17 | ppl     23.80
| epoch  17 step    35110 | batches   1494 / 2101 | lr 1.345e-03 | ms/batch 397.3 | tok/s  123711 | loss  3.17 | ppl     23.76
| epoch  17 step    35120 | batches   1504 / 2101 | lr 1.343e-03 | ms/batch 397.7 | tok/s  123591 | loss  3.16 | ppl     23.51
| epoch  17 step    35130 | batches   1514 / 2101 | lr 1.342e-03 | ms/batch 397.0 | tok/s  123811 | loss  3.13 | ppl     22.94
| epoch  17 step    35140 | batches   1524 / 2101 | lr 1.340e-03 | ms/batch 397.3 | tok/s  123702 | loss  3.13 | ppl     22.78
| epoch  17 step    35150 | batches   1534 / 2101 | lr 1.339e-03 | ms/batch 397.9 | tok/s  123531 | loss  3.15 | ppl     23.40
| epoch  17 step    35160 | batches   1544 / 2101 | lr 1.338e-03 | ms/batch 398.2 | tok/s  123428 | loss  3.20 | ppl     24.58
| epoch  17 step    35170 | batches   1554 / 2101 | lr 1.336e-03 | ms/batch 397.7 | tok/s  123605 | loss  3.19 | ppl     24.29
| epoch  17 step    35180 | batches   1564 / 2101 | lr 1.335e-03 | ms/batch 408.3 | tok/s  120387 | loss  3.19 | ppl     24.23
| epoch  17 step    35190 | batches   1574 / 2101 | lr 1.334e-03 | ms/batch 398.1 | tok/s  123477 | loss  3.21 | ppl     24.88
| epoch  17 step    35200 | batches   1584 / 2101 | lr 1.332e-03 | ms/batch 409.0 | tok/s  120177 | loss  3.21 | ppl     24.70
| epoch  17 step    35210 | batches   1594 / 2101 | lr 1.331e-03 | ms/batch 397.4 | tok/s  123672 | loss  3.15 | ppl     23.37
| epoch  17 step    35220 | batches   1604 / 2101 | lr 1.329e-03 | ms/batch 397.6 | tok/s  123611 | loss  3.11 | ppl     22.51
| epoch  17 step    35230 | batches   1614 / 2101 | lr 1.328e-03 | ms/batch 397.5 | tok/s  123650 | loss  3.15 | ppl     23.45
| epoch  17 step    35240 | batches   1624 / 2101 | lr 1.327e-03 | ms/batch 397.3 | tok/s  123721 | loss  3.16 | ppl     23.66
| epoch  17 step    35250 | batches   1634 / 2101 | lr 1.325e-03 | ms/batch 397.8 | tok/s  123546 | loss  3.15 | ppl     23.35
| epoch  17 step    35260 | batches   1644 / 2101 | lr 1.324e-03 | ms/batch 398.3 | tok/s  123398 | loss  3.17 | ppl     23.80
| epoch  17 step    35270 | batches   1654 / 2101 | lr 1.323e-03 | ms/batch 398.2 | tok/s  123434 | loss  3.14 | ppl     23.15
| epoch  17 step    35280 | batches   1664 / 2101 | lr 1.321e-03 | ms/batch 397.5 | tok/s  123641 | loss  3.14 | ppl     23.11
| epoch  17 step    35290 | batches   1674 / 2101 | lr 1.320e-03 | ms/batch 397.2 | tok/s  123746 | loss  3.14 | ppl     23.01
| epoch  17 step    35300 | batches   1684 / 2101 | lr 1.319e-03 | ms/batch 397.4 | tok/s  123675 | loss  3.18 | ppl     24.08
| epoch  17 step    35310 | batches   1694 / 2101 | lr 1.317e-03 | ms/batch 397.7 | tok/s  123595 | loss  3.19 | ppl     24.38
| epoch  17 step    35320 | batches   1704 / 2101 | lr 1.316e-03 | ms/batch 397.7 | tok/s  123607 | loss  3.16 | ppl     23.61
| epoch  17 step    35330 | batches   1714 / 2101 | lr 1.315e-03 | ms/batch 397.5 | tok/s  123669 | loss  3.19 | ppl     24.18
| epoch  17 step    35340 | batches   1724 / 2101 | lr 1.313e-03 | ms/batch 397.2 | tok/s  123759 | loss  3.19 | ppl     24.28
| epoch  17 step    35350 | batches   1734 / 2101 | lr 1.312e-03 | ms/batch 398.3 | tok/s  123413 | loss  3.19 | ppl     24.29
| epoch  17 step    35360 | batches   1744 / 2101 | lr 1.311e-03 | ms/batch 397.8 | tok/s  123562 | loss  3.17 | ppl     23.73
| epoch  17 step    35370 | batches   1754 / 2101 | lr 1.309e-03 | ms/batch 397.6 | tok/s  123614 | loss  3.17 | ppl     23.89
| epoch  17 step    35380 | batches   1764 / 2101 | lr 1.308e-03 | ms/batch 397.1 | tok/s  123771 | loss  3.16 | ppl     23.68
| epoch  17 step    35390 | batches   1774 / 2101 | lr 1.307e-03 | ms/batch 397.3 | tok/s  123708 | loss  3.16 | ppl     23.49
| epoch  17 step    35400 | batches   1784 / 2101 | lr 1.305e-03 | ms/batch 397.1 | tok/s  123765 | loss  3.13 | ppl     22.88
| epoch  17 step    35410 | batches   1794 / 2101 | lr 1.304e-03 | ms/batch 408.6 | tok/s  120306 | loss  3.17 | ppl     23.77
| epoch  17 step    35420 | batches   1804 / 2101 | lr 1.303e-03 | ms/batch 397.8 | tok/s  123556 | loss  3.15 | ppl     23.40
| epoch  17 step    35430 | batches   1814 / 2101 | lr 1.301e-03 | ms/batch 410.5 | tok/s  119743 | loss  3.15 | ppl     23.40
| epoch  17 step    35440 | batches   1824 / 2101 | lr 1.300e-03 | ms/batch 410.4 | tok/s  119768 | loss  3.15 | ppl     23.27
| epoch  17 step    35450 | batches   1834 / 2101 | lr 1.299e-03 | ms/batch 397.3 | tok/s  123709 | loss  3.13 | ppl     22.89
| epoch  17 step    35460 | batches   1844 / 2101 | lr 1.298e-03 | ms/batch 398.0 | tok/s  123485 | loss  3.16 | ppl     23.68
| epoch  17 step    35470 | batches   1854 / 2101 | lr 1.296e-03 | ms/batch 398.2 | tok/s  123425 | loss  3.15 | ppl     23.42
| epoch  17 step    35480 | batches   1864 / 2101 | lr 1.295e-03 | ms/batch 398.9 | tok/s  123206 | loss  3.16 | ppl     23.55
| epoch  17 step    35490 | batches   1874 / 2101 | lr 1.294e-03 | ms/batch 397.3 | tok/s  123728 | loss  3.13 | ppl     22.77
| epoch  17 step    35500 | batches   1884 / 2101 | lr 1.292e-03 | ms/batch 398.4 | tok/s  123363 | loss  3.15 | ppl     23.25
----------------------------------------------------------------------------------------------------
| Eval  71 at step    35500 | time:  0.81s | valid loss  3.15 | valid ppl    23.416
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  17 step    35510 | batches   1894 / 2101 | lr 1.291e-03 | ms/batch 398.1 | tok/s  123465 | loss  3.16 | ppl     23.52
| epoch  17 step    35520 | batches   1904 / 2101 | lr 1.290e-03 | ms/batch 420.5 | tok/s  116899 | loss  3.12 | ppl     22.65
| epoch  17 step    35530 | batches   1914 / 2101 | lr 1.289e-03 | ms/batch 408.7 | tok/s  120251 | loss  3.16 | ppl     23.57
| epoch  17 step    35540 | batches   1924 / 2101 | lr 1.287e-03 | ms/batch 397.9 | tok/s  123520 | loss  3.19 | ppl     24.26
| epoch  17 step    35550 | batches   1934 / 2101 | lr 1.286e-03 | ms/batch 396.8 | tok/s  123857 | loss  3.20 | ppl     24.55
| epoch  17 step    35560 | batches   1944 / 2101 | lr 1.285e-03 | ms/batch 397.4 | tok/s  123686 | loss  3.17 | ppl     23.91
| epoch  17 step    35570 | batches   1954 / 2101 | lr 1.283e-03 | ms/batch 397.4 | tok/s  123678 | loss  3.18 | ppl     24.05
| epoch  17 step    35580 | batches   1964 / 2101 | lr 1.282e-03 | ms/batch 408.0 | tok/s  120473 | loss  3.16 | ppl     23.66
| epoch  17 step    35590 | batches   1974 / 2101 | lr 1.281e-03 | ms/batch 398.1 | tok/s  123470 | loss  3.16 | ppl     23.68
| epoch  17 step    35600 | batches   1984 / 2101 | lr 1.280e-03 | ms/batch 408.2 | tok/s  120426 | loss  3.14 | ppl     23.09
| epoch  17 step    35610 | batches   1994 / 2101 | lr 1.278e-03 | ms/batch 397.6 | tok/s  123624 | loss  3.13 | ppl     22.87
| epoch  17 step    35620 | batches   2004 / 2101 | lr 1.277e-03 | ms/batch 397.7 | tok/s  123606 | loss  3.15 | ppl     23.22
| epoch  17 step    35630 | batches   2014 / 2101 | lr 1.276e-03 | ms/batch 396.7 | tok/s  123903 | loss  3.13 | ppl     22.91
| epoch  17 step    35640 | batches   2024 / 2101 | lr 1.275e-03 | ms/batch 397.2 | tok/s  123732 | loss  3.13 | ppl     22.86
| epoch  17 step    35650 | batches   2034 / 2101 | lr 1.273e-03 | ms/batch 397.4 | tok/s  123689 | loss  3.14 | ppl     23.04
| epoch  17 step    35660 | batches   2044 / 2101 | lr 1.272e-03 | ms/batch 398.0 | tok/s  123497 | loss  3.15 | ppl     23.31
| epoch  17 step    35670 | batches   2054 / 2101 | lr 1.271e-03 | ms/batch 397.5 | tok/s  123652 | loss  3.10 | ppl     22.31
| epoch  17 step    35680 | batches   2064 / 2101 | lr 1.270e-03 | ms/batch 396.7 | tok/s  123903 | loss  3.12 | ppl     22.75
| epoch  17 step    35690 | batches   2074 / 2101 | lr 1.268e-03 | ms/batch 397.6 | tok/s  123614 | loss  3.16 | ppl     23.58
| epoch  17 step    35700 | batches   2084 / 2101 | lr 1.267e-03 | ms/batch 397.1 | tok/s  123767 | loss  3.18 | ppl     23.93
| epoch  17 step    35710 | batches   2094 / 2101 | lr 1.266e-03 | ms/batch 397.5 | tok/s  123659 | loss  3.17 | ppl     23.73
| epoch  18 step    35720 | batches      3 / 2101 | lr 1.265e-03 | ms/batch 401.8 | tok/s  122852 | loss  3.32 | ppl     27.66
| epoch  18 step    35730 | batches     13 / 2101 | lr 1.264e-03 | ms/batch 397.2 | tok/s  123751 | loss  3.13 | ppl     22.85
| epoch  18 step    35740 | batches     23 / 2101 | lr 1.262e-03 | ms/batch 396.9 | tok/s  123832 | loss  3.16 | ppl     23.55
| epoch  18 step    35750 | batches     33 / 2101 | lr 1.261e-03 | ms/batch 397.4 | tok/s  123688 | loss  3.15 | ppl     23.34
| epoch  18 step    35760 | batches     43 / 2101 | lr 1.260e-03 | ms/batch 397.2 | tok/s  123741 | loss  3.13 | ppl     22.85
| epoch  18 step    35770 | batches     53 / 2101 | lr 1.259e-03 | ms/batch 398.4 | tok/s  123385 | loss  3.11 | ppl     22.47
| epoch  18 step    35780 | batches     63 / 2101 | lr 1.258e-03 | ms/batch 398.2 | tok/s  123447 | loss  3.13 | ppl     22.98
| epoch  18 step    35790 | batches     73 / 2101 | lr 1.256e-03 | ms/batch 397.9 | tok/s  123515 | loss  3.13 | ppl     22.85
| epoch  18 step    35800 | batches     83 / 2101 | lr 1.255e-03 | ms/batch 396.7 | tok/s  123903 | loss  3.09 | ppl     21.87
| epoch  18 step    35810 | batches     93 / 2101 | lr 1.254e-03 | ms/batch 397.0 | tok/s  123805 | loss  3.09 | ppl     22.03
| epoch  18 step    35820 | batches    103 / 2101 | lr 1.253e-03 | ms/batch 397.6 | tok/s  123625 | loss  3.16 | ppl     23.48
| epoch  18 step    35830 | batches    113 / 2101 | lr 1.251e-03 | ms/batch 397.4 | tok/s  123675 | loss  3.14 | ppl     23.21
| epoch  18 step    35840 | batches    123 / 2101 | lr 1.250e-03 | ms/batch 397.7 | tok/s  123590 | loss  3.16 | ppl     23.50
| epoch  18 step    35850 | batches    133 / 2101 | lr 1.249e-03 | ms/batch 397.5 | tok/s  123661 | loss  3.15 | ppl     23.37
| epoch  18 step    35860 | batches    143 / 2101 | lr 1.248e-03 | ms/batch 397.4 | tok/s  123679 | loss  3.13 | ppl     22.90
| epoch  18 step    35870 | batches    153 / 2101 | lr 1.247e-03 | ms/batch 398.0 | tok/s  123508 | loss  3.11 | ppl     22.45
| epoch  18 step    35880 | batches    163 / 2101 | lr 1.246e-03 | ms/batch 398.4 | tok/s  123370 | loss  3.09 | ppl     22.01
| epoch  18 step    35890 | batches    173 / 2101 | lr 1.244e-03 | ms/batch 397.8 | tok/s  123571 | loss  3.13 | ppl     22.89
| epoch  18 step    35900 | batches    183 / 2101 | lr 1.243e-03 | ms/batch 397.2 | tok/s  123745 | loss  3.15 | ppl     23.38
| epoch  18 step    35910 | batches    193 / 2101 | lr 1.242e-03 | ms/batch 396.6 | tok/s  123943 | loss  3.14 | ppl     23.02
| epoch  18 step    35920 | batches    203 / 2101 | lr 1.241e-03 | ms/batch 396.7 | tok/s  123897 | loss  3.15 | ppl     23.29
| epoch  18 step    35930 | batches    213 / 2101 | lr 1.240e-03 | ms/batch 396.8 | tok/s  123882 | loss  3.13 | ppl     22.94
| epoch  18 step    35940 | batches    223 / 2101 | lr 1.239e-03 | ms/batch 397.8 | tok/s  123575 | loss  3.09 | ppl     21.92
| epoch  18 step    35950 | batches    233 / 2101 | lr 1.237e-03 | ms/batch 397.2 | tok/s  123749 | loss  3.10 | ppl     22.31
| epoch  18 step    35960 | batches    243 / 2101 | lr 1.236e-03 | ms/batch 397.1 | tok/s  123773 | loss  3.13 | ppl     22.89
| epoch  18 step    35970 | batches    253 / 2101 | lr 1.235e-03 | ms/batch 397.1 | tok/s  123779 | loss  3.15 | ppl     23.25
| epoch  18 step    35980 | batches    263 / 2101 | lr 1.234e-03 | ms/batch 396.9 | tok/s  123833 | loss  3.18 | ppl     24.03
| epoch  18 step    35990 | batches    273 / 2101 | lr 1.233e-03 | ms/batch 396.8 | tok/s  123861 | loss  3.13 | ppl     22.91
| epoch  18 step    36000 | batches    283 / 2101 | lr 1.232e-03 | ms/batch 410.6 | tok/s  119721 | loss  3.13 | ppl     22.86
----------------------------------------------------------------------------------------------------
| Eval  72 at step    36000 | time:  0.81s | valid loss  3.15 | valid ppl    23.404
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.03121695516201724, 0.03151613958493842, 0.03819045716602504, 0.031186511188266042, 0.03015390834276543, 0.03211660013087816, 0.03042949523072002, 0.0294299829130048, 0.033622376392979235, 0.0290949817264526, 0.030974916467062005, 0.03331580709460786, 0.028338262140749255, 0.035455973368132686, 0.03188837354384538, 0.03273820796798089, 0.03292761827606853, 0.035504873491954136, 0.03310978374518356, 0.031163646523591056, 0.032391541677684196, 0.033730697017820103, 0.03862192544615277, 0.03124838852896749, 0.03157736615616003, 0.03355603349399519, 0.03425766274146058, 0.02690186066525727, 0.030914881383780995, 0.03201137790636001, 0.03155192764140364, 0.03227217528280552, 0.04298921429168477, 0.02961859495276796, 0.03073709366496195, 0.03198095638045086, 0.03311817327513975, 0.030579063058472477, 0.03156718936283571, 0.031367174856279066, 0.02671551025994108, 0.034266976842610694, 0.040328816622072106, 0.03042931377441809, 0.029804128121158662, 0.028297753858018724, 0.03181040956054504, 0.02836627592798928, 0.029443463308651167, 0.029733369201867355, 0.03406819028560754, 0.03289434746803695, 0.031128258101277513, 0.03130292451772095, 0.030570365779082696, 0.029904716491641847, 0.03329993205720406, 0.01590255615017802, 0.03301258147050174, 0.030262560057306563, 0.024257568444196857, 0.025725692351116217, 0.005664943022433985, 0.02640724088253196, 0.029214052399181543, 0.028466237803589974, 0.03225597885493232, 0.019558843492022217, 0.027069229205419727, 0.030138723257359987, 0.029838021477389665, 0.030259452887489678, 0.030841605310843206, 0.024565137326269706, 0.02760221245635888, 0.03228218953832008, 0.0301560740691396, 0.03701965056725318, 0.024796279747998265, 0.029143892672375996, 0.03068776779186372]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [54, 69, 9, 14, 9, 59, 76, 8, 21, 8], [38, 38, 17, 8, 8, 41, 57, 12, 8, 8], [26, 41, 8, 8, 8, 39, 43, 9, 8, 8], [28, 42, 9, 8, 8, 16, 18, 10, 8, 8], [8, 14, 8, 8, 8, 15, 20, 8, 8, 8], [8, 12, 8, 8, 8, 9, 12, 8, 8, 8], [8, 9, 8, 8, 8, 8, 9, 8, 8, 8], [8, 8, 8, 8, 8, 9, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [54, 69, 9, 14, 9, 59, 76, 8, 21, 8], [38, 38, 17, 8, 8, 41, 57, 12, 8, 8], [26, 41, 8, 8, 8, 39, 43, 9, 8, 8], [28, 42, 9, 8, 8, 16, 18, 10, 8, 8], [8, 14, 8, 8, 8, 15, 20, 8, 8, 8], [8, 12, 8, 8, 8, 9, 12, 8, 8, 8], [8, 9, 8, 8, 8, 8, 9, 8, 8, 8], [8, 8, 8, 8, 8, 9, 9, 8, 8, 8], [8]]
| epoch  18 step    36010 | batches    293 / 2101 | lr 1.230e-03 | ms/batch 4874.6 | tok/s   10083 | loss  3.15 | ppl     23.31
| epoch  18 step    36020 | batches    303 / 2101 | lr 1.229e-03 | ms/batch 406.2 | tok/s  120996 | loss  3.16 | ppl     23.46
| epoch  18 step    36030 | batches    313 / 2101 | lr 1.228e-03 | ms/batch 405.3 | tok/s  121276 | loss  3.15 | ppl     23.23
| epoch  18 step    36040 | batches    323 / 2101 | lr 1.227e-03 | ms/batch 395.9 | tok/s  124148 | loss  3.16 | ppl     23.65
| epoch  18 step    36050 | batches    333 / 2101 | lr 1.226e-03 | ms/batch 396.6 | tok/s  123940 | loss  3.14 | ppl     23.17
| epoch  18 step    36060 | batches    343 / 2101 | lr 1.225e-03 | ms/batch 396.0 | tok/s  124118 | loss  3.15 | ppl     23.45
| epoch  18 step    36070 | batches    353 / 2101 | lr 1.224e-03 | ms/batch 395.9 | tok/s  124167 | loss  3.11 | ppl     22.38
| epoch  18 step    36080 | batches    363 / 2101 | lr 1.222e-03 | ms/batch 396.2 | tok/s  124061 | loss  3.14 | ppl     23.05
| epoch  18 step    36090 | batches    373 / 2101 | lr 1.221e-03 | ms/batch 406.3 | tok/s  120975 | loss  3.18 | ppl     24.11
| epoch  18 step    36100 | batches    383 / 2101 | lr 1.220e-03 | ms/batch 397.6 | tok/s  123623 | loss  3.13 | ppl     22.78
| epoch  18 step    36110 | batches    393 / 2101 | lr 1.219e-03 | ms/batch 407.3 | tok/s  120668 | loss  3.17 | ppl     23.69
| epoch  18 step    36120 | batches    403 / 2101 | lr 1.218e-03 | ms/batch 398.0 | tok/s  123497 | loss  3.14 | ppl     23.11
| epoch  18 step    36130 | batches    413 / 2101 | lr 1.217e-03 | ms/batch 396.0 | tok/s  124133 | loss  3.16 | ppl     23.68
| epoch  18 step    36140 | batches    423 / 2101 | lr 1.216e-03 | ms/batch 396.6 | tok/s  123921 | loss  3.15 | ppl     23.36
| epoch  18 step    36150 | batches    433 / 2101 | lr 1.215e-03 | ms/batch 397.0 | tok/s  123818 | loss  3.17 | ppl     23.78
| epoch  18 step    36160 | batches    443 / 2101 | lr 1.214e-03 | ms/batch 397.3 | tok/s  123725 | loss  3.18 | ppl     24.02
| epoch  18 step    36170 | batches    453 / 2101 | lr 1.212e-03 | ms/batch 397.2 | tok/s  123737 | loss  3.15 | ppl     23.34
| epoch  18 step    36180 | batches    463 / 2101 | lr 1.211e-03 | ms/batch 408.7 | tok/s  120259 | loss  3.11 | ppl     22.51
| epoch  18 step    36190 | batches    473 / 2101 | lr 1.210e-03 | ms/batch 407.9 | tok/s  120509 | loss  3.12 | ppl     22.72
| epoch  18 step    36200 | batches    483 / 2101 | lr 1.209e-03 | ms/batch 397.0 | tok/s  123819 | loss  3.12 | ppl     22.70
| epoch  18 step    36210 | batches    493 / 2101 | lr 1.208e-03 | ms/batch 397.1 | tok/s  123781 | loss  3.13 | ppl     22.78
| epoch  18 step    36220 | batches    503 / 2101 | lr 1.207e-03 | ms/batch 407.5 | tok/s  120623 | loss  3.15 | ppl     23.30
| epoch  18 step    36230 | batches    513 / 2101 | lr 1.206e-03 | ms/batch 398.5 | tok/s  123337 | loss  3.16 | ppl     23.59
| epoch  18 step    36240 | batches    523 / 2101 | lr 1.205e-03 | ms/batch 408.6 | tok/s  120309 | loss  3.16 | ppl     23.51
| epoch  18 step    36250 | batches    533 / 2101 | lr 1.204e-03 | ms/batch 397.4 | tok/s  123690 | loss  3.15 | ppl     23.42
| epoch  18 step    36260 | batches    543 / 2101 | lr 1.203e-03 | ms/batch 397.2 | tok/s  123742 | loss  3.13 | ppl     22.89
| epoch  18 step    36270 | batches    553 / 2101 | lr 1.202e-03 | ms/batch 397.1 | tok/s  123787 | loss  3.15 | ppl     23.24
| epoch  18 step    36280 | batches    563 / 2101 | lr 1.201e-03 | ms/batch 396.4 | tok/s  123986 | loss  3.12 | ppl     22.76
| epoch  18 step    36290 | batches    573 / 2101 | lr 1.199e-03 | ms/batch 397.0 | tok/s  123811 | loss  3.13 | ppl     22.93
| epoch  18 step    36300 | batches    583 / 2101 | lr 1.198e-03 | ms/batch 396.9 | tok/s  123854 | loss  3.14 | ppl     23.17
| epoch  18 step    36310 | batches    593 / 2101 | lr 1.197e-03 | ms/batch 396.8 | tok/s  123875 | loss  3.16 | ppl     23.53
| epoch  18 step    36320 | batches    603 / 2101 | lr 1.196e-03 | ms/batch 407.5 | tok/s  120628 | loss  3.17 | ppl     23.69
| epoch  18 step    36330 | batches    613 / 2101 | lr 1.195e-03 | ms/batch 397.4 | tok/s  123669 | loss  3.17 | ppl     23.80
| epoch  18 step    36340 | batches    623 / 2101 | lr 1.194e-03 | ms/batch 397.1 | tok/s  123781 | loss  3.15 | ppl     23.36
| epoch  18 step    36350 | batches    633 / 2101 | lr 1.193e-03 | ms/batch 397.1 | tok/s  123773 | loss  3.15 | ppl     23.32
| epoch  18 step    36360 | batches    643 / 2101 | lr 1.192e-03 | ms/batch 407.6 | tok/s  120604 | loss  3.14 | ppl     23.07
| epoch  18 step    36370 | batches    653 / 2101 | lr 1.191e-03 | ms/batch 408.6 | tok/s  120296 | loss  3.14 | ppl     23.08
| epoch  18 step    36380 | batches    663 / 2101 | lr 1.190e-03 | ms/batch 399.1 | tok/s  123145 | loss  3.15 | ppl     23.37
| epoch  18 step    36390 | batches    673 / 2101 | lr 1.189e-03 | ms/batch 408.5 | tok/s  120335 | loss  3.11 | ppl     22.37
| epoch  18 step    36400 | batches    683 / 2101 | lr 1.188e-03 | ms/batch 398.4 | tok/s  123376 | loss  3.14 | ppl     23.06
| epoch  18 step    36410 | batches    693 / 2101 | lr 1.187e-03 | ms/batch 408.8 | tok/s  120234 | loss  3.10 | ppl     22.16
| epoch  18 step    36420 | batches    703 / 2101 | lr 1.186e-03 | ms/batch 398.2 | tok/s  123429 | loss  3.13 | ppl     22.87
| epoch  18 step    36430 | batches    713 / 2101 | lr 1.185e-03 | ms/batch 397.4 | tok/s  123694 | loss  3.18 | ppl     24.02
| epoch  18 step    36440 | batches    723 / 2101 | lr 1.184e-03 | ms/batch 398.3 | tok/s  123407 | loss  3.14 | ppl     23.21
| epoch  18 step    36450 | batches    733 / 2101 | lr 1.183e-03 | ms/batch 396.9 | tok/s  123853 | loss  3.13 | ppl     22.76
| epoch  18 step    36460 | batches    743 / 2101 | lr 1.182e-03 | ms/batch 396.7 | tok/s  123902 | loss  3.13 | ppl     22.78
| epoch  18 step    36470 | batches    753 / 2101 | lr 1.181e-03 | ms/batch 396.4 | tok/s  123996 | loss  3.12 | ppl     22.75
| epoch  18 step    36480 | batches    763 / 2101 | lr 1.180e-03 | ms/batch 396.9 | tok/s  123855 | loss  3.15 | ppl     23.35
| epoch  18 step    36490 | batches    773 / 2101 | lr 1.179e-03 | ms/batch 396.3 | tok/s  124027 | loss  3.13 | ppl     22.77
| epoch  18 step    36500 | batches    783 / 2101 | lr 1.178e-03 | ms/batch 397.3 | tok/s  123709 | loss  3.16 | ppl     23.64
----------------------------------------------------------------------------------------------------
| Eval  73 at step    36500 | time:  0.81s | valid loss  3.15 | valid ppl    23.361
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  18 step    36510 | batches    793 / 2101 | lr 1.177e-03 | ms/batch 399.3 | tok/s  123095 | loss  3.14 | ppl     23.06
| epoch  18 step    36520 | batches    803 / 2101 | lr 1.176e-03 | ms/batch 408.7 | tok/s  120265 | loss  3.15 | ppl     23.45
| epoch  18 step    36530 | batches    813 / 2101 | lr 1.175e-03 | ms/batch 407.4 | tok/s  120647 | loss  3.15 | ppl     23.30
| epoch  18 step    36540 | batches    823 / 2101 | lr 1.174e-03 | ms/batch 397.1 | tok/s  123773 | loss  3.17 | ppl     23.90
| epoch  18 step    36550 | batches    833 / 2101 | lr 1.173e-03 | ms/batch 407.1 | tok/s  120732 | loss  3.13 | ppl     22.88
| epoch  18 step    36560 | batches    843 / 2101 | lr 1.172e-03 | ms/batch 396.9 | tok/s  123841 | loss  3.16 | ppl     23.61
| epoch  18 step    36570 | batches    853 / 2101 | lr 1.171e-03 | ms/batch 397.2 | tok/s  123744 | loss  3.17 | ppl     23.76
| epoch  18 step    36580 | batches    863 / 2101 | lr 1.170e-03 | ms/batch 396.7 | tok/s  123891 | loss  3.13 | ppl     22.88
| epoch  18 step    36590 | batches    873 / 2101 | lr 1.169e-03 | ms/batch 407.7 | tok/s  120572 | loss  3.14 | ppl     23.11
| epoch  18 step    36600 | batches    883 / 2101 | lr 1.168e-03 | ms/batch 407.6 | tok/s  120578 | loss  3.15 | ppl     23.41
| epoch  18 step    36610 | batches    893 / 2101 | lr 1.167e-03 | ms/batch 398.0 | tok/s  123513 | loss  3.13 | ppl     22.98
| epoch  18 step    36620 | batches    903 / 2101 | lr 1.166e-03 | ms/batch 396.6 | tok/s  123933 | loss  3.12 | ppl     22.63
| epoch  18 step    36630 | batches    913 / 2101 | lr 1.165e-03 | ms/batch 397.1 | tok/s  123780 | loss  3.11 | ppl     22.46
| epoch  18 step    36640 | batches    923 / 2101 | lr 1.164e-03 | ms/batch 396.8 | tok/s  123871 | loss  3.15 | ppl     23.26
| epoch  18 step    36650 | batches    933 / 2101 | lr 1.163e-03 | ms/batch 397.2 | tok/s  123761 | loss  3.12 | ppl     22.65
| epoch  18 step    36660 | batches    943 / 2101 | lr 1.162e-03 | ms/batch 396.7 | tok/s  123905 | loss  3.09 | ppl     22.06
| epoch  18 step    36670 | batches    953 / 2101 | lr 1.161e-03 | ms/batch 396.8 | tok/s  123860 | loss  3.12 | ppl     22.71
| epoch  18 step    36680 | batches    963 / 2101 | lr 1.160e-03 | ms/batch 397.2 | tok/s  123738 | loss  3.17 | ppl     23.84
| epoch  18 step    36690 | batches    973 / 2101 | lr 1.159e-03 | ms/batch 397.0 | tok/s  123821 | loss  3.15 | ppl     23.25
| epoch  18 step    36700 | batches    983 / 2101 | lr 1.158e-03 | ms/batch 397.6 | tok/s  123618 | loss  3.17 | ppl     23.70
| epoch  18 step    36710 | batches    993 / 2101 | lr 1.157e-03 | ms/batch 407.5 | tok/s  120621 | loss  3.16 | ppl     23.58
| epoch  18 step    36720 | batches   1003 / 2101 | lr 1.156e-03 | ms/batch 397.9 | tok/s  123522 | loss  3.19 | ppl     24.19
| epoch  18 step    36730 | batches   1013 / 2101 | lr 1.155e-03 | ms/batch 408.8 | tok/s  120229 | loss  3.13 | ppl     22.99
| epoch  18 step    36740 | batches   1023 / 2101 | lr 1.154e-03 | ms/batch 398.1 | tok/s  123470 | loss  3.14 | ppl     23.05
| epoch  18 step    36750 | batches   1033 / 2101 | lr 1.153e-03 | ms/batch 397.9 | tok/s  123529 | loss  3.15 | ppl     23.26
| epoch  18 step    36760 | batches   1043 / 2101 | lr 1.152e-03 | ms/batch 398.1 | tok/s  123481 | loss  3.16 | ppl     23.51
| epoch  18 step    36770 | batches   1053 / 2101 | lr 1.151e-03 | ms/batch 397.7 | tok/s  123579 | loss  3.17 | ppl     23.90
| epoch  18 step    36780 | batches   1063 / 2101 | lr 1.151e-03 | ms/batch 398.4 | tok/s  123388 | loss  3.19 | ppl     24.33
| epoch  18 step    36790 | batches   1073 / 2101 | lr 1.150e-03 | ms/batch 397.9 | tok/s  123544 | loss  3.17 | ppl     23.74
| epoch  18 step    36800 | batches   1083 / 2101 | lr 1.149e-03 | ms/batch 397.4 | tok/s  123691 | loss  3.12 | ppl     22.53
| epoch  18 step    36810 | batches   1093 / 2101 | lr 1.148e-03 | ms/batch 397.6 | tok/s  123611 | loss  3.14 | ppl     23.05
| epoch  18 step    36820 | batches   1103 / 2101 | lr 1.147e-03 | ms/batch 397.4 | tok/s  123685 | loss  3.16 | ppl     23.65
| epoch  18 step    36830 | batches   1113 / 2101 | lr 1.146e-03 | ms/batch 397.5 | tok/s  123641 | loss  3.15 | ppl     23.31
| epoch  18 step    36840 | batches   1123 / 2101 | lr 1.145e-03 | ms/batch 398.0 | tok/s  123509 | loss  3.15 | ppl     23.34
| epoch  18 step    36850 | batches   1133 / 2101 | lr 1.144e-03 | ms/batch 397.5 | tok/s  123665 | loss  3.13 | ppl     22.96
| epoch  18 step    36860 | batches   1143 / 2101 | lr 1.143e-03 | ms/batch 396.7 | tok/s  123918 | loss  3.11 | ppl     22.53
| epoch  18 step    36870 | batches   1153 / 2101 | lr 1.142e-03 | ms/batch 397.5 | tok/s  123652 | loss  3.14 | ppl     23.10
| epoch  18 step    36880 | batches   1163 / 2101 | lr 1.141e-03 | ms/batch 397.1 | tok/s  123779 | loss  3.17 | ppl     23.78
| epoch  18 step    36890 | batches   1173 / 2101 | lr 1.140e-03 | ms/batch 397.2 | tok/s  123739 | loss  3.15 | ppl     23.31
| epoch  18 step    36900 | batches   1183 / 2101 | lr 1.140e-03 | ms/batch 397.9 | tok/s  123534 | loss  3.15 | ppl     23.43
| epoch  18 step    36910 | batches   1193 / 2101 | lr 1.139e-03 | ms/batch 398.0 | tok/s  123495 | loss  3.12 | ppl     22.73
| epoch  18 step    36920 | batches   1203 / 2101 | lr 1.138e-03 | ms/batch 398.0 | tok/s  123500 | loss  3.10 | ppl     22.10
| epoch  18 step    36930 | batches   1213 / 2101 | lr 1.137e-03 | ms/batch 398.3 | tok/s  123405 | loss  3.12 | ppl     22.65
| epoch  18 step    36940 | batches   1223 / 2101 | lr 1.136e-03 | ms/batch 397.1 | tok/s  123784 | loss  3.11 | ppl     22.40
| epoch  18 step    36950 | batches   1233 / 2101 | lr 1.135e-03 | ms/batch 397.2 | tok/s  123744 | loss  3.15 | ppl     23.28
| epoch  18 step    36960 | batches   1243 / 2101 | lr 1.134e-03 | ms/batch 397.8 | tok/s  123554 | loss  3.13 | ppl     22.94
| epoch  18 step    36970 | batches   1253 / 2101 | lr 1.133e-03 | ms/batch 397.3 | tok/s  123728 | loss  3.12 | ppl     22.59
| epoch  18 step    36980 | batches   1263 / 2101 | lr 1.133e-03 | ms/batch 398.1 | tok/s  123471 | loss  3.12 | ppl     22.73
| epoch  18 step    36990 | batches   1273 / 2101 | lr 1.132e-03 | ms/batch 397.6 | tok/s  123636 | loss  3.14 | ppl     23.07
| epoch  18 step    37000 | batches   1283 / 2101 | lr 1.131e-03 | ms/batch 412.7 | tok/s  119108 | loss  3.17 | ppl     23.77
----------------------------------------------------------------------------------------------------
| Eval  74 at step    37000 | time:  0.82s | valid loss  3.15 | valid ppl    23.351
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
ratio list [0.0332977602744069, 0.031939513757607334, 0.03736642832753885, 0.03128016421830353, 0.030186919653759706, 0.0328468626939631, 0.031400123593483036, 0.03266432768218557, 0.03286846991767242, 0.02834127583483069, 0.034493399453815896, 0.034628696143103606, 0.031963919125116355, 0.032278565705227566, 0.03211015433446411, 0.034210715389348174, 0.03256930279117898, 0.03365389118584584, 0.033902928796479, 0.03156046188809849, 0.03237364842561634, 0.0341143175003731, 0.04788599127645411, 0.033646396815756, 0.032071155271862446, 0.03448709651969681, 0.03471624122243582, 0.03958495397241277, 0.034298800677535324, 0.032501923031442934, 0.03520433481849599, 0.03372126495446263, 0.027389907242533394, 0.03141659258270135, 0.032474817148394064, 0.03446319737901494, 0.03438324354666895, 0.029845900915519682, 0.03220463934666777, 0.03223223756125673, 0.03685493071127708, 0.03445670485963483, 0.02918080285933333, 0.031729512241119286, 0.031406711612756606, 0.034463656322284625, 0.03414270737702321, 0.033563922318496864, 0.03165487882014462, 0.0318840302519086, 0.0370430333678321, 0.03358926696624461, 0.03434402506942485, 0.03186005041409637, 0.0313812548490207, 0.03956383566030535, 0.034503506600483465, 0.04397421667968454, 0.02985113991841008, 0.031642608184335834, 0.03390490501553194, 0.026019288052089997, 0.001529748929163216, 0.027124782548947464, 0.030480974132361536, 0.03336680837016353, 0.032497975168782105, 0.024390327636455995, 0.027893585998103817, 0.03131508828531551, 0.032236584844610415, 0.03190285530849121, 0.01572723872513443, 0.02516753870718066, 0.028770619353930205, 0.032826705805941464, 0.03125548135602258, 0.019839683602777478, 0.026555900954930357, 0.03049196111343052, 0.029306124290575553]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [54, 63, 9, 11, 9, 56, 87, 8, 20, 9], [40, 42, 19, 8, 8, 46, 53, 12, 8, 8], [30, 43, 8, 8, 8, 33, 42, 9, 9, 9], [27, 41, 9, 8, 8, 15, 11, 10, 8, 8], [9, 12, 8, 8, 8, 17, 23, 8, 8, 8], [9, 15, 8, 8, 8, 8, 12, 8, 8, 8], [8, 8, 8, 8, 8, 8, 10, 8, 8, 8], [10, 12, 8, 8, 8, 10, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [54, 63, 9, 11, 9, 56, 87, 8, 20, 9], [40, 42, 19, 8, 8, 46, 53, 12, 8, 8], [30, 43, 8, 8, 8, 33, 42, 9, 9, 9], [27, 41, 9, 8, 8, 15, 11, 10, 8, 8], [9, 12, 8, 8, 8, 17, 23, 8, 8, 8], [9, 15, 8, 8, 8, 8, 12, 8, 8, 8], [8, 8, 8, 8, 8, 8, 10, 8, 8, 8], [10, 12, 8, 8, 8, 10, 9, 8, 8, 8], [8]]
| epoch  18 step    37010 | batches   1293 / 2101 | lr 1.130e-03 | ms/batch 4895.1 | tok/s   10041 | loss  3.14 | ppl     23.20
| epoch  18 step    37020 | batches   1303 / 2101 | lr 1.129e-03 | ms/batch 394.8 | tok/s  124486 | loss  3.12 | ppl     22.71
| epoch  18 step    37030 | batches   1313 / 2101 | lr 1.128e-03 | ms/batch 395.4 | tok/s  124312 | loss  3.11 | ppl     22.39
| epoch  18 step    37040 | batches   1323 / 2101 | lr 1.127e-03 | ms/batch 395.6 | tok/s  124234 | loss  3.17 | ppl     23.82
| epoch  18 step    37050 | batches   1333 / 2101 | lr 1.126e-03 | ms/batch 396.2 | tok/s  124054 | loss  3.16 | ppl     23.51
| epoch  18 step    37060 | batches   1343 / 2101 | lr 1.126e-03 | ms/batch 396.5 | tok/s  123955 | loss  3.15 | ppl     23.41
| epoch  18 step    37070 | batches   1353 / 2101 | lr 1.125e-03 | ms/batch 396.2 | tok/s  124059 | loss  3.11 | ppl     22.48
| epoch  18 step    37080 | batches   1363 / 2101 | lr 1.124e-03 | ms/batch 395.9 | tok/s  124144 | loss  3.10 | ppl     22.28
| epoch  18 step    37090 | batches   1373 / 2101 | lr 1.123e-03 | ms/batch 397.0 | tok/s  123804 | loss  3.11 | ppl     22.35
| epoch  18 step    37100 | batches   1383 / 2101 | lr 1.122e-03 | ms/batch 396.6 | tok/s  123933 | loss  3.16 | ppl     23.54
| epoch  18 step    37110 | batches   1393 / 2101 | lr 1.121e-03 | ms/batch 396.9 | tok/s  123852 | loss  3.16 | ppl     23.53
| epoch  18 step    37120 | batches   1403 / 2101 | lr 1.121e-03 | ms/batch 396.3 | tok/s  124016 | loss  3.13 | ppl     22.81
| epoch  18 step    37130 | batches   1413 / 2101 | lr 1.120e-03 | ms/batch 396.6 | tok/s  123940 | loss  3.17 | ppl     23.71
| epoch  18 step    37140 | batches   1423 / 2101 | lr 1.119e-03 | ms/batch 397.0 | tok/s  123812 | loss  3.16 | ppl     23.46
| epoch  18 step    37150 | batches   1433 / 2101 | lr 1.118e-03 | ms/batch 397.2 | tok/s  123746 | loss  3.14 | ppl     23.13
| epoch  18 step    37160 | batches   1443 / 2101 | lr 1.117e-03 | ms/batch 396.9 | tok/s  123835 | loss  3.18 | ppl     24.01
| epoch  18 step    37170 | batches   1453 / 2101 | lr 1.116e-03 | ms/batch 397.5 | tok/s  123662 | loss  3.15 | ppl     23.31
| epoch  18 step    37180 | batches   1463 / 2101 | lr 1.116e-03 | ms/batch 397.1 | tok/s  123763 | loss  3.10 | ppl     22.30
| epoch  18 step    37190 | batches   1473 / 2101 | lr 1.115e-03 | ms/batch 396.9 | tok/s  123845 | loss  3.12 | ppl     22.68
| epoch  18 step    37200 | batches   1483 / 2101 | lr 1.114e-03 | ms/batch 397.1 | tok/s  123789 | loss  3.15 | ppl     23.24
| epoch  18 step    37210 | batches   1493 / 2101 | lr 1.113e-03 | ms/batch 397.5 | tok/s  123654 | loss  3.16 | ppl     23.46
| epoch  18 step    37220 | batches   1503 / 2101 | lr 1.112e-03 | ms/batch 397.3 | tok/s  123705 | loss  3.18 | ppl     24.14
| epoch  18 step    37230 | batches   1513 / 2101 | lr 1.112e-03 | ms/batch 397.1 | tok/s  123765 | loss  3.18 | ppl     24.07
| epoch  18 step    37240 | batches   1523 / 2101 | lr 1.111e-03 | ms/batch 396.8 | tok/s  123878 | loss  3.21 | ppl     24.75
| epoch  18 step    37250 | batches   1533 / 2101 | lr 1.110e-03 | ms/batch 398.3 | tok/s  123404 | loss  3.19 | ppl     24.21
| epoch  18 step    37260 | batches   1543 / 2101 | lr 1.109e-03 | ms/batch 397.9 | tok/s  123539 | loss  3.18 | ppl     23.95
| epoch  18 step    37270 | batches   1553 / 2101 | lr 1.108e-03 | ms/batch 397.0 | tok/s  123797 | loss  3.13 | ppl     22.98
| epoch  18 step    37280 | batches   1563 / 2101 | lr 1.108e-03 | ms/batch 397.7 | tok/s  123600 | loss  3.17 | ppl     23.85
| epoch  18 step    37290 | batches   1573 / 2101 | lr 1.107e-03 | ms/batch 398.0 | tok/s  123512 | loss  3.15 | ppl     23.40
| epoch  18 step    37300 | batches   1583 / 2101 | lr 1.106e-03 | ms/batch 396.8 | tok/s  123865 | loss  3.14 | ppl     23.04
| epoch  18 step    37310 | batches   1593 / 2101 | lr 1.105e-03 | ms/batch 397.4 | tok/s  123700 | loss  3.18 | ppl     23.98
| epoch  18 step    37320 | batches   1603 / 2101 | lr 1.104e-03 | ms/batch 398.1 | tok/s  123460 | loss  3.15 | ppl     23.43
| epoch  18 step    37330 | batches   1613 / 2101 | lr 1.104e-03 | ms/batch 397.9 | tok/s  123541 | loss  3.16 | ppl     23.60
| epoch  18 step    37340 | batches   1623 / 2101 | lr 1.103e-03 | ms/batch 398.0 | tok/s  123501 | loss  3.19 | ppl     24.20
| epoch  18 step    37350 | batches   1633 / 2101 | lr 1.102e-03 | ms/batch 397.5 | tok/s  123646 | loss  3.16 | ppl     23.54
| epoch  18 step    37360 | batches   1643 / 2101 | lr 1.101e-03 | ms/batch 397.6 | tok/s  123623 | loss  3.13 | ppl     22.88
| epoch  18 step    37370 | batches   1653 / 2101 | lr 1.101e-03 | ms/batch 397.5 | tok/s  123651 | loss  3.14 | ppl     23.06
| epoch  18 step    37380 | batches   1663 / 2101 | lr 1.100e-03 | ms/batch 398.7 | tok/s  123287 | loss  3.14 | ppl     23.02
| epoch  18 step    37390 | batches   1673 / 2101 | lr 1.099e-03 | ms/batch 397.3 | tok/s  123724 | loss  3.14 | ppl     23.16
| epoch  18 step    37400 | batches   1683 / 2101 | lr 1.098e-03 | ms/batch 397.3 | tok/s  123712 | loss  3.11 | ppl     22.37
| epoch  18 step    37410 | batches   1693 / 2101 | lr 1.098e-03 | ms/batch 397.3 | tok/s  123731 | loss  3.14 | ppl     23.03
| epoch  18 step    37420 | batches   1703 / 2101 | lr 1.097e-03 | ms/batch 398.1 | tok/s  123463 | loss  3.14 | ppl     23.03
| epoch  18 step    37430 | batches   1713 / 2101 | lr 1.096e-03 | ms/batch 398.5 | tok/s  123342 | loss  3.13 | ppl     22.92
| epoch  18 step    37440 | batches   1723 / 2101 | lr 1.095e-03 | ms/batch 398.7 | tok/s  123287 | loss  3.15 | ppl     23.25
| epoch  18 step    37450 | batches   1733 / 2101 | lr 1.095e-03 | ms/batch 397.5 | tok/s  123659 | loss  3.10 | ppl     22.27
| epoch  18 step    37460 | batches   1743 / 2101 | lr 1.094e-03 | ms/batch 397.2 | tok/s  123761 | loss  3.13 | ppl     22.98
| epoch  18 step    37470 | batches   1753 / 2101 | lr 1.093e-03 | ms/batch 397.4 | tok/s  123675 | loss  3.14 | ppl     23.17
| epoch  18 step    37480 | batches   1763 / 2101 | lr 1.092e-03 | ms/batch 398.2 | tok/s  123449 | loss  3.14 | ppl     23.10
| epoch  18 step    37490 | batches   1773 / 2101 | lr 1.092e-03 | ms/batch 398.4 | tok/s  123386 | loss  3.15 | ppl     23.40
| epoch  18 step    37500 | batches   1783 / 2101 | lr 1.091e-03 | ms/batch 399.1 | tok/s  123159 | loss  3.15 | ppl     23.40
----------------------------------------------------------------------------------------------------
| Eval  75 at step    37500 | time:  0.83s | valid loss  3.15 | valid ppl    23.272
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  18 step    37510 | batches   1793 / 2101 | lr 1.090e-03 | ms/batch 400.7 | tok/s  122676 | loss  3.16 | ppl     23.62
| epoch  18 step    37520 | batches   1803 / 2101 | lr 1.089e-03 | ms/batch 411.8 | tok/s  119374 | loss  3.16 | ppl     23.54
| epoch  18 step    37530 | batches   1813 / 2101 | lr 1.089e-03 | ms/batch 418.8 | tok/s  117351 | loss  3.17 | ppl     23.86
| epoch  18 step    37540 | batches   1823 / 2101 | lr 1.088e-03 | ms/batch 409.3 | tok/s  120100 | loss  3.14 | ppl     23.21
| epoch  18 step    37550 | batches   1833 / 2101 | lr 1.087e-03 | ms/batch 398.0 | tok/s  123497 | loss  3.16 | ppl     23.46
| epoch  18 step    37560 | batches   1843 / 2101 | lr 1.087e-03 | ms/batch 408.7 | tok/s  120259 | loss  3.16 | ppl     23.51
| epoch  18 step    37570 | batches   1853 / 2101 | lr 1.086e-03 | ms/batch 408.4 | tok/s  120368 | loss  3.16 | ppl     23.68
| epoch  18 step    37580 | batches   1863 / 2101 | lr 1.085e-03 | ms/batch 408.6 | tok/s  120280 | loss  3.15 | ppl     23.42
| epoch  18 step    37590 | batches   1873 / 2101 | lr 1.085e-03 | ms/batch 398.4 | tok/s  123381 | loss  3.19 | ppl     24.23
| epoch  18 step    37600 | batches   1883 / 2101 | lr 1.084e-03 | ms/batch 408.8 | tok/s  120230 | loss  3.17 | ppl     23.92
| epoch  18 step    37610 | batches   1893 / 2101 | lr 1.083e-03 | ms/batch 409.4 | tok/s  120046 | loss  3.13 | ppl     22.85
| epoch  18 step    37620 | batches   1903 / 2101 | lr 1.082e-03 | ms/batch 397.2 | tok/s  123739 | loss  3.16 | ppl     23.50
| epoch  18 step    37630 | batches   1913 / 2101 | lr 1.082e-03 | ms/batch 409.7 | tok/s  119977 | loss  3.16 | ppl     23.46
| epoch  18 step    37640 | batches   1923 / 2101 | lr 1.081e-03 | ms/batch 398.0 | tok/s  123498 | loss  3.17 | ppl     23.70
| epoch  18 step    37650 | batches   1933 / 2101 | lr 1.080e-03 | ms/batch 397.4 | tok/s  123696 | loss  3.13 | ppl     22.96
| epoch  18 step    37660 | batches   1943 / 2101 | lr 1.080e-03 | ms/batch 397.3 | tok/s  123728 | loss  3.15 | ppl     23.22
| epoch  18 step    37670 | batches   1953 / 2101 | lr 1.079e-03 | ms/batch 397.5 | tok/s  123653 | loss  3.16 | ppl     23.54
| epoch  18 step    37680 | batches   1963 / 2101 | lr 1.078e-03 | ms/batch 397.3 | tok/s  123713 | loss  3.15 | ppl     23.42
| epoch  18 step    37690 | batches   1973 / 2101 | lr 1.078e-03 | ms/batch 409.0 | tok/s  120163 | loss  3.14 | ppl     23.11
| epoch  18 step    37700 | batches   1983 / 2101 | lr 1.077e-03 | ms/batch 408.3 | tok/s  120390 | loss  3.17 | ppl     23.70
| epoch  18 step    37710 | batches   1993 / 2101 | lr 1.076e-03 | ms/batch 408.7 | tok/s  120258 | loss  3.17 | ppl     23.91
| epoch  18 step    37720 | batches   2003 / 2101 | lr 1.076e-03 | ms/batch 399.4 | tok/s  123064 | loss  3.14 | ppl     23.17
| epoch  18 step    37730 | batches   2013 / 2101 | lr 1.075e-03 | ms/batch 408.9 | tok/s  120201 | loss  3.15 | ppl     23.41
| epoch  18 step    37740 | batches   2023 / 2101 | lr 1.074e-03 | ms/batch 398.2 | tok/s  123428 | loss  3.18 | ppl     23.94
| epoch  18 step    37750 | batches   2033 / 2101 | lr 1.074e-03 | ms/batch 398.0 | tok/s  123486 | loss  3.18 | ppl     23.97
| epoch  18 step    37760 | batches   2043 / 2101 | lr 1.073e-03 | ms/batch 397.9 | tok/s  123516 | loss  3.18 | ppl     23.99
| epoch  18 step    37770 | batches   2053 / 2101 | lr 1.072e-03 | ms/batch 397.4 | tok/s  123693 | loss  3.16 | ppl     23.46
| epoch  18 step    37780 | batches   2063 / 2101 | lr 1.072e-03 | ms/batch 397.2 | tok/s  123761 | loss  3.14 | ppl     23.08
| epoch  18 step    37790 | batches   2073 / 2101 | lr 1.071e-03 | ms/batch 397.0 | tok/s  123825 | loss  3.13 | ppl     22.88
| epoch  18 step    37800 | batches   2083 / 2101 | lr 1.070e-03 | ms/batch 397.6 | tok/s  123633 | loss  3.14 | ppl     23.22
| epoch  18 step    37810 | batches   2093 / 2101 | lr 1.070e-03 | ms/batch 408.4 | tok/s  120365 | loss  3.13 | ppl     22.77
| epoch  19 step    37820 | batches      2 / 2101 | lr 1.069e-03 | ms/batch 400.9 | tok/s  123273 | loss  3.49 | ppl     32.90
| epoch  19 step    37830 | batches     12 / 2101 | lr 1.069e-03 | ms/batch 408.0 | tok/s  120465 | loss  3.15 | ppl     23.30
| epoch  19 step    37840 | batches     22 / 2101 | lr 1.068e-03 | ms/batch 397.1 | tok/s  123786 | loss  3.12 | ppl     22.69
| epoch  19 step    37850 | batches     32 / 2101 | lr 1.067e-03 | ms/batch 397.3 | tok/s  123718 | loss  3.15 | ppl     23.43
| epoch  19 step    37860 | batches     42 / 2101 | lr 1.067e-03 | ms/batch 397.4 | tok/s  123686 | loss  3.15 | ppl     23.34
| epoch  19 step    37870 | batches     52 / 2101 | lr 1.066e-03 | ms/batch 397.3 | tok/s  123708 | loss  3.13 | ppl     22.91
| epoch  19 step    37880 | batches     62 / 2101 | lr 1.065e-03 | ms/batch 397.3 | tok/s  123724 | loss  3.15 | ppl     23.25
| epoch  19 step    37890 | batches     72 / 2101 | lr 1.065e-03 | ms/batch 397.7 | tok/s  123588 | loss  3.11 | ppl     22.50
| epoch  19 step    37900 | batches     82 / 2101 | lr 1.064e-03 | ms/batch 397.0 | tok/s  123819 | loss  3.10 | ppl     22.21
| epoch  19 step    37910 | batches     92 / 2101 | lr 1.064e-03 | ms/batch 397.7 | tok/s  123588 | loss  3.12 | ppl     22.54
| epoch  19 step    37920 | batches    102 / 2101 | lr 1.063e-03 | ms/batch 398.3 | tok/s  123402 | loss  3.11 | ppl     22.34
| epoch  19 step    37930 | batches    112 / 2101 | lr 1.062e-03 | ms/batch 397.6 | tok/s  123631 | loss  3.11 | ppl     22.43
| epoch  19 step    37940 | batches    122 / 2101 | lr 1.062e-03 | ms/batch 397.1 | tok/s  123774 | loss  3.11 | ppl     22.32
| epoch  19 step    37950 | batches    132 / 2101 | lr 1.061e-03 | ms/batch 397.1 | tok/s  123770 | loss  3.14 | ppl     23.05
| epoch  19 step    37960 | batches    142 / 2101 | lr 1.061e-03 | ms/batch 396.7 | tok/s  123896 | loss  3.12 | ppl     22.67
| epoch  19 step    37970 | batches    152 / 2101 | lr 1.060e-03 | ms/batch 397.0 | tok/s  123799 | loss  3.14 | ppl     23.13
| epoch  19 step    37980 | batches    162 / 2101 | lr 1.059e-03 | ms/batch 399.0 | tok/s  123191 | loss  3.17 | ppl     23.76
| epoch  19 step    37990 | batches    172 / 2101 | lr 1.059e-03 | ms/batch 397.7 | tok/s  123602 | loss  3.12 | ppl     22.70
| epoch  19 step    38000 | batches    182 / 2101 | lr 1.058e-03 | ms/batch 410.8 | tok/s  119643 | loss  3.10 | ppl     22.25
----------------------------------------------------------------------------------------------------
| Eval  76 at step    38000 | time:  0.82s | valid loss  3.15 | valid ppl    23.291
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
ratio list [0.031616886191965954, 0.03088446451550086, 0.027904263976945377, 0.029552700631343392, 0.028930783735523113, 0.03209896139214721, 0.03005379648889228, 0.03712320342792114, 0.028332482503364193, 0.02741778260905789, 0.03253174414723528, 0.03279658888636419, 0.026526895994183276, 0.03267594946916467, 0.030472776900089846, 0.032014851996663846, 0.03187823518857231, 0.03171943902068999, 0.03133721642378014, 0.029584692035868634, 0.03509684268121599, 0.03246119754404087, 0.023880829672828806, 0.02954131707103472, 0.03068755478040013, 0.03132647016414973, 0.03272606440530372, 0.030996623276938473, 0.030850946686793435, 0.030757599227247683, 0.03366011141866752, 0.0318396770415805, 0.025639374429137104, 0.030030611151272205, 0.031183899521366014, 0.03326601037810652, 0.03262479233554413, 0.025725007525123838, 0.030205829525883843, 0.0309189668739378, 0.033411232158517, 0.032971241529202604, 0.043666956414218284, 0.03149109836846806, 0.03076890016136175, 0.036713890612289204, 0.03206997749891409, 0.038351050358808834, 0.031546464946215394, 0.030266186019086688, 0.03557254023273063, 0.03203574188153975, 0.041716464342713935, 0.02883110350066328, 0.030176262188120525, 0.03193652489254896, 0.03237651308284754, 0.022947812573195617, 0.02952505781565284, 0.03045854700960355, 0.022540330051023086, 0.026425933455245507, 0.0018362653649566984, 0.026158077122626314, 0.02937172928819303, 0.032030649340869854, 0.03207865940962252, 0.025004330863466626, 0.02901456106434309, 0.029751569987243917, 0.0280971941631792, 0.030151001242488627, 0.030531423534987546, 0.02426635988093329, 0.026798157473837295, 0.030217378282501615, 0.030429626746965983, 0.02995167917717707, 0.02506772062582551, 0.028123490628374017, 0.026640147237172885]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [49, 68, 9, 12, 8, 57, 90, 8, 18, 9], [41, 36, 17, 8, 8, 44, 59, 8, 8, 8], [27, 39, 8, 8, 8, 37, 41, 9, 8, 8], [28, 44, 9, 8, 8, 18, 14, 10, 8, 8], [8, 15, 8, 8, 8, 18, 22, 8, 8, 8], [8, 15, 8, 8, 8, 10, 11, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 8, 8, 8], [9, 9, 9, 8, 8, 10, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [49, 68, 9, 12, 8, 57, 90, 8, 18, 9], [41, 36, 17, 8, 8, 44, 59, 8, 8, 8], [27, 39, 8, 8, 8, 37, 41, 9, 8, 8], [28, 44, 9, 8, 8, 18, 14, 10, 8, 8], [8, 15, 8, 8, 8, 18, 22, 8, 8, 8], [8, 15, 8, 8, 8, 10, 11, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 8, 8, 8], [9, 9, 9, 8, 8, 10, 9, 8, 8, 8], [8]]
| epoch  19 step    38010 | batches    192 / 2101 | lr 1.058e-03 | ms/batch 4898.7 | tok/s   10034 | loss  3.14 | ppl     23.16
| epoch  19 step    38020 | batches    202 / 2101 | lr 1.057e-03 | ms/batch 404.1 | tok/s  121633 | loss  3.12 | ppl     22.64
| epoch  19 step    38030 | batches    212 / 2101 | lr 1.057e-03 | ms/batch 394.6 | tok/s  124555 | loss  3.14 | ppl     23.19
| epoch  19 step    38040 | batches    222 / 2101 | lr 1.056e-03 | ms/batch 394.7 | tok/s  124530 | loss  3.13 | ppl     22.95
| epoch  19 step    38050 | batches    232 / 2101 | lr 1.055e-03 | ms/batch 394.9 | tok/s  124464 | loss  3.15 | ppl     23.33
| epoch  19 step    38060 | batches    242 / 2101 | lr 1.055e-03 | ms/batch 395.0 | tok/s  124444 | loss  3.12 | ppl     22.56
| epoch  19 step    38070 | batches    252 / 2101 | lr 1.054e-03 | ms/batch 395.4 | tok/s  124304 | loss  3.10 | ppl     22.11
| epoch  19 step    38080 | batches    262 / 2101 | lr 1.054e-03 | ms/batch 395.9 | tok/s  124144 | loss  3.11 | ppl     22.37
| epoch  19 step    38090 | batches    272 / 2101 | lr 1.053e-03 | ms/batch 395.2 | tok/s  124361 | loss  3.13 | ppl     22.80
| epoch  19 step    38100 | batches    282 / 2101 | lr 1.053e-03 | ms/batch 396.3 | tok/s  124033 | loss  3.14 | ppl     23.21
| epoch  19 step    38110 | batches    292 / 2101 | lr 1.052e-03 | ms/batch 396.1 | tok/s  124081 | loss  3.12 | ppl     22.65
| epoch  19 step    38120 | batches    302 / 2101 | lr 1.052e-03 | ms/batch 407.6 | tok/s  120576 | loss  3.15 | ppl     23.26
| epoch  19 step    38130 | batches    312 / 2101 | lr 1.051e-03 | ms/batch 407.8 | tok/s  120518 | loss  3.10 | ppl     22.20
| epoch  19 step    38140 | batches    322 / 2101 | lr 1.050e-03 | ms/batch 397.1 | tok/s  123767 | loss  3.12 | ppl     22.55
| epoch  19 step    38150 | batches    332 / 2101 | lr 1.050e-03 | ms/batch 407.2 | tok/s  120700 | loss  3.10 | ppl     22.18
| epoch  19 step    38160 | batches    342 / 2101 | lr 1.049e-03 | ms/batch 396.6 | tok/s  123936 | loss  3.07 | ppl     21.64
| epoch  19 step    38170 | batches    352 / 2101 | lr 1.049e-03 | ms/batch 396.5 | tok/s  123982 | loss  3.10 | ppl     22.30
| epoch  19 step    38180 | batches    362 / 2101 | lr 1.048e-03 | ms/batch 398.6 | tok/s  123314 | loss  3.14 | ppl     23.13
| epoch  19 step    38190 | batches    372 / 2101 | lr 1.048e-03 | ms/batch 407.3 | tok/s  120667 | loss  3.17 | ppl     23.75
| epoch  19 step    38200 | batches    382 / 2101 | lr 1.047e-03 | ms/batch 396.8 | tok/s  123868 | loss  3.12 | ppl     22.70
| epoch  19 step    38210 | batches    392 / 2101 | lr 1.047e-03 | ms/batch 396.5 | tok/s  123976 | loss  3.08 | ppl     21.79
| epoch  19 step    38220 | batches    402 / 2101 | lr 1.046e-03 | ms/batch 396.9 | tok/s  123827 | loss  3.16 | ppl     23.59
| epoch  19 step    38230 | batches    412 / 2101 | lr 1.046e-03 | ms/batch 396.5 | tok/s  123956 | loss  3.15 | ppl     23.35
| epoch  19 step    38240 | batches    422 / 2101 | lr 1.045e-03 | ms/batch 396.1 | tok/s  124103 | loss  3.12 | ppl     22.58
| epoch  19 step    38250 | batches    432 / 2101 | lr 1.045e-03 | ms/batch 396.7 | tok/s  123908 | loss  3.14 | ppl     23.05
| epoch  19 step    38260 | batches    442 / 2101 | lr 1.044e-03 | ms/batch 396.5 | tok/s  123967 | loss  3.14 | ppl     23.14
| epoch  19 step    38270 | batches    452 / 2101 | lr 1.044e-03 | ms/batch 397.3 | tok/s  123725 | loss  3.11 | ppl     22.37
| epoch  19 step    38280 | batches    462 / 2101 | lr 1.043e-03 | ms/batch 397.0 | tok/s  123797 | loss  3.11 | ppl     22.49
| epoch  19 step    38290 | batches    472 / 2101 | lr 1.043e-03 | ms/batch 397.1 | tok/s  123778 | loss  3.14 | ppl     23.07
| epoch  19 step    38300 | batches    482 / 2101 | lr 1.042e-03 | ms/batch 397.6 | tok/s  123637 | loss  3.12 | ppl     22.60
| epoch  19 step    38310 | batches    492 / 2101 | lr 1.042e-03 | ms/batch 397.1 | tok/s  123764 | loss  3.12 | ppl     22.74
| epoch  19 step    38320 | batches    502 / 2101 | lr 1.041e-03 | ms/batch 396.9 | tok/s  123833 | loss  3.10 | ppl     22.12
| epoch  19 step    38330 | batches    512 / 2101 | lr 1.041e-03 | ms/batch 396.8 | tok/s  123877 | loss  3.13 | ppl     22.84
| epoch  19 step    38340 | batches    522 / 2101 | lr 1.040e-03 | ms/batch 396.9 | tok/s  123838 | loss  3.12 | ppl     22.66
| epoch  19 step    38350 | batches    532 / 2101 | lr 1.040e-03 | ms/batch 396.6 | tok/s  123923 | loss  3.11 | ppl     22.39
| epoch  19 step    38360 | batches    542 / 2101 | lr 1.039e-03 | ms/batch 396.5 | tok/s  123976 | loss  3.09 | ppl     22.00
| epoch  19 step    38370 | batches    552 / 2101 | lr 1.039e-03 | ms/batch 406.6 | tok/s  120880 | loss  3.08 | ppl     21.66
| epoch  19 step    38380 | batches    562 / 2101 | lr 1.038e-03 | ms/batch 406.9 | tok/s  120786 | loss  3.10 | ppl     22.27
| epoch  19 step    38390 | batches    572 / 2101 | lr 1.038e-03 | ms/batch 397.9 | tok/s  123543 | loss  3.11 | ppl     22.35
| epoch  19 step    38400 | batches    582 / 2101 | lr 1.037e-03 | ms/batch 396.8 | tok/s  123887 | loss  3.11 | ppl     22.43
| epoch  19 step    38410 | batches    592 / 2101 | lr 1.037e-03 | ms/batch 396.8 | tok/s  123884 | loss  3.10 | ppl     22.09
| epoch  19 step    38420 | batches    602 / 2101 | lr 1.036e-03 | ms/batch 408.5 | tok/s  120332 | loss  3.13 | ppl     22.85
| epoch  19 step    38430 | batches    612 / 2101 | lr 1.036e-03 | ms/batch 397.3 | tok/s  123727 | loss  3.12 | ppl     22.75
| epoch  19 step    38440 | batches    622 / 2101 | lr 1.035e-03 | ms/batch 409.3 | tok/s  120081 | loss  3.13 | ppl     22.91
| epoch  19 step    38450 | batches    632 / 2101 | lr 1.035e-03 | ms/batch 397.6 | tok/s  123624 | loss  3.13 | ppl     22.77
| epoch  19 step    38460 | batches    642 / 2101 | lr 1.035e-03 | ms/batch 396.9 | tok/s  123842 | loss  3.12 | ppl     22.66
| epoch  19 step    38470 | batches    652 / 2101 | lr 1.034e-03 | ms/batch 397.0 | tok/s  123805 | loss  3.10 | ppl     22.28
| epoch  19 step    38480 | batches    662 / 2101 | lr 1.034e-03 | ms/batch 396.2 | tok/s  124053 | loss  3.11 | ppl     22.42
| epoch  19 step    38490 | batches    672 / 2101 | lr 1.033e-03 | ms/batch 396.6 | tok/s  123937 | loss  3.16 | ppl     23.65
| epoch  19 step    38500 | batches    682 / 2101 | lr 1.033e-03 | ms/batch 396.6 | tok/s  123933 | loss  3.12 | ppl     22.68
----------------------------------------------------------------------------------------------------
| Eval  77 at step    38500 | time:  0.81s | valid loss  3.15 | valid ppl    23.244
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  19 step    38510 | batches    692 / 2101 | lr 1.032e-03 | ms/batch 398.9 | tok/s  123228 | loss  3.16 | ppl     23.46
| epoch  19 step    38520 | batches    702 / 2101 | lr 1.032e-03 | ms/batch 424.2 | tok/s  115882 | loss  3.14 | ppl     23.04
| epoch  19 step    38530 | batches    712 / 2101 | lr 1.032e-03 | ms/batch 408.0 | tok/s  120485 | loss  3.14 | ppl     23.05
| epoch  19 step    38540 | batches    722 / 2101 | lr 1.031e-03 | ms/batch 397.4 | tok/s  123694 | loss  3.14 | ppl     23.07
| epoch  19 step    38550 | batches    732 / 2101 | lr 1.031e-03 | ms/batch 397.0 | tok/s  123805 | loss  3.12 | ppl     22.53
| epoch  19 step    38560 | batches    742 / 2101 | lr 1.030e-03 | ms/batch 397.6 | tok/s  123625 | loss  3.12 | ppl     22.75
| epoch  19 step    38570 | batches    752 / 2101 | lr 1.030e-03 | ms/batch 397.7 | tok/s  123593 | loss  3.13 | ppl     22.88
| epoch  19 step    38580 | batches    762 / 2101 | lr 1.029e-03 | ms/batch 397.0 | tok/s  123823 | loss  3.12 | ppl     22.70
| epoch  19 step    38590 | batches    772 / 2101 | lr 1.029e-03 | ms/batch 397.0 | tok/s  123813 | loss  3.09 | ppl     21.93
| epoch  19 step    38600 | batches    782 / 2101 | lr 1.029e-03 | ms/batch 397.2 | tok/s  123746 | loss  3.09 | ppl     21.89
| epoch  19 step    38610 | batches    792 / 2101 | lr 1.028e-03 | ms/batch 397.1 | tok/s  123773 | loss  3.14 | ppl     23.03
| epoch  19 step    38620 | batches    802 / 2101 | lr 1.028e-03 | ms/batch 397.3 | tok/s  123709 | loss  3.16 | ppl     23.47
| epoch  19 step    38630 | batches    812 / 2101 | lr 1.027e-03 | ms/batch 407.5 | tok/s  120609 | loss  3.18 | ppl     23.97
| epoch  19 step    38640 | batches    822 / 2101 | lr 1.027e-03 | ms/batch 396.8 | tok/s  123883 | loss  3.14 | ppl     23.01
| epoch  19 step    38650 | batches    832 / 2101 | lr 1.027e-03 | ms/batch 409.2 | tok/s  120130 | loss  3.11 | ppl     22.49
| epoch  19 step    38660 | batches    842 / 2101 | lr 1.026e-03 | ms/batch 397.1 | tok/s  123788 | loss  3.11 | ppl     22.38
| epoch  19 step    38670 | batches    852 / 2101 | lr 1.026e-03 | ms/batch 397.6 | tok/s  123624 | loss  3.13 | ppl     22.85
| epoch  19 step    38680 | batches    862 / 2101 | lr 1.025e-03 | ms/batch 397.6 | tok/s  123627 | loss  3.16 | ppl     23.48
| epoch  19 step    38690 | batches    872 / 2101 | lr 1.025e-03 | ms/batch 397.6 | tok/s  123626 | loss  3.19 | ppl     24.22
| epoch  19 step    38700 | batches    882 / 2101 | lr 1.025e-03 | ms/batch 398.2 | tok/s  123449 | loss  3.19 | ppl     24.30
| epoch  19 step    38710 | batches    892 / 2101 | lr 1.024e-03 | ms/batch 397.7 | tok/s  123586 | loss  3.17 | ppl     23.82
| epoch  19 step    38720 | batches    902 / 2101 | lr 1.024e-03 | ms/batch 397.4 | tok/s  123687 | loss  3.17 | ppl     23.86
| epoch  19 step    38730 | batches    912 / 2101 | lr 1.024e-03 | ms/batch 398.0 | tok/s  123500 | loss  3.16 | ppl     23.53
| epoch  19 step    38740 | batches    922 / 2101 | lr 1.023e-03 | ms/batch 408.3 | tok/s  120371 | loss  3.14 | ppl     23.12
| epoch  19 step    38750 | batches    932 / 2101 | lr 1.023e-03 | ms/batch 408.6 | tok/s  120301 | loss  3.13 | ppl     22.95
| epoch  19 step    38760 | batches    942 / 2101 | lr 1.022e-03 | ms/batch 397.9 | tok/s  123516 | loss  3.14 | ppl     23.01
| epoch  19 step    38770 | batches    952 / 2101 | lr 1.022e-03 | ms/batch 398.3 | tok/s  123396 | loss  3.16 | ppl     23.58
| epoch  19 step    38780 | batches    962 / 2101 | lr 1.022e-03 | ms/batch 397.2 | tok/s  123746 | loss  3.16 | ppl     23.55
| epoch  19 step    38790 | batches    972 / 2101 | lr 1.021e-03 | ms/batch 398.3 | tok/s  123416 | loss  3.14 | ppl     23.06
| epoch  19 step    38800 | batches    982 / 2101 | lr 1.021e-03 | ms/batch 398.6 | tok/s  123317 | loss  3.14 | ppl     23.16
| epoch  19 step    38810 | batches    992 / 2101 | lr 1.021e-03 | ms/batch 398.4 | tok/s  123361 | loss  3.15 | ppl     23.27
| epoch  19 step    38820 | batches   1002 / 2101 | lr 1.020e-03 | ms/batch 397.7 | tok/s  123599 | loss  3.15 | ppl     23.37
| epoch  19 step    38830 | batches   1012 / 2101 | lr 1.020e-03 | ms/batch 397.6 | tok/s  123628 | loss  3.13 | ppl     22.87
| epoch  19 step    38840 | batches   1022 / 2101 | lr 1.020e-03 | ms/batch 398.2 | tok/s  123436 | loss  3.16 | ppl     23.55
| epoch  19 step    38850 | batches   1032 / 2101 | lr 1.019e-03 | ms/batch 399.3 | tok/s  123104 | loss  3.15 | ppl     23.39
| epoch  19 step    38860 | batches   1042 / 2101 | lr 1.019e-03 | ms/batch 398.0 | tok/s  123487 | loss  3.12 | ppl     22.75
| epoch  19 step    38870 | batches   1052 / 2101 | lr 1.019e-03 | ms/batch 398.6 | tok/s  123307 | loss  3.17 | ppl     23.87
| epoch  19 step    38880 | batches   1062 / 2101 | lr 1.018e-03 | ms/batch 398.4 | tok/s  123359 | loss  3.18 | ppl     23.99
| epoch  19 step    38890 | batches   1072 / 2101 | lr 1.018e-03 | ms/batch 398.1 | tok/s  123478 | loss  3.16 | ppl     23.55
| epoch  19 step    38900 | batches   1082 / 2101 | lr 1.018e-03 | ms/batch 398.0 | tok/s  123502 | loss  3.15 | ppl     23.44
| epoch  19 step    38910 | batches   1092 / 2101 | lr 1.017e-03 | ms/batch 398.0 | tok/s  123500 | loss  3.17 | ppl     23.70
| epoch  19 step    38920 | batches   1102 / 2101 | lr 1.017e-03 | ms/batch 397.8 | tok/s  123552 | loss  3.15 | ppl     23.30
| epoch  19 step    38930 | batches   1112 / 2101 | lr 1.017e-03 | ms/batch 398.2 | tok/s  123438 | loss  3.14 | ppl     23.06
| epoch  19 step    38940 | batches   1122 / 2101 | lr 1.016e-03 | ms/batch 397.6 | tok/s  123619 | loss  3.10 | ppl     22.18
| epoch  19 step    38950 | batches   1132 / 2101 | lr 1.016e-03 | ms/batch 397.7 | tok/s  123581 | loss  3.09 | ppl     21.98
| epoch  19 step    38960 | batches   1142 / 2101 | lr 1.016e-03 | ms/batch 397.6 | tok/s  123630 | loss  3.11 | ppl     22.39
| epoch  19 step    38970 | batches   1152 / 2101 | lr 1.015e-03 | ms/batch 397.7 | tok/s  123590 | loss  3.12 | ppl     22.75
| epoch  19 step    38980 | batches   1162 / 2101 | lr 1.015e-03 | ms/batch 398.2 | tok/s  123430 | loss  3.15 | ppl     23.39
| epoch  19 step    38990 | batches   1172 / 2101 | lr 1.015e-03 | ms/batch 398.0 | tok/s  123491 | loss  3.11 | ppl     22.37
| epoch  19 step    39000 | batches   1182 / 2101 | lr 1.015e-03 | ms/batch 412.3 | tok/s  119217 | loss  3.13 | ppl     22.87
----------------------------------------------------------------------------------------------------
| Eval  78 at step    39000 | time:  0.83s | valid loss  3.15 | valid ppl    23.271
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
ratio list [0.03207991244066949, 0.030322362204055302, 0.033147955543131685, 0.029177176847321285, 0.028476584439762174, 0.03148400099747771, 0.029493963906018016, 0.03139297598504952, 0.028332410295275015, 0.02695691123758048, 0.030275288893092056, 0.032556459471839175, 0.028045980140900876, 0.032994808330219574, 0.030135896000491467, 0.03170665942492098, 0.030739134321852195, 0.03216975521690148, 0.030827640493408814, 0.029481866825828828, 0.03330554196529533, 0.03301039152022835, 0.03366071302804502, 0.030812234685758937, 0.030532019279417212, 0.032813761890006926, 0.033009887140716905, 0.03764627547892663, 0.03300034613951708, 0.03050316469350146, 0.03324035230613383, 0.03139656548317692, 0.041022804794368664, 0.029476006880440532, 0.030908817457294655, 0.034023176486976885, 0.03281345282445583, 0.02877985662367881, 0.02952863885826236, 0.03043480319626064, 0.032961430936912214, 0.032376056411071885, 0.0384001027780344, 0.030451865048723777, 0.03041940187236513, 0.03396032153504436, 0.03244608038539985, 0.035643714481449325, 0.02844351193374686, 0.030048668338010134, 0.03401567367744829, 0.031189822257122742, 0.03370011574018141, 0.029282349852846078, 0.030184402828493648, 0.033750748673206946, 0.03337685708180437, 0.02734781257845424, 0.03200947399233205, 0.030009518383741798, 0.029839163644136576, 0.027140430391092502, 0.0018674591188840713, 0.026833720481492504, 0.029546050418722176, 0.030944427651804378, 0.031902722196373356, 0.022177280085223607, 0.027797122934336237, 0.030076112890758, 0.030257043728130924, 0.030201964793659653, 0.034284069035737136, 0.024216000926014884, 0.027654487081119623, 0.03242256459048198, 0.03156955433605987, 0.024789701785625885, 0.02514646205675651, 0.02900020842185119, 0.026601700655437266]
accordion ranks [[], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16, 16, 16, 16, 16, 16, 16, 16, 16, 16], [16]]
optimal compression parameters =  [[], [51, 59, 9, 14, 9, 59, 90, 8, 15, 9], [38, 33, 14, 8, 8, 49, 49, 9, 8, 8], [29, 38, 8, 8, 8, 41, 40, 9, 8, 9], [25, 43, 9, 8, 8, 17, 10, 10, 8, 8], [10, 14, 8, 8, 8, 14, 18, 9, 8, 8], [9, 14, 8, 8, 8, 8, 14, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 8, 8, 8], [9, 9, 9, 8, 8, 10, 9, 8, 8, 8], [8]]
optimal compression parameters =  [[], [51, 59, 9, 14, 9, 59, 90, 8, 15, 9], [38, 33, 14, 8, 8, 49, 49, 9, 8, 8], [29, 38, 8, 8, 8, 41, 40, 9, 8, 9], [25, 43, 9, 8, 8, 17, 10, 10, 8, 8], [10, 14, 8, 8, 8, 14, 18, 9, 8, 8], [9, 14, 8, 8, 8, 8, 14, 8, 8, 8], [8, 8, 8, 8, 8, 8, 9, 8, 8, 8], [9, 9, 9, 8, 8, 10, 9, 8, 8, 8], [8]]
| epoch  19 step    39010 | batches   1192 / 2101 | lr 1.014e-03 | ms/batch 4889.0 | tok/s   10054 | loss  3.13 | ppl     22.82
| epoch  19 step    39020 | batches   1202 / 2101 | lr 1.014e-03 | ms/batch 406.9 | tok/s  120785 | loss  3.13 | ppl     22.94
| epoch  19 step    39030 | batches   1212 / 2101 | lr 1.014e-03 | ms/batch 405.5 | tok/s  121204 | loss  3.15 | ppl     23.23
| epoch  19 step    39040 | batches   1222 / 2101 | lr 1.013e-03 | ms/batch 395.9 | tok/s  124144 | loss  3.14 | ppl     23.11
| epoch  19 step    39050 | batches   1232 / 2101 | lr 1.013e-03 | ms/batch 417.1 | tok/s  117854 | loss  3.15 | ppl     23.34
| epoch  19 step    39060 | batches   1242 / 2101 | lr 1.013e-03 | ms/batch 396.7 | tok/s  123911 | loss  3.15 | ppl     23.45
| epoch  19 step    39070 | batches   1252 / 2101 | lr 1.013e-03 | ms/batch 405.8 | tok/s  121123 | loss  3.17 | ppl     23.84
| epoch  19 step    39080 | batches   1262 / 2101 | lr 1.012e-03 | ms/batch 406.2 | tok/s  121003 | loss  3.12 | ppl     22.56
| epoch  19 step    39090 | batches   1272 / 2101 | lr 1.012e-03 | ms/batch 396.7 | tok/s  123906 | loss  3.12 | ppl     22.71
| epoch  19 step    39100 | batches   1282 / 2101 | lr 1.012e-03 | ms/batch 397.4 | tok/s  123695 | loss  3.12 | ppl     22.66
| epoch  19 step    39110 | batches   1292 / 2101 | lr 1.012e-03 | ms/batch 396.4 | tok/s  124007 | loss  3.12 | ppl     22.69
| epoch  19 step    39120 | batches   1302 / 2101 | lr 1.011e-03 | ms/batch 396.3 | tok/s  124026 | loss  3.13 | ppl     22.94
| epoch  19 step    39130 | batches   1312 / 2101 | lr 1.011e-03 | ms/batch 396.7 | tok/s  123901 | loss  3.14 | ppl     22.99
| epoch  19 step    39140 | batches   1322 / 2101 | lr 1.011e-03 | ms/batch 397.0 | tok/s  123809 | loss  3.18 | ppl     24.05
| epoch  19 step    39150 | batches   1332 / 2101 | lr 1.011e-03 | ms/batch 397.4 | tok/s  123694 | loss  3.16 | ppl     23.51
| epoch  19 step    39160 | batches   1342 / 2101 | lr 1.010e-03 | ms/batch 397.0 | tok/s  123801 | loss  3.18 | ppl     24.10
| epoch  19 step    39170 | batches   1352 / 2101 | lr 1.010e-03 | ms/batch 397.7 | tok/s  123600 | loss  3.16 | ppl     23.64
| epoch  19 step    39180 | batches   1362 / 2101 | lr 1.010e-03 | ms/batch 397.2 | tok/s  123750 | loss  3.16 | ppl     23.53
| epoch  19 step    39190 | batches   1372 / 2101 | lr 1.010e-03 | ms/batch 397.0 | tok/s  123806 | loss  3.15 | ppl     23.38
| epoch  19 step    39200 | batches   1382 / 2101 | lr 1.009e-03 | ms/batch 397.5 | tok/s  123652 | loss  3.17 | ppl     23.70
| epoch  19 step    39210 | batches   1392 / 2101 | lr 1.009e-03 | ms/batch 398.6 | tok/s  123325 | loss  3.20 | ppl     24.55
| epoch  19 step    39220 | batches   1402 / 2101 | lr 1.009e-03 | ms/batch 398.0 | tok/s  123502 | loss  3.18 | ppl     24.14
| epoch  19 step    39230 | batches   1412 / 2101 | lr 1.009e-03 | ms/batch 397.9 | tok/s  123542 | loss  3.17 | ppl     23.71
| epoch  19 step    39240 | batches   1422 / 2101 | lr 1.008e-03 | ms/batch 397.6 | tok/s  123629 | loss  3.14 | ppl     23.19
| epoch  19 step    39250 | batches   1432 / 2101 | lr 1.008e-03 | ms/batch 397.4 | tok/s  123689 | loss  3.15 | ppl     23.38
| epoch  19 step    39260 | batches   1442 / 2101 | lr 1.008e-03 | ms/batch 397.3 | tok/s  123721 | loss  3.15 | ppl     23.31
| epoch  19 step    39270 | batches   1452 / 2101 | lr 1.008e-03 | ms/batch 397.1 | tok/s  123773 | loss  3.16 | ppl     23.56
| epoch  19 step    39280 | batches   1462 / 2101 | lr 1.008e-03 | ms/batch 397.5 | tok/s  123664 | loss  3.18 | ppl     24.11
| epoch  19 step    39290 | batches   1472 / 2101 | lr 1.007e-03 | ms/batch 397.7 | tok/s  123587 | loss  3.18 | ppl     24.08
| epoch  19 step    39300 | batches   1482 / 2101 | lr 1.007e-03 | ms/batch 397.1 | tok/s  123773 | loss  3.16 | ppl     23.67
| epoch  19 step    39310 | batches   1492 / 2101 | lr 1.007e-03 | ms/batch 397.3 | tok/s  123707 | loss  3.15 | ppl     23.39
| epoch  19 step    39320 | batches   1502 / 2101 | lr 1.007e-03 | ms/batch 397.6 | tok/s  123631 | loss  3.17 | ppl     23.74
| epoch  19 step    39330 | batches   1512 / 2101 | lr 1.007e-03 | ms/batch 397.5 | tok/s  123647 | loss  3.16 | ppl     23.51
| epoch  19 step    39340 | batches   1522 / 2101 | lr 1.006e-03 | ms/batch 397.7 | tok/s  123585 | loss  3.11 | ppl     22.48
| epoch  19 step    39350 | batches   1532 / 2101 | lr 1.006e-03 | ms/batch 397.2 | tok/s  123736 | loss  3.15 | ppl     23.23
| epoch  19 step    39360 | batches   1542 / 2101 | lr 1.006e-03 | ms/batch 397.3 | tok/s  123704 | loss  3.14 | ppl     23.13
| epoch  19 step    39370 | batches   1552 / 2101 | lr 1.006e-03 | ms/batch 397.6 | tok/s  123638 | loss  3.15 | ppl     23.27
| epoch  19 step    39380 | batches   1562 / 2101 | lr 1.006e-03 | ms/batch 398.0 | tok/s  123510 | loss  3.17 | ppl     23.75
| epoch  19 step    39390 | batches   1572 / 2101 | lr 1.005e-03 | ms/batch 397.7 | tok/s  123599 | loss  3.17 | ppl     23.85
| epoch  19 step    39400 | batches   1582 / 2101 | lr 1.005e-03 | ms/batch 397.3 | tok/s  123726 | loss  3.16 | ppl     23.57
| epoch  19 step    39410 | batches   1592 / 2101 | lr 1.005e-03 | ms/batch 397.5 | tok/s  123653 | loss  3.18 | ppl     23.97
| epoch  19 step    39420 | batches   1602 / 2101 | lr 1.005e-03 | ms/batch 397.2 | tok/s  123734 | loss  3.11 | ppl     22.49
| epoch  19 step    39430 | batches   1612 / 2101 | lr 1.005e-03 | ms/batch 397.5 | tok/s  123653 | loss  3.17 | ppl     23.79
| epoch  19 step    39440 | batches   1622 / 2101 | lr 1.005e-03 | ms/batch 397.9 | tok/s  123521 | loss  3.17 | ppl     23.88
| epoch  19 step    39450 | batches   1632 / 2101 | lr 1.004e-03 | ms/batch 396.9 | tok/s  123850 | loss  3.13 | ppl     22.91
| epoch  19 step    39460 | batches   1642 / 2101 | lr 1.004e-03 | ms/batch 397.6 | tok/s  123617 | loss  3.15 | ppl     23.23
| epoch  19 step    39470 | batches   1652 / 2101 | lr 1.004e-03 | ms/batch 397.1 | tok/s  123769 | loss  3.11 | ppl     22.53
| epoch  19 step    39480 | batches   1662 / 2101 | lr 1.004e-03 | ms/batch 396.7 | tok/s  123902 | loss  3.14 | ppl     23.19
| epoch  19 step    39490 | batches   1672 / 2101 | lr 1.004e-03 | ms/batch 397.5 | tok/s  123665 | loss  3.12 | ppl     22.73
| epoch  19 step    39500 | batches   1682 / 2101 | lr 1.004e-03 | ms/batch 396.9 | tok/s  123848 | loss  3.09 | ppl     21.92
----------------------------------------------------------------------------------------------------
| Eval  79 at step    39500 | time:  0.87s | valid loss  3.14 | valid ppl    23.212
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
| epoch  19 step    39510 | batches   1692 / 2101 | lr 1.004e-03 | ms/batch 402.0 | tok/s  122279 | loss  3.10 | ppl     22.13
| epoch  19 step    39520 | batches   1702 / 2101 | lr 1.003e-03 | ms/batch 411.0 | tok/s  119599 | loss  3.10 | ppl     22.10
| epoch  19 step    39530 | batches   1712 / 2101 | lr 1.003e-03 | ms/batch 397.8 | tok/s  123557 | loss  3.14 | ppl     23.00
| epoch  19 step    39540 | batches   1722 / 2101 | lr 1.003e-03 | ms/batch 396.4 | tok/s  123986 | loss  3.14 | ppl     23.03
| epoch  19 step    39550 | batches   1732 / 2101 | lr 1.003e-03 | ms/batch 396.3 | tok/s  124039 | loss  3.09 | ppl     22.06
| epoch  19 step    39560 | batches   1742 / 2101 | lr 1.003e-03 | ms/batch 395.9 | tok/s  124161 | loss  3.09 | ppl     22.06
| epoch  19 step    39570 | batches   1752 / 2101 | lr 1.003e-03 | ms/batch 397.0 | tok/s  123796 | loss  3.14 | ppl     23.13
| epoch  19 step    39580 | batches   1762 / 2101 | lr 1.003e-03 | ms/batch 397.9 | tok/s  123540 | loss  3.11 | ppl     22.33
| epoch  19 step    39590 | batches   1772 / 2101 | lr 1.002e-03 | ms/batch 407.9 | tok/s  120487 | loss  3.15 | ppl     23.45
| epoch  19 step    39600 | batches   1782 / 2101 | lr 1.002e-03 | ms/batch 406.6 | tok/s  120876 | loss  3.11 | ppl     22.43
| epoch  19 step    39610 | batches   1792 / 2101 | lr 1.002e-03 | ms/batch 417.5 | tok/s  117734 | loss  3.08 | ppl     21.65
| epoch  19 step    39620 | batches   1802 / 2101 | lr 1.002e-03 | ms/batch 397.6 | tok/s  123621 | loss  3.12 | ppl     22.63
| epoch  19 step    39630 | batches   1812 / 2101 | lr 1.002e-03 | ms/batch 397.2 | tok/s  123755 | loss  3.11 | ppl     22.51
| epoch  19 step    39640 | batches   1822 / 2101 | lr 1.002e-03 | ms/batch 397.3 | tok/s  123725 | loss  3.14 | ppl     23.02
| epoch  19 step    39650 | batches   1832 / 2101 | lr 1.002e-03 | ms/batch 397.0 | tok/s  123799 | loss  3.15 | ppl     23.30
| epoch  19 step    39660 | batches   1842 / 2101 | lr 1.002e-03 | ms/batch 396.9 | tok/s  123836 | loss  3.15 | ppl     23.34
| epoch  19 step    39670 | batches   1852 / 2101 | lr 1.002e-03 | ms/batch 409.4 | tok/s  120048 | loss  3.13 | ppl     22.82
| epoch  19 step    39680 | batches   1862 / 2101 | lr 1.001e-03 | ms/batch 397.8 | tok/s  123559 | loss  3.14 | ppl     23.12
| epoch  19 step    39690 | batches   1872 / 2101 | lr 1.001e-03 | ms/batch 396.9 | tok/s  123847 | loss  3.14 | ppl     23.10
| epoch  19 step    39700 | batches   1882 / 2101 | lr 1.001e-03 | ms/batch 397.4 | tok/s  123688 | loss  3.13 | ppl     22.93
| epoch  19 step    39710 | batches   1892 / 2101 | lr 1.001e-03 | ms/batch 397.2 | tok/s  123757 | loss  3.11 | ppl     22.39
| epoch  19 step    39720 | batches   1902 / 2101 | lr 1.001e-03 | ms/batch 396.6 | tok/s  123945 | loss  3.09 | ppl     22.05
| epoch  19 step    39730 | batches   1912 / 2101 | lr 1.001e-03 | ms/batch 396.9 | tok/s  123827 | loss  3.10 | ppl     22.27
| epoch  19 step    39740 | batches   1922 / 2101 | lr 1.001e-03 | ms/batch 397.2 | tok/s  123742 | loss  3.13 | ppl     22.94
| epoch  19 step    39750 | batches   1932 / 2101 | lr 1.001e-03 | ms/batch 397.6 | tok/s  123629 | loss  3.12 | ppl     22.62
| epoch  19 step    39760 | batches   1942 / 2101 | lr 1.001e-03 | ms/batch 398.3 | tok/s  123417 | loss  3.18 | ppl     24.10
| epoch  19 step    39770 | batches   1952 / 2101 | lr 1.001e-03 | ms/batch 408.7 | tok/s  120278 | loss  3.18 | ppl     24.02
| epoch  19 step    39780 | batches   1962 / 2101 | lr 1.001e-03 | ms/batch 398.0 | tok/s  123507 | loss  3.11 | ppl     22.37
| epoch  19 step    39790 | batches   1972 / 2101 | lr 1.001e-03 | ms/batch 396.7 | tok/s  123888 | loss  3.11 | ppl     22.41
| epoch  19 step    39800 | batches   1982 / 2101 | lr 1.001e-03 | ms/batch 397.1 | tok/s  123789 | loss  3.12 | ppl     22.64
| epoch  19 step    39810 | batches   1992 / 2101 | lr 1.001e-03 | ms/batch 396.6 | tok/s  123922 | loss  3.14 | ppl     23.19
| epoch  19 step    39820 | batches   2002 / 2101 | lr 1.000e-03 | ms/batch 397.3 | tok/s  123723 | loss  3.15 | ppl     23.26
| epoch  19 step    39830 | batches   2012 / 2101 | lr 1.000e-03 | ms/batch 397.3 | tok/s  123716 | loss  3.15 | ppl     23.26
| epoch  19 step    39840 | batches   2022 / 2101 | lr 1.000e-03 | ms/batch 397.5 | tok/s  123646 | loss  3.14 | ppl     23.15
| epoch  19 step    39850 | batches   2032 / 2101 | lr 1.000e-03 | ms/batch 397.5 | tok/s  123668 | loss  3.15 | ppl     23.31
| epoch  19 step    39860 | batches   2042 / 2101 | lr 1.000e-03 | ms/batch 396.9 | tok/s  123854 | loss  3.12 | ppl     22.59
| epoch  19 step    39870 | batches   2052 / 2101 | lr 1.000e-03 | ms/batch 397.2 | tok/s  123740 | loss  3.14 | ppl     23.21
| epoch  19 step    39880 | batches   2062 / 2101 | lr 1.000e-03 | ms/batch 396.8 | tok/s  123867 | loss  3.13 | ppl     22.92
| epoch  19 step    39890 | batches   2072 / 2101 | lr 1.000e-03 | ms/batch 406.6 | tok/s  120880 | loss  3.12 | ppl     22.74
| epoch  19 step    39900 | batches   2082 / 2101 | lr 1.000e-03 | ms/batch 397.6 | tok/s  123614 | loss  3.11 | ppl     22.39
| epoch  19 step    39910 | batches   2092 / 2101 | lr 1.000e-03 | ms/batch 397.3 | tok/s  123708 | loss  3.15 | ppl     23.35
| epoch  20 step    39920 | batches      1 / 2101 | lr 1.000e-03 | ms/batch 481.6 | tok/s  108793 | loss  3.71 | ppl     40.74
| epoch  20 step    39930 | batches     11 / 2101 | lr 1.000e-03 | ms/batch 397.3 | tok/s  123727 | loss  3.14 | ppl     23.16
| epoch  20 step    39940 | batches     21 / 2101 | lr 1.000e-03 | ms/batch 396.9 | tok/s  123832 | loss  3.10 | ppl     22.26
| epoch  20 step    39950 | batches     31 / 2101 | lr 1.000e-03 | ms/batch 397.6 | tok/s  123620 | loss  3.11 | ppl     22.53
| epoch  20 step    39960 | batches     41 / 2101 | lr 1.000e-03 | ms/batch 397.1 | tok/s  123786 | loss  3.14 | ppl     23.09
| epoch  20 step    39970 | batches     51 / 2101 | lr 1.000e-03 | ms/batch 397.8 | tok/s  123552 | loss  3.12 | ppl     22.75
| epoch  20 step    39980 | batches     61 / 2101 | lr 1.000e-03 | ms/batch 397.5 | tok/s  123654 | loss  3.15 | ppl     23.23
| epoch  20 step    39990 | batches     71 / 2101 | lr 1.000e-03 | ms/batch 407.9 | tok/s  120486 | loss  3.14 | ppl     23.00
| epoch  20 step    40000 | batches     81 / 2101 | lr 1.000e-03 | ms/batch 410.7 | tok/s  119692 | loss  3.13 | ppl     22.83
----------------------------------------------------------------------------------------------------
| Eval  80 at step    40000 | time:  0.82s | valid loss  3.14 | valid ppl    23.215
----------------------------------------------------------------------------------------------------
Saving checkpoint to TF32/Accordion_16_64LGreco_8_128_new/checkpoint_last.pt
----------------------------------------------------------------------------------------------------
End of training
Loading checkpoint from TF32/Accordion_16_64LGreco_8_128_new/checkpoint_best.pt
====================================================================================================
| End of training | test time:  0.91s | test loss  3.19 | test ppl    24.179
====================================================================================================
Training time: 328.29 minutes
Training throughput: 118063.60 tok/s
